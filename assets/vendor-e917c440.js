function Sp(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const a in i)if(a!=="default"&&!(a in t)){const l=Object.getOwnPropertyDescriptor(i,a);l&&Object.defineProperty(t,a,l.get?l:{enumerable:!0,get:()=>i[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}var Ta=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Rp(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Np={exports:{}},Ue={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rl=Symbol.for("react.element"),kw=Symbol.for("react.portal"),Lw=Symbol.for("react.fragment"),Bw=Symbol.for("react.strict_mode"),Fw=Symbol.for("react.profiler"),Vw=Symbol.for("react.provider"),Uw=Symbol.for("react.context"),zw=Symbol.for("react.forward_ref"),Hw=Symbol.for("react.suspense"),Gw=Symbol.for("react.memo"),Ww=Symbol.for("react.lazy"),e0=Symbol.iterator;function jw(t){return t===null||typeof t!="object"?null:(t=e0&&t[e0]||t["@@iterator"],typeof t=="function"?t:null)}var bp={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Dp=Object.assign,Op={};function ia(t,e,n){this.props=t,this.context=e,this.refs=Op,this.updater=n||bp}ia.prototype.isReactComponent={};ia.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ia.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Pp(){}Pp.prototype=ia.prototype;function p1(t,e,n){this.props=t,this.context=e,this.refs=Op,this.updater=n||bp}var m1=p1.prototype=new Pp;m1.constructor=p1;Dp(m1,ia.prototype);m1.isPureReactComponent=!0;var t0=Array.isArray,Mp=Object.prototype.hasOwnProperty,y1={current:null},kp={key:!0,ref:!0,__self:!0,__source:!0};function Lp(t,e,n){var i,a={},l=null,f=null;if(e!=null)for(i in e.ref!==void 0&&(f=e.ref),e.key!==void 0&&(l=""+e.key),e)Mp.call(e,i)&&!kp.hasOwnProperty(i)&&(a[i]=e[i]);var y=arguments.length-2;if(y===1)a.children=n;else if(1<y){for(var x=Array(y),m=0;m<y;m++)x[m]=arguments[m+2];a.children=x}if(t&&t.defaultProps)for(i in y=t.defaultProps,y)a[i]===void 0&&(a[i]=y[i]);return{$$typeof:Rl,type:t,key:l,ref:f,props:a,_owner:y1.current}}function Xw(t,e){return{$$typeof:Rl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function w1(t){return typeof t=="object"&&t!==null&&t.$$typeof===Rl}function qw(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var n0=/\/+/g;function mh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?qw(""+t.key):e.toString(36)}function Au(t,e,n,i,a){var l=typeof t;(l==="undefined"||l==="boolean")&&(t=null);var f=!1;if(t===null)f=!0;else switch(l){case"string":case"number":f=!0;break;case"object":switch(t.$$typeof){case Rl:case kw:f=!0}}if(f)return f=t,a=a(f),t=i===""?"."+mh(f,0):i,t0(a)?(n="",t!=null&&(n=t.replace(n0,"$&/")+"/"),Au(a,e,n,"",function(m){return m})):a!=null&&(w1(a)&&(a=Xw(a,n+(!a.key||f&&f.key===a.key?"":(""+a.key).replace(n0,"$&/")+"/")+t)),e.push(a)),1;if(f=0,i=i===""?".":i+":",t0(t))for(var y=0;y<t.length;y++){l=t[y];var x=i+mh(l,y);f+=Au(l,e,n,x,a)}else if(x=jw(t),typeof x=="function")for(t=x.call(t),y=0;!(l=t.next()).done;)l=l.value,x=i+mh(l,y++),f+=Au(l,e,n,x,a);else if(l==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return f}function eu(t,e,n){if(t==null)return t;var i=[],a=0;return Au(t,i,"","",function(l){return e.call(n,l,a++)}),i}function Kw(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Fn={current:null},Cu={transition:null},Yw={ReactCurrentDispatcher:Fn,ReactCurrentBatchConfig:Cu,ReactCurrentOwner:y1};function Bp(){throw Error("act(...) is not supported in production builds of React.")}Ue.Children={map:eu,forEach:function(t,e,n){eu(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return eu(t,function(){e++}),e},toArray:function(t){return eu(t,function(e){return e})||[]},only:function(t){if(!w1(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ue.Component=ia;Ue.Fragment=Lw;Ue.Profiler=Fw;Ue.PureComponent=p1;Ue.StrictMode=Bw;Ue.Suspense=Hw;Ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Yw;Ue.act=Bp;Ue.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=Dp({},t.props),a=t.key,l=t.ref,f=t._owner;if(e!=null){if(e.ref!==void 0&&(l=e.ref,f=y1.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var y=t.type.defaultProps;for(x in e)Mp.call(e,x)&&!kp.hasOwnProperty(x)&&(i[x]=e[x]===void 0&&y!==void 0?y[x]:e[x])}var x=arguments.length-2;if(x===1)i.children=n;else if(1<x){y=Array(x);for(var m=0;m<x;m++)y[m]=arguments[m+2];i.children=y}return{$$typeof:Rl,type:t.type,key:a,ref:l,props:i,_owner:f}};Ue.createContext=function(t){return t={$$typeof:Uw,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Vw,_context:t},t.Consumer=t};Ue.createElement=Lp;Ue.createFactory=function(t){var e=Lp.bind(null,t);return e.type=t,e};Ue.createRef=function(){return{current:null}};Ue.forwardRef=function(t){return{$$typeof:zw,render:t}};Ue.isValidElement=w1;Ue.lazy=function(t){return{$$typeof:Ww,_payload:{_status:-1,_result:t},_init:Kw}};Ue.memo=function(t,e){return{$$typeof:Gw,type:t,compare:e===void 0?null:e}};Ue.startTransition=function(t){var e=Cu.transition;Cu.transition={};try{t()}finally{Cu.transition=e}};Ue.unstable_act=Bp;Ue.useCallback=function(t,e){return Fn.current.useCallback(t,e)};Ue.useContext=function(t){return Fn.current.useContext(t)};Ue.useDebugValue=function(){};Ue.useDeferredValue=function(t){return Fn.current.useDeferredValue(t)};Ue.useEffect=function(t,e){return Fn.current.useEffect(t,e)};Ue.useId=function(){return Fn.current.useId()};Ue.useImperativeHandle=function(t,e,n){return Fn.current.useImperativeHandle(t,e,n)};Ue.useInsertionEffect=function(t,e){return Fn.current.useInsertionEffect(t,e)};Ue.useLayoutEffect=function(t,e){return Fn.current.useLayoutEffect(t,e)};Ue.useMemo=function(t,e){return Fn.current.useMemo(t,e)};Ue.useReducer=function(t,e,n){return Fn.current.useReducer(t,e,n)};Ue.useRef=function(t){return Fn.current.useRef(t)};Ue.useState=function(t){return Fn.current.useState(t)};Ue.useSyncExternalStore=function(t,e,n){return Fn.current.useSyncExternalStore(t,e,n)};Ue.useTransition=function(){return Fn.current.useTransition()};Ue.version="18.3.1";Np.exports=Ue;var x1=Np.exports;const Qw=Rp(x1),bT=Sp({__proto__:null,default:Qw},[x1]);var Fp={exports:{}},lr={},Vp={exports:{}},Up={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ge,Ie){var Se=ge.length;ge.push(Ie);e:for(;0<Se;){var ht=Se-1>>>1,Be=ge[ht];if(0<a(Be,Ie))ge[ht]=Ie,ge[Se]=Be,Se=ht;else break e}}function n(ge){return ge.length===0?null:ge[0]}function i(ge){if(ge.length===0)return null;var Ie=ge[0],Se=ge.pop();if(Se!==Ie){ge[0]=Se;e:for(var ht=0,Be=ge.length,On=Be>>>1;ht<On;){var ut=2*(ht+1)-1,Nr=ge[ut],Ee=ut+1,cr=ge[Ee];if(0>a(Nr,Se))Ee<Be&&0>a(cr,Nr)?(ge[ht]=cr,ge[Ee]=Se,ht=Ee):(ge[ht]=Nr,ge[ut]=Se,ht=ut);else if(Ee<Be&&0>a(cr,Se))ge[ht]=cr,ge[Ee]=Se,ht=Ee;else break e}}return Ie}function a(ge,Ie){var Se=ge.sortIndex-Ie.sortIndex;return Se!==0?Se:ge.id-Ie.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var f=Date,y=f.now();t.unstable_now=function(){return f.now()-y}}var x=[],m=[],C=1,v=null,D=3,V=!1,Y=!1,X=!1,ne=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function B(ge){for(var Ie=n(m);Ie!==null;){if(Ie.callback===null)i(m);else if(Ie.startTime<=ge)i(m),Ie.sortIndex=Ie.expirationTime,e(x,Ie);else break;Ie=n(m)}}function $(ge){if(X=!1,B(ge),!Y)if(n(x)!==null)Y=!0,Tt(ce);else{var Ie=n(m);Ie!==null&&Ne($,Ie.startTime-ge)}}function ce(ge,Ie){Y=!1,X&&(X=!1,H(O),O=-1),V=!0;var Se=D;try{for(B(Ie),v=n(x);v!==null&&(!(v.expirationTime>Ie)||ge&&!U());){var ht=v.callback;if(typeof ht=="function"){v.callback=null,D=v.priorityLevel;var Be=ht(v.expirationTime<=Ie);Ie=t.unstable_now(),typeof Be=="function"?v.callback=Be:v===n(x)&&i(x),B(Ie)}else i(x);v=n(x)}if(v!==null)var On=!0;else{var ut=n(m);ut!==null&&Ne($,ut.startTime-Ie),On=!1}return On}finally{v=null,D=Se,V=!1}}var se=!1,N=null,O=-1,b=5,F=-1;function U(){return!(t.unstable_now()-F<b)}function G(){if(N!==null){var ge=t.unstable_now();F=ge;var Ie=!0;try{Ie=N(!0,ge)}finally{Ie?L():(se=!1,N=null)}}else se=!1}var L;if(typeof k=="function")L=function(){k(G)};else if(typeof MessageChannel<"u"){var ze=new MessageChannel,ee=ze.port2;ze.port1.onmessage=G,L=function(){ee.postMessage(null)}}else L=function(){ne(G,0)};function Tt(ge){N=ge,se||(se=!0,L())}function Ne(ge,Ie){O=ne(function(){ge(t.unstable_now())},Ie)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ge){ge.callback=null},t.unstable_continueExecution=function(){Y||V||(Y=!0,Tt(ce))},t.unstable_forceFrameRate=function(ge){0>ge||125<ge?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<ge?Math.floor(1e3/ge):5},t.unstable_getCurrentPriorityLevel=function(){return D},t.unstable_getFirstCallbackNode=function(){return n(x)},t.unstable_next=function(ge){switch(D){case 1:case 2:case 3:var Ie=3;break;default:Ie=D}var Se=D;D=Ie;try{return ge()}finally{D=Se}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ge,Ie){switch(ge){case 1:case 2:case 3:case 4:case 5:break;default:ge=3}var Se=D;D=ge;try{return Ie()}finally{D=Se}},t.unstable_scheduleCallback=function(ge,Ie,Se){var ht=t.unstable_now();switch(typeof Se=="object"&&Se!==null?(Se=Se.delay,Se=typeof Se=="number"&&0<Se?ht+Se:ht):Se=ht,ge){case 1:var Be=-1;break;case 2:Be=250;break;case 5:Be=1073741823;break;case 4:Be=1e4;break;default:Be=5e3}return Be=Se+Be,ge={id:C++,callback:Ie,priorityLevel:ge,startTime:Se,expirationTime:Be,sortIndex:-1},Se>ht?(ge.sortIndex=Se,e(m,ge),n(x)===null&&ge===n(m)&&(X?(H(O),O=-1):X=!0,Ne($,Se-ht))):(ge.sortIndex=Be,e(x,ge),Y||V||(Y=!0,Tt(ce))),ge},t.unstable_shouldYield=U,t.unstable_wrapCallback=function(ge){var Ie=D;return function(){var Se=D;D=Ie;try{return ge.apply(this,arguments)}finally{D=Se}}}})(Up);Vp.exports=Up;var Zw=Vp.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $w=x1,or=Zw;function ae(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var zp=new Set,nl={};function eo(t,e){jo(t,e),jo(t+"Capture",e)}function jo(t,e){for(nl[t]=e,t=0;t<e.length;t++)zp.add(e[t])}var Ii=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),$h=Object.prototype.hasOwnProperty,Jw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,r0={},i0={};function ex(t){return $h.call(i0,t)?!0:$h.call(r0,t)?!1:Jw.test(t)?i0[t]=!0:(r0[t]=!0,!1)}function tx(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function nx(t,e,n,i){if(e===null||typeof e>"u"||tx(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Vn(t,e,n,i,a,l,f){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=l,this.removeEmptyString=f}var En={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){En[t]=new Vn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];En[e]=new Vn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){En[t]=new Vn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){En[t]=new Vn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){En[t]=new Vn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){En[t]=new Vn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){En[t]=new Vn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){En[t]=new Vn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){En[t]=new Vn(t,5,!1,t.toLowerCase(),null,!1,!1)});var E1=/[\-:]([a-z])/g;function _1(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(E1,_1);En[e]=new Vn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(E1,_1);En[e]=new Vn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(E1,_1);En[e]=new Vn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){En[t]=new Vn(t,1,!1,t.toLowerCase(),null,!1,!1)});En.xlinkHref=new Vn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){En[t]=new Vn(t,1,!1,t.toLowerCase(),null,!0,!0)});function A1(t,e,n,i){var a=En.hasOwnProperty(e)?En[e]:null;(a!==null?a.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(nx(e,n,a,i)&&(n=null),i||a===null?ex(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):a.mustUseProperty?t[a.propertyName]=n===null?a.type===3?!1:"":n:(e=a.attributeName,i=a.attributeNamespace,n===null?t.removeAttribute(e):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var Oi=$w.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,tu=Symbol.for("react.element"),Co=Symbol.for("react.portal"),Io=Symbol.for("react.fragment"),C1=Symbol.for("react.strict_mode"),Jh=Symbol.for("react.profiler"),Hp=Symbol.for("react.provider"),Gp=Symbol.for("react.context"),I1=Symbol.for("react.forward_ref"),ef=Symbol.for("react.suspense"),tf=Symbol.for("react.suspense_list"),T1=Symbol.for("react.memo"),Ki=Symbol.for("react.lazy"),Wp=Symbol.for("react.offscreen"),s0=Symbol.iterator;function va(t){return t===null||typeof t!="object"?null:(t=s0&&t[s0]||t["@@iterator"],typeof t=="function"?t:null)}var Pt=Object.assign,yh;function Ma(t){if(yh===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);yh=e&&e[1]||""}return`
`+yh+t}var wh=!1;function xh(t,e){if(!t||wh)return"";wh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(m){var i=m}Reflect.construct(t,[],e)}else{try{e.call()}catch(m){i=m}t.call(e.prototype)}else{try{throw Error()}catch(m){i=m}t()}}catch(m){if(m&&i&&typeof m.stack=="string"){for(var a=m.stack.split(`
`),l=i.stack.split(`
`),f=a.length-1,y=l.length-1;1<=f&&0<=y&&a[f]!==l[y];)y--;for(;1<=f&&0<=y;f--,y--)if(a[f]!==l[y]){if(f!==1||y!==1)do if(f--,y--,0>y||a[f]!==l[y]){var x=`
`+a[f].replace(" at new "," at ");return t.displayName&&x.includes("<anonymous>")&&(x=x.replace("<anonymous>",t.displayName)),x}while(1<=f&&0<=y);break}}}finally{wh=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ma(t):""}function rx(t){switch(t.tag){case 5:return Ma(t.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return t=xh(t.type,!1),t;case 11:return t=xh(t.type.render,!1),t;case 1:return t=xh(t.type,!0),t;default:return""}}function nf(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Io:return"Fragment";case Co:return"Portal";case Jh:return"Profiler";case C1:return"StrictMode";case ef:return"Suspense";case tf:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Gp:return(t.displayName||"Context")+".Consumer";case Hp:return(t._context.displayName||"Context")+".Provider";case I1:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case T1:return e=t.displayName||null,e!==null?e:nf(t.type)||"Memo";case Ki:e=t._payload,t=t._init;try{return nf(t(e))}catch{}}return null}function ix(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return nf(e);case 8:return e===C1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function gs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function jp(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function sx(t){var e=jp(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,l=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(f){i=""+f,l.call(this,f)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(f){i=""+f},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function nu(t){t._valueTracker||(t._valueTracker=sx(t))}function Xp(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=jp(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function Uu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function rf(t,e){var n=e.checked;return Pt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function o0(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=gs(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function qp(t,e){e=e.checked,e!=null&&A1(t,"checked",e,!1)}function sf(t,e){qp(t,e);var n=gs(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?of(t,e.type,n):e.hasOwnProperty("defaultValue")&&of(t,e.type,gs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function a0(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function of(t,e,n){(e!=="number"||Uu(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ka=Array.isArray;function Lo(t,e,n,i){if(t=t.options,e){e={};for(var a=0;a<n.length;a++)e["$"+n[a]]=!0;for(n=0;n<t.length;n++)a=e.hasOwnProperty("$"+t[n].value),t[n].selected!==a&&(t[n].selected=a),a&&i&&(t[n].defaultSelected=!0)}else{for(n=""+gs(n),e=null,a=0;a<t.length;a++){if(t[a].value===n){t[a].selected=!0,i&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function af(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ae(91));return Pt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function l0(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ae(92));if(ka(n)){if(1<n.length)throw Error(ae(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:gs(n)}}function Kp(t,e){var n=gs(e.value),i=gs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function u0(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Yp(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lf(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Yp(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ru,Qp=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,a){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ru=ru||document.createElement("div"),ru.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ru.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function rl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ha={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ox=["Webkit","ms","Moz","O"];Object.keys(Ha).forEach(function(t){ox.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ha[e]=Ha[t]})});function Zp(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ha.hasOwnProperty(t)&&Ha[t]?(""+e).trim():e+"px"}function $p(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,a=Zp(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,a):t[n]=a}}var ax=Pt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function uf(t,e){if(e){if(ax[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ae(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ae(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ae(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ae(62))}}function cf(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hf=null;function v1(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ff=null,Bo=null,Fo=null;function c0(t){if(t=Dl(t)){if(typeof ff!="function")throw Error(ae(280));var e=t.stateNode;e&&(e=Pc(e),ff(t.stateNode,t.type,e))}}function Jp(t){Bo?Fo?Fo.push(t):Fo=[t]:Bo=t}function em(){if(Bo){var t=Bo,e=Fo;if(Fo=Bo=null,c0(t),e)for(t=0;t<e.length;t++)c0(e[t])}}function tm(t,e){return t(e)}function nm(){}var Eh=!1;function rm(t,e,n){if(Eh)return t(e,n);Eh=!0;try{return tm(t,e,n)}finally{Eh=!1,(Bo!==null||Fo!==null)&&(nm(),em())}}function il(t,e){var n=t.stateNode;if(n===null)return null;var i=Pc(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ae(231,e,typeof n));return n}var df=!1;if(Ii)try{var Sa={};Object.defineProperty(Sa,"passive",{get:function(){df=!0}}),window.addEventListener("test",Sa,Sa),window.removeEventListener("test",Sa,Sa)}catch{df=!1}function lx(t,e,n,i,a,l,f,y,x){var m=Array.prototype.slice.call(arguments,3);try{e.apply(n,m)}catch(C){this.onError(C)}}var Ga=!1,zu=null,Hu=!1,gf=null,ux={onError:function(t){Ga=!0,zu=t}};function cx(t,e,n,i,a,l,f,y,x){Ga=!1,zu=null,lx.apply(ux,arguments)}function hx(t,e,n,i,a,l,f,y,x){if(cx.apply(this,arguments),Ga){if(Ga){var m=zu;Ga=!1,zu=null}else throw Error(ae(198));Hu||(Hu=!0,gf=m)}}function to(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function im(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function h0(t){if(to(t)!==t)throw Error(ae(188))}function fx(t){var e=t.alternate;if(!e){if(e=to(t),e===null)throw Error(ae(188));return e!==t?null:t}for(var n=t,i=e;;){var a=n.return;if(a===null)break;var l=a.alternate;if(l===null){if(i=a.return,i!==null){n=i;continue}break}if(a.child===l.child){for(l=a.child;l;){if(l===n)return h0(a),t;if(l===i)return h0(a),e;l=l.sibling}throw Error(ae(188))}if(n.return!==i.return)n=a,i=l;else{for(var f=!1,y=a.child;y;){if(y===n){f=!0,n=a,i=l;break}if(y===i){f=!0,i=a,n=l;break}y=y.sibling}if(!f){for(y=l.child;y;){if(y===n){f=!0,n=l,i=a;break}if(y===i){f=!0,i=l,n=a;break}y=y.sibling}if(!f)throw Error(ae(189))}}if(n.alternate!==i)throw Error(ae(190))}if(n.tag!==3)throw Error(ae(188));return n.stateNode.current===n?t:e}function sm(t){return t=fx(t),t!==null?om(t):null}function om(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=om(t);if(e!==null)return e;t=t.sibling}return null}var am=or.unstable_scheduleCallback,f0=or.unstable_cancelCallback,dx=or.unstable_shouldYield,gx=or.unstable_requestPaint,Gt=or.unstable_now,px=or.unstable_getCurrentPriorityLevel,S1=or.unstable_ImmediatePriority,lm=or.unstable_UserBlockingPriority,Gu=or.unstable_NormalPriority,mx=or.unstable_LowPriority,um=or.unstable_IdlePriority,Nc=null,ii=null;function yx(t){if(ii&&typeof ii.onCommitFiberRoot=="function")try{ii.onCommitFiberRoot(Nc,t,void 0,(t.current.flags&128)===128)}catch{}}var Ur=Math.clz32?Math.clz32:Ex,wx=Math.log,xx=Math.LN2;function Ex(t){return t>>>=0,t===0?32:31-(wx(t)/xx|0)|0}var iu=64,su=4194304;function La(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Wu(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,a=t.suspendedLanes,l=t.pingedLanes,f=n&268435455;if(f!==0){var y=f&~a;y!==0?i=La(y):(l&=f,l!==0&&(i=La(l)))}else f=n&~a,f!==0?i=La(f):l!==0&&(i=La(l));if(i===0)return 0;if(e!==0&&e!==i&&!(e&a)&&(a=i&-i,l=e&-e,a>=l||a===16&&(l&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-Ur(e),a=1<<n,i|=t[n],e&=~a;return i}function _x(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ax(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,a=t.expirationTimes,l=t.pendingLanes;0<l;){var f=31-Ur(l),y=1<<f,x=a[f];x===-1?(!(y&n)||y&i)&&(a[f]=_x(y,e)):x<=e&&(t.expiredLanes|=y),l&=~y}}function pf(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function cm(){var t=iu;return iu<<=1,!(iu&4194240)&&(iu=64),t}function _h(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Nl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ur(e),t[e]=n}function Cx(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var a=31-Ur(n),l=1<<a;e[a]=0,i[a]=-1,t[a]=-1,n&=~l}}function R1(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-Ur(n),a=1<<i;a&e|t[i]&e&&(t[i]|=e),n&=~a}}var lt=0;function hm(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var fm,N1,dm,gm,pm,mf=!1,ou=[],ns=null,rs=null,is=null,sl=new Map,ol=new Map,Qi=[],Ix="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function d0(t,e){switch(t){case"focusin":case"focusout":ns=null;break;case"dragenter":case"dragleave":rs=null;break;case"mouseover":case"mouseout":is=null;break;case"pointerover":case"pointerout":sl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ol.delete(e.pointerId)}}function Ra(t,e,n,i,a,l){return t===null||t.nativeEvent!==l?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:l,targetContainers:[a]},e!==null&&(e=Dl(e),e!==null&&N1(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function Tx(t,e,n,i,a){switch(e){case"focusin":return ns=Ra(ns,t,e,n,i,a),!0;case"dragenter":return rs=Ra(rs,t,e,n,i,a),!0;case"mouseover":return is=Ra(is,t,e,n,i,a),!0;case"pointerover":var l=a.pointerId;return sl.set(l,Ra(sl.get(l)||null,t,e,n,i,a)),!0;case"gotpointercapture":return l=a.pointerId,ol.set(l,Ra(ol.get(l)||null,t,e,n,i,a)),!0}return!1}function mm(t){var e=Us(t.target);if(e!==null){var n=to(e);if(n!==null){if(e=n.tag,e===13){if(e=im(n),e!==null){t.blockedOn=e,pm(t.priority,function(){dm(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Iu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=yf(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);hf=i,n.target.dispatchEvent(i),hf=null}else return e=Dl(n),e!==null&&N1(e),t.blockedOn=n,!1;e.shift()}return!0}function g0(t,e,n){Iu(t)&&n.delete(e)}function vx(){mf=!1,ns!==null&&Iu(ns)&&(ns=null),rs!==null&&Iu(rs)&&(rs=null),is!==null&&Iu(is)&&(is=null),sl.forEach(g0),ol.forEach(g0)}function Na(t,e){t.blockedOn===e&&(t.blockedOn=null,mf||(mf=!0,or.unstable_scheduleCallback(or.unstable_NormalPriority,vx)))}function al(t){function e(a){return Na(a,t)}if(0<ou.length){Na(ou[0],t);for(var n=1;n<ou.length;n++){var i=ou[n];i.blockedOn===t&&(i.blockedOn=null)}}for(ns!==null&&Na(ns,t),rs!==null&&Na(rs,t),is!==null&&Na(is,t),sl.forEach(e),ol.forEach(e),n=0;n<Qi.length;n++)i=Qi[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<Qi.length&&(n=Qi[0],n.blockedOn===null);)mm(n),n.blockedOn===null&&Qi.shift()}var Vo=Oi.ReactCurrentBatchConfig,ju=!0;function Sx(t,e,n,i){var a=lt,l=Vo.transition;Vo.transition=null;try{lt=1,b1(t,e,n,i)}finally{lt=a,Vo.transition=l}}function Rx(t,e,n,i){var a=lt,l=Vo.transition;Vo.transition=null;try{lt=4,b1(t,e,n,i)}finally{lt=a,Vo.transition=l}}function b1(t,e,n,i){if(ju){var a=yf(t,e,n,i);if(a===null)Dh(t,e,i,Xu,n),d0(t,i);else if(Tx(a,t,e,n,i))i.stopPropagation();else if(d0(t,i),e&4&&-1<Ix.indexOf(t)){for(;a!==null;){var l=Dl(a);if(l!==null&&fm(l),l=yf(t,e,n,i),l===null&&Dh(t,e,i,Xu,n),l===a)break;a=l}a!==null&&i.stopPropagation()}else Dh(t,e,i,null,n)}}var Xu=null;function yf(t,e,n,i){if(Xu=null,t=v1(i),t=Us(t),t!==null)if(e=to(t),e===null)t=null;else if(n=e.tag,n===13){if(t=im(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Xu=t,null}function ym(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(px()){case S1:return 1;case lm:return 4;case Gu:case mx:return 16;case um:return 536870912;default:return 16}default:return 16}}var Ji=null,D1=null,Tu=null;function wm(){if(Tu)return Tu;var t,e=D1,n=e.length,i,a="value"in Ji?Ji.value:Ji.textContent,l=a.length;for(t=0;t<n&&e[t]===a[t];t++);var f=n-t;for(i=1;i<=f&&e[n-i]===a[l-i];i++);return Tu=a.slice(t,1<i?1-i:void 0)}function vu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function au(){return!0}function p0(){return!1}function ur(t){function e(n,i,a,l,f){this._reactName=n,this._targetInst=a,this.type=i,this.nativeEvent=l,this.target=f,this.currentTarget=null;for(var y in t)t.hasOwnProperty(y)&&(n=t[y],this[y]=n?n(l):l[y]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?au:p0,this.isPropagationStopped=p0,this}return Pt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=au)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=au)},persist:function(){},isPersistent:au}),e}var sa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},O1=ur(sa),bl=Pt({},sa,{view:0,detail:0}),Nx=ur(bl),Ah,Ch,ba,bc=Pt({},bl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:P1,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ba&&(ba&&t.type==="mousemove"?(Ah=t.screenX-ba.screenX,Ch=t.screenY-ba.screenY):Ch=Ah=0,ba=t),Ah)},movementY:function(t){return"movementY"in t?t.movementY:Ch}}),m0=ur(bc),bx=Pt({},bc,{dataTransfer:0}),Dx=ur(bx),Ox=Pt({},bl,{relatedTarget:0}),Ih=ur(Ox),Px=Pt({},sa,{animationName:0,elapsedTime:0,pseudoElement:0}),Mx=ur(Px),kx=Pt({},sa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Lx=ur(kx),Bx=Pt({},sa,{data:0}),y0=ur(Bx),Fx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Vx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ux={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zx(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Ux[t])?!!e[t]:!1}function P1(){return zx}var Hx=Pt({},bl,{key:function(t){if(t.key){var e=Fx[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=vu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Vx[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:P1,charCode:function(t){return t.type==="keypress"?vu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?vu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Gx=ur(Hx),Wx=Pt({},bc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),w0=ur(Wx),jx=Pt({},bl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:P1}),Xx=ur(jx),qx=Pt({},sa,{propertyName:0,elapsedTime:0,pseudoElement:0}),Kx=ur(qx),Yx=Pt({},bc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Qx=ur(Yx),Zx=[9,13,27,32],M1=Ii&&"CompositionEvent"in window,Wa=null;Ii&&"documentMode"in document&&(Wa=document.documentMode);var $x=Ii&&"TextEvent"in window&&!Wa,xm=Ii&&(!M1||Wa&&8<Wa&&11>=Wa),x0=String.fromCharCode(32),E0=!1;function Em(t,e){switch(t){case"keyup":return Zx.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _m(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var To=!1;function Jx(t,e){switch(t){case"compositionend":return _m(e);case"keypress":return e.which!==32?null:(E0=!0,x0);case"textInput":return t=e.data,t===x0&&E0?null:t;default:return null}}function eE(t,e){if(To)return t==="compositionend"||!M1&&Em(t,e)?(t=wm(),Tu=D1=Ji=null,To=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return xm&&e.locale!=="ko"?null:e.data;default:return null}}var tE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!tE[t.type]:e==="textarea"}function Am(t,e,n,i){Jp(i),e=qu(e,"onChange"),0<e.length&&(n=new O1("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var ja=null,ll=null;function nE(t){Pm(t,0)}function Dc(t){var e=Ro(t);if(Xp(e))return t}function rE(t,e){if(t==="change")return e}var Cm=!1;if(Ii){var Th;if(Ii){var vh="oninput"in document;if(!vh){var A0=document.createElement("div");A0.setAttribute("oninput","return;"),vh=typeof A0.oninput=="function"}Th=vh}else Th=!1;Cm=Th&&(!document.documentMode||9<document.documentMode)}function C0(){ja&&(ja.detachEvent("onpropertychange",Im),ll=ja=null)}function Im(t){if(t.propertyName==="value"&&Dc(ll)){var e=[];Am(e,ll,t,v1(t)),rm(nE,e)}}function iE(t,e,n){t==="focusin"?(C0(),ja=e,ll=n,ja.attachEvent("onpropertychange",Im)):t==="focusout"&&C0()}function sE(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Dc(ll)}function oE(t,e){if(t==="click")return Dc(e)}function aE(t,e){if(t==="input"||t==="change")return Dc(e)}function lE(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Hr=typeof Object.is=="function"?Object.is:lE;function ul(t,e){if(Hr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var a=n[i];if(!$h.call(e,a)||!Hr(t[a],e[a]))return!1}return!0}function I0(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function T0(t,e){var n=I0(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=I0(n)}}function Tm(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Tm(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function vm(){for(var t=window,e=Uu();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Uu(t.document)}return e}function k1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function uE(t){var e=vm(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Tm(n.ownerDocument.documentElement,n)){if(i!==null&&k1(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=n.textContent.length,l=Math.min(i.start,a);i=i.end===void 0?l:Math.min(i.end,a),!t.extend&&l>i&&(a=i,i=l,l=a),a=T0(n,l);var f=T0(n,i);a&&f&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==f.node||t.focusOffset!==f.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),l>i?(t.addRange(e),t.extend(f.node,f.offset)):(e.setEnd(f.node,f.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var cE=Ii&&"documentMode"in document&&11>=document.documentMode,vo=null,wf=null,Xa=null,xf=!1;function v0(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;xf||vo==null||vo!==Uu(i)||(i=vo,"selectionStart"in i&&k1(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Xa&&ul(Xa,i)||(Xa=i,i=qu(wf,"onSelect"),0<i.length&&(e=new O1("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=vo)))}function lu(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var So={animationend:lu("Animation","AnimationEnd"),animationiteration:lu("Animation","AnimationIteration"),animationstart:lu("Animation","AnimationStart"),transitionend:lu("Transition","TransitionEnd")},Sh={},Sm={};Ii&&(Sm=document.createElement("div").style,"AnimationEvent"in window||(delete So.animationend.animation,delete So.animationiteration.animation,delete So.animationstart.animation),"TransitionEvent"in window||delete So.transitionend.transition);function Oc(t){if(Sh[t])return Sh[t];if(!So[t])return t;var e=So[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Sm)return Sh[t]=e[n];return t}var Rm=Oc("animationend"),Nm=Oc("animationiteration"),bm=Oc("animationstart"),Dm=Oc("transitionend"),Om=new Map,S0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function As(t,e){Om.set(t,e),eo(e,[t])}for(var Rh=0;Rh<S0.length;Rh++){var Nh=S0[Rh],hE=Nh.toLowerCase(),fE=Nh[0].toUpperCase()+Nh.slice(1);As(hE,"on"+fE)}As(Rm,"onAnimationEnd");As(Nm,"onAnimationIteration");As(bm,"onAnimationStart");As("dblclick","onDoubleClick");As("focusin","onFocus");As("focusout","onBlur");As(Dm,"onTransitionEnd");jo("onMouseEnter",["mouseout","mouseover"]);jo("onMouseLeave",["mouseout","mouseover"]);jo("onPointerEnter",["pointerout","pointerover"]);jo("onPointerLeave",["pointerout","pointerover"]);eo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));eo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));eo("onBeforeInput",["compositionend","keypress","textInput","paste"]);eo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));eo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));eo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ba="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dE=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ba));function R0(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,hx(i,e,void 0,t),t.currentTarget=null}function Pm(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],a=i.event;i=i.listeners;e:{var l=void 0;if(e)for(var f=i.length-1;0<=f;f--){var y=i[f],x=y.instance,m=y.currentTarget;if(y=y.listener,x!==l&&a.isPropagationStopped())break e;R0(a,y,m),l=x}else for(f=0;f<i.length;f++){if(y=i[f],x=y.instance,m=y.currentTarget,y=y.listener,x!==l&&a.isPropagationStopped())break e;R0(a,y,m),l=x}}}if(Hu)throw t=gf,Hu=!1,gf=null,t}function _t(t,e){var n=e[If];n===void 0&&(n=e[If]=new Set);var i=t+"__bubble";n.has(i)||(Mm(e,t,2,!1),n.add(i))}function bh(t,e,n){var i=0;e&&(i|=4),Mm(n,t,i,e)}var uu="_reactListening"+Math.random().toString(36).slice(2);function cl(t){if(!t[uu]){t[uu]=!0,zp.forEach(function(n){n!=="selectionchange"&&(dE.has(n)||bh(n,!1,t),bh(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[uu]||(e[uu]=!0,bh("selectionchange",!1,e))}}function Mm(t,e,n,i){switch(ym(e)){case 1:var a=Sx;break;case 4:a=Rx;break;default:a=b1}n=a.bind(null,e,n,t),a=void 0,!df||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),i?a!==void 0?t.addEventListener(e,n,{capture:!0,passive:a}):t.addEventListener(e,n,!0):a!==void 0?t.addEventListener(e,n,{passive:a}):t.addEventListener(e,n,!1)}function Dh(t,e,n,i,a){var l=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var f=i.tag;if(f===3||f===4){var y=i.stateNode.containerInfo;if(y===a||y.nodeType===8&&y.parentNode===a)break;if(f===4)for(f=i.return;f!==null;){var x=f.tag;if((x===3||x===4)&&(x=f.stateNode.containerInfo,x===a||x.nodeType===8&&x.parentNode===a))return;f=f.return}for(;y!==null;){if(f=Us(y),f===null)return;if(x=f.tag,x===5||x===6){i=l=f;continue e}y=y.parentNode}}i=i.return}rm(function(){var m=l,C=v1(n),v=[];e:{var D=Om.get(t);if(D!==void 0){var V=O1,Y=t;switch(t){case"keypress":if(vu(n)===0)break e;case"keydown":case"keyup":V=Gx;break;case"focusin":Y="focus",V=Ih;break;case"focusout":Y="blur",V=Ih;break;case"beforeblur":case"afterblur":V=Ih;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":V=m0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":V=Dx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":V=Xx;break;case Rm:case Nm:case bm:V=Mx;break;case Dm:V=Kx;break;case"scroll":V=Nx;break;case"wheel":V=Qx;break;case"copy":case"cut":case"paste":V=Lx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":V=w0}var X=(e&4)!==0,ne=!X&&t==="scroll",H=X?D!==null?D+"Capture":null:D;X=[];for(var k=m,B;k!==null;){B=k;var $=B.stateNode;if(B.tag===5&&$!==null&&(B=$,H!==null&&($=il(k,H),$!=null&&X.push(hl(k,$,B)))),ne)break;k=k.return}0<X.length&&(D=new V(D,Y,null,n,C),v.push({event:D,listeners:X}))}}if(!(e&7)){e:{if(D=t==="mouseover"||t==="pointerover",V=t==="mouseout"||t==="pointerout",D&&n!==hf&&(Y=n.relatedTarget||n.fromElement)&&(Us(Y)||Y[Ti]))break e;if((V||D)&&(D=C.window===C?C:(D=C.ownerDocument)?D.defaultView||D.parentWindow:window,V?(Y=n.relatedTarget||n.toElement,V=m,Y=Y?Us(Y):null,Y!==null&&(ne=to(Y),Y!==ne||Y.tag!==5&&Y.tag!==6)&&(Y=null)):(V=null,Y=m),V!==Y)){if(X=m0,$="onMouseLeave",H="onMouseEnter",k="mouse",(t==="pointerout"||t==="pointerover")&&(X=w0,$="onPointerLeave",H="onPointerEnter",k="pointer"),ne=V==null?D:Ro(V),B=Y==null?D:Ro(Y),D=new X($,k+"leave",V,n,C),D.target=ne,D.relatedTarget=B,$=null,Us(C)===m&&(X=new X(H,k+"enter",Y,n,C),X.target=B,X.relatedTarget=ne,$=X),ne=$,V&&Y)t:{for(X=V,H=Y,k=0,B=X;B;B=xo(B))k++;for(B=0,$=H;$;$=xo($))B++;for(;0<k-B;)X=xo(X),k--;for(;0<B-k;)H=xo(H),B--;for(;k--;){if(X===H||H!==null&&X===H.alternate)break t;X=xo(X),H=xo(H)}X=null}else X=null;V!==null&&N0(v,D,V,X,!1),Y!==null&&ne!==null&&N0(v,ne,Y,X,!0)}}e:{if(D=m?Ro(m):window,V=D.nodeName&&D.nodeName.toLowerCase(),V==="select"||V==="input"&&D.type==="file")var ce=rE;else if(_0(D))if(Cm)ce=aE;else{ce=sE;var se=iE}else(V=D.nodeName)&&V.toLowerCase()==="input"&&(D.type==="checkbox"||D.type==="radio")&&(ce=oE);if(ce&&(ce=ce(t,m))){Am(v,ce,n,C);break e}se&&se(t,D,m),t==="focusout"&&(se=D._wrapperState)&&se.controlled&&D.type==="number"&&of(D,"number",D.value)}switch(se=m?Ro(m):window,t){case"focusin":(_0(se)||se.contentEditable==="true")&&(vo=se,wf=m,Xa=null);break;case"focusout":Xa=wf=vo=null;break;case"mousedown":xf=!0;break;case"contextmenu":case"mouseup":case"dragend":xf=!1,v0(v,n,C);break;case"selectionchange":if(cE)break;case"keydown":case"keyup":v0(v,n,C)}var N;if(M1)e:{switch(t){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else To?Em(t,n)&&(O="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(O="onCompositionStart");O&&(xm&&n.locale!=="ko"&&(To||O!=="onCompositionStart"?O==="onCompositionEnd"&&To&&(N=wm()):(Ji=C,D1="value"in Ji?Ji.value:Ji.textContent,To=!0)),se=qu(m,O),0<se.length&&(O=new y0(O,t,null,n,C),v.push({event:O,listeners:se}),N?O.data=N:(N=_m(n),N!==null&&(O.data=N)))),(N=$x?Jx(t,n):eE(t,n))&&(m=qu(m,"onBeforeInput"),0<m.length&&(C=new y0("onBeforeInput","beforeinput",null,n,C),v.push({event:C,listeners:m}),C.data=N))}Pm(v,e)})}function hl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function qu(t,e){for(var n=e+"Capture",i=[];t!==null;){var a=t,l=a.stateNode;a.tag===5&&l!==null&&(a=l,l=il(t,n),l!=null&&i.unshift(hl(t,l,a)),l=il(t,e),l!=null&&i.push(hl(t,l,a))),t=t.return}return i}function xo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function N0(t,e,n,i,a){for(var l=e._reactName,f=[];n!==null&&n!==i;){var y=n,x=y.alternate,m=y.stateNode;if(x!==null&&x===i)break;y.tag===5&&m!==null&&(y=m,a?(x=il(n,l),x!=null&&f.unshift(hl(n,x,y))):a||(x=il(n,l),x!=null&&f.push(hl(n,x,y)))),n=n.return}f.length!==0&&t.push({event:e,listeners:f})}var gE=/\r\n?/g,pE=/\u0000|\uFFFD/g;function b0(t){return(typeof t=="string"?t:""+t).replace(gE,`
`).replace(pE,"")}function cu(t,e,n){if(e=b0(e),b0(t)!==e&&n)throw Error(ae(425))}function Ku(){}var Ef=null,_f=null;function Af(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Cf=typeof setTimeout=="function"?setTimeout:void 0,mE=typeof clearTimeout=="function"?clearTimeout:void 0,D0=typeof Promise=="function"?Promise:void 0,yE=typeof queueMicrotask=="function"?queueMicrotask:typeof D0<"u"?function(t){return D0.resolve(null).then(t).catch(wE)}:Cf;function wE(t){setTimeout(function(){throw t})}function Oh(t,e){var n=e,i=0;do{var a=n.nextSibling;if(t.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(i===0){t.removeChild(a),al(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=a}while(n);al(e)}function ss(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function O0(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var oa=Math.random().toString(36).slice(2),ri="__reactFiber$"+oa,fl="__reactProps$"+oa,Ti="__reactContainer$"+oa,If="__reactEvents$"+oa,xE="__reactListeners$"+oa,EE="__reactHandles$"+oa;function Us(t){var e=t[ri];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ti]||n[ri]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=O0(t);t!==null;){if(n=t[ri])return n;t=O0(t)}return e}t=n,n=t.parentNode}return null}function Dl(t){return t=t[ri]||t[Ti],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ro(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ae(33))}function Pc(t){return t[fl]||null}var Tf=[],No=-1;function Cs(t){return{current:t}}function It(t){0>No||(t.current=Tf[No],Tf[No]=null,No--)}function yt(t,e){No++,Tf[No]=t.current,t.current=e}var ps={},Dn=Cs(ps),Qn=Cs(!1),qs=ps;function Xo(t,e){var n=t.type.contextTypes;if(!n)return ps;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var a={},l;for(l in n)a[l]=e[l];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function Zn(t){return t=t.childContextTypes,t!=null}function Yu(){It(Qn),It(Dn)}function P0(t,e,n){if(Dn.current!==ps)throw Error(ae(168));yt(Dn,e),yt(Qn,n)}function km(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var a in i)if(!(a in e))throw Error(ae(108,ix(t)||"Unknown",a));return Pt({},n,i)}function Qu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ps,qs=Dn.current,yt(Dn,t),yt(Qn,Qn.current),!0}function M0(t,e,n){var i=t.stateNode;if(!i)throw Error(ae(169));n?(t=km(t,e,qs),i.__reactInternalMemoizedMergedChildContext=t,It(Qn),It(Dn),yt(Dn,t)):It(Qn),yt(Qn,n)}var Ei=null,Mc=!1,Ph=!1;function Lm(t){Ei===null?Ei=[t]:Ei.push(t)}function _E(t){Mc=!0,Lm(t)}function Is(){if(!Ph&&Ei!==null){Ph=!0;var t=0,e=lt;try{var n=Ei;for(lt=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}Ei=null,Mc=!1}catch(a){throw Ei!==null&&(Ei=Ei.slice(t+1)),am(S1,Is),a}finally{lt=e,Ph=!1}}return null}var bo=[],Do=0,Zu=null,$u=0,_r=[],Ar=0,Ks=null,_i=1,Ai="";function Bs(t,e){bo[Do++]=$u,bo[Do++]=Zu,Zu=t,$u=e}function Bm(t,e,n){_r[Ar++]=_i,_r[Ar++]=Ai,_r[Ar++]=Ks,Ks=t;var i=_i;t=Ai;var a=32-Ur(i)-1;i&=~(1<<a),n+=1;var l=32-Ur(e)+a;if(30<l){var f=a-a%5;l=(i&(1<<f)-1).toString(32),i>>=f,a-=f,_i=1<<32-Ur(e)+a|n<<a|i,Ai=l+t}else _i=1<<l|n<<a|i,Ai=t}function L1(t){t.return!==null&&(Bs(t,1),Bm(t,1,0))}function B1(t){for(;t===Zu;)Zu=bo[--Do],bo[Do]=null,$u=bo[--Do],bo[Do]=null;for(;t===Ks;)Ks=_r[--Ar],_r[Ar]=null,Ai=_r[--Ar],_r[Ar]=null,_i=_r[--Ar],_r[Ar]=null}var sr=null,rr=null,vt=!1,Vr=null;function Fm(t,e){var n=Ir(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function k0(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,sr=t,rr=ss(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,sr=t,rr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ks!==null?{id:_i,overflow:Ai}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ir(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,sr=t,rr=null,!0):!1;default:return!1}}function vf(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Sf(t){if(vt){var e=rr;if(e){var n=e;if(!k0(t,e)){if(vf(t))throw Error(ae(418));e=ss(n.nextSibling);var i=sr;e&&k0(t,e)?Fm(i,n):(t.flags=t.flags&-4097|2,vt=!1,sr=t)}}else{if(vf(t))throw Error(ae(418));t.flags=t.flags&-4097|2,vt=!1,sr=t}}}function L0(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;sr=t}function hu(t){if(t!==sr)return!1;if(!vt)return L0(t),vt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Af(t.type,t.memoizedProps)),e&&(e=rr)){if(vf(t))throw Vm(),Error(ae(418));for(;e;)Fm(t,e),e=ss(e.nextSibling)}if(L0(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ae(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){rr=ss(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}rr=null}}else rr=sr?ss(t.stateNode.nextSibling):null;return!0}function Vm(){for(var t=rr;t;)t=ss(t.nextSibling)}function qo(){rr=sr=null,vt=!1}function F1(t){Vr===null?Vr=[t]:Vr.push(t)}var AE=Oi.ReactCurrentBatchConfig;function Da(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ae(309));var i=n.stateNode}if(!i)throw Error(ae(147,t));var a=i,l=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===l?e.ref:(e=function(f){var y=a.refs;f===null?delete y[l]:y[l]=f},e._stringRef=l,e)}if(typeof t!="string")throw Error(ae(284));if(!n._owner)throw Error(ae(290,t))}return t}function fu(t,e){throw t=Object.prototype.toString.call(e),Error(ae(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function B0(t){var e=t._init;return e(t._payload)}function Um(t){function e(H,k){if(t){var B=H.deletions;B===null?(H.deletions=[k],H.flags|=16):B.push(k)}}function n(H,k){if(!t)return null;for(;k!==null;)e(H,k),k=k.sibling;return null}function i(H,k){for(H=new Map;k!==null;)k.key!==null?H.set(k.key,k):H.set(k.index,k),k=k.sibling;return H}function a(H,k){return H=us(H,k),H.index=0,H.sibling=null,H}function l(H,k,B){return H.index=B,t?(B=H.alternate,B!==null?(B=B.index,B<k?(H.flags|=2,k):B):(H.flags|=2,k)):(H.flags|=1048576,k)}function f(H){return t&&H.alternate===null&&(H.flags|=2),H}function y(H,k,B,$){return k===null||k.tag!==6?(k=Uh(B,H.mode,$),k.return=H,k):(k=a(k,B),k.return=H,k)}function x(H,k,B,$){var ce=B.type;return ce===Io?C(H,k,B.props.children,$,B.key):k!==null&&(k.elementType===ce||typeof ce=="object"&&ce!==null&&ce.$$typeof===Ki&&B0(ce)===k.type)?($=a(k,B.props),$.ref=Da(H,k,B),$.return=H,$):($=Pu(B.type,B.key,B.props,null,H.mode,$),$.ref=Da(H,k,B),$.return=H,$)}function m(H,k,B,$){return k===null||k.tag!==4||k.stateNode.containerInfo!==B.containerInfo||k.stateNode.implementation!==B.implementation?(k=zh(B,H.mode,$),k.return=H,k):(k=a(k,B.children||[]),k.return=H,k)}function C(H,k,B,$,ce){return k===null||k.tag!==7?(k=js(B,H.mode,$,ce),k.return=H,k):(k=a(k,B),k.return=H,k)}function v(H,k,B){if(typeof k=="string"&&k!==""||typeof k=="number")return k=Uh(""+k,H.mode,B),k.return=H,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case tu:return B=Pu(k.type,k.key,k.props,null,H.mode,B),B.ref=Da(H,null,k),B.return=H,B;case Co:return k=zh(k,H.mode,B),k.return=H,k;case Ki:var $=k._init;return v(H,$(k._payload),B)}if(ka(k)||va(k))return k=js(k,H.mode,B,null),k.return=H,k;fu(H,k)}return null}function D(H,k,B,$){var ce=k!==null?k.key:null;if(typeof B=="string"&&B!==""||typeof B=="number")return ce!==null?null:y(H,k,""+B,$);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case tu:return B.key===ce?x(H,k,B,$):null;case Co:return B.key===ce?m(H,k,B,$):null;case Ki:return ce=B._init,D(H,k,ce(B._payload),$)}if(ka(B)||va(B))return ce!==null?null:C(H,k,B,$,null);fu(H,B)}return null}function V(H,k,B,$,ce){if(typeof $=="string"&&$!==""||typeof $=="number")return H=H.get(B)||null,y(k,H,""+$,ce);if(typeof $=="object"&&$!==null){switch($.$$typeof){case tu:return H=H.get($.key===null?B:$.key)||null,x(k,H,$,ce);case Co:return H=H.get($.key===null?B:$.key)||null,m(k,H,$,ce);case Ki:var se=$._init;return V(H,k,B,se($._payload),ce)}if(ka($)||va($))return H=H.get(B)||null,C(k,H,$,ce,null);fu(k,$)}return null}function Y(H,k,B,$){for(var ce=null,se=null,N=k,O=k=0,b=null;N!==null&&O<B.length;O++){N.index>O?(b=N,N=null):b=N.sibling;var F=D(H,N,B[O],$);if(F===null){N===null&&(N=b);break}t&&N&&F.alternate===null&&e(H,N),k=l(F,k,O),se===null?ce=F:se.sibling=F,se=F,N=b}if(O===B.length)return n(H,N),vt&&Bs(H,O),ce;if(N===null){for(;O<B.length;O++)N=v(H,B[O],$),N!==null&&(k=l(N,k,O),se===null?ce=N:se.sibling=N,se=N);return vt&&Bs(H,O),ce}for(N=i(H,N);O<B.length;O++)b=V(N,H,O,B[O],$),b!==null&&(t&&b.alternate!==null&&N.delete(b.key===null?O:b.key),k=l(b,k,O),se===null?ce=b:se.sibling=b,se=b);return t&&N.forEach(function(U){return e(H,U)}),vt&&Bs(H,O),ce}function X(H,k,B,$){var ce=va(B);if(typeof ce!="function")throw Error(ae(150));if(B=ce.call(B),B==null)throw Error(ae(151));for(var se=ce=null,N=k,O=k=0,b=null,F=B.next();N!==null&&!F.done;O++,F=B.next()){N.index>O?(b=N,N=null):b=N.sibling;var U=D(H,N,F.value,$);if(U===null){N===null&&(N=b);break}t&&N&&U.alternate===null&&e(H,N),k=l(U,k,O),se===null?ce=U:se.sibling=U,se=U,N=b}if(F.done)return n(H,N),vt&&Bs(H,O),ce;if(N===null){for(;!F.done;O++,F=B.next())F=v(H,F.value,$),F!==null&&(k=l(F,k,O),se===null?ce=F:se.sibling=F,se=F);return vt&&Bs(H,O),ce}for(N=i(H,N);!F.done;O++,F=B.next())F=V(N,H,O,F.value,$),F!==null&&(t&&F.alternate!==null&&N.delete(F.key===null?O:F.key),k=l(F,k,O),se===null?ce=F:se.sibling=F,se=F);return t&&N.forEach(function(G){return e(H,G)}),vt&&Bs(H,O),ce}function ne(H,k,B,$){if(typeof B=="object"&&B!==null&&B.type===Io&&B.key===null&&(B=B.props.children),typeof B=="object"&&B!==null){switch(B.$$typeof){case tu:e:{for(var ce=B.key,se=k;se!==null;){if(se.key===ce){if(ce=B.type,ce===Io){if(se.tag===7){n(H,se.sibling),k=a(se,B.props.children),k.return=H,H=k;break e}}else if(se.elementType===ce||typeof ce=="object"&&ce!==null&&ce.$$typeof===Ki&&B0(ce)===se.type){n(H,se.sibling),k=a(se,B.props),k.ref=Da(H,se,B),k.return=H,H=k;break e}n(H,se);break}else e(H,se);se=se.sibling}B.type===Io?(k=js(B.props.children,H.mode,$,B.key),k.return=H,H=k):($=Pu(B.type,B.key,B.props,null,H.mode,$),$.ref=Da(H,k,B),$.return=H,H=$)}return f(H);case Co:e:{for(se=B.key;k!==null;){if(k.key===se)if(k.tag===4&&k.stateNode.containerInfo===B.containerInfo&&k.stateNode.implementation===B.implementation){n(H,k.sibling),k=a(k,B.children||[]),k.return=H,H=k;break e}else{n(H,k);break}else e(H,k);k=k.sibling}k=zh(B,H.mode,$),k.return=H,H=k}return f(H);case Ki:return se=B._init,ne(H,k,se(B._payload),$)}if(ka(B))return Y(H,k,B,$);if(va(B))return X(H,k,B,$);fu(H,B)}return typeof B=="string"&&B!==""||typeof B=="number"?(B=""+B,k!==null&&k.tag===6?(n(H,k.sibling),k=a(k,B),k.return=H,H=k):(n(H,k),k=Uh(B,H.mode,$),k.return=H,H=k),f(H)):n(H,k)}return ne}var Ko=Um(!0),zm=Um(!1),Ju=Cs(null),ec=null,Oo=null,V1=null;function U1(){V1=Oo=ec=null}function z1(t){var e=Ju.current;It(Ju),t._currentValue=e}function Rf(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function Uo(t,e){ec=t,V1=Oo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Yn=!0),t.firstContext=null)}function Sr(t){var e=t._currentValue;if(V1!==t)if(t={context:t,memoizedValue:e,next:null},Oo===null){if(ec===null)throw Error(ae(308));Oo=t,ec.dependencies={lanes:0,firstContext:t}}else Oo=Oo.next=t;return e}var zs=null;function H1(t){zs===null?zs=[t]:zs.push(t)}function Hm(t,e,n,i){var a=e.interleaved;return a===null?(n.next=n,H1(e)):(n.next=a.next,a.next=n),e.interleaved=n,vi(t,i)}function vi(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Yi=!1;function G1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Gm(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ci(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function os(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,$e&2){var a=i.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),i.pending=e,vi(t,n)}return a=i.interleaved,a===null?(e.next=e,H1(i)):(e.next=a.next,a.next=e),i.interleaved=e,vi(t,n)}function Su(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,R1(t,n)}}function F0(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var a=null,l=null;if(n=n.firstBaseUpdate,n!==null){do{var f={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};l===null?a=l=f:l=l.next=f,n=n.next}while(n!==null);l===null?a=l=e:l=l.next=e}else a=l=e;n={baseState:i.baseState,firstBaseUpdate:a,lastBaseUpdate:l,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function tc(t,e,n,i){var a=t.updateQueue;Yi=!1;var l=a.firstBaseUpdate,f=a.lastBaseUpdate,y=a.shared.pending;if(y!==null){a.shared.pending=null;var x=y,m=x.next;x.next=null,f===null?l=m:f.next=m,f=x;var C=t.alternate;C!==null&&(C=C.updateQueue,y=C.lastBaseUpdate,y!==f&&(y===null?C.firstBaseUpdate=m:y.next=m,C.lastBaseUpdate=x))}if(l!==null){var v=a.baseState;f=0,C=m=x=null,y=l;do{var D=y.lane,V=y.eventTime;if((i&D)===D){C!==null&&(C=C.next={eventTime:V,lane:0,tag:y.tag,payload:y.payload,callback:y.callback,next:null});e:{var Y=t,X=y;switch(D=e,V=n,X.tag){case 1:if(Y=X.payload,typeof Y=="function"){v=Y.call(V,v,D);break e}v=Y;break e;case 3:Y.flags=Y.flags&-65537|128;case 0:if(Y=X.payload,D=typeof Y=="function"?Y.call(V,v,D):Y,D==null)break e;v=Pt({},v,D);break e;case 2:Yi=!0}}y.callback!==null&&y.lane!==0&&(t.flags|=64,D=a.effects,D===null?a.effects=[y]:D.push(y))}else V={eventTime:V,lane:D,tag:y.tag,payload:y.payload,callback:y.callback,next:null},C===null?(m=C=V,x=v):C=C.next=V,f|=D;if(y=y.next,y===null){if(y=a.shared.pending,y===null)break;D=y,y=D.next,D.next=null,a.lastBaseUpdate=D,a.shared.pending=null}}while(1);if(C===null&&(x=v),a.baseState=x,a.firstBaseUpdate=m,a.lastBaseUpdate=C,e=a.shared.interleaved,e!==null){a=e;do f|=a.lane,a=a.next;while(a!==e)}else l===null&&(a.shared.lanes=0);Qs|=f,t.lanes=f,t.memoizedState=v}}function V0(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],a=i.callback;if(a!==null){if(i.callback=null,i=n,typeof a!="function")throw Error(ae(191,a));a.call(i)}}}var Ol={},si=Cs(Ol),dl=Cs(Ol),gl=Cs(Ol);function Hs(t){if(t===Ol)throw Error(ae(174));return t}function W1(t,e){switch(yt(gl,e),yt(dl,t),yt(si,Ol),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lf(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=lf(e,t)}It(si),yt(si,e)}function Yo(){It(si),It(dl),It(gl)}function Wm(t){Hs(gl.current);var e=Hs(si.current),n=lf(e,t.type);e!==n&&(yt(dl,t),yt(si,n))}function j1(t){dl.current===t&&(It(si),It(dl))}var Dt=Cs(0);function nc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Mh=[];function X1(){for(var t=0;t<Mh.length;t++)Mh[t]._workInProgressVersionPrimary=null;Mh.length=0}var Ru=Oi.ReactCurrentDispatcher,kh=Oi.ReactCurrentBatchConfig,Ys=0,Ot=null,$t=null,un=null,rc=!1,qa=!1,pl=0,CE=0;function Tn(){throw Error(ae(321))}function q1(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Hr(t[n],e[n]))return!1;return!0}function K1(t,e,n,i,a,l){if(Ys=l,Ot=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ru.current=t===null||t.memoizedState===null?SE:RE,t=n(i,a),qa){l=0;do{if(qa=!1,pl=0,25<=l)throw Error(ae(301));l+=1,un=$t=null,e.updateQueue=null,Ru.current=NE,t=n(i,a)}while(qa)}if(Ru.current=ic,e=$t!==null&&$t.next!==null,Ys=0,un=$t=Ot=null,rc=!1,e)throw Error(ae(300));return t}function Y1(){var t=pl!==0;return pl=0,t}function ti(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return un===null?Ot.memoizedState=un=t:un=un.next=t,un}function Rr(){if($t===null){var t=Ot.alternate;t=t!==null?t.memoizedState:null}else t=$t.next;var e=un===null?Ot.memoizedState:un.next;if(e!==null)un=e,$t=t;else{if(t===null)throw Error(ae(310));$t=t,t={memoizedState:$t.memoizedState,baseState:$t.baseState,baseQueue:$t.baseQueue,queue:$t.queue,next:null},un===null?Ot.memoizedState=un=t:un=un.next=t}return un}function ml(t,e){return typeof e=="function"?e(t):e}function Lh(t){var e=Rr(),n=e.queue;if(n===null)throw Error(ae(311));n.lastRenderedReducer=t;var i=$t,a=i.baseQueue,l=n.pending;if(l!==null){if(a!==null){var f=a.next;a.next=l.next,l.next=f}i.baseQueue=a=l,n.pending=null}if(a!==null){l=a.next,i=i.baseState;var y=f=null,x=null,m=l;do{var C=m.lane;if((Ys&C)===C)x!==null&&(x=x.next={lane:0,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null}),i=m.hasEagerState?m.eagerState:t(i,m.action);else{var v={lane:C,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null};x===null?(y=x=v,f=i):x=x.next=v,Ot.lanes|=C,Qs|=C}m=m.next}while(m!==null&&m!==l);x===null?f=i:x.next=y,Hr(i,e.memoizedState)||(Yn=!0),e.memoizedState=i,e.baseState=f,e.baseQueue=x,n.lastRenderedState=i}if(t=n.interleaved,t!==null){a=t;do l=a.lane,Ot.lanes|=l,Qs|=l,a=a.next;while(a!==t)}else a===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Bh(t){var e=Rr(),n=e.queue;if(n===null)throw Error(ae(311));n.lastRenderedReducer=t;var i=n.dispatch,a=n.pending,l=e.memoizedState;if(a!==null){n.pending=null;var f=a=a.next;do l=t(l,f.action),f=f.next;while(f!==a);Hr(l,e.memoizedState)||(Yn=!0),e.memoizedState=l,e.baseQueue===null&&(e.baseState=l),n.lastRenderedState=l}return[l,i]}function jm(){}function Xm(t,e){var n=Ot,i=Rr(),a=e(),l=!Hr(i.memoizedState,a);if(l&&(i.memoizedState=a,Yn=!0),i=i.queue,Q1(Ym.bind(null,n,i,t),[t]),i.getSnapshot!==e||l||un!==null&&un.memoizedState.tag&1){if(n.flags|=2048,yl(9,Km.bind(null,n,i,a,e),void 0,null),cn===null)throw Error(ae(349));Ys&30||qm(n,e,a)}return a}function qm(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ot.updateQueue,e===null?(e={lastEffect:null,stores:null},Ot.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Km(t,e,n,i){e.value=n,e.getSnapshot=i,Qm(e)&&Zm(t)}function Ym(t,e,n){return n(function(){Qm(e)&&Zm(t)})}function Qm(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Hr(t,n)}catch{return!0}}function Zm(t){var e=vi(t,1);e!==null&&zr(e,t,1,-1)}function U0(t){var e=ti();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ml,lastRenderedState:t},e.queue=t,t=t.dispatch=vE.bind(null,Ot,t),[e.memoizedState,t]}function yl(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=Ot.updateQueue,e===null?(e={lastEffect:null,stores:null},Ot.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function $m(){return Rr().memoizedState}function Nu(t,e,n,i){var a=ti();Ot.flags|=t,a.memoizedState=yl(1|e,n,void 0,i===void 0?null:i)}function kc(t,e,n,i){var a=Rr();i=i===void 0?null:i;var l=void 0;if($t!==null){var f=$t.memoizedState;if(l=f.destroy,i!==null&&q1(i,f.deps)){a.memoizedState=yl(e,n,l,i);return}}Ot.flags|=t,a.memoizedState=yl(1|e,n,l,i)}function z0(t,e){return Nu(8390656,8,t,e)}function Q1(t,e){return kc(2048,8,t,e)}function Jm(t,e){return kc(4,2,t,e)}function e2(t,e){return kc(4,4,t,e)}function t2(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function n2(t,e,n){return n=n!=null?n.concat([t]):null,kc(4,4,t2.bind(null,e,t),n)}function Z1(){}function r2(t,e){var n=Rr();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&q1(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function i2(t,e){var n=Rr();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&q1(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function s2(t,e,n){return Ys&21?(Hr(n,e)||(n=cm(),Ot.lanes|=n,Qs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Yn=!0),t.memoizedState=n)}function IE(t,e){var n=lt;lt=n!==0&&4>n?n:4,t(!0);var i=kh.transition;kh.transition={};try{t(!1),e()}finally{lt=n,kh.transition=i}}function o2(){return Rr().memoizedState}function TE(t,e,n){var i=ls(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},a2(t))l2(e,n);else if(n=Hm(t,e,n,i),n!==null){var a=Bn();zr(n,t,i,a),u2(n,e,i)}}function vE(t,e,n){var i=ls(t),a={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(a2(t))l2(e,a);else{var l=t.alternate;if(t.lanes===0&&(l===null||l.lanes===0)&&(l=e.lastRenderedReducer,l!==null))try{var f=e.lastRenderedState,y=l(f,n);if(a.hasEagerState=!0,a.eagerState=y,Hr(y,f)){var x=e.interleaved;x===null?(a.next=a,H1(e)):(a.next=x.next,x.next=a),e.interleaved=a;return}}catch{}finally{}n=Hm(t,e,a,i),n!==null&&(a=Bn(),zr(n,t,i,a),u2(n,e,i))}}function a2(t){var e=t.alternate;return t===Ot||e!==null&&e===Ot}function l2(t,e){qa=rc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function u2(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,R1(t,n)}}var ic={readContext:Sr,useCallback:Tn,useContext:Tn,useEffect:Tn,useImperativeHandle:Tn,useInsertionEffect:Tn,useLayoutEffect:Tn,useMemo:Tn,useReducer:Tn,useRef:Tn,useState:Tn,useDebugValue:Tn,useDeferredValue:Tn,useTransition:Tn,useMutableSource:Tn,useSyncExternalStore:Tn,useId:Tn,unstable_isNewReconciler:!1},SE={readContext:Sr,useCallback:function(t,e){return ti().memoizedState=[t,e===void 0?null:e],t},useContext:Sr,useEffect:z0,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Nu(4194308,4,t2.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Nu(4194308,4,t,e)},useInsertionEffect:function(t,e){return Nu(4,2,t,e)},useMemo:function(t,e){var n=ti();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=ti();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=TE.bind(null,Ot,t),[i.memoizedState,t]},useRef:function(t){var e=ti();return t={current:t},e.memoizedState=t},useState:U0,useDebugValue:Z1,useDeferredValue:function(t){return ti().memoizedState=t},useTransition:function(){var t=U0(!1),e=t[0];return t=IE.bind(null,t[1]),ti().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=Ot,a=ti();if(vt){if(n===void 0)throw Error(ae(407));n=n()}else{if(n=e(),cn===null)throw Error(ae(349));Ys&30||qm(i,e,n)}a.memoizedState=n;var l={value:n,getSnapshot:e};return a.queue=l,z0(Ym.bind(null,i,l,t),[t]),i.flags|=2048,yl(9,Km.bind(null,i,l,n,e),void 0,null),n},useId:function(){var t=ti(),e=cn.identifierPrefix;if(vt){var n=Ai,i=_i;n=(i&~(1<<32-Ur(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=pl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=CE++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},RE={readContext:Sr,useCallback:r2,useContext:Sr,useEffect:Q1,useImperativeHandle:n2,useInsertionEffect:Jm,useLayoutEffect:e2,useMemo:i2,useReducer:Lh,useRef:$m,useState:function(){return Lh(ml)},useDebugValue:Z1,useDeferredValue:function(t){var e=Rr();return s2(e,$t.memoizedState,t)},useTransition:function(){var t=Lh(ml)[0],e=Rr().memoizedState;return[t,e]},useMutableSource:jm,useSyncExternalStore:Xm,useId:o2,unstable_isNewReconciler:!1},NE={readContext:Sr,useCallback:r2,useContext:Sr,useEffect:Q1,useImperativeHandle:n2,useInsertionEffect:Jm,useLayoutEffect:e2,useMemo:i2,useReducer:Bh,useRef:$m,useState:function(){return Bh(ml)},useDebugValue:Z1,useDeferredValue:function(t){var e=Rr();return $t===null?e.memoizedState=t:s2(e,$t.memoizedState,t)},useTransition:function(){var t=Bh(ml)[0],e=Rr().memoizedState;return[t,e]},useMutableSource:jm,useSyncExternalStore:Xm,useId:o2,unstable_isNewReconciler:!1};function Br(t,e){if(t&&t.defaultProps){e=Pt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Nf(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:Pt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Lc={isMounted:function(t){return(t=t._reactInternals)?to(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=Bn(),a=ls(t),l=Ci(i,a);l.payload=e,n!=null&&(l.callback=n),e=os(t,l,a),e!==null&&(zr(e,t,a,i),Su(e,t,a))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=Bn(),a=ls(t),l=Ci(i,a);l.tag=1,l.payload=e,n!=null&&(l.callback=n),e=os(t,l,a),e!==null&&(zr(e,t,a,i),Su(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Bn(),i=ls(t),a=Ci(n,i);a.tag=2,e!=null&&(a.callback=e),e=os(t,a,i),e!==null&&(zr(e,t,i,n),Su(e,t,i))}};function H0(t,e,n,i,a,l,f){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,l,f):e.prototype&&e.prototype.isPureReactComponent?!ul(n,i)||!ul(a,l):!0}function c2(t,e,n){var i=!1,a=ps,l=e.contextType;return typeof l=="object"&&l!==null?l=Sr(l):(a=Zn(e)?qs:Dn.current,i=e.contextTypes,l=(i=i!=null)?Xo(t,a):ps),e=new e(n,l),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Lc,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=l),e}function G0(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&Lc.enqueueReplaceState(e,e.state,null)}function bf(t,e,n,i){var a=t.stateNode;a.props=n,a.state=t.memoizedState,a.refs={},G1(t);var l=e.contextType;typeof l=="object"&&l!==null?a.context=Sr(l):(l=Zn(e)?qs:Dn.current,a.context=Xo(t,l)),a.state=t.memoizedState,l=e.getDerivedStateFromProps,typeof l=="function"&&(Nf(t,e,l,n),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&Lc.enqueueReplaceState(a,a.state,null),tc(t,n,a,i),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function Qo(t,e){try{var n="",i=e;do n+=rx(i),i=i.return;while(i);var a=n}catch(l){a=`
Error generating stack: `+l.message+`
`+l.stack}return{value:t,source:e,stack:a,digest:null}}function Fh(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Df(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var bE=typeof WeakMap=="function"?WeakMap:Map;function h2(t,e,n){n=Ci(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){oc||(oc=!0,zf=i),Df(t,e)},n}function f2(t,e,n){n=Ci(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var a=e.value;n.payload=function(){return i(a)},n.callback=function(){Df(t,e)}}var l=t.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(n.callback=function(){Df(t,e),typeof i!="function"&&(as===null?as=new Set([this]):as.add(this));var f=e.stack;this.componentDidCatch(e.value,{componentStack:f!==null?f:""})}),n}function W0(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new bE;var a=new Set;i.set(e,a)}else a=i.get(e),a===void 0&&(a=new Set,i.set(e,a));a.has(n)||(a.add(n),t=WE.bind(null,t,e,n),e.then(t,t))}function j0(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function X0(t,e,n,i,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ci(-1,1),e.tag=2,os(n,e,1))),n.lanes|=1),t)}var DE=Oi.ReactCurrentOwner,Yn=!1;function Ln(t,e,n,i){e.child=t===null?zm(e,null,n,i):Ko(e,t.child,n,i)}function q0(t,e,n,i,a){n=n.render;var l=e.ref;return Uo(e,a),i=K1(t,e,n,i,l,a),n=Y1(),t!==null&&!Yn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,Si(t,e,a)):(vt&&n&&L1(e),e.flags|=1,Ln(t,e,i,a),e.child)}function K0(t,e,n,i,a){if(t===null){var l=n.type;return typeof l=="function"&&!sd(l)&&l.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=l,d2(t,e,l,i,a)):(t=Pu(n.type,null,i,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(l=t.child,!(t.lanes&a)){var f=l.memoizedProps;if(n=n.compare,n=n!==null?n:ul,n(f,i)&&t.ref===e.ref)return Si(t,e,a)}return e.flags|=1,t=us(l,i),t.ref=e.ref,t.return=e,e.child=t}function d2(t,e,n,i,a){if(t!==null){var l=t.memoizedProps;if(ul(l,i)&&t.ref===e.ref)if(Yn=!1,e.pendingProps=i=l,(t.lanes&a)!==0)t.flags&131072&&(Yn=!0);else return e.lanes=t.lanes,Si(t,e,a)}return Of(t,e,n,i,a)}function g2(t,e,n){var i=e.pendingProps,a=i.children,l=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},yt(Mo,nr),nr|=n;else{if(!(n&1073741824))return t=l!==null?l.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,yt(Mo,nr),nr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=l!==null?l.baseLanes:n,yt(Mo,nr),nr|=i}else l!==null?(i=l.baseLanes|n,e.memoizedState=null):i=n,yt(Mo,nr),nr|=i;return Ln(t,e,a,n),e.child}function p2(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Of(t,e,n,i,a){var l=Zn(n)?qs:Dn.current;return l=Xo(e,l),Uo(e,a),n=K1(t,e,n,i,l,a),i=Y1(),t!==null&&!Yn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,Si(t,e,a)):(vt&&i&&L1(e),e.flags|=1,Ln(t,e,n,a),e.child)}function Y0(t,e,n,i,a){if(Zn(n)){var l=!0;Qu(e)}else l=!1;if(Uo(e,a),e.stateNode===null)bu(t,e),c2(e,n,i),bf(e,n,i,a),i=!0;else if(t===null){var f=e.stateNode,y=e.memoizedProps;f.props=y;var x=f.context,m=n.contextType;typeof m=="object"&&m!==null?m=Sr(m):(m=Zn(n)?qs:Dn.current,m=Xo(e,m));var C=n.getDerivedStateFromProps,v=typeof C=="function"||typeof f.getSnapshotBeforeUpdate=="function";v||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(y!==i||x!==m)&&G0(e,f,i,m),Yi=!1;var D=e.memoizedState;f.state=D,tc(e,i,f,a),x=e.memoizedState,y!==i||D!==x||Qn.current||Yi?(typeof C=="function"&&(Nf(e,n,C,i),x=e.memoizedState),(y=Yi||H0(e,n,y,i,D,x,m))?(v||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount()),typeof f.componentDidMount=="function"&&(e.flags|=4194308)):(typeof f.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=x),f.props=i,f.state=x,f.context=m,i=y):(typeof f.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{f=e.stateNode,Gm(t,e),y=e.memoizedProps,m=e.type===e.elementType?y:Br(e.type,y),f.props=m,v=e.pendingProps,D=f.context,x=n.contextType,typeof x=="object"&&x!==null?x=Sr(x):(x=Zn(n)?qs:Dn.current,x=Xo(e,x));var V=n.getDerivedStateFromProps;(C=typeof V=="function"||typeof f.getSnapshotBeforeUpdate=="function")||typeof f.UNSAFE_componentWillReceiveProps!="function"&&typeof f.componentWillReceiveProps!="function"||(y!==v||D!==x)&&G0(e,f,i,x),Yi=!1,D=e.memoizedState,f.state=D,tc(e,i,f,a);var Y=e.memoizedState;y!==v||D!==Y||Qn.current||Yi?(typeof V=="function"&&(Nf(e,n,V,i),Y=e.memoizedState),(m=Yi||H0(e,n,m,i,D,Y,x)||!1)?(C||typeof f.UNSAFE_componentWillUpdate!="function"&&typeof f.componentWillUpdate!="function"||(typeof f.componentWillUpdate=="function"&&f.componentWillUpdate(i,Y,x),typeof f.UNSAFE_componentWillUpdate=="function"&&f.UNSAFE_componentWillUpdate(i,Y,x)),typeof f.componentDidUpdate=="function"&&(e.flags|=4),typeof f.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof f.componentDidUpdate!="function"||y===t.memoizedProps&&D===t.memoizedState||(e.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||y===t.memoizedProps&&D===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=Y),f.props=i,f.state=Y,f.context=x,i=m):(typeof f.componentDidUpdate!="function"||y===t.memoizedProps&&D===t.memoizedState||(e.flags|=4),typeof f.getSnapshotBeforeUpdate!="function"||y===t.memoizedProps&&D===t.memoizedState||(e.flags|=1024),i=!1)}return Pf(t,e,n,i,l,a)}function Pf(t,e,n,i,a,l){p2(t,e);var f=(e.flags&128)!==0;if(!i&&!f)return a&&M0(e,n,!1),Si(t,e,l);i=e.stateNode,DE.current=e;var y=f&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&f?(e.child=Ko(e,t.child,null,l),e.child=Ko(e,null,y,l)):Ln(t,e,y,l),e.memoizedState=i.state,a&&M0(e,n,!0),e.child}function m2(t){var e=t.stateNode;e.pendingContext?P0(t,e.pendingContext,e.pendingContext!==e.context):e.context&&P0(t,e.context,!1),W1(t,e.containerInfo)}function Q0(t,e,n,i,a){return qo(),F1(a),e.flags|=256,Ln(t,e,n,i),e.child}var Mf={dehydrated:null,treeContext:null,retryLane:0};function kf(t){return{baseLanes:t,cachePool:null,transitions:null}}function y2(t,e,n){var i=e.pendingProps,a=Dt.current,l=!1,f=(e.flags&128)!==0,y;if((y=f)||(y=t!==null&&t.memoizedState===null?!1:(a&2)!==0),y?(l=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),yt(Dt,a&1),t===null)return Sf(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(f=i.children,t=i.fallback,l?(i=e.mode,l=e.child,f={mode:"hidden",children:f},!(i&1)&&l!==null?(l.childLanes=0,l.pendingProps=f):l=Vc(f,i,0,null),t=js(t,i,n,null),l.return=e,t.return=e,l.sibling=t,e.child=l,e.child.memoizedState=kf(n),e.memoizedState=Mf,t):$1(e,f));if(a=t.memoizedState,a!==null&&(y=a.dehydrated,y!==null))return OE(t,e,f,i,y,a,n);if(l){l=i.fallback,f=e.mode,a=t.child,y=a.sibling;var x={mode:"hidden",children:i.children};return!(f&1)&&e.child!==a?(i=e.child,i.childLanes=0,i.pendingProps=x,e.deletions=null):(i=us(a,x),i.subtreeFlags=a.subtreeFlags&14680064),y!==null?l=us(y,l):(l=js(l,f,n,null),l.flags|=2),l.return=e,i.return=e,i.sibling=l,e.child=i,i=l,l=e.child,f=t.child.memoizedState,f=f===null?kf(n):{baseLanes:f.baseLanes|n,cachePool:null,transitions:f.transitions},l.memoizedState=f,l.childLanes=t.childLanes&~n,e.memoizedState=Mf,i}return l=t.child,t=l.sibling,i=us(l,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function $1(t,e){return e=Vc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function du(t,e,n,i){return i!==null&&F1(i),Ko(e,t.child,null,n),t=$1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function OE(t,e,n,i,a,l,f){if(n)return e.flags&256?(e.flags&=-257,i=Fh(Error(ae(422))),du(t,e,f,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(l=i.fallback,a=e.mode,i=Vc({mode:"visible",children:i.children},a,0,null),l=js(l,a,f,null),l.flags|=2,i.return=e,l.return=e,i.sibling=l,e.child=i,e.mode&1&&Ko(e,t.child,null,f),e.child.memoizedState=kf(f),e.memoizedState=Mf,l);if(!(e.mode&1))return du(t,e,f,null);if(a.data==="$!"){if(i=a.nextSibling&&a.nextSibling.dataset,i)var y=i.dgst;return i=y,l=Error(ae(419)),i=Fh(l,i,void 0),du(t,e,f,i)}if(y=(f&t.childLanes)!==0,Yn||y){if(i=cn,i!==null){switch(f&-f){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(i.suspendedLanes|f)?0:a,a!==0&&a!==l.retryLane&&(l.retryLane=a,vi(t,a),zr(i,t,a,-1))}return id(),i=Fh(Error(ae(421))),du(t,e,f,i)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=jE.bind(null,t),a._reactRetry=e,null):(t=l.treeContext,rr=ss(a.nextSibling),sr=e,vt=!0,Vr=null,t!==null&&(_r[Ar++]=_i,_r[Ar++]=Ai,_r[Ar++]=Ks,_i=t.id,Ai=t.overflow,Ks=e),e=$1(e,i.children),e.flags|=4096,e)}function Z0(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),Rf(t.return,e,n)}function Vh(t,e,n,i,a){var l=t.memoizedState;l===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:a}:(l.isBackwards=e,l.rendering=null,l.renderingStartTime=0,l.last=i,l.tail=n,l.tailMode=a)}function w2(t,e,n){var i=e.pendingProps,a=i.revealOrder,l=i.tail;if(Ln(t,e,i.children,n),i=Dt.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Z0(t,n,e);else if(t.tag===19)Z0(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(yt(Dt,i),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(n=e.child,a=null;n!==null;)t=n.alternate,t!==null&&nc(t)===null&&(a=n),n=n.sibling;n=a,n===null?(a=e.child,e.child=null):(a=n.sibling,n.sibling=null),Vh(e,!1,a,n,l);break;case"backwards":for(n=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&nc(t)===null){e.child=a;break}t=a.sibling,a.sibling=n,n=a,a=t}Vh(e,!0,n,null,l);break;case"together":Vh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function bu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Si(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Qs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ae(153));if(e.child!==null){for(t=e.child,n=us(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=us(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function PE(t,e,n){switch(e.tag){case 3:m2(e),qo();break;case 5:Wm(e);break;case 1:Zn(e.type)&&Qu(e);break;case 4:W1(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,a=e.memoizedProps.value;yt(Ju,i._currentValue),i._currentValue=a;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(yt(Dt,Dt.current&1),e.flags|=128,null):n&e.child.childLanes?y2(t,e,n):(yt(Dt,Dt.current&1),t=Si(t,e,n),t!==null?t.sibling:null);yt(Dt,Dt.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return w2(t,e,n);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),yt(Dt,Dt.current),i)break;return null;case 22:case 23:return e.lanes=0,g2(t,e,n)}return Si(t,e,n)}var x2,Lf,E2,_2;x2=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Lf=function(){};E2=function(t,e,n,i){var a=t.memoizedProps;if(a!==i){t=e.stateNode,Hs(si.current);var l=null;switch(n){case"input":a=rf(t,a),i=rf(t,i),l=[];break;case"select":a=Pt({},a,{value:void 0}),i=Pt({},i,{value:void 0}),l=[];break;case"textarea":a=af(t,a),i=af(t,i),l=[];break;default:typeof a.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=Ku)}uf(n,i);var f;n=null;for(m in a)if(!i.hasOwnProperty(m)&&a.hasOwnProperty(m)&&a[m]!=null)if(m==="style"){var y=a[m];for(f in y)y.hasOwnProperty(f)&&(n||(n={}),n[f]="")}else m!=="dangerouslySetInnerHTML"&&m!=="children"&&m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(nl.hasOwnProperty(m)?l||(l=[]):(l=l||[]).push(m,null));for(m in i){var x=i[m];if(y=a!=null?a[m]:void 0,i.hasOwnProperty(m)&&x!==y&&(x!=null||y!=null))if(m==="style")if(y){for(f in y)!y.hasOwnProperty(f)||x&&x.hasOwnProperty(f)||(n||(n={}),n[f]="");for(f in x)x.hasOwnProperty(f)&&y[f]!==x[f]&&(n||(n={}),n[f]=x[f])}else n||(l||(l=[]),l.push(m,n)),n=x;else m==="dangerouslySetInnerHTML"?(x=x?x.__html:void 0,y=y?y.__html:void 0,x!=null&&y!==x&&(l=l||[]).push(m,x)):m==="children"?typeof x!="string"&&typeof x!="number"||(l=l||[]).push(m,""+x):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&(nl.hasOwnProperty(m)?(x!=null&&m==="onScroll"&&_t("scroll",t),l||y===x||(l=[])):(l=l||[]).push(m,x))}n&&(l=l||[]).push("style",n);var m=l;(e.updateQueue=m)&&(e.flags|=4)}};_2=function(t,e,n,i){n!==i&&(e.flags|=4)};function Oa(t,e){if(!vt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function vn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var a=t.child;a!==null;)n|=a.lanes|a.childLanes,i|=a.subtreeFlags&14680064,i|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)n|=a.lanes|a.childLanes,i|=a.subtreeFlags,i|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function ME(t,e,n){var i=e.pendingProps;switch(B1(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vn(e),null;case 1:return Zn(e.type)&&Yu(),vn(e),null;case 3:return i=e.stateNode,Yo(),It(Qn),It(Dn),X1(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(hu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Vr!==null&&(Wf(Vr),Vr=null))),Lf(t,e),vn(e),null;case 5:j1(e);var a=Hs(gl.current);if(n=e.type,t!==null&&e.stateNode!=null)E2(t,e,n,i,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(ae(166));return vn(e),null}if(t=Hs(si.current),hu(e)){i=e.stateNode,n=e.type;var l=e.memoizedProps;switch(i[ri]=e,i[fl]=l,t=(e.mode&1)!==0,n){case"dialog":_t("cancel",i),_t("close",i);break;case"iframe":case"object":case"embed":_t("load",i);break;case"video":case"audio":for(a=0;a<Ba.length;a++)_t(Ba[a],i);break;case"source":_t("error",i);break;case"img":case"image":case"link":_t("error",i),_t("load",i);break;case"details":_t("toggle",i);break;case"input":o0(i,l),_t("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!l.multiple},_t("invalid",i);break;case"textarea":l0(i,l),_t("invalid",i)}uf(n,l),a=null;for(var f in l)if(l.hasOwnProperty(f)){var y=l[f];f==="children"?typeof y=="string"?i.textContent!==y&&(l.suppressHydrationWarning!==!0&&cu(i.textContent,y,t),a=["children",y]):typeof y=="number"&&i.textContent!==""+y&&(l.suppressHydrationWarning!==!0&&cu(i.textContent,y,t),a=["children",""+y]):nl.hasOwnProperty(f)&&y!=null&&f==="onScroll"&&_t("scroll",i)}switch(n){case"input":nu(i),a0(i,l,!0);break;case"textarea":nu(i),u0(i);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(i.onclick=Ku)}i=a,e.updateQueue=i,i!==null&&(e.flags|=4)}else{f=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Yp(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=f.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=f.createElement(n,{is:i.is}):(t=f.createElement(n),n==="select"&&(f=t,i.multiple?f.multiple=!0:i.size&&(f.size=i.size))):t=f.createElementNS(t,n),t[ri]=e,t[fl]=i,x2(t,e,!1,!1),e.stateNode=t;e:{switch(f=cf(n,i),n){case"dialog":_t("cancel",t),_t("close",t),a=i;break;case"iframe":case"object":case"embed":_t("load",t),a=i;break;case"video":case"audio":for(a=0;a<Ba.length;a++)_t(Ba[a],t);a=i;break;case"source":_t("error",t),a=i;break;case"img":case"image":case"link":_t("error",t),_t("load",t),a=i;break;case"details":_t("toggle",t),a=i;break;case"input":o0(t,i),a=rf(t,i),_t("invalid",t);break;case"option":a=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},a=Pt({},i,{value:void 0}),_t("invalid",t);break;case"textarea":l0(t,i),a=af(t,i),_t("invalid",t);break;default:a=i}uf(n,a),y=a;for(l in y)if(y.hasOwnProperty(l)){var x=y[l];l==="style"?$p(t,x):l==="dangerouslySetInnerHTML"?(x=x?x.__html:void 0,x!=null&&Qp(t,x)):l==="children"?typeof x=="string"?(n!=="textarea"||x!=="")&&rl(t,x):typeof x=="number"&&rl(t,""+x):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(nl.hasOwnProperty(l)?x!=null&&l==="onScroll"&&_t("scroll",t):x!=null&&A1(t,l,x,f))}switch(n){case"input":nu(t),a0(t,i,!1);break;case"textarea":nu(t),u0(t);break;case"option":i.value!=null&&t.setAttribute("value",""+gs(i.value));break;case"select":t.multiple=!!i.multiple,l=i.value,l!=null?Lo(t,!!i.multiple,l,!1):i.defaultValue!=null&&Lo(t,!!i.multiple,i.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=Ku)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return vn(e),null;case 6:if(t&&e.stateNode!=null)_2(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(ae(166));if(n=Hs(gl.current),Hs(si.current),hu(e)){if(i=e.stateNode,n=e.memoizedProps,i[ri]=e,(l=i.nodeValue!==n)&&(t=sr,t!==null))switch(t.tag){case 3:cu(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&cu(i.nodeValue,n,(t.mode&1)!==0)}l&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[ri]=e,e.stateNode=i}return vn(e),null;case 13:if(It(Dt),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(vt&&rr!==null&&e.mode&1&&!(e.flags&128))Vm(),qo(),e.flags|=98560,l=!1;else if(l=hu(e),i!==null&&i.dehydrated!==null){if(t===null){if(!l)throw Error(ae(318));if(l=e.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(ae(317));l[ri]=e}else qo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;vn(e),l=!1}else Vr!==null&&(Wf(Vr),Vr=null),l=!0;if(!l)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||Dt.current&1?Jt===0&&(Jt=3):id())),e.updateQueue!==null&&(e.flags|=4),vn(e),null);case 4:return Yo(),Lf(t,e),t===null&&cl(e.stateNode.containerInfo),vn(e),null;case 10:return z1(e.type._context),vn(e),null;case 17:return Zn(e.type)&&Yu(),vn(e),null;case 19:if(It(Dt),l=e.memoizedState,l===null)return vn(e),null;if(i=(e.flags&128)!==0,f=l.rendering,f===null)if(i)Oa(l,!1);else{if(Jt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(f=nc(t),f!==null){for(e.flags|=128,Oa(l,!1),i=f.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)l=n,t=i,l.flags&=14680066,f=l.alternate,f===null?(l.childLanes=0,l.lanes=t,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=f.childLanes,l.lanes=f.lanes,l.child=f.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=f.memoizedProps,l.memoizedState=f.memoizedState,l.updateQueue=f.updateQueue,l.type=f.type,t=f.dependencies,l.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return yt(Dt,Dt.current&1|2),e.child}t=t.sibling}l.tail!==null&&Gt()>Zo&&(e.flags|=128,i=!0,Oa(l,!1),e.lanes=4194304)}else{if(!i)if(t=nc(f),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Oa(l,!0),l.tail===null&&l.tailMode==="hidden"&&!f.alternate&&!vt)return vn(e),null}else 2*Gt()-l.renderingStartTime>Zo&&n!==1073741824&&(e.flags|=128,i=!0,Oa(l,!1),e.lanes=4194304);l.isBackwards?(f.sibling=e.child,e.child=f):(n=l.last,n!==null?n.sibling=f:e.child=f,l.last=f)}return l.tail!==null?(e=l.tail,l.rendering=e,l.tail=e.sibling,l.renderingStartTime=Gt(),e.sibling=null,n=Dt.current,yt(Dt,i?n&1|2:n&1),e):(vn(e),null);case 22:case 23:return rd(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?nr&1073741824&&(vn(e),e.subtreeFlags&6&&(e.flags|=8192)):vn(e),null;case 24:return null;case 25:return null}throw Error(ae(156,e.tag))}function kE(t,e){switch(B1(e),e.tag){case 1:return Zn(e.type)&&Yu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Yo(),It(Qn),It(Dn),X1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return j1(e),null;case 13:if(It(Dt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ae(340));qo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return It(Dt),null;case 4:return Yo(),null;case 10:return z1(e.type._context),null;case 22:case 23:return rd(),null;case 24:return null;default:return null}}var gu=!1,Nn=!1,LE=typeof WeakSet=="function"?WeakSet:Set,xe=null;function Po(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){Ft(t,e,i)}else n.current=null}function Bf(t,e,n){try{n()}catch(i){Ft(t,e,i)}}var $0=!1;function BE(t,e){if(Ef=ju,t=vm(),k1(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var a=i.anchorOffset,l=i.focusNode;i=i.focusOffset;try{n.nodeType,l.nodeType}catch{n=null;break e}var f=0,y=-1,x=-1,m=0,C=0,v=t,D=null;t:for(;;){for(var V;v!==n||a!==0&&v.nodeType!==3||(y=f+a),v!==l||i!==0&&v.nodeType!==3||(x=f+i),v.nodeType===3&&(f+=v.nodeValue.length),(V=v.firstChild)!==null;)D=v,v=V;for(;;){if(v===t)break t;if(D===n&&++m===a&&(y=f),D===l&&++C===i&&(x=f),(V=v.nextSibling)!==null)break;v=D,D=v.parentNode}v=V}n=y===-1||x===-1?null:{start:y,end:x}}else n=null}n=n||{start:0,end:0}}else n=null;for(_f={focusedElem:t,selectionRange:n},ju=!1,xe=e;xe!==null;)if(e=xe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,xe=t;else for(;xe!==null;){e=xe;try{var Y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(Y!==null){var X=Y.memoizedProps,ne=Y.memoizedState,H=e.stateNode,k=H.getSnapshotBeforeUpdate(e.elementType===e.type?X:Br(e.type,X),ne);H.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var B=e.stateNode.containerInfo;B.nodeType===1?B.textContent="":B.nodeType===9&&B.documentElement&&B.removeChild(B.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ae(163))}}catch($){Ft(e,e.return,$)}if(t=e.sibling,t!==null){t.return=e.return,xe=t;break}xe=e.return}return Y=$0,$0=!1,Y}function Ka(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var a=i=i.next;do{if((a.tag&t)===t){var l=a.destroy;a.destroy=void 0,l!==void 0&&Bf(e,n,l)}a=a.next}while(a!==i)}}function Bc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function Ff(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function A2(t){var e=t.alternate;e!==null&&(t.alternate=null,A2(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ri],delete e[fl],delete e[If],delete e[xE],delete e[EE])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function C2(t){return t.tag===5||t.tag===3||t.tag===4}function J0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||C2(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Vf(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Ku));else if(i!==4&&(t=t.child,t!==null))for(Vf(t,e,n),t=t.sibling;t!==null;)Vf(t,e,n),t=t.sibling}function Uf(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(Uf(t,e,n),t=t.sibling;t!==null;)Uf(t,e,n),t=t.sibling}var mn=null,Fr=!1;function qi(t,e,n){for(n=n.child;n!==null;)I2(t,e,n),n=n.sibling}function I2(t,e,n){if(ii&&typeof ii.onCommitFiberUnmount=="function")try{ii.onCommitFiberUnmount(Nc,n)}catch{}switch(n.tag){case 5:Nn||Po(n,e);case 6:var i=mn,a=Fr;mn=null,qi(t,e,n),mn=i,Fr=a,mn!==null&&(Fr?(t=mn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):mn.removeChild(n.stateNode));break;case 18:mn!==null&&(Fr?(t=mn,n=n.stateNode,t.nodeType===8?Oh(t.parentNode,n):t.nodeType===1&&Oh(t,n),al(t)):Oh(mn,n.stateNode));break;case 4:i=mn,a=Fr,mn=n.stateNode.containerInfo,Fr=!0,qi(t,e,n),mn=i,Fr=a;break;case 0:case 11:case 14:case 15:if(!Nn&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){a=i=i.next;do{var l=a,f=l.destroy;l=l.tag,f!==void 0&&(l&2||l&4)&&Bf(n,e,f),a=a.next}while(a!==i)}qi(t,e,n);break;case 1:if(!Nn&&(Po(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(y){Ft(n,e,y)}qi(t,e,n);break;case 21:qi(t,e,n);break;case 22:n.mode&1?(Nn=(i=Nn)||n.memoizedState!==null,qi(t,e,n),Nn=i):qi(t,e,n);break;default:qi(t,e,n)}}function eg(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new LE),e.forEach(function(i){var a=XE.bind(null,t,i);n.has(i)||(n.add(i),i.then(a,a))})}}function Lr(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var a=n[i];try{var l=t,f=e,y=f;e:for(;y!==null;){switch(y.tag){case 5:mn=y.stateNode,Fr=!1;break e;case 3:mn=y.stateNode.containerInfo,Fr=!0;break e;case 4:mn=y.stateNode.containerInfo,Fr=!0;break e}y=y.return}if(mn===null)throw Error(ae(160));I2(l,f,a),mn=null,Fr=!1;var x=a.alternate;x!==null&&(x.return=null),a.return=null}catch(m){Ft(a,e,m)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)T2(e,t),e=e.sibling}function T2(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Lr(e,t),ei(t),i&4){try{Ka(3,t,t.return),Bc(3,t)}catch(X){Ft(t,t.return,X)}try{Ka(5,t,t.return)}catch(X){Ft(t,t.return,X)}}break;case 1:Lr(e,t),ei(t),i&512&&n!==null&&Po(n,n.return);break;case 5:if(Lr(e,t),ei(t),i&512&&n!==null&&Po(n,n.return),t.flags&32){var a=t.stateNode;try{rl(a,"")}catch(X){Ft(t,t.return,X)}}if(i&4&&(a=t.stateNode,a!=null)){var l=t.memoizedProps,f=n!==null?n.memoizedProps:l,y=t.type,x=t.updateQueue;if(t.updateQueue=null,x!==null)try{y==="input"&&l.type==="radio"&&l.name!=null&&qp(a,l),cf(y,f);var m=cf(y,l);for(f=0;f<x.length;f+=2){var C=x[f],v=x[f+1];C==="style"?$p(a,v):C==="dangerouslySetInnerHTML"?Qp(a,v):C==="children"?rl(a,v):A1(a,C,v,m)}switch(y){case"input":sf(a,l);break;case"textarea":Kp(a,l);break;case"select":var D=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!l.multiple;var V=l.value;V!=null?Lo(a,!!l.multiple,V,!1):D!==!!l.multiple&&(l.defaultValue!=null?Lo(a,!!l.multiple,l.defaultValue,!0):Lo(a,!!l.multiple,l.multiple?[]:"",!1))}a[fl]=l}catch(X){Ft(t,t.return,X)}}break;case 6:if(Lr(e,t),ei(t),i&4){if(t.stateNode===null)throw Error(ae(162));a=t.stateNode,l=t.memoizedProps;try{a.nodeValue=l}catch(X){Ft(t,t.return,X)}}break;case 3:if(Lr(e,t),ei(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{al(e.containerInfo)}catch(X){Ft(t,t.return,X)}break;case 4:Lr(e,t),ei(t);break;case 13:Lr(e,t),ei(t),a=t.child,a.flags&8192&&(l=a.memoizedState!==null,a.stateNode.isHidden=l,!l||a.alternate!==null&&a.alternate.memoizedState!==null||(td=Gt())),i&4&&eg(t);break;case 22:if(C=n!==null&&n.memoizedState!==null,t.mode&1?(Nn=(m=Nn)||C,Lr(e,t),Nn=m):Lr(e,t),ei(t),i&8192){if(m=t.memoizedState!==null,(t.stateNode.isHidden=m)&&!C&&t.mode&1)for(xe=t,C=t.child;C!==null;){for(v=xe=C;xe!==null;){switch(D=xe,V=D.child,D.tag){case 0:case 11:case 14:case 15:Ka(4,D,D.return);break;case 1:Po(D,D.return);var Y=D.stateNode;if(typeof Y.componentWillUnmount=="function"){i=D,n=D.return;try{e=i,Y.props=e.memoizedProps,Y.state=e.memoizedState,Y.componentWillUnmount()}catch(X){Ft(i,n,X)}}break;case 5:Po(D,D.return);break;case 22:if(D.memoizedState!==null){ng(v);continue}}V!==null?(V.return=D,xe=V):ng(v)}C=C.sibling}e:for(C=null,v=t;;){if(v.tag===5){if(C===null){C=v;try{a=v.stateNode,m?(l=a.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(y=v.stateNode,x=v.memoizedProps.style,f=x!=null&&x.hasOwnProperty("display")?x.display:null,y.style.display=Zp("display",f))}catch(X){Ft(t,t.return,X)}}}else if(v.tag===6){if(C===null)try{v.stateNode.nodeValue=m?"":v.memoizedProps}catch(X){Ft(t,t.return,X)}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===t)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===t)break e;for(;v.sibling===null;){if(v.return===null||v.return===t)break e;C===v&&(C=null),v=v.return}C===v&&(C=null),v.sibling.return=v.return,v=v.sibling}}break;case 19:Lr(e,t),ei(t),i&4&&eg(t);break;case 21:break;default:Lr(e,t),ei(t)}}function ei(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(C2(n)){var i=n;break e}n=n.return}throw Error(ae(160))}switch(i.tag){case 5:var a=i.stateNode;i.flags&32&&(rl(a,""),i.flags&=-33);var l=J0(t);Uf(t,l,a);break;case 3:case 4:var f=i.stateNode.containerInfo,y=J0(t);Vf(t,y,f);break;default:throw Error(ae(161))}}catch(x){Ft(t,t.return,x)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function FE(t,e,n){xe=t,v2(t)}function v2(t,e,n){for(var i=(t.mode&1)!==0;xe!==null;){var a=xe,l=a.child;if(a.tag===22&&i){var f=a.memoizedState!==null||gu;if(!f){var y=a.alternate,x=y!==null&&y.memoizedState!==null||Nn;y=gu;var m=Nn;if(gu=f,(Nn=x)&&!m)for(xe=a;xe!==null;)f=xe,x=f.child,f.tag===22&&f.memoizedState!==null?rg(a):x!==null?(x.return=f,xe=x):rg(a);for(;l!==null;)xe=l,v2(l),l=l.sibling;xe=a,gu=y,Nn=m}tg(t)}else a.subtreeFlags&8772&&l!==null?(l.return=a,xe=l):tg(t)}}function tg(t){for(;xe!==null;){var e=xe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Nn||Bc(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Nn)if(n===null)i.componentDidMount();else{var a=e.elementType===e.type?n.memoizedProps:Br(e.type,n.memoizedProps);i.componentDidUpdate(a,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var l=e.updateQueue;l!==null&&V0(e,l,i);break;case 3:var f=e.updateQueue;if(f!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}V0(e,f,n)}break;case 5:var y=e.stateNode;if(n===null&&e.flags&4){n=y;var x=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":x.autoFocus&&n.focus();break;case"img":x.src&&(n.src=x.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var m=e.alternate;if(m!==null){var C=m.memoizedState;if(C!==null){var v=C.dehydrated;v!==null&&al(v)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ae(163))}Nn||e.flags&512&&Ff(e)}catch(D){Ft(e,e.return,D)}}if(e===t){xe=null;break}if(n=e.sibling,n!==null){n.return=e.return,xe=n;break}xe=e.return}}function ng(t){for(;xe!==null;){var e=xe;if(e===t){xe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,xe=n;break}xe=e.return}}function rg(t){for(;xe!==null;){var e=xe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Bc(4,e)}catch(x){Ft(e,n,x)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var a=e.return;try{i.componentDidMount()}catch(x){Ft(e,a,x)}}var l=e.return;try{Ff(e)}catch(x){Ft(e,l,x)}break;case 5:var f=e.return;try{Ff(e)}catch(x){Ft(e,f,x)}}}catch(x){Ft(e,e.return,x)}if(e===t){xe=null;break}var y=e.sibling;if(y!==null){y.return=e.return,xe=y;break}xe=e.return}}var VE=Math.ceil,sc=Oi.ReactCurrentDispatcher,J1=Oi.ReactCurrentOwner,Tr=Oi.ReactCurrentBatchConfig,$e=0,cn=null,Kt=null,xn=0,nr=0,Mo=Cs(0),Jt=0,wl=null,Qs=0,Fc=0,ed=0,Ya=null,qn=null,td=0,Zo=1/0,xi=null,oc=!1,zf=null,as=null,pu=!1,es=null,ac=0,Qa=0,Hf=null,Du=-1,Ou=0;function Bn(){return $e&6?Gt():Du!==-1?Du:Du=Gt()}function ls(t){return t.mode&1?$e&2&&xn!==0?xn&-xn:AE.transition!==null?(Ou===0&&(Ou=cm()),Ou):(t=lt,t!==0||(t=window.event,t=t===void 0?16:ym(t.type)),t):1}function zr(t,e,n,i){if(50<Qa)throw Qa=0,Hf=null,Error(ae(185));Nl(t,n,i),(!($e&2)||t!==cn)&&(t===cn&&(!($e&2)&&(Fc|=n),Jt===4&&Zi(t,xn)),$n(t,i),n===1&&$e===0&&!(e.mode&1)&&(Zo=Gt()+500,Mc&&Is()))}function $n(t,e){var n=t.callbackNode;Ax(t,e);var i=Wu(t,t===cn?xn:0);if(i===0)n!==null&&f0(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&f0(n),e===1)t.tag===0?_E(ig.bind(null,t)):Lm(ig.bind(null,t)),yE(function(){!($e&6)&&Is()}),n=null;else{switch(hm(i)){case 1:n=S1;break;case 4:n=lm;break;case 16:n=Gu;break;case 536870912:n=um;break;default:n=Gu}n=M2(n,S2.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function S2(t,e){if(Du=-1,Ou=0,$e&6)throw Error(ae(327));var n=t.callbackNode;if(zo()&&t.callbackNode!==n)return null;var i=Wu(t,t===cn?xn:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=lc(t,i);else{e=i;var a=$e;$e|=2;var l=N2();(cn!==t||xn!==e)&&(xi=null,Zo=Gt()+500,Ws(t,e));do try{HE();break}catch(y){R2(t,y)}while(1);U1(),sc.current=l,$e=a,Kt!==null?e=0:(cn=null,xn=0,e=Jt)}if(e!==0){if(e===2&&(a=pf(t),a!==0&&(i=a,e=Gf(t,a))),e===1)throw n=wl,Ws(t,0),Zi(t,i),$n(t,Gt()),n;if(e===6)Zi(t,i);else{if(a=t.current.alternate,!(i&30)&&!UE(a)&&(e=lc(t,i),e===2&&(l=pf(t),l!==0&&(i=l,e=Gf(t,l))),e===1))throw n=wl,Ws(t,0),Zi(t,i),$n(t,Gt()),n;switch(t.finishedWork=a,t.finishedLanes=i,e){case 0:case 1:throw Error(ae(345));case 2:Fs(t,qn,xi);break;case 3:if(Zi(t,i),(i&130023424)===i&&(e=td+500-Gt(),10<e)){if(Wu(t,0)!==0)break;if(a=t.suspendedLanes,(a&i)!==i){Bn(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=Cf(Fs.bind(null,t,qn,xi),e);break}Fs(t,qn,xi);break;case 4:if(Zi(t,i),(i&4194240)===i)break;for(e=t.eventTimes,a=-1;0<i;){var f=31-Ur(i);l=1<<f,f=e[f],f>a&&(a=f),i&=~l}if(i=a,i=Gt()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*VE(i/1960))-i,10<i){t.timeoutHandle=Cf(Fs.bind(null,t,qn,xi),i);break}Fs(t,qn,xi);break;case 5:Fs(t,qn,xi);break;default:throw Error(ae(329))}}}return $n(t,Gt()),t.callbackNode===n?S2.bind(null,t):null}function Gf(t,e){var n=Ya;return t.current.memoizedState.isDehydrated&&(Ws(t,e).flags|=256),t=lc(t,e),t!==2&&(e=qn,qn=n,e!==null&&Wf(e)),t}function Wf(t){qn===null?qn=t:qn.push.apply(qn,t)}function UE(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var a=n[i],l=a.getSnapshot;a=a.value;try{if(!Hr(l(),a))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Zi(t,e){for(e&=~ed,e&=~Fc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ur(e),i=1<<n;t[n]=-1,e&=~i}}function ig(t){if($e&6)throw Error(ae(327));zo();var e=Wu(t,0);if(!(e&1))return $n(t,Gt()),null;var n=lc(t,e);if(t.tag!==0&&n===2){var i=pf(t);i!==0&&(e=i,n=Gf(t,i))}if(n===1)throw n=wl,Ws(t,0),Zi(t,e),$n(t,Gt()),n;if(n===6)throw Error(ae(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Fs(t,qn,xi),$n(t,Gt()),null}function nd(t,e){var n=$e;$e|=1;try{return t(e)}finally{$e=n,$e===0&&(Zo=Gt()+500,Mc&&Is())}}function Zs(t){es!==null&&es.tag===0&&!($e&6)&&zo();var e=$e;$e|=1;var n=Tr.transition,i=lt;try{if(Tr.transition=null,lt=1,t)return t()}finally{lt=i,Tr.transition=n,$e=e,!($e&6)&&Is()}}function rd(){nr=Mo.current,It(Mo)}function Ws(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,mE(n)),Kt!==null)for(n=Kt.return;n!==null;){var i=n;switch(B1(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Yu();break;case 3:Yo(),It(Qn),It(Dn),X1();break;case 5:j1(i);break;case 4:Yo();break;case 13:It(Dt);break;case 19:It(Dt);break;case 10:z1(i.type._context);break;case 22:case 23:rd()}n=n.return}if(cn=t,Kt=t=us(t.current,null),xn=nr=e,Jt=0,wl=null,ed=Fc=Qs=0,qn=Ya=null,zs!==null){for(e=0;e<zs.length;e++)if(n=zs[e],i=n.interleaved,i!==null){n.interleaved=null;var a=i.next,l=n.pending;if(l!==null){var f=l.next;l.next=a,i.next=f}n.pending=i}zs=null}return t}function R2(t,e){do{var n=Kt;try{if(U1(),Ru.current=ic,rc){for(var i=Ot.memoizedState;i!==null;){var a=i.queue;a!==null&&(a.pending=null),i=i.next}rc=!1}if(Ys=0,un=$t=Ot=null,qa=!1,pl=0,J1.current=null,n===null||n.return===null){Jt=1,wl=e,Kt=null;break}e:{var l=t,f=n.return,y=n,x=e;if(e=xn,y.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){var m=x,C=y,v=C.tag;if(!(C.mode&1)&&(v===0||v===11||v===15)){var D=C.alternate;D?(C.updateQueue=D.updateQueue,C.memoizedState=D.memoizedState,C.lanes=D.lanes):(C.updateQueue=null,C.memoizedState=null)}var V=j0(f);if(V!==null){V.flags&=-257,X0(V,f,y,l,e),V.mode&1&&W0(l,m,e),e=V,x=m;var Y=e.updateQueue;if(Y===null){var X=new Set;X.add(x),e.updateQueue=X}else Y.add(x);break e}else{if(!(e&1)){W0(l,m,e),id();break e}x=Error(ae(426))}}else if(vt&&y.mode&1){var ne=j0(f);if(ne!==null){!(ne.flags&65536)&&(ne.flags|=256),X0(ne,f,y,l,e),F1(Qo(x,y));break e}}l=x=Qo(x,y),Jt!==4&&(Jt=2),Ya===null?Ya=[l]:Ya.push(l),l=f;do{switch(l.tag){case 3:l.flags|=65536,e&=-e,l.lanes|=e;var H=h2(l,x,e);F0(l,H);break e;case 1:y=x;var k=l.type,B=l.stateNode;if(!(l.flags&128)&&(typeof k.getDerivedStateFromError=="function"||B!==null&&typeof B.componentDidCatch=="function"&&(as===null||!as.has(B)))){l.flags|=65536,e&=-e,l.lanes|=e;var $=f2(l,y,e);F0(l,$);break e}}l=l.return}while(l!==null)}D2(n)}catch(ce){e=ce,Kt===n&&n!==null&&(Kt=n=n.return);continue}break}while(1)}function N2(){var t=sc.current;return sc.current=ic,t===null?ic:t}function id(){(Jt===0||Jt===3||Jt===2)&&(Jt=4),cn===null||!(Qs&268435455)&&!(Fc&268435455)||Zi(cn,xn)}function lc(t,e){var n=$e;$e|=2;var i=N2();(cn!==t||xn!==e)&&(xi=null,Ws(t,e));do try{zE();break}catch(a){R2(t,a)}while(1);if(U1(),$e=n,sc.current=i,Kt!==null)throw Error(ae(261));return cn=null,xn=0,Jt}function zE(){for(;Kt!==null;)b2(Kt)}function HE(){for(;Kt!==null&&!dx();)b2(Kt)}function b2(t){var e=P2(t.alternate,t,nr);t.memoizedProps=t.pendingProps,e===null?D2(t):Kt=e,J1.current=null}function D2(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=kE(n,e),n!==null){n.flags&=32767,Kt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Jt=6,Kt=null;return}}else if(n=ME(n,e,nr),n!==null){Kt=n;return}if(e=e.sibling,e!==null){Kt=e;return}Kt=e=t}while(e!==null);Jt===0&&(Jt=5)}function Fs(t,e,n){var i=lt,a=Tr.transition;try{Tr.transition=null,lt=1,GE(t,e,n,i)}finally{Tr.transition=a,lt=i}return null}function GE(t,e,n,i){do zo();while(es!==null);if($e&6)throw Error(ae(327));n=t.finishedWork;var a=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ae(177));t.callbackNode=null,t.callbackPriority=0;var l=n.lanes|n.childLanes;if(Cx(t,l),t===cn&&(Kt=cn=null,xn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||pu||(pu=!0,M2(Gu,function(){return zo(),null})),l=(n.flags&15990)!==0,n.subtreeFlags&15990||l){l=Tr.transition,Tr.transition=null;var f=lt;lt=1;var y=$e;$e|=4,J1.current=null,BE(t,n),T2(n,t),uE(_f),ju=!!Ef,_f=Ef=null,t.current=n,FE(n),gx(),$e=y,lt=f,Tr.transition=l}else t.current=n;if(pu&&(pu=!1,es=t,ac=a),l=t.pendingLanes,l===0&&(as=null),yx(n.stateNode),$n(t,Gt()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)a=e[n],i(a.value,{componentStack:a.stack,digest:a.digest});if(oc)throw oc=!1,t=zf,zf=null,t;return ac&1&&t.tag!==0&&zo(),l=t.pendingLanes,l&1?t===Hf?Qa++:(Qa=0,Hf=t):Qa=0,Is(),null}function zo(){if(es!==null){var t=hm(ac),e=Tr.transition,n=lt;try{if(Tr.transition=null,lt=16>t?16:t,es===null)var i=!1;else{if(t=es,es=null,ac=0,$e&6)throw Error(ae(331));var a=$e;for($e|=4,xe=t.current;xe!==null;){var l=xe,f=l.child;if(xe.flags&16){var y=l.deletions;if(y!==null){for(var x=0;x<y.length;x++){var m=y[x];for(xe=m;xe!==null;){var C=xe;switch(C.tag){case 0:case 11:case 15:Ka(8,C,l)}var v=C.child;if(v!==null)v.return=C,xe=v;else for(;xe!==null;){C=xe;var D=C.sibling,V=C.return;if(A2(C),C===m){xe=null;break}if(D!==null){D.return=V,xe=D;break}xe=V}}}var Y=l.alternate;if(Y!==null){var X=Y.child;if(X!==null){Y.child=null;do{var ne=X.sibling;X.sibling=null,X=ne}while(X!==null)}}xe=l}}if(l.subtreeFlags&2064&&f!==null)f.return=l,xe=f;else e:for(;xe!==null;){if(l=xe,l.flags&2048)switch(l.tag){case 0:case 11:case 15:Ka(9,l,l.return)}var H=l.sibling;if(H!==null){H.return=l.return,xe=H;break e}xe=l.return}}var k=t.current;for(xe=k;xe!==null;){f=xe;var B=f.child;if(f.subtreeFlags&2064&&B!==null)B.return=f,xe=B;else e:for(f=k;xe!==null;){if(y=xe,y.flags&2048)try{switch(y.tag){case 0:case 11:case 15:Bc(9,y)}}catch(ce){Ft(y,y.return,ce)}if(y===f){xe=null;break e}var $=y.sibling;if($!==null){$.return=y.return,xe=$;break e}xe=y.return}}if($e=a,Is(),ii&&typeof ii.onPostCommitFiberRoot=="function")try{ii.onPostCommitFiberRoot(Nc,t)}catch{}i=!0}return i}finally{lt=n,Tr.transition=e}}return!1}function sg(t,e,n){e=Qo(n,e),e=h2(t,e,1),t=os(t,e,1),e=Bn(),t!==null&&(Nl(t,1,e),$n(t,e))}function Ft(t,e,n){if(t.tag===3)sg(t,t,n);else for(;e!==null;){if(e.tag===3){sg(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(as===null||!as.has(i))){t=Qo(n,t),t=f2(e,t,1),e=os(e,t,1),t=Bn(),e!==null&&(Nl(e,1,t),$n(e,t));break}}e=e.return}}function WE(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=Bn(),t.pingedLanes|=t.suspendedLanes&n,cn===t&&(xn&n)===n&&(Jt===4||Jt===3&&(xn&130023424)===xn&&500>Gt()-td?Ws(t,0):ed|=n),$n(t,e)}function O2(t,e){e===0&&(t.mode&1?(e=su,su<<=1,!(su&130023424)&&(su=4194304)):e=1);var n=Bn();t=vi(t,e),t!==null&&(Nl(t,e,n),$n(t,n))}function jE(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),O2(t,n)}function XE(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,a=t.memoizedState;a!==null&&(n=a.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(ae(314))}i!==null&&i.delete(e),O2(t,n)}var P2;P2=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Qn.current)Yn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Yn=!1,PE(t,e,n);Yn=!!(t.flags&131072)}else Yn=!1,vt&&e.flags&1048576&&Bm(e,$u,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;bu(t,e),t=e.pendingProps;var a=Xo(e,Dn.current);Uo(e,n),a=K1(null,e,i,t,a,n);var l=Y1();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Zn(i)?(l=!0,Qu(e)):l=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,G1(e),a.updater=Lc,e.stateNode=a,a._reactInternals=e,bf(e,i,t,n),e=Pf(null,e,i,!0,l,n)):(e.tag=0,vt&&l&&L1(e),Ln(null,e,a,n),e=e.child),e;case 16:i=e.elementType;e:{switch(bu(t,e),t=e.pendingProps,a=i._init,i=a(i._payload),e.type=i,a=e.tag=KE(i),t=Br(i,t),a){case 0:e=Of(null,e,i,t,n);break e;case 1:e=Y0(null,e,i,t,n);break e;case 11:e=q0(null,e,i,t,n);break e;case 14:e=K0(null,e,i,Br(i.type,t),n);break e}throw Error(ae(306,i,""))}return e;case 0:return i=e.type,a=e.pendingProps,a=e.elementType===i?a:Br(i,a),Of(t,e,i,a,n);case 1:return i=e.type,a=e.pendingProps,a=e.elementType===i?a:Br(i,a),Y0(t,e,i,a,n);case 3:e:{if(m2(e),t===null)throw Error(ae(387));i=e.pendingProps,l=e.memoizedState,a=l.element,Gm(t,e),tc(e,i,null,n);var f=e.memoizedState;if(i=f.element,l.isDehydrated)if(l={element:i,isDehydrated:!1,cache:f.cache,pendingSuspenseBoundaries:f.pendingSuspenseBoundaries,transitions:f.transitions},e.updateQueue.baseState=l,e.memoizedState=l,e.flags&256){a=Qo(Error(ae(423)),e),e=Q0(t,e,i,n,a);break e}else if(i!==a){a=Qo(Error(ae(424)),e),e=Q0(t,e,i,n,a);break e}else for(rr=ss(e.stateNode.containerInfo.firstChild),sr=e,vt=!0,Vr=null,n=zm(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(qo(),i===a){e=Si(t,e,n);break e}Ln(t,e,i,n)}e=e.child}return e;case 5:return Wm(e),t===null&&Sf(e),i=e.type,a=e.pendingProps,l=t!==null?t.memoizedProps:null,f=a.children,Af(i,a)?f=null:l!==null&&Af(i,l)&&(e.flags|=32),p2(t,e),Ln(t,e,f,n),e.child;case 6:return t===null&&Sf(e),null;case 13:return y2(t,e,n);case 4:return W1(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=Ko(e,null,i,n):Ln(t,e,i,n),e.child;case 11:return i=e.type,a=e.pendingProps,a=e.elementType===i?a:Br(i,a),q0(t,e,i,a,n);case 7:return Ln(t,e,e.pendingProps,n),e.child;case 8:return Ln(t,e,e.pendingProps.children,n),e.child;case 12:return Ln(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,a=e.pendingProps,l=e.memoizedProps,f=a.value,yt(Ju,i._currentValue),i._currentValue=f,l!==null)if(Hr(l.value,f)){if(l.children===a.children&&!Qn.current){e=Si(t,e,n);break e}}else for(l=e.child,l!==null&&(l.return=e);l!==null;){var y=l.dependencies;if(y!==null){f=l.child;for(var x=y.firstContext;x!==null;){if(x.context===i){if(l.tag===1){x=Ci(-1,n&-n),x.tag=2;var m=l.updateQueue;if(m!==null){m=m.shared;var C=m.pending;C===null?x.next=x:(x.next=C.next,C.next=x),m.pending=x}}l.lanes|=n,x=l.alternate,x!==null&&(x.lanes|=n),Rf(l.return,n,e),y.lanes|=n;break}x=x.next}}else if(l.tag===10)f=l.type===e.type?null:l.child;else if(l.tag===18){if(f=l.return,f===null)throw Error(ae(341));f.lanes|=n,y=f.alternate,y!==null&&(y.lanes|=n),Rf(f,n,e),f=l.sibling}else f=l.child;if(f!==null)f.return=l;else for(f=l;f!==null;){if(f===e){f=null;break}if(l=f.sibling,l!==null){l.return=f.return,f=l;break}f=f.return}l=f}Ln(t,e,a.children,n),e=e.child}return e;case 9:return a=e.type,i=e.pendingProps.children,Uo(e,n),a=Sr(a),i=i(a),e.flags|=1,Ln(t,e,i,n),e.child;case 14:return i=e.type,a=Br(i,e.pendingProps),a=Br(i.type,a),K0(t,e,i,a,n);case 15:return d2(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,a=e.pendingProps,a=e.elementType===i?a:Br(i,a),bu(t,e),e.tag=1,Zn(i)?(t=!0,Qu(e)):t=!1,Uo(e,n),c2(e,i,a),bf(e,i,a,n),Pf(null,e,i,!0,t,n);case 19:return w2(t,e,n);case 22:return g2(t,e,n)}throw Error(ae(156,e.tag))};function M2(t,e){return am(t,e)}function qE(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ir(t,e,n,i){return new qE(t,e,n,i)}function sd(t){return t=t.prototype,!(!t||!t.isReactComponent)}function KE(t){if(typeof t=="function")return sd(t)?1:0;if(t!=null){if(t=t.$$typeof,t===I1)return 11;if(t===T1)return 14}return 2}function us(t,e){var n=t.alternate;return n===null?(n=Ir(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Pu(t,e,n,i,a,l){var f=2;if(i=t,typeof t=="function")sd(t)&&(f=1);else if(typeof t=="string")f=5;else e:switch(t){case Io:return js(n.children,a,l,e);case C1:f=8,a|=8;break;case Jh:return t=Ir(12,n,e,a|2),t.elementType=Jh,t.lanes=l,t;case ef:return t=Ir(13,n,e,a),t.elementType=ef,t.lanes=l,t;case tf:return t=Ir(19,n,e,a),t.elementType=tf,t.lanes=l,t;case Wp:return Vc(n,a,l,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Hp:f=10;break e;case Gp:f=9;break e;case I1:f=11;break e;case T1:f=14;break e;case Ki:f=16,i=null;break e}throw Error(ae(130,t==null?t:typeof t,""))}return e=Ir(f,n,e,a),e.elementType=t,e.type=i,e.lanes=l,e}function js(t,e,n,i){return t=Ir(7,t,i,e),t.lanes=n,t}function Vc(t,e,n,i){return t=Ir(22,t,i,e),t.elementType=Wp,t.lanes=n,t.stateNode={isHidden:!1},t}function Uh(t,e,n){return t=Ir(6,t,null,e),t.lanes=n,t}function zh(t,e,n){return e=Ir(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function YE(t,e,n,i,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_h(0),this.expirationTimes=_h(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_h(0),this.identifierPrefix=i,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function od(t,e,n,i,a,l,f,y,x){return t=new YE(t,e,n,y,x),e===1?(e=1,l===!0&&(e|=8)):e=0,l=Ir(3,null,null,e),t.current=l,l.stateNode=t,l.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},G1(l),t}function QE(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Co,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function k2(t){if(!t)return ps;t=t._reactInternals;e:{if(to(t)!==t||t.tag!==1)throw Error(ae(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Zn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ae(171))}if(t.tag===1){var n=t.type;if(Zn(n))return km(t,n,e)}return e}function L2(t,e,n,i,a,l,f,y,x){return t=od(n,i,!0,t,a,l,f,y,x),t.context=k2(null),n=t.current,i=Bn(),a=ls(n),l=Ci(i,a),l.callback=e??null,os(n,l,a),t.current.lanes=a,Nl(t,a,i),$n(t,i),t}function Uc(t,e,n,i){var a=e.current,l=Bn(),f=ls(a);return n=k2(n),e.context===null?e.context=n:e.pendingContext=n,e=Ci(l,f),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=os(a,e,f),t!==null&&(zr(t,a,f,l),Su(t,a,f)),f}function uc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function og(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function ad(t,e){og(t,e),(t=t.alternate)&&og(t,e)}function ZE(){return null}var B2=typeof reportError=="function"?reportError:function(t){console.error(t)};function ld(t){this._internalRoot=t}zc.prototype.render=ld.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ae(409));Uc(t,e,null,null)};zc.prototype.unmount=ld.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Zs(function(){Uc(null,t,null,null)}),e[Ti]=null}};function zc(t){this._internalRoot=t}zc.prototype.unstable_scheduleHydration=function(t){if(t){var e=gm();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Qi.length&&e!==0&&e<Qi[n].priority;n++);Qi.splice(n,0,t),n===0&&mm(t)}};function ud(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Hc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function ag(){}function $E(t,e,n,i,a){if(a){if(typeof i=="function"){var l=i;i=function(){var m=uc(f);l.call(m)}}var f=L2(e,i,t,0,null,!1,!1,"",ag);return t._reactRootContainer=f,t[Ti]=f.current,cl(t.nodeType===8?t.parentNode:t),Zs(),f}for(;a=t.lastChild;)t.removeChild(a);if(typeof i=="function"){var y=i;i=function(){var m=uc(x);y.call(m)}}var x=od(t,0,!1,null,null,!1,!1,"",ag);return t._reactRootContainer=x,t[Ti]=x.current,cl(t.nodeType===8?t.parentNode:t),Zs(function(){Uc(e,x,n,i)}),x}function Gc(t,e,n,i,a){var l=n._reactRootContainer;if(l){var f=l;if(typeof a=="function"){var y=a;a=function(){var x=uc(f);y.call(x)}}Uc(e,f,t,a)}else f=$E(n,e,t,a,i);return uc(f)}fm=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=La(e.pendingLanes);n!==0&&(R1(e,n|1),$n(e,Gt()),!($e&6)&&(Zo=Gt()+500,Is()))}break;case 13:Zs(function(){var i=vi(t,1);if(i!==null){var a=Bn();zr(i,t,1,a)}}),ad(t,1)}};N1=function(t){if(t.tag===13){var e=vi(t,134217728);if(e!==null){var n=Bn();zr(e,t,134217728,n)}ad(t,134217728)}};dm=function(t){if(t.tag===13){var e=ls(t),n=vi(t,e);if(n!==null){var i=Bn();zr(n,t,e,i)}ad(t,e)}};gm=function(){return lt};pm=function(t,e){var n=lt;try{return lt=t,e()}finally{lt=n}};ff=function(t,e,n){switch(e){case"input":if(sf(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var a=Pc(i);if(!a)throw Error(ae(90));Xp(i),sf(i,a)}}}break;case"textarea":Kp(t,n);break;case"select":e=n.value,e!=null&&Lo(t,!!n.multiple,e,!1)}};tm=nd;nm=Zs;var JE={usingClientEntryPoint:!1,Events:[Dl,Ro,Pc,Jp,em,nd]},Pa={findFiberByHostInstance:Us,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},e_={bundleType:Pa.bundleType,version:Pa.version,rendererPackageName:Pa.rendererPackageName,rendererConfig:Pa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Oi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=sm(t),t===null?null:t.stateNode},findFiberByHostInstance:Pa.findFiberByHostInstance||ZE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mu.isDisabled&&mu.supportsFiber)try{Nc=mu.inject(e_),ii=mu}catch{}}lr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=JE;lr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ud(e))throw Error(ae(200));return QE(t,e,null,n)};lr.createRoot=function(t,e){if(!ud(t))throw Error(ae(299));var n=!1,i="",a=B2;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=od(t,1,!1,null,null,n,!1,i,a),t[Ti]=e.current,cl(t.nodeType===8?t.parentNode:t),new ld(e)};lr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ae(188)):(t=Object.keys(t).join(","),Error(ae(268,t)));return t=sm(e),t=t===null?null:t.stateNode,t};lr.flushSync=function(t){return Zs(t)};lr.hydrate=function(t,e,n){if(!Hc(e))throw Error(ae(200));return Gc(null,t,e,!0,n)};lr.hydrateRoot=function(t,e,n){if(!ud(t))throw Error(ae(405));var i=n!=null&&n.hydratedSources||null,a=!1,l="",f=B2;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(f=n.onRecoverableError)),e=L2(e,null,t,1,n??null,a,!1,l,f),t[Ti]=e.current,cl(t),i)for(t=0;t<i.length;t++)n=i[t],a=n._getVersion,a=a(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,a]:e.mutableSourceEagerHydrationData.push(n,a);return new zc(e)};lr.render=function(t,e,n){if(!Hc(e))throw Error(ae(200));return Gc(null,t,e,!1,n)};lr.unmountComponentAtNode=function(t){if(!Hc(t))throw Error(ae(40));return t._reactRootContainer?(Zs(function(){Gc(null,null,t,!1,function(){t._reactRootContainer=null,t[Ti]=null})}),!0):!1};lr.unstable_batchedUpdates=nd;lr.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!Hc(n))throw Error(ae(200));if(t==null||t._reactInternals===void 0)throw Error(ae(38));return Gc(t,e,n,!1,i)};lr.version="18.3.1-next-f1338f8080-20240426";function F2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(F2)}catch(t){console.error(t)}}F2(),Fp.exports=lr;var DT=Fp.exports;const t_=()=>{};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V2=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let a=t.charCodeAt(i);a<128?e[n++]=a:a<2048?(e[n++]=a>>6|192,e[n++]=a&63|128):(a&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++i)&1023),e[n++]=a>>18|240,e[n++]=a>>12&63|128,e[n++]=a>>6&63|128,e[n++]=a&63|128):(e[n++]=a>>12|224,e[n++]=a>>6&63|128,e[n++]=a&63|128)}return e},n_=function(t){const e=[];let n=0,i=0;for(;n<t.length;){const a=t[n++];if(a<128)e[i++]=String.fromCharCode(a);else if(a>191&&a<224){const l=t[n++];e[i++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=t[n++],f=t[n++],y=t[n++],x=((a&7)<<18|(l&63)<<12|(f&63)<<6|y&63)-65536;e[i++]=String.fromCharCode(55296+(x>>10)),e[i++]=String.fromCharCode(56320+(x&1023))}else{const l=t[n++],f=t[n++];e[i++]=String.fromCharCode((a&15)<<12|(l&63)<<6|f&63)}}return e.join("")},U2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let a=0;a<t.length;a+=3){const l=t[a],f=a+1<t.length,y=f?t[a+1]:0,x=a+2<t.length,m=x?t[a+2]:0,C=l>>2,v=(l&3)<<4|y>>4;let D=(y&15)<<2|m>>6,V=m&63;x||(V=64,f||(D=64)),i.push(n[C],n[v],n[D],n[V])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(V2(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):n_(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let a=0;a<t.length;){const l=n[t.charAt(a++)],y=a<t.length?n[t.charAt(a)]:0;++a;const m=a<t.length?n[t.charAt(a)]:64;++a;const v=a<t.length?n[t.charAt(a)]:64;if(++a,l==null||y==null||m==null||v==null)throw new r_;const D=l<<2|y>>4;if(i.push(D),m!==64){const V=y<<4&240|m>>2;if(i.push(V),v!==64){const Y=m<<6&192|v;i.push(Y)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class r_ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const i_=function(t){const e=V2(t);return U2.encodeByteArray(e,!0)},cc=function(t){return i_(t).replace(/\./g,"")},s_=function(t){try{return U2.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a_=()=>o_().__FIREBASE_DEFAULTS__,l_=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},u_=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&s_(t[1]);return e&&JSON.parse(e)},Wc=()=>{try{return t_()||a_()||l_()||u_()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},c_=t=>{var e,n;return(n=(e=Wc())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},h_=t=>{const e=c_(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},z2=()=>{var t;return(t=Wc())==null?void 0:t.config},OT=t=>{var e;return(e=Wc())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f_{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cd(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function d_(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g_(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=e||"demo-project",a=t.iat||0,l=t.sub||t.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const f={iss:`https://securetoken.google.com/${i}`,aud:i,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...t},y="";return[cc(JSON.stringify(n)),cc(JSON.stringify(f)),y].join(".")}const Za={};function p_(){const t={prod:[],emulator:[]};for(const e of Object.keys(Za))Za[e]?t.emulator.push(e):t.prod.push(e);return t}function m_(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let lg=!1;function y_(t,e){if(typeof window>"u"||typeof document>"u"||!cd(window.location.host)||Za[t]===e||Za[t]||lg)return;Za[t]=e;function n(D){return`__firebase__banner__${D}`}const i="__firebase__banner",l=p_().prod.length>0;function f(){const D=document.getElementById(i);D&&D.remove()}function y(D){D.style.display="flex",D.style.background="#7faaf0",D.style.position="fixed",D.style.bottom="5px",D.style.left="5px",D.style.padding=".5em",D.style.borderRadius="5px",D.style.alignItems="center"}function x(D,V){D.setAttribute("width","24"),D.setAttribute("id",V),D.setAttribute("height","24"),D.setAttribute("viewBox","0 0 24 24"),D.setAttribute("fill","none"),D.style.marginLeft="-6px"}function m(){const D=document.createElement("span");return D.style.cursor="pointer",D.style.marginLeft="16px",D.style.fontSize="24px",D.innerHTML=" &times;",D.onclick=()=>{lg=!0,f()},D}function C(D,V){D.setAttribute("id",V),D.innerText="Learn more",D.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",D.setAttribute("target","__blank"),D.style.paddingLeft="5px",D.style.textDecoration="underline"}function v(){const D=m_(i),V=n("text"),Y=document.getElementById(V)||document.createElement("span"),X=n("learnmore"),ne=document.getElementById(X)||document.createElement("a"),H=n("preprendIcon"),k=document.getElementById(H)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(D.created){const B=D.element;y(B),C(ne,X);const $=m();x(k,H),B.append(k,Y,ne,$),document.body.appendChild(B)}l?(Y.innerText="Preview backend disconnected.",k.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(k.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,Y.innerText="Preview backend running in this workspace."),Y.setAttribute("id",V)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hd(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function PT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(hd())}function w_(){var e;const t=(e=Wc())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function MT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function kT(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function LT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function BT(){const t=hd();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function x_(){return!w_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function E_(){try{return typeof indexedDB=="object"}catch{return!1}}function __(){return new Promise((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(i);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{var l;e(((l=a.error)==null?void 0:l.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A_="FirebaseError";class aa extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=A_,Object.setPrototypeOf(this,aa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,H2.prototype.create)}}class H2{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){const i=n[0]||{},a=`${this.service}/${e}`,l=this.errors[e],f=l?C_(l,i):"Error",y=`${this.serviceName}: ${f} (${a}).`;return new aa(a,y,i)}}function C_(t,e){return t.replace(I_,(n,i)=>{const a=e[i];return a!=null?String(a):`<${i}?>`})}const I_=/\{\$([^}]+)}/g;function FT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function hc(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const a of n){if(!i.includes(a))return!1;const l=t[a],f=e[a];if(ug(l)&&ug(f)){if(!hc(l,f))return!1}else if(l!==f)return!1}for(const a of i)if(!n.includes(a))return!1;return!0}function ug(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VT(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach(a=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function UT(t){const e={};return t.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[a,l]=i.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function zT(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function HT(t,e){const n=new T_(t,e);return n.subscribe.bind(n)}class T_{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,i){let a;if(e===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");v_(e,["next","error","complete"])?a=e:a={next:e,error:n,complete:i},a.next===void 0&&(a.next=Hh),a.error===void 0&&(a.error=Hh),a.complete===void 0&&(a.complete=Hh);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function v_(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Hh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ri(t){return t&&t._delegate?t._delegate:t}class xl{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S_{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const i=new f_;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:n});a&&i.resolve(a)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(N_(e))try{this.getOrInitializeService({instanceIdentifier:Vs})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(n);try{const l=this.getOrInitializeService({instanceIdentifier:a});i.resolve(l)}catch{}}}}clearInstance(e=Vs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Vs){return this.instances.has(e)}getOptions(e=Vs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[l,f]of this.instancesDeferred.entries()){const y=this.normalizeInstanceIdentifier(l);i===y&&f.resolve(a)}return a}onInit(e,n){const i=this.normalizeInstanceIdentifier(n),a=this.onInitCallbacks.get(i)??new Set;a.add(e),this.onInitCallbacks.set(i,a);const l=this.instances.get(i);return l&&e(l,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,n){const i=this.onInitCallbacks.get(n);if(i)for(const a of i)try{a(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:R_(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Vs){return this.component?this.component.multipleInstances?e:Vs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function R_(t){return t===Vs?void 0:t}function N_(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b_{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new S_(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Qe||(Qe={}));const D_={debug:Qe.DEBUG,verbose:Qe.VERBOSE,info:Qe.INFO,warn:Qe.WARN,error:Qe.ERROR,silent:Qe.SILENT},O_=Qe.INFO,P_={[Qe.DEBUG]:"log",[Qe.VERBOSE]:"log",[Qe.INFO]:"info",[Qe.WARN]:"warn",[Qe.ERROR]:"error"},M_=(t,e,...n)=>{if(e<t.logLevel)return;const i=new Date().toISOString(),a=P_[e];if(a)console[a](`[${i}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class G2{constructor(e){this.name=e,this._logLevel=O_,this._logHandler=M_,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Qe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?D_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Qe.DEBUG,...e),this._logHandler(this,Qe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Qe.VERBOSE,...e),this._logHandler(this,Qe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Qe.INFO,...e),this._logHandler(this,Qe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Qe.WARN,...e),this._logHandler(this,Qe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Qe.ERROR,...e),this._logHandler(this,Qe.ERROR,...e)}}const k_=(t,e)=>e.some(n=>t instanceof n);let cg,hg;function L_(){return cg||(cg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function B_(){return hg||(hg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const W2=new WeakMap,jf=new WeakMap,j2=new WeakMap,Gh=new WeakMap,fd=new WeakMap;function F_(t){const e=new Promise((n,i)=>{const a=()=>{t.removeEventListener("success",l),t.removeEventListener("error",f)},l=()=>{n(cs(t.result)),a()},f=()=>{i(t.error),a()};t.addEventListener("success",l),t.addEventListener("error",f)});return e.then(n=>{n instanceof IDBCursor&&W2.set(n,t)}).catch(()=>{}),fd.set(e,t),e}function V_(t){if(jf.has(t))return;const e=new Promise((n,i)=>{const a=()=>{t.removeEventListener("complete",l),t.removeEventListener("error",f),t.removeEventListener("abort",f)},l=()=>{n(),a()},f=()=>{i(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",l),t.addEventListener("error",f),t.addEventListener("abort",f)});jf.set(t,e)}let Xf={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return jf.get(t);if(e==="objectStoreNames")return t.objectStoreNames||j2.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return cs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function U_(t){Xf=t(Xf)}function z_(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const i=t.call(Wh(this),e,...n);return j2.set(i,e.sort?e.sort():[e]),cs(i)}:B_().includes(t)?function(...e){return t.apply(Wh(this),e),cs(W2.get(this))}:function(...e){return cs(t.apply(Wh(this),e))}}function H_(t){return typeof t=="function"?z_(t):(t instanceof IDBTransaction&&V_(t),k_(t,L_())?new Proxy(t,Xf):t)}function cs(t){if(t instanceof IDBRequest)return F_(t);if(Gh.has(t))return Gh.get(t);const e=H_(t);return e!==t&&(Gh.set(t,e),fd.set(e,t)),e}const Wh=t=>fd.get(t);function G_(t,e,{blocked:n,upgrade:i,blocking:a,terminated:l}={}){const f=indexedDB.open(t,e),y=cs(f);return i&&f.addEventListener("upgradeneeded",x=>{i(cs(f.result),x.oldVersion,x.newVersion,cs(f.transaction),x)}),n&&f.addEventListener("blocked",x=>n(x.oldVersion,x.newVersion,x)),y.then(x=>{l&&x.addEventListener("close",()=>l()),a&&x.addEventListener("versionchange",m=>a(m.oldVersion,m.newVersion,m))}).catch(()=>{}),y}const W_=["get","getKey","getAll","getAllKeys","count"],j_=["put","add","delete","clear"],jh=new Map;function fg(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(jh.get(e))return jh.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,a=j_.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(a||W_.includes(n)))return;const l=async function(f,...y){const x=this.transaction(f,a?"readwrite":"readonly");let m=x.store;return i&&(m=m.index(y.shift())),(await Promise.all([m[n](...y),a&&x.done]))[0]};return jh.set(e,l),l}U_(t=>({...t,get:(e,n,i)=>fg(e,n)||t.get(e,n,i),has:(e,n)=>!!fg(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(q_(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function q_(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const qf="@firebase/app",dg="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ni=new G2("@firebase/app"),K_="@firebase/app-compat",Y_="@firebase/analytics-compat",Q_="@firebase/analytics",Z_="@firebase/app-check-compat",$_="@firebase/app-check",J_="@firebase/auth",eA="@firebase/auth-compat",tA="@firebase/database",nA="@firebase/data-connect",rA="@firebase/database-compat",iA="@firebase/functions",sA="@firebase/functions-compat",oA="@firebase/installations",aA="@firebase/installations-compat",lA="@firebase/messaging",uA="@firebase/messaging-compat",cA="@firebase/performance",hA="@firebase/performance-compat",fA="@firebase/remote-config",dA="@firebase/remote-config-compat",gA="@firebase/storage",pA="@firebase/storage-compat",mA="@firebase/firestore",yA="@firebase/ai",wA="@firebase/firestore-compat",xA="firebase",EA="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kf="[DEFAULT]",_A={[qf]:"fire-core",[K_]:"fire-core-compat",[Q_]:"fire-analytics",[Y_]:"fire-analytics-compat",[$_]:"fire-app-check",[Z_]:"fire-app-check-compat",[J_]:"fire-auth",[eA]:"fire-auth-compat",[tA]:"fire-rtdb",[nA]:"fire-data-connect",[rA]:"fire-rtdb-compat",[iA]:"fire-fn",[sA]:"fire-fn-compat",[oA]:"fire-iid",[aA]:"fire-iid-compat",[lA]:"fire-fcm",[uA]:"fire-fcm-compat",[cA]:"fire-perf",[hA]:"fire-perf-compat",[fA]:"fire-rc",[dA]:"fire-rc-compat",[gA]:"fire-gcs",[pA]:"fire-gcs-compat",[mA]:"fire-fst",[wA]:"fire-fst-compat",[yA]:"fire-vertex","fire-js":"fire-js",[xA]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fc=new Map,AA=new Map,Yf=new Map;function gg(t,e){try{t.container.addComponent(e)}catch(n){Ni.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function dc(t){const e=t.name;if(Yf.has(e))return Ni.debug(`There were multiple attempts to register component ${e}.`),!1;Yf.set(e,t);for(const n of fc.values())gg(n,t);for(const n of AA.values())gg(n,t);return!0}function CA(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function IA(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},hs=new H2("app","Firebase",TA);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vA{constructor(e,n,i){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new xl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw hs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SA=EA;function RA(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const i={name:Kf,automaticDataCollectionEnabled:!0,...e},a=i.name;if(typeof a!="string"||!a)throw hs.create("bad-app-name",{appName:String(a)});if(n||(n=z2()),!n)throw hs.create("no-options");const l=fc.get(a);if(l){if(hc(n,l.options)&&hc(i,l.config))return l;throw hs.create("duplicate-app",{appName:a})}const f=new b_(a);for(const x of Yf.values())f.addComponent(x);const y=new vA(n,i,f);return fc.set(a,y),y}function NA(t=Kf){const e=fc.get(t);if(!e&&t===Kf&&z2())return RA();if(!e)throw hs.create("no-app",{appName:t});return e}function Ho(t,e,n){let i=_A[t]??t;n&&(i+=`-${n}`);const a=i.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const f=[`Unable to register library "${i}" with version "${e}":`];a&&f.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&l&&f.push("and"),l&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ni.warn(f.join(" "));return}dc(new xl(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bA="firebase-heartbeat-database",DA=1,El="firebase-heartbeat-store";let Xh=null;function X2(){return Xh||(Xh=G_(bA,DA,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(El)}catch(n){console.warn(n)}}}}).catch(t=>{throw hs.create("idb-open",{originalErrorMessage:t.message})})),Xh}async function OA(t){try{const n=(await X2()).transaction(El),i=await n.objectStore(El).get(q2(t));return await n.done,i}catch(e){if(e instanceof aa)Ni.warn(e.message);else{const n=hs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ni.warn(n.message)}}}async function pg(t,e){try{const i=(await X2()).transaction(El,"readwrite");await i.objectStore(El).put(e,q2(t)),await i.done}catch(n){if(n instanceof aa)Ni.warn(n.message);else{const i=hs.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Ni.warn(i.message)}}}function q2(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PA=1024,MA=30;class kA{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new BA(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,n;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=mg();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(f=>f.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:a}),this._heartbeatsCache.heartbeats.length>MA){const f=FA(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(f,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Ni.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=mg(),{heartbeatsToSend:i,unsentEntries:a}=LA(this._heartbeatsCache.heartbeats),l=cc(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=n,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(n){return Ni.warn(n),""}}}function mg(){return new Date().toISOString().substring(0,10)}function LA(t,e=PA){const n=[];let i=t.slice();for(const a of t){const l=n.find(f=>f.agent===a.agent);if(l){if(l.dates.push(a.date),yg(n)>e){l.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),yg(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class BA{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return E_()?__().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await OA(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return pg(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return pg(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function yg(t){return cc(JSON.stringify({version:2,heartbeats:t})).length}function FA(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let i=1;i<t.length;i++)t[i].date<n&&(n=t[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VA(t){dc(new xl("platform-logger",e=>new X_(e),"PRIVATE")),dc(new xl("heartbeat",e=>new kA(e),"PRIVATE")),Ho(qf,dg,t),Ho(qf,dg,"esm2020"),Ho("fire-js","")}VA("");var UA="firebase",zA="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ho(UA,zA,"app");var wg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var fs,K2;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,O){function b(){}b.prototype=O.prototype,N.F=O.prototype,N.prototype=new b,N.prototype.constructor=N,N.D=function(F,U,G){for(var L=Array(arguments.length-2),ze=2;ze<arguments.length;ze++)L[ze-2]=arguments[ze];return O.prototype[U].apply(F,L)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,n),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(N,O,b){b||(b=0);const F=Array(16);if(typeof O=="string")for(var U=0;U<16;++U)F[U]=O.charCodeAt(b++)|O.charCodeAt(b++)<<8|O.charCodeAt(b++)<<16|O.charCodeAt(b++)<<24;else for(U=0;U<16;++U)F[U]=O[b++]|O[b++]<<8|O[b++]<<16|O[b++]<<24;O=N.g[0],b=N.g[1],U=N.g[2];let G=N.g[3],L;L=O+(G^b&(U^G))+F[0]+3614090360&4294967295,O=b+(L<<7&4294967295|L>>>25),L=G+(U^O&(b^U))+F[1]+3905402710&4294967295,G=O+(L<<12&4294967295|L>>>20),L=U+(b^G&(O^b))+F[2]+606105819&4294967295,U=G+(L<<17&4294967295|L>>>15),L=b+(O^U&(G^O))+F[3]+3250441966&4294967295,b=U+(L<<22&4294967295|L>>>10),L=O+(G^b&(U^G))+F[4]+4118548399&4294967295,O=b+(L<<7&4294967295|L>>>25),L=G+(U^O&(b^U))+F[5]+1200080426&4294967295,G=O+(L<<12&4294967295|L>>>20),L=U+(b^G&(O^b))+F[6]+2821735955&4294967295,U=G+(L<<17&4294967295|L>>>15),L=b+(O^U&(G^O))+F[7]+4249261313&4294967295,b=U+(L<<22&4294967295|L>>>10),L=O+(G^b&(U^G))+F[8]+1770035416&4294967295,O=b+(L<<7&4294967295|L>>>25),L=G+(U^O&(b^U))+F[9]+2336552879&4294967295,G=O+(L<<12&4294967295|L>>>20),L=U+(b^G&(O^b))+F[10]+4294925233&4294967295,U=G+(L<<17&4294967295|L>>>15),L=b+(O^U&(G^O))+F[11]+2304563134&4294967295,b=U+(L<<22&4294967295|L>>>10),L=O+(G^b&(U^G))+F[12]+1804603682&4294967295,O=b+(L<<7&4294967295|L>>>25),L=G+(U^O&(b^U))+F[13]+4254626195&4294967295,G=O+(L<<12&4294967295|L>>>20),L=U+(b^G&(O^b))+F[14]+2792965006&4294967295,U=G+(L<<17&4294967295|L>>>15),L=b+(O^U&(G^O))+F[15]+1236535329&4294967295,b=U+(L<<22&4294967295|L>>>10),L=O+(U^G&(b^U))+F[1]+4129170786&4294967295,O=b+(L<<5&4294967295|L>>>27),L=G+(b^U&(O^b))+F[6]+3225465664&4294967295,G=O+(L<<9&4294967295|L>>>23),L=U+(O^b&(G^O))+F[11]+643717713&4294967295,U=G+(L<<14&4294967295|L>>>18),L=b+(G^O&(U^G))+F[0]+3921069994&4294967295,b=U+(L<<20&4294967295|L>>>12),L=O+(U^G&(b^U))+F[5]+3593408605&4294967295,O=b+(L<<5&4294967295|L>>>27),L=G+(b^U&(O^b))+F[10]+38016083&4294967295,G=O+(L<<9&4294967295|L>>>23),L=U+(O^b&(G^O))+F[15]+3634488961&4294967295,U=G+(L<<14&4294967295|L>>>18),L=b+(G^O&(U^G))+F[4]+3889429448&4294967295,b=U+(L<<20&4294967295|L>>>12),L=O+(U^G&(b^U))+F[9]+568446438&4294967295,O=b+(L<<5&4294967295|L>>>27),L=G+(b^U&(O^b))+F[14]+3275163606&4294967295,G=O+(L<<9&4294967295|L>>>23),L=U+(O^b&(G^O))+F[3]+4107603335&4294967295,U=G+(L<<14&4294967295|L>>>18),L=b+(G^O&(U^G))+F[8]+1163531501&4294967295,b=U+(L<<20&4294967295|L>>>12),L=O+(U^G&(b^U))+F[13]+2850285829&4294967295,O=b+(L<<5&4294967295|L>>>27),L=G+(b^U&(O^b))+F[2]+4243563512&4294967295,G=O+(L<<9&4294967295|L>>>23),L=U+(O^b&(G^O))+F[7]+1735328473&4294967295,U=G+(L<<14&4294967295|L>>>18),L=b+(G^O&(U^G))+F[12]+2368359562&4294967295,b=U+(L<<20&4294967295|L>>>12),L=O+(b^U^G)+F[5]+4294588738&4294967295,O=b+(L<<4&4294967295|L>>>28),L=G+(O^b^U)+F[8]+2272392833&4294967295,G=O+(L<<11&4294967295|L>>>21),L=U+(G^O^b)+F[11]+1839030562&4294967295,U=G+(L<<16&4294967295|L>>>16),L=b+(U^G^O)+F[14]+4259657740&4294967295,b=U+(L<<23&4294967295|L>>>9),L=O+(b^U^G)+F[1]+2763975236&4294967295,O=b+(L<<4&4294967295|L>>>28),L=G+(O^b^U)+F[4]+1272893353&4294967295,G=O+(L<<11&4294967295|L>>>21),L=U+(G^O^b)+F[7]+4139469664&4294967295,U=G+(L<<16&4294967295|L>>>16),L=b+(U^G^O)+F[10]+3200236656&4294967295,b=U+(L<<23&4294967295|L>>>9),L=O+(b^U^G)+F[13]+681279174&4294967295,O=b+(L<<4&4294967295|L>>>28),L=G+(O^b^U)+F[0]+3936430074&4294967295,G=O+(L<<11&4294967295|L>>>21),L=U+(G^O^b)+F[3]+3572445317&4294967295,U=G+(L<<16&4294967295|L>>>16),L=b+(U^G^O)+F[6]+76029189&4294967295,b=U+(L<<23&4294967295|L>>>9),L=O+(b^U^G)+F[9]+3654602809&4294967295,O=b+(L<<4&4294967295|L>>>28),L=G+(O^b^U)+F[12]+3873151461&4294967295,G=O+(L<<11&4294967295|L>>>21),L=U+(G^O^b)+F[15]+530742520&4294967295,U=G+(L<<16&4294967295|L>>>16),L=b+(U^G^O)+F[2]+3299628645&4294967295,b=U+(L<<23&4294967295|L>>>9),L=O+(U^(b|~G))+F[0]+4096336452&4294967295,O=b+(L<<6&4294967295|L>>>26),L=G+(b^(O|~U))+F[7]+1126891415&4294967295,G=O+(L<<10&4294967295|L>>>22),L=U+(O^(G|~b))+F[14]+2878612391&4294967295,U=G+(L<<15&4294967295|L>>>17),L=b+(G^(U|~O))+F[5]+4237533241&4294967295,b=U+(L<<21&4294967295|L>>>11),L=O+(U^(b|~G))+F[12]+1700485571&4294967295,O=b+(L<<6&4294967295|L>>>26),L=G+(b^(O|~U))+F[3]+2399980690&4294967295,G=O+(L<<10&4294967295|L>>>22),L=U+(O^(G|~b))+F[10]+4293915773&4294967295,U=G+(L<<15&4294967295|L>>>17),L=b+(G^(U|~O))+F[1]+2240044497&4294967295,b=U+(L<<21&4294967295|L>>>11),L=O+(U^(b|~G))+F[8]+1873313359&4294967295,O=b+(L<<6&4294967295|L>>>26),L=G+(b^(O|~U))+F[15]+4264355552&4294967295,G=O+(L<<10&4294967295|L>>>22),L=U+(O^(G|~b))+F[6]+2734768916&4294967295,U=G+(L<<15&4294967295|L>>>17),L=b+(G^(U|~O))+F[13]+1309151649&4294967295,b=U+(L<<21&4294967295|L>>>11),L=O+(U^(b|~G))+F[4]+4149444226&4294967295,O=b+(L<<6&4294967295|L>>>26),L=G+(b^(O|~U))+F[11]+3174756917&4294967295,G=O+(L<<10&4294967295|L>>>22),L=U+(O^(G|~b))+F[2]+718787259&4294967295,U=G+(L<<15&4294967295|L>>>17),L=b+(G^(U|~O))+F[9]+3951481745&4294967295,N.g[0]=N.g[0]+O&4294967295,N.g[1]=N.g[1]+(U+(L<<21&4294967295|L>>>11))&4294967295,N.g[2]=N.g[2]+U&4294967295,N.g[3]=N.g[3]+G&4294967295}i.prototype.v=function(N,O){O===void 0&&(O=N.length);const b=O-this.blockSize,F=this.C;let U=this.h,G=0;for(;G<O;){if(U==0)for(;G<=b;)a(this,N,G),G+=this.blockSize;if(typeof N=="string"){for(;G<O;)if(F[U++]=N.charCodeAt(G++),U==this.blockSize){a(this,F),U=0;break}}else for(;G<O;)if(F[U++]=N[G++],U==this.blockSize){a(this,F),U=0;break}}this.h=U,this.o+=O},i.prototype.A=function(){var N=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);N[0]=128;for(var O=1;O<N.length-8;++O)N[O]=0;O=this.o*8;for(var b=N.length-8;b<N.length;++b)N[b]=O&255,O/=256;for(this.v(N),N=Array(16),O=0,b=0;b<4;++b)for(let F=0;F<32;F+=8)N[O++]=this.g[b]>>>F&255;return N};function l(N,O){var b=y;return Object.prototype.hasOwnProperty.call(b,N)?b[N]:b[N]=O(N)}function f(N,O){this.h=O;const b=[];let F=!0;for(let U=N.length-1;U>=0;U--){const G=N[U]|0;F&&G==O||(b[U]=G,F=!1)}this.g=b}var y={};function x(N){return-128<=N&&N<128?l(N,function(O){return new f([O|0],O<0?-1:0)}):new f([N|0],N<0?-1:0)}function m(N){if(isNaN(N)||!isFinite(N))return v;if(N<0)return ne(m(-N));const O=[];let b=1;for(let F=0;N>=b;F++)O[F]=N/b|0,b*=4294967296;return new f(O,0)}function C(N,O){if(N.length==0)throw Error("number format error: empty string");if(O=O||10,O<2||36<O)throw Error("radix out of range: "+O);if(N.charAt(0)=="-")return ne(C(N.substring(1),O));if(N.indexOf("-")>=0)throw Error('number format error: interior "-" character');const b=m(Math.pow(O,8));let F=v;for(let G=0;G<N.length;G+=8){var U=Math.min(8,N.length-G);const L=parseInt(N.substring(G,G+U),O);U<8?(U=m(Math.pow(O,U)),F=F.j(U).add(m(L))):(F=F.j(b),F=F.add(m(L)))}return F}var v=x(0),D=x(1),V=x(16777216);t=f.prototype,t.m=function(){if(X(this))return-ne(this).m();let N=0,O=1;for(let b=0;b<this.g.length;b++){const F=this.i(b);N+=(F>=0?F:4294967296+F)*O,O*=4294967296}return N},t.toString=function(N){if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(Y(this))return"0";if(X(this))return"-"+ne(this).toString(N);const O=m(Math.pow(N,6));var b=this;let F="";for(;;){const U=$(b,O).g;b=H(b,U.j(O));let G=((b.g.length>0?b.g[0]:b.h)>>>0).toString(N);if(b=U,Y(b))return G+F;for(;G.length<6;)G="0"+G;F=G+F}},t.i=function(N){return N<0?0:N<this.g.length?this.g[N]:this.h};function Y(N){if(N.h!=0)return!1;for(let O=0;O<N.g.length;O++)if(N.g[O]!=0)return!1;return!0}function X(N){return N.h==-1}t.l=function(N){return N=H(this,N),X(N)?-1:Y(N)?0:1};function ne(N){const O=N.g.length,b=[];for(let F=0;F<O;F++)b[F]=~N.g[F];return new f(b,~N.h).add(D)}t.abs=function(){return X(this)?ne(this):this},t.add=function(N){const O=Math.max(this.g.length,N.g.length),b=[];let F=0;for(let U=0;U<=O;U++){let G=F+(this.i(U)&65535)+(N.i(U)&65535),L=(G>>>16)+(this.i(U)>>>16)+(N.i(U)>>>16);F=L>>>16,G&=65535,L&=65535,b[U]=L<<16|G}return new f(b,b[b.length-1]&-2147483648?-1:0)};function H(N,O){return N.add(ne(O))}t.j=function(N){if(Y(this)||Y(N))return v;if(X(this))return X(N)?ne(this).j(ne(N)):ne(ne(this).j(N));if(X(N))return ne(this.j(ne(N)));if(this.l(V)<0&&N.l(V)<0)return m(this.m()*N.m());const O=this.g.length+N.g.length,b=[];for(var F=0;F<2*O;F++)b[F]=0;for(F=0;F<this.g.length;F++)for(let U=0;U<N.g.length;U++){const G=this.i(F)>>>16,L=this.i(F)&65535,ze=N.i(U)>>>16,ee=N.i(U)&65535;b[2*F+2*U]+=L*ee,k(b,2*F+2*U),b[2*F+2*U+1]+=G*ee,k(b,2*F+2*U+1),b[2*F+2*U+1]+=L*ze,k(b,2*F+2*U+1),b[2*F+2*U+2]+=G*ze,k(b,2*F+2*U+2)}for(N=0;N<O;N++)b[N]=b[2*N+1]<<16|b[2*N];for(N=O;N<2*O;N++)b[N]=0;return new f(b,0)};function k(N,O){for(;(N[O]&65535)!=N[O];)N[O+1]+=N[O]>>>16,N[O]&=65535,O++}function B(N,O){this.g=N,this.h=O}function $(N,O){if(Y(O))throw Error("division by zero");if(Y(N))return new B(v,v);if(X(N))return O=$(ne(N),O),new B(ne(O.g),ne(O.h));if(X(O))return O=$(N,ne(O)),new B(ne(O.g),O.h);if(N.g.length>30){if(X(N)||X(O))throw Error("slowDivide_ only works with positive integers.");for(var b=D,F=O;F.l(N)<=0;)b=ce(b),F=ce(F);var U=se(b,1),G=se(F,1);for(F=se(F,2),b=se(b,2);!Y(F);){var L=G.add(F);L.l(N)<=0&&(U=U.add(b),G=L),F=se(F,1),b=se(b,1)}return O=H(N,U.j(O)),new B(U,O)}for(U=v;N.l(O)>=0;){for(b=Math.max(1,Math.floor(N.m()/O.m())),F=Math.ceil(Math.log(b)/Math.LN2),F=F<=48?1:Math.pow(2,F-48),G=m(b),L=G.j(O);X(L)||L.l(N)>0;)b-=F,G=m(b),L=G.j(O);Y(G)&&(G=D),U=U.add(G),N=H(N,L)}return new B(U,N)}t.B=function(N){return $(this,N).h},t.and=function(N){const O=Math.max(this.g.length,N.g.length),b=[];for(let F=0;F<O;F++)b[F]=this.i(F)&N.i(F);return new f(b,this.h&N.h)},t.or=function(N){const O=Math.max(this.g.length,N.g.length),b=[];for(let F=0;F<O;F++)b[F]=this.i(F)|N.i(F);return new f(b,this.h|N.h)},t.xor=function(N){const O=Math.max(this.g.length,N.g.length),b=[];for(let F=0;F<O;F++)b[F]=this.i(F)^N.i(F);return new f(b,this.h^N.h)};function ce(N){const O=N.g.length+1,b=[];for(let F=0;F<O;F++)b[F]=N.i(F)<<1|N.i(F-1)>>>31;return new f(b,N.h)}function se(N,O){const b=O>>5;O%=32;const F=N.g.length-b,U=[];for(let G=0;G<F;G++)U[G]=O>0?N.i(G+b)>>>O|N.i(G+b+1)<<32-O:N.i(G+b);return new f(U,N.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,K2=i,f.prototype.add=f.prototype.add,f.prototype.multiply=f.prototype.j,f.prototype.modulo=f.prototype.B,f.prototype.compare=f.prototype.l,f.prototype.toNumber=f.prototype.m,f.prototype.toString=f.prototype.toString,f.prototype.getBits=f.prototype.i,f.fromNumber=m,f.fromString=C,fs=f}).apply(typeof wg<"u"?wg:typeof self<"u"?self:typeof window<"u"?window:{});var yu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Y2,Fa,Q2,Mu,Qf,Z2,$2,J2;(function(){var t,e=Object.defineProperty;function n(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof yu=="object"&&yu];for(var E=0;E<g.length;++E){var A=g[E];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var i=n(this);function a(g,E){if(E)e:{var A=i;g=g.split(".");for(var R=0;R<g.length-1;R++){var j=g[R];if(!(j in A))break e;A=A[j]}g=g[g.length-1],R=A[g],E=E(R),E!=R&&E!=null&&e(A,g,{configurable:!0,writable:!0,value:E})}}a("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(g){return g||function(E){var A=[],R;for(R in E)Object.prototype.hasOwnProperty.call(E,R)&&A.push([R,E[R]]);return A}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},f=this||self;function y(g){var E=typeof g;return E=="object"&&g!=null||E=="function"}function x(g,E,A){return g.call.apply(g.bind,arguments)}function m(g,E,A){return m=x,m.apply(null,arguments)}function C(g,E){var A=Array.prototype.slice.call(arguments,1);return function(){var R=A.slice();return R.push.apply(R,arguments),g.apply(this,R)}}function v(g,E){function A(){}A.prototype=E.prototype,g.Z=E.prototype,g.prototype=new A,g.prototype.constructor=g,g.Ob=function(R,j,Q){for(var fe=Array(arguments.length-2),Me=2;Me<arguments.length;Me++)fe[Me-2]=arguments[Me];return E.prototype[j].apply(R,fe)}}var D=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function V(g){const E=g.length;if(E>0){const A=Array(E);for(let R=0;R<E;R++)A[R]=g[R];return A}return[]}function Y(g,E){for(let R=1;R<arguments.length;R++){const j=arguments[R];var A=typeof j;if(A=A!="object"?A:j?Array.isArray(j)?"array":A:"null",A=="array"||A=="object"&&typeof j.length=="number"){A=g.length||0;const Q=j.length||0;g.length=A+Q;for(let fe=0;fe<Q;fe++)g[A+fe]=j[fe]}else g.push(j)}}class X{constructor(E,A){this.i=E,this.j=A,this.h=0,this.g=null}get(){let E;return this.h>0?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function ne(g){f.setTimeout(()=>{throw g},0)}function H(){var g=N;let E=null;return g.g&&(E=g.g,g.g=g.g.next,g.g||(g.h=null),E.next=null),E}class k{constructor(){this.h=this.g=null}add(E,A){const R=B.get();R.set(E,A),this.h?this.h.next=R:this.g=R,this.h=R}}var B=new X(()=>new $,g=>g.reset());class ${constructor(){this.next=this.g=this.h=null}set(E,A){this.h=E,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let ce,se=!1,N=new k,O=()=>{const g=Promise.resolve(void 0);ce=()=>{g.then(b)}};function b(){for(var g;g=H();){try{g.h.call(g.g)}catch(A){ne(A)}var E=B;E.j(g),E.h<100&&(E.h++,g.next=E.g,E.g=g)}se=!1}function F(){this.u=this.u,this.C=this.C}F.prototype.u=!1,F.prototype.dispose=function(){this.u||(this.u=!0,this.N())},F.prototype[Symbol.dispose]=function(){this.dispose()},F.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function U(g,E){this.type=g,this.g=this.target=E,this.defaultPrevented=!1}U.prototype.h=function(){this.defaultPrevented=!0};var G=function(){if(!f.addEventListener||!Object.defineProperty)return!1;var g=!1,E=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const A=()=>{};f.addEventListener("test",A,E),f.removeEventListener("test",A,E)}catch{}return g}();function L(g){return/^[\s\xa0]*$/.test(g)}function ze(g,E){U.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,E)}v(ze,U),ze.prototype.init=function(g,E){const A=this.type=g.type,R=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=E,E=g.relatedTarget,E||(A=="mouseover"?E=g.fromElement:A=="mouseout"&&(E=g.toElement)),this.relatedTarget=E,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&ze.Z.h.call(this)},ze.prototype.h=function(){ze.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var ee="closure_listenable_"+(Math.random()*1e6|0),Tt=0;function Ne(g,E,A,R,j){this.listener=g,this.proxy=null,this.src=E,this.type=A,this.capture=!!R,this.ha=j,this.key=++Tt,this.da=this.fa=!1}function ge(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function Ie(g,E,A){for(const R in g)E.call(A,g[R],R,g)}function Se(g,E){for(const A in g)E.call(void 0,g[A],A,g)}function ht(g){const E={};for(const A in g)E[A]=g[A];return E}const Be="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function On(g,E){let A,R;for(let j=1;j<arguments.length;j++){R=arguments[j];for(A in R)g[A]=R[A];for(let Q=0;Q<Be.length;Q++)A=Be[Q],Object.prototype.hasOwnProperty.call(R,A)&&(g[A]=R[A])}}function ut(g){this.src=g,this.g={},this.h=0}ut.prototype.add=function(g,E,A,R,j){const Q=g.toString();g=this.g[Q],g||(g=this.g[Q]=[],this.h++);const fe=Ee(g,E,R,j);return fe>-1?(E=g[fe],A||(E.fa=!1)):(E=new Ne(E,this.src,Q,!!R,j),E.fa=A,g.push(E)),E};function Nr(g,E){const A=E.type;if(A in g.g){var R=g.g[A],j=Array.prototype.indexOf.call(R,E,void 0),Q;(Q=j>=0)&&Array.prototype.splice.call(R,j,1),Q&&(ge(E),g.g[A].length==0&&(delete g.g[A],g.h--))}}function Ee(g,E,A,R){for(let j=0;j<g.length;++j){const Q=g[j];if(!Q.da&&Q.listener==E&&Q.capture==!!A&&Q.ha==R)return j}return-1}var cr="closure_lm_"+(Math.random()*1e6|0),kt={};function Mi(g,E,A,R,j){if(R&&R.once)return Rs(g,E,A,R,j);if(Array.isArray(E)){for(let Q=0;Q<E.length;Q++)Mi(g,E[Q],A,R,j);return null}return A=Fe(A),g&&g[ee]?g.J(E,A,y(R)?!!R.capture:!!R,j):ki(g,E,A,!1,R,j)}function ki(g,E,A,R,j,Q){if(!E)throw Error("Invalid event type");const fe=y(j)?!!j.capture:!!j;let Me=Vt(g);if(Me||(g[cr]=Me=new ut(g)),A=Me.add(E,A,R,fe,Q),A.proxy)return A;if(R=An(),A.proxy=R,R.src=g,R.listener=A,g.addEventListener)G||(j=fe),j===void 0&&(j=!1),g.addEventListener(E.toString(),R,j);else if(g.attachEvent)g.attachEvent(Jn(E.toString()),R);else if(g.addListener&&g.removeListener)g.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return A}function An(){function g(A){return E.call(g.src,g.listener,A)}const E=Ns;return g}function Rs(g,E,A,R,j){if(Array.isArray(E)){for(let Q=0;Q<E.length;Q++)Rs(g,E[Q],A,R,j);return null}return A=Fe(A),g&&g[ee]?g.K(E,A,y(R)?!!R.capture:!!R,j):ki(g,E,A,!0,R,j)}function je(g,E,A,R,j){if(Array.isArray(E))for(var Q=0;Q<E.length;Q++)je(g,E[Q],A,R,j);else R=y(R)?!!R.capture:!!R,A=Fe(A),g&&g[ee]?(g=g.i,Q=String(E).toString(),Q in g.g&&(E=g.g[Q],A=Ee(E,A,R,j),A>-1&&(ge(E[A]),Array.prototype.splice.call(E,A,1),E.length==0&&(delete g.g[Q],g.h--)))):g&&(g=Vt(g))&&(E=g.g[E.toString()],g=-1,E&&(g=Ee(E,A,R,j)),(A=g>-1?E[g]:null)&&Wr(A))}function Wr(g){if(typeof g!="number"&&g&&!g.da){var E=g.src;if(E&&E[ee])Nr(E.i,g);else{var A=g.type,R=g.proxy;E.removeEventListener?E.removeEventListener(A,R,g.capture):E.detachEvent?E.detachEvent(Jn(A),R):E.addListener&&E.removeListener&&E.removeListener(R),(A=Vt(E))?(Nr(A,g),A.h==0&&(A.src=null,E[cr]=null)):ge(g)}}}function Jn(g){return g in kt?kt[g]:kt[g]="on"+g}function Ns(g,E){if(g.da)g=!0;else{E=new ze(E,this);const A=g.listener,R=g.ha||g.src;g.fa&&Wr(g),g=A.call(R,E)}return g}function Vt(g){return g=g[cr],g instanceof ut?g:null}var nt="__closure_events_fn_"+(Math.random()*1e9>>>0);function Fe(g){return typeof g=="function"?g:(g[nt]||(g[nt]=function(E){return g.handleEvent(E)}),g[nt])}function Ut(){F.call(this),this.i=new ut(this),this.M=this,this.G=null}v(Ut,F),Ut.prototype[ee]=!0,Ut.prototype.removeEventListener=function(g,E,A,R){je(this,g,E,A,R)};function de(g,E){var A,R=g.G;if(R)for(A=[];R;R=R.G)A.push(R);if(g=g.M,R=E.type||E,typeof E=="string")E=new U(E,g);else if(E instanceof U)E.target=E.target||g;else{var j=E;E=new U(R,g),On(E,j)}j=!0;let Q,fe;if(A)for(fe=A.length-1;fe>=0;fe--)Q=E.g=A[fe],j=fi(Q,R,!0,E)&&j;if(Q=E.g=g,j=fi(Q,R,!0,E)&&j,j=fi(Q,R,!1,E)&&j,A)for(fe=0;fe<A.length;fe++)Q=E.g=A[fe],j=fi(Q,R,!1,E)&&j}Ut.prototype.N=function(){if(Ut.Z.N.call(this),this.i){var g=this.i;for(const E in g.g){const A=g.g[E];for(let R=0;R<A.length;R++)ge(A[R]);delete g.g[E],g.h--}}this.G=null},Ut.prototype.J=function(g,E,A,R){return this.i.add(String(g),E,!1,A,R)},Ut.prototype.K=function(g,E,A,R){return this.i.add(String(g),E,!0,A,R)};function fi(g,E,A,R){if(E=g.i.g[String(E)],!E)return!0;E=E.concat();let j=!0;for(let Q=0;Q<E.length;++Q){const fe=E[Q];if(fe&&!fe.da&&fe.capture==A){const Me=fe.listener,bt=fe.ha||fe.src;fe.fa&&Nr(g.i,fe),j=Me.call(bt,R)!==!1&&j}}return j&&!R.defaultPrevented}function Ul(g,E){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=m(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(E)>2147483647?-1:f.setTimeout(g,E||0)}function hr(g){g.g=Ul(()=>{g.g=null,g.i&&(g.i=!1,hr(g))},g.l);const E=g.h;g.h=null,g.m.apply(null,E)}class fa extends F{constructor(E,A){super(),this.m=E,this.l=A,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:hr(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function hn(g){F.call(this),this.h=g,this.g={}}v(hn,F);var da=[];function br(g){Ie(g.g,function(E,A){this.g.hasOwnProperty(A)&&Wr(E)},g),g.g={}}hn.prototype.N=function(){hn.Z.N.call(this),br(this)},hn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Zt=f.JSON.stringify,zl=f.JSON.parse,so=class{stringify(g){return f.JSON.stringify(g,void 0)}parse(g){return f.JSON.parse(g,void 0)}};function Hl(){}function St(){}var he={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Rt(){U.call(this,"d")}v(Rt,U);function et(){U.call(this,"c")}v(et,U);var rt={},Li=null;function Bi(){return Li=Li||new Ut}rt.Ia="serverreachability";function ga(g){U.call(this,rt.Ia,g)}v(ga,U);function Ve(g){const E=Bi();de(E,new ga(E))}rt.STAT_EVENT="statevent";function jr(g,E){U.call(this,rt.STAT_EVENT,g),this.stat=E}v(jr,U);function tn(g){const E=Bi();de(E,new jr(E,g))}rt.Ja="timingevent";function pa(g,E){U.call(this,rt.Ja,g),this.size=E}v(pa,U);function fn(g,E){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){g()},E)}function di(){this.g=!0}di.prototype.ua=function(){this.g=!1};function nn(g,E,A,R,j,Q){g.info(function(){if(g.g)if(Q){var fe="",Me=Q.split("&");for(let at=0;at<Me.length;at++){var bt=Me[at].split("=");if(bt.length>1){const zt=bt[0];bt=bt[1];const wr=zt.split("_");fe=wr.length>=2&&wr[1]=="type"?fe+(zt+"="+bt+"&"):fe+(zt+"=redacted&")}}}else fe=null;else fe=Q;return"XMLHTTP REQ ("+R+") [attempt "+j+"]: "+E+`
`+A+`
`+fe})}function Fi(g,E,A,R,j,Q,fe){g.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+j+"]: "+E+`
`+A+`
`+Q+" "+fe})}function Dr(g,E,A,R){g.info(function(){return"XMLHTTP TEXT ("+E+"): "+ch(g,A)+(R?" "+R:"")})}function fr(g,E){g.info(function(){return"TIMEOUT: "+E})}di.prototype.info=function(){};function ch(g,E){if(!g.g)return E;if(!E)return null;try{const Q=JSON.parse(E);if(Q){for(g=0;g<Q.length;g++)if(Array.isArray(Q[g])){var A=Q[g];if(!(A.length<2)){var R=A[1];if(Array.isArray(R)&&!(R.length<1)){var j=R[0];if(j!="noop"&&j!="stop"&&j!="close")for(let fe=1;fe<R.length;fe++)R[fe]=""}}}}return Zt(Q)}catch{return E}}var dr={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},oo={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},dn;function Or(){}v(Or,Hl),Or.prototype.g=function(){return new XMLHttpRequest},dn=new Or;function rn(g){return encodeURIComponent(String(g))}function me(g){var E=1;g=g.split(":");const A=[];for(;E>0&&g.length;)A.push(g.shift()),E--;return g.length&&A.push(g.join(":")),A}function Pn(g,E,A,R){this.j=g,this.i=E,this.l=A,this.S=R||1,this.V=new hn(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ao}function ao(){this.i=null,this.g="",this.h=!1}var gn={},Xr={};function Vi(g,E,A){g.M=1,g.A=uo(it(E)),g.u=A,g.R=!0,bs(g,null)}function bs(g,E){g.F=Date.now(),Mn(g),g.B=it(g.A);var A=g.B,R=g.S;Array.isArray(R)||(R=[String(R)]),wa(A.i,"t",R),g.C=0,A=g.j.L,g.h=new ao,g.g=Lt(g.j,A?E:null,!g.u),g.P>0&&(g.O=new fa(m(g.Y,g,g.g),g.P)),E=g.V,A=g.g,R=g.ba;var j="readystatechange";Array.isArray(j)||(j&&(da[0]=j.toString()),j=da);for(let Q=0;Q<j.length;Q++){const fe=Mi(A,j[Q],R||E.handleEvent,!1,E.h||E);if(!fe)break;E.g[fe.key]=fe}E=g.J?ht(g.J):{},g.u?(g.v||(g.v="POST"),E["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,E)):(g.v="GET",g.g.ea(g.B,g.v,null,E)),Ve(),nn(g.i,g.v,g.B,g.l,g.S,g.u)}Pn.prototype.ba=function(g){g=g.target;const E=this.O;E&&Hn(g)==3?E.j():this.Y(g)},Pn.prototype.Y=function(g){try{if(g==this.g)e:{const Me=Hn(this.g),bt=this.g.ya(),at=this.g.ca();if(!(Me<3)&&(Me!=3||this.g&&(this.h.h||this.g.la()||Wi(this.g)))){this.K||Me!=4||bt==7||(bt==8||at<=0?Ve(3):Ve(2)),ct(this);var E=this.g.ca();this.X=E;var A=gr(this);if(this.o=E==200,Fi(this.i,this.v,this.B,this.l,this.S,Me,E),this.o){if(this.U&&!this.L){t:{if(this.g){var R,j=this.g;if((R=j.g?j.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!L(R)){var Q=R;break t}}Q=null}if(g=Q)Dr(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ds(this,g);else{this.o=!1,this.m=3,tn(12),Cn(this),Ui(this);break e}}if(this.R){g=!0;let zt;for(;!this.K&&this.C<A.length;)if(zt=hh(this,A),zt==Xr){Me==4&&(this.m=4,tn(14),g=!1),Dr(this.i,this.l,null,"[Incomplete Response]");break}else if(zt==gn){this.m=4,tn(15),Dr(this.i,this.l,A,"[Invalid Chunk]"),g=!1;break}else Dr(this.i,this.l,zt,null),Ds(this,zt);if(Gl(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Me!=4||A.length!=0||this.h.h||(this.m=1,tn(16),g=!1),this.o=this.o&&g,!g)Dr(this.i,this.l,A,"[Invalid Chunked Response]"),Cn(this),Ui(this);else if(A.length>0&&!this.W){this.W=!0;var fe=this.j;fe.g==this&&fe.aa&&!fe.P&&(fe.j.info("Great, no buffering proxy detected. Bytes received: "+A.length),Pe(fe),fe.P=!0,tn(11))}}else Dr(this.i,this.l,A,null),Ds(this,A);Me==4&&Cn(this),this.o&&!this.K&&(Me==4?Aa(this.j,this):(this.o=!1,Mn(this)))}else In(this.g),E==400&&A.indexOf("Unknown SID")>0?(this.m=3,tn(12)):(this.m=0,tn(13)),Cn(this),Ui(this)}}}catch{}finally{}};function gr(g){if(!Gl(g))return g.g.la();const E=Wi(g.g);if(E==="")return"";let A="";const R=E.length,j=Hn(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return Cn(g),Ui(g),"";g.h.i=new f.TextDecoder}for(let Q=0;Q<R;Q++)g.h.h=!0,A+=g.h.i.decode(E[Q],{stream:!(j&&Q==R-1)});return E.length=0,g.h.g+=A,g.C=0,g.h.g}function Gl(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function hh(g,E){var A=g.C,R=E.indexOf(`
`,A);return R==-1?Xr:(A=Number(E.substring(A,R)),isNaN(A)?gn:(R+=1,R+A>E.length?Xr:(E=E.slice(R,R+A),g.C=R+A,E)))}Pn.prototype.cancel=function(){this.K=!0,Cn(this)};function Mn(g){g.T=Date.now()+g.H,sn(g,g.H)}function sn(g,E){if(g.D!=null)throw Error("WatchDog timer not null");g.D=fn(m(g.aa,g),E)}function ct(g){g.D&&(f.clearTimeout(g.D),g.D=null)}Pn.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(fr(this.i,this.B),this.M!=2&&(Ve(),tn(17)),Cn(this),this.m=2,Ui(this)):sn(this,this.T-g)};function Ui(g){g.j.I==0||g.K||Aa(g.j,g)}function Cn(g){ct(g);var E=g.O;E&&typeof E.dispose=="function"&&E.dispose(),g.O=null,br(g.V),g.g&&(E=g.g,g.g=null,E.abort(),E.dispose())}function Ds(g,E){try{var A=g.j;if(A.I!=0&&(A.g==g||ma(A.h,g))){if(!g.L&&ma(A.h,g)&&A.I==3){try{var R=A.Ba.g.parse(E)}catch{R=null}if(Array.isArray(R)&&R.length==3){var j=R;if(j[0]==0){e:if(!A.v){if(A.g)if(A.g.F+3e3<g.F)mi(A),fo(A);else break e;Z(A),tn(18)}}else A.xa=j[1],0<A.xa-A.K&&j[2]<37500&&A.F&&A.A==0&&!A.C&&(A.C=fn(m(A.Va,A),6e3));gi(A.h)<=1&&A.ta&&(A.ta=void 0)}else yi(A,11)}else if((g.L||A.g==g)&&mi(A),!L(E))for(j=A.Ba.g.parse(E),E=0;E<j.length;E++){let at=j[E];const zt=at[0];if(!(zt<=A.K))if(A.K=zt,at=at[1],A.I==2)if(at[0]=="c"){A.M=at[1],A.ba=at[2];const wr=at[3];wr!=null&&(A.ka=wr,A.j.info("VER="+A.ka));const Gn=at[4];Gn!=null&&(A.za=Gn,A.j.info("SVER="+A.za));const xr=at[5];xr!=null&&typeof xr=="number"&&xr>0&&(R=1.5*xr,A.O=R,A.j.info("backChannelRequestTimeoutMs_="+R)),R=A;const Qr=g.g;if(Qr){const Zr=Qr.g?Qr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Zr){var Q=R.h;Q.g||Zr.indexOf("spdy")==-1&&Zr.indexOf("quic")==-1&&Zr.indexOf("h2")==-1||(Q.j=Q.l,Q.g=new Set,Q.h&&(Xe(Q,Q.h),Q.h=null))}if(R.G){const Ca=Qr.g?Qr.g.getResponseHeader("X-HTTP-Session-Id"):null;Ca&&(R.wa=Ca,Ke(R.J,R.G,Ca))}}A.I=3,A.l&&A.l.ra(),A.aa&&(A.T=Date.now()-g.F,A.j.info("Handshake RTT: "+A.T+"ms")),R=A;var fe=g;if(R.na=po(R,R.L?R.ba:null,R.W),fe.L){qe(R.h,fe);var Me=fe,bt=R.O;bt&&(Me.H=bt),Me.D&&(ct(Me),Mn(Me)),R.g=fe}else Yl(R);A.i.length>0&&go(A)}else at[0]!="stop"&&at[0]!="close"||yi(A,7);else A.I==3&&(at[0]=="stop"||at[0]=="close"?at[0]=="stop"?yi(A,7):ho(A):at[0]!="noop"&&A.l&&A.l.qa(at),A.A=0)}}Ve(4)}catch{}}var ie=class{constructor(g,E){this.g=g,this.map=E}};function Wl(g){this.l=g||10,f.PerformanceNavigationTiming?(g=f.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function wt(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function gi(g){return g.h?1:g.g?g.g.size:0}function ma(g,E){return g.h?g.h==E:g.g?g.g.has(E):!1}function Xe(g,E){g.g?g.g.add(E):g.h=E}function qe(g,E){g.h&&g.h==E?g.h=null:g.g&&g.g.has(E)&&g.g.delete(E)}Wl.prototype.cancel=function(){if(this.i=Le(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function Le(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let E=g.i;for(const A of g.g.values())E=E.concat(A.G);return E}return V(g.i)}var lo=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ya(g,E){if(g){g=g.split("&");for(let A=0;A<g.length;A++){const R=g[A].indexOf("=");let j,Q=null;R>=0?(j=g[A].substring(0,R),Q=g[A].substring(R+1)):j=g[A],E(j,Q?decodeURIComponent(Q.replace(/\+/g," ")):"")}}}function pr(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let E;g instanceof pr?(this.l=g.l,Un(this,g.j),this.o=g.o,this.g=g.g,Os(this,g.u),this.h=g.h,xt(this,jl(g.i)),this.m=g.m):g&&(E=String(g).match(lo))?(this.l=!1,Un(this,E[1]||"",!0),this.o=mr(E[2]||""),this.g=mr(E[3]||"",!0),Os(this,E[4]),this.h=mr(E[5]||"",!0),xt(this,E[6]||"",!0),this.m=mr(E[7]||"")):(this.l=!1,this.i=new Ps(null,this.l))}pr.prototype.toString=function(){const g=[];var E=this.j;E&&g.push(Je(E,K,!0),":");var A=this.g;return(A||E=="file")&&(g.push("//"),(E=this.o)&&g.push(Je(E,K,!0),"@"),g.push(rn(A).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.u,A!=null&&g.push(":",String(A))),(A=this.h)&&(this.g&&A.charAt(0)!="/"&&g.push("/"),g.push(Je(A,A.charAt(0)=="/"?_e:P,!0))),(A=this.i.toString())&&g.push("?",A),(A=this.m)&&g.push("#",Je(A,zn)),g.join("")},pr.prototype.resolve=function(g){const E=it(this);let A=!!g.j;A?Un(E,g.j):A=!!g.o,A?E.o=g.o:A=!!g.g,A?E.g=g.g:A=g.u!=null;var R=g.h;if(A)Os(E,g.u);else if(A=!!g.h){if(R.charAt(0)!="/")if(this.g&&!this.h)R="/"+R;else{var j=E.h.lastIndexOf("/");j!=-1&&(R=E.h.slice(0,j+1)+R)}if(j=R,j==".."||j==".")R="";else if(j.indexOf("./")!=-1||j.indexOf("/.")!=-1){R=j.lastIndexOf("/",0)==0,j=j.split("/");const Q=[];for(let fe=0;fe<j.length;){const Me=j[fe++];Me=="."?R&&fe==j.length&&Q.push(""):Me==".."?((Q.length>1||Q.length==1&&Q[0]!="")&&Q.pop(),R&&fe==j.length&&Q.push("")):(Q.push(Me),R=!0)}R=Q.join("/")}else R=j}return A?E.h=R:A=g.i.toString()!=="",A?xt(E,jl(g.i)):A=!!g.m,A&&(E.m=g.m),E};function it(g){return new pr(g)}function Un(g,E,A){g.j=A?mr(E,!0):E,g.j&&(g.j=g.j.replace(/:$/,""))}function Os(g,E){if(E){if(E=Number(E),isNaN(E)||E<0)throw Error("Bad port number "+E);g.u=E}else g.u=null}function xt(g,E,A){E instanceof Ps?(g.i=E,co(g.i,g.l)):(A||(E=Je(E,jt)),g.i=new Ps(E,g.l))}function Ke(g,E,A){g.i.set(E,A)}function uo(g){return Ke(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function mr(g,E){return g?E?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function Je(g,E,A){return typeof g=="string"?(g=encodeURI(g).replace(E,on),A&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function on(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var K=/[#\/\?@]/g,P=/[#\?:]/g,_e=/[#\?]/g,jt=/[#\?@]/g,zn=/#/g;function Ps(g,E){this.h=this.g=null,this.i=g||null,this.j=!!E}function Pr(g){g.g||(g.g=new Map,g.h=0,g.i&&ya(g.i,function(E,A){g.add(decodeURIComponent(E.replace(/\+/g," ")),A)}))}t=Ps.prototype,t.add=function(g,E){Pr(this),this.i=null,g=qr(this,g);let A=this.g.get(g);return A||this.g.set(g,A=[]),A.push(E),this.h+=1,this};function kn(g,E){Pr(g),E=qr(g,E),g.g.has(E)&&(g.i=null,g.h-=g.g.get(E).length,g.g.delete(E))}function Ce(g,E){return Pr(g),E=qr(g,E),g.g.has(E)}t.forEach=function(g,E){Pr(this),this.g.forEach(function(A,R){A.forEach(function(j){g.call(E,j,R,this)},this)},this)};function mt(g,E){Pr(g);let A=[];if(typeof E=="string")Ce(g,E)&&(A=A.concat(g.g.get(qr(g,E))));else for(g=Array.from(g.g.values()),E=0;E<g.length;E++)A=A.concat(g[E]);return A}t.set=function(g,E){return Pr(this),this.i=null,g=qr(this,g),Ce(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[E]),this.h+=1,this},t.get=function(g,E){return g?(g=mt(this,g),g.length>0?String(g[0]):E):E};function wa(g,E,A){kn(g,E),A.length>0&&(g.i=null,g.g.set(qr(g,E),V(A)),g.h+=A.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],E=Array.from(this.g.keys());for(let R=0;R<E.length;R++){var A=E[R];const j=rn(A);A=mt(this,A);for(let Q=0;Q<A.length;Q++){let fe=j;A[Q]!==""&&(fe+="="+rn(A[Q])),g.push(fe)}}return this.i=g.join("&")};function jl(g){const E=new Ps;return E.i=g.i,g.g&&(E.g=new Map(g.g),E.h=g.h),E}function qr(g,E){return E=String(E),g.j&&(E=E.toLowerCase()),E}function co(g,E){E&&!g.j&&(Pr(g),g.i=null,g.g.forEach(function(A,R){const j=R.toLowerCase();R!=j&&(kn(this,R),wa(this,j,A))},g)),g.j=E}function xa(g,E){const A=new di;if(f.Image){const R=new Image;R.onload=C(ft,A,"TestLoadImage: loaded",!0,E,R),R.onerror=C(ft,A,"TestLoadImage: error",!1,E,R),R.onabort=C(ft,A,"TestLoadImage: abort",!1,E,R),R.ontimeout=C(ft,A,"TestLoadImage: timeout",!1,E,R),f.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=g}else E(!1)}function fh(g,E){const A=new di,R=new AbortController,j=setTimeout(()=>{R.abort(),ft(A,"TestPingServer: timeout",!1,E)},1e4);fetch(g,{signal:R.signal}).then(Q=>{clearTimeout(j),Q.ok?ft(A,"TestPingServer: ok",!0,E):ft(A,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(j),ft(A,"TestPingServer: error",!1,E)})}function ft(g,E,A,R,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),R(A)}catch{}}function Ms(){this.g=new so}function yr(g){this.i=g.Sb||null,this.h=g.ab||!1}v(yr,Hl),yr.prototype.g=function(){return new ve(this.i,this.h)};function ve(g,E){Ut.call(this),this.H=g,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(ve,Ut),t=ve.prototype,t.open=function(g,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=E,this.readyState=1,Nt(this)},t.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const E={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(E.body=g),(this.H||f).fetch(new Request(this.D,E)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,be(this)),this.readyState=0},t.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,Nt(this)),this.g&&(this.readyState=3,Nt(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Xl(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function Xl(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}t.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var E=g.value?g.value:new Uint8Array(0);(E=this.B.decode(E,{stream:!g.done}))&&(this.response=this.responseText+=E)}g.done?be(this):Nt(this),this.readyState==3&&Xl(this)}},t.Oa=function(g){this.g&&(this.response=this.responseText=g,be(this))},t.Na=function(g){this.g&&(this.response=g,be(this))},t.ga=function(){this.g&&be(this)};function be(g){g.readyState=4,g.l=null,g.j=null,g.B=null,Nt(g)}t.setRequestHeader=function(g,E){this.A.append(g,E)},t.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],E=this.h.entries();for(var A=E.next();!A.done;)A=A.value,g.push(A[0]+": "+A[1]),A=E.next();return g.join(`\r
`)};function Nt(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(ve.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function ql(g){let E="";return Ie(g,function(A,R){E+=R,E+=":",E+=A,E+=`\r
`}),E}function ks(g,E,A){e:{for(R in A){var R=!1;break e}R=!0}R||(A=ql(A),typeof g=="string"?A!=null&&rn(A):Ke(g,E,A))}function Et(g){Ut.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(Et,Ut);var pi=/^https?$/i,dh=["POST","PUT"];t=Et.prototype,t.Fa=function(g){this.H=g},t.ea=function(g,E,A,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);E=E?E.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():dn.g(),this.g.onreadystatechange=D(m(this.Ca,this));try{this.B=!0,this.g.open(E,String(g),!0),this.B=!1}catch(Q){zi(this,Q);return}if(g=A||"",A=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var j in R)A.set(j,R[j]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const Q of R.keys())A.set(Q,R.get(Q));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(A.keys()).find(Q=>Q.toLowerCase()=="content-type"),j=f.FormData&&g instanceof f.FormData,!(Array.prototype.indexOf.call(dh,E,void 0)>=0)||R||j||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Q,fe]of A)this.g.setRequestHeader(Q,fe);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(Q){zi(this,Q)}};function zi(g,E){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=E,g.o=5,Hi(g),Ls(g)}function Hi(g){g.A||(g.A=!0,de(g,"complete"),de(g,"error"))}t.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,de(this,"complete"),de(this,"abort"),Ls(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ls(this,!0)),Et.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Gi(this):this.Xa())},t.Xa=function(){Gi(this)};function Gi(g){if(g.h&&typeof l<"u"){if(g.v&&Hn(g)==4)setTimeout(g.Ca.bind(g),0);else if(de(g,"readystatechange"),Hn(g)==4){g.h=!1;try{const Q=g.ca();e:switch(Q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var A;if(!(A=E)){var R;if(R=Q===0){let fe=String(g.D).match(lo)[1]||null;!fe&&f.self&&f.self.location&&(fe=f.self.location.protocol.slice(0,-1)),R=!pi.test(fe?fe.toLowerCase():"")}A=R}if(A)de(g,"complete"),de(g,"success");else{g.o=6;try{var j=Hn(g)>2?g.g.statusText:""}catch{j=""}g.l=j+" ["+g.ca()+"]",Hi(g)}}finally{Ls(g)}}}}function Ls(g,E){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const A=g.g;g.g=null,E||de(g,"ready");try{A.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Hn(g){return g.g?g.g.readyState:0}t.ca=function(){try{return Hn(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(g){if(this.g){var E=this.g.responseText;return g&&E.indexOf(g)==0&&(E=E.substring(g.length)),zl(E)}};function Wi(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function In(g){const E={};g=(g.g&&Hn(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<g.length;R++){if(L(g[R]))continue;var A=me(g[R]);const j=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const Q=E[j]||[];E[j]=Q,Q.push(A)}Se(E,function(R){return R.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ji(g,E,A){return A&&A.internalChannelParams&&A.internalChannelParams[g]||E}function Ea(g){this.za=0,this.i=[],this.j=new di,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ji("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ji("baseRetryDelayMs",5e3,g),this.Za=ji("retryDelaySeedMs",1e4,g),this.Ta=ji("forwardChannelMaxRetries",2,g),this.va=ji("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new Wl(g&&g.concurrentRequestLimit),this.Ba=new Ms,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Ea.prototype,t.ka=8,t.I=1,t.connect=function(g,E,A,R){tn(0),this.W=g,this.H=E||{},A&&R!==void 0&&(this.H.OSID=A,this.H.OAID=R),this.F=this.X,this.J=po(this,null,this.W),go(this)};function ho(g){if(Kl(g),g.I==3){var E=g.V++,A=it(g.J);if(Ke(A,"SID",g.M),Ke(A,"RID",E),Ke(A,"TYPE","terminate"),Kr(g,A),E=new Pn(g,g.j,E),E.M=2,E.A=uo(it(A)),A=!1,f.navigator&&f.navigator.sendBeacon)try{A=f.navigator.sendBeacon(E.A.toString(),"")}catch{}!A&&f.Image&&(new Image().src=E.A,A=!0),A||(E.g=Lt(E.j,null),E.g.ea(E.A)),E.F=Date.now(),Mn(E)}Zl(g)}function fo(g){g.g&&(Pe(g),g.g.cancel(),g.g=null)}function Kl(g){fo(g),g.v&&(f.clearTimeout(g.v),g.v=null),mi(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&f.clearTimeout(g.m),g.m=null)}function go(g){if(!wt(g.h)&&!g.m){g.m=!0;var E=g.Ea;ce||O(),se||(ce(),se=!0),N.add(E,g),g.D=0}}function st(g,E){return gi(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=E.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=fn(m(g.Ea,g,E),Ql(g,g.D)),g.D++,!0)}t.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const j=new Pn(this,this.j,g);let Q=this.o;if(this.U&&(Q?(Q=ht(Q),On(Q,this.U)):Q=this.U),this.u!==null||this.R||(j.J=Q,Q=null),this.S)e:{for(var E=0,A=0;A<this.i.length;A++){t:{var R=this.i[A];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(E+=R,E>4096){E=A;break e}if(E===4096||A===this.i.length-1){E=A+1;break e}}E=1e3}else E=1e3;E=Mr(this,j,E),A=it(this.J),Ke(A,"RID",g),Ke(A,"CVER",22),this.G&&Ke(A,"X-HTTP-Session-Id",this.G),Kr(this,A),Q&&(this.R?E="headers="+rn(ql(Q))+"&"+E:this.u&&ks(A,this.u,Q)),Xe(this.h,j),this.Ra&&Ke(A,"TYPE","init"),this.S?(Ke(A,"$req",E),Ke(A,"SID","null"),j.U=!0,Vi(j,A,null)):Vi(j,A,E),this.I=2}}else this.I==3&&(g?_a(this,g):this.i.length==0||wt(this.h)||_a(this))};function _a(g,E){var A;E?A=E.l:A=g.V++;const R=it(g.J);Ke(R,"SID",g.M),Ke(R,"RID",A),Ke(R,"AID",g.K),Kr(g,R),g.u&&g.o&&ks(R,g.u,g.o),A=new Pn(g,g.j,A,g.D+1),g.u===null&&(A.J=g.o),E&&(g.i=E.G.concat(g.i)),E=Mr(g,A,1e3),A.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),Xe(g.h,A),Vi(A,R,E)}function Kr(g,E){g.H&&Ie(g.H,function(A,R){Ke(E,R,A)}),g.l&&Ie({},function(A,R){Ke(E,R,A)})}function Mr(g,E,A){A=Math.min(g.i.length,A);const R=g.l?m(g.l.Ka,g.l,g):null;e:{var j=g.i;let Me=-1;for(;;){const bt=["count="+A];Me==-1?A>0?(Me=j[0].g,bt.push("ofs="+Me)):Me=0:bt.push("ofs="+Me);let at=!0;for(let zt=0;zt<A;zt++){var Q=j[zt].g;const wr=j[zt].map;if(Q-=Me,Q<0)Me=Math.max(0,j[zt].g-100),at=!1;else try{Q="req"+Q+"_"||"";try{var fe=wr instanceof Map?wr:Object.entries(wr);for(const[Gn,xr]of fe){let Qr=xr;y(xr)&&(Qr=Zt(xr)),bt.push(Q+Gn+"="+encodeURIComponent(Qr))}}catch(Gn){throw bt.push(Q+"type="+encodeURIComponent("_badmap")),Gn}}catch{R&&R(wr)}}if(at){fe=bt.join("&");break e}}fe=void 0}return g=g.i.splice(0,A),E.G=g,fe}function Yl(g){if(!g.g&&!g.v){g.Y=1;var E=g.Da;ce||O(),se||(ce(),se=!0),N.add(E,g),g.A=0}}function Z(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=fn(m(g.Da,g),Ql(g,g.A)),g.A++,!0)}t.Da=function(){if(this.v=null,Xt(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=fn(m(this.Wa,this),g)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,tn(10),fo(this),Xt(this))};function Pe(g){g.B!=null&&(f.clearTimeout(g.B),g.B=null)}function Xt(g){g.g=new Pn(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var E=it(g.na);Ke(E,"RID","rpc"),Ke(E,"SID",g.M),Ke(E,"AID",g.K),Ke(E,"CI",g.F?"0":"1"),!g.F&&g.ia&&Ke(E,"TO",g.ia),Ke(E,"TYPE","xmlhttp"),Kr(g,E),g.u&&g.o&&ks(E,g.u,g.o),g.O&&(g.g.H=g.O);var A=g.g;g=g.ba,A.M=1,A.A=uo(it(E)),A.u=null,A.R=!0,bs(A,g)}t.Va=function(){this.C!=null&&(this.C=null,fo(this),Z(this),tn(19))};function mi(g){g.C!=null&&(f.clearTimeout(g.C),g.C=null)}function Aa(g,E){var A=null;if(g.g==E){mi(g),Pe(g),g.g=null;var R=2}else if(ma(g.h,E))A=E.G,qe(g.h,E),R=1;else return;if(g.I!=0){if(E.o)if(R==1){A=E.u?E.u.length:0,E=Date.now()-E.F;var j=g.D;R=Bi(),de(R,new pa(R,A)),go(g)}else Yl(g);else if(j=E.m,j==3||j==0&&E.X>0||!(R==1&&st(g,E)||R==2&&Z(g)))switch(A&&A.length>0&&(E=g.h,E.i=E.i.concat(A)),j){case 1:yi(g,5);break;case 4:yi(g,10);break;case 3:yi(g,6);break;default:yi(g,2)}}}function Ql(g,E){let A=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(A*=2),A*E}function yi(g,E){if(g.j.info("Error code "+E),E==2){var A=m(g.bb,g),R=g.Ua;const j=!R;R=new pr(R||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||Un(R,"https"),uo(R),j?xa(R.toString(),A):fh(R.toString(),A)}else tn(2);g.I=0,g.l&&g.l.pa(E),Zl(g),Kl(g)}t.bb=function(g){g?(this.j.info("Successfully pinged google.com"),tn(2)):(this.j.info("Failed to ping google.com"),tn(1))};function Zl(g){if(g.I=0,g.ja=[],g.l){const E=Le(g.h);(E.length!=0||g.i.length!=0)&&(Y(g.ja,E),Y(g.ja,g.i),g.h.i.length=0,V(g.i),g.i.length=0),g.l.oa()}}function po(g,E,A){var R=A instanceof pr?it(A):new pr(A);if(R.g!="")E&&(R.g=E+"."+R.g),Os(R,R.u);else{var j=f.location;R=j.protocol,E=E?E+"."+j.hostname:j.hostname,j=+j.port;const Q=new pr(null);R&&Un(Q,R),E&&(Q.g=E),j&&Os(Q,j),A&&(Q.h=A),R=Q}return A=g.G,E=g.wa,A&&E&&Ke(R,A,E),Ke(R,"VER",g.ka),Kr(g,R),R}function Lt(g,E,A){if(E&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return E=g.Aa&&!g.ma?new Et(new yr({ab:A})):new Et(g.ma),E.Fa(g.L),E}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function mo(){}t=mo.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function dt(){}dt.prototype.g=function(g,E){return new an(g,E)};function an(g,E){Ut.call(this),this.g=new Ea(E),this.l=g,this.h=E&&E.messageUrlParams||null,g=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(g?g["X-WebChannel-Content-Type"]=E.messageContentType:g={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.sa&&(g?g["X-WebChannel-Client-Profile"]=E.sa:g={"X-WebChannel-Client-Profile":E.sa}),this.g.U=g,(g=E&&E.Qb)&&!L(g)&&(this.g.u=g),this.A=E&&E.supportsCrossDomainXhr||!1,this.v=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!L(E)&&(this.g.G=E,g=this.h,g!==null&&E in g&&(g=this.h,E in g&&delete g[E])),this.j=new Ae(this)}v(an,Ut),an.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},an.prototype.close=function(){ho(this.g)},an.prototype.o=function(g){var E=this.g;if(typeof g=="string"){var A={};A.__data__=g,g=A}else this.v&&(A={},A.__data__=Zt(g),g=A);E.i.push(new ie(E.Ya++,g)),E.I==3&&go(E)},an.prototype.N=function(){this.g.l=null,delete this.j,ho(this.g),delete this.g,an.Z.N.call(this)};function Yr(g){Rt.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var E=g.__sm__;if(E){e:{for(const A in E){g=A;break e}g=void 0}(this.i=g)&&(g=this.i,E=E!==null&&g in E?E[g]:void 0),this.data=E}else this.data=g}v(Yr,Rt);function ot(){et.call(this),this.status=1}v(ot,et);function Ae(g){this.g=g}v(Ae,mo),Ae.prototype.ra=function(){de(this.g,"a")},Ae.prototype.qa=function(g){de(this.g,new Yr(g))},Ae.prototype.pa=function(g){de(this.g,new ot)},Ae.prototype.oa=function(){de(this.g,"b")},dt.prototype.createWebChannel=dt.prototype.g,an.prototype.send=an.prototype.o,an.prototype.open=an.prototype.m,an.prototype.close=an.prototype.close,J2=function(){return new dt},$2=function(){return Bi()},Z2=rt,Qf={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},dr.NO_ERROR=0,dr.TIMEOUT=8,dr.HTTP_ERROR=6,Mu=dr,oo.COMPLETE="complete",Q2=oo,St.EventType=he,he.OPEN="a",he.CLOSE="b",he.ERROR="c",he.MESSAGE="d",Ut.prototype.listen=Ut.prototype.J,Fa=St,Et.prototype.listenOnce=Et.prototype.K,Et.prototype.getLastError=Et.prototype.Ha,Et.prototype.getLastErrorCode=Et.prototype.ya,Et.prototype.getStatus=Et.prototype.ca,Et.prototype.getResponseJson=Et.prototype.La,Et.prototype.getResponseText=Et.prototype.la,Et.prototype.send=Et.prototype.ea,Et.prototype.setWithCredentials=Et.prototype.Fa,Y2=Et}).apply(typeof yu<"u"?yu:typeof self<"u"?self:typeof window<"u"?window:{});const xg="@firebase/firestore",Eg="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Rn.UNAUTHENTICATED=new Rn(null),Rn.GOOGLE_CREDENTIALS=new Rn("google-credentials-uid"),Rn.FIRST_PARTY=new Rn("first-party-uid"),Rn.MOCK_USER=new Rn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let la="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $s=new G2("@firebase/firestore");function Eo(){return $s.logLevel}function ye(t,...e){if($s.logLevel<=Qe.DEBUG){const n=e.map(dd);$s.debug(`Firestore (${la}): ${t}`,...n)}}function bi(t,...e){if($s.logLevel<=Qe.ERROR){const n=e.map(dd);$s.error(`Firestore (${la}): ${t}`,...n)}}function $o(t,...e){if($s.logLevel<=Qe.WARN){const n=e.map(dd);$s.warn(`Firestore (${la}): ${t}`,...n)}}function dd(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Re(t,e,n){let i="Unexpected state";typeof e=="string"?i=e:n=e,ey(t,i,n)}function ey(t,e,n){let i=`FIRESTORE (${la}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{i+=" CONTEXT: "+JSON.stringify(n)}catch{i+=" CONTEXT: "+n}throw bi(i),new Error(i)}function tt(t,e,n,i){let a="Unexpected state";typeof n=="string"?a=n:i=n,t||ey(e,a,i)}function De(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const te={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class pe extends aa{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ty{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class HA{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Rn.UNAUTHENTICATED))}shutdown(){}}class GA{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class WA{constructor(e){this.t=e,this.currentUser=Rn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){tt(this.o===void 0,42304);let i=this.i;const a=x=>this.i!==i?(i=this.i,n(x)):Promise.resolve();let l=new oi;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new oi,e.enqueueRetryable(()=>a(this.currentUser))};const f=()=>{const x=l;e.enqueueRetryable(async()=>{await x.promise,await a(this.currentUser)})},y=x=>{ye("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=x,this.o&&(this.auth.addAuthTokenListener(this.o),f())};this.t.onInit(x=>y(x)),setTimeout(()=>{if(!this.auth){const x=this.t.getImmediate({optional:!0});x?y(x):(ye("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new oi)}},0),f()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(i=>this.i!==e?(ye("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(tt(typeof i.accessToken=="string",31837,{l:i}),new ty(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return tt(e===null||typeof e=="string",2055,{h:e}),new Rn(e)}}class jA{constructor(e,n,i){this.P=e,this.T=n,this.I=i,this.type="FirstParty",this.user=Rn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class XA{constructor(e,n,i){this.P=e,this.T=n,this.I=i}getToken(){return Promise.resolve(new jA(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(Rn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class _g{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class qA{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,IA(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){tt(this.o===void 0,3512);const i=l=>{l.error!=null&&ye("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const f=l.token!==this.m;return this.m=l.token,ye("FirebaseAppCheckTokenProvider",`Received ${f?"new":"existing"} token.`),f?n(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable(()=>i(l))};const a=l=>{ye("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(l=>a(l)),setTimeout(()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):ye("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new _g(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(tt(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new _g(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KA(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gd{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const a=KA(40);for(let l=0;l<a.length;++l)i.length<20&&a[l]<n&&(i+=e.charAt(a[l]%62))}return i}}function Ge(t,e){return t<e?-1:t>e?1:0}function Zf(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const a=t.charAt(i),l=e.charAt(i);if(a!==l)return qh(a)===qh(l)?Ge(a,l):qh(a)?1:-1}return Ge(t.length,e.length)}const YA=55296,QA=57343;function qh(t){const e=t.charCodeAt(0);return e>=YA&&e<=QA}function Jo(t,e,n){return t.length===e.length&&t.every((i,a)=>n(i,e[a]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ag="__name__";class ni{constructor(e,n,i){n===void 0?n=0:n>e.length&&Re(637,{offset:n,range:e.length}),i===void 0?i=e.length-n:i>e.length-n&&Re(1746,{length:i,range:e.length-n}),this.segments=e,this.offset=n,this.len=i}get length(){return this.len}isEqual(e){return ni.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ni?e.forEach(i=>{n.push(i)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,i=this.limit();n<i;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const i=Math.min(e.length,n.length);for(let a=0;a<i;a++){const l=ni.compareSegments(e.get(a),n.get(a));if(l!==0)return l}return Ge(e.length,n.length)}static compareSegments(e,n){const i=ni.isNumericId(e),a=ni.isNumericId(n);return i&&!a?-1:!i&&a?1:i&&a?ni.extractNumericId(e).compare(ni.extractNumericId(n)):Zf(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return fs.fromString(e.substring(4,e.length-2))}}class pt extends ni{construct(e,n,i){return new pt(e,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const i of e){if(i.indexOf("//")>=0)throw new pe(te.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter(a=>a.length>0))}return new pt(n)}static emptyPath(){return new pt([])}}const ZA=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class wn extends ni{construct(e,n,i){return new wn(e,n,i)}static isValidIdentifier(e){return ZA.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),wn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Ag}static keyField(){return new wn([Ag])}static fromServerFormat(e){const n=[];let i="",a=0;const l=()=>{if(i.length===0)throw new pe(te.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let f=!1;for(;a<e.length;){const y=e[a];if(y==="\\"){if(a+1===e.length)throw new pe(te.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const x=e[a+1];if(x!=="\\"&&x!=="."&&x!=="`")throw new pe(te.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=x,a+=2}else y==="`"?(f=!f,a++):y!=="."||f?(i+=y,a++):(l(),a++)}if(l(),f)throw new pe(te.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new wn(n)}static emptyPath(){return new wn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(e){this.path=e}static fromPath(e){return new Te(pt.fromString(e))}static fromName(e){return new Te(pt.fromString(e).popFirst(5))}static empty(){return new Te(pt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return pt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Te(new pt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pd(t,e,n){if(!n)throw new pe(te.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function $A(t,e,n,i){if(e===!0&&i===!0)throw new pe(te.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Cg(t){if(!Te.isDocumentKey(t))throw new pe(te.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Ig(t){if(Te.isDocumentKey(t))throw new pe(te.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ny(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function jc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(i){return i.constructor?i.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Re(12329,{type:typeof t})}function ar(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new pe(te.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=jc(t);throw new pe(te.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function JA(t,e){if(e<=0)throw new pe(te.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qt(t,e){const n={typeString:t};return e&&(n.value=e),n}function Pl(t,e){if(!ny(t))throw new pe(te.INVALID_ARGUMENT,"JSON must be an object");let n;for(const i in e)if(e[i]){const a=e[i].typeString,l="value"in e[i]?{value:e[i].value}:void 0;if(!(i in t)){n=`JSON missing required field: '${i}'`;break}const f=t[i];if(a&&typeof f!==a){n=`JSON field '${i}' must be a ${a}.`;break}if(l!==void 0&&f!==l.value){n=`Expected '${i}' field to equal '${l.value}'`;break}}if(n)throw new pe(te.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tg=-62135596800,vg=1e6;class Ct{static now(){return Ct.fromMillis(Date.now())}static fromDate(e){return Ct.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),i=Math.floor((e-1e3*n)*vg);return new Ct(n,i)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new pe(te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new pe(te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Tg)throw new pe(te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new pe(te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/vg}_compareTo(e){return this.seconds===e.seconds?Ge(this.nanoseconds,e.nanoseconds):Ge(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ct._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Pl(e,Ct._jsonSchema))return new Ct(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Tg;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ct._jsonSchemaVersion="firestore/timestamp/1.0",Ct._jsonSchema={type:Qt("string",Ct._jsonSchemaVersion),seconds:Qt("number"),nanoseconds:Qt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{static fromTimestamp(e){return new Oe(e)}static min(){return new Oe(new Ct(0,0))}static max(){return new Oe(new Ct(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _l=-1;function e3(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,a=Oe.fromTimestamp(i===1e9?new Ct(n+1,0):new Ct(n,i));return new ms(a,Te.empty(),e)}function t3(t){return new ms(t.readTime,t.key,_l)}class ms{constructor(e,n,i){this.readTime=e,this.documentKey=n,this.largestBatchId=i}static min(){return new ms(Oe.min(),Te.empty(),_l)}static max(){return new ms(Oe.max(),Te.empty(),_l)}}function n3(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Te.comparator(t.documentKey,e.documentKey),n!==0?n:Ge(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r3="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class i3{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ua(t){if(t.code!==te.FAILED_PRECONDITION||t.message!==r3)throw t;ye("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Re(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new re((i,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(i,a)},this.catchCallback=l=>{this.wrapFailure(n,l).next(i,a)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof re?n:re.resolve(n)}catch(n){return re.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):re.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):re.reject(n)}static resolve(e){return new re((n,i)=>{n(e)})}static reject(e){return new re((n,i)=>{i(e)})}static waitFor(e){return new re((n,i)=>{let a=0,l=0,f=!1;e.forEach(y=>{++a,y.next(()=>{++l,f&&l===a&&n()},x=>i(x))}),f=!0,l===a&&n()})}static or(e){let n=re.resolve(!1);for(const i of e)n=n.next(a=>a?re.resolve(a):i());return n}static forEach(e,n){const i=[];return e.forEach((a,l)=>{i.push(n.call(this,a,l))}),this.waitFor(i)}static mapArray(e,n){return new re((i,a)=>{const l=e.length,f=new Array(l);let y=0;for(let x=0;x<l;x++){const m=x;n(e[m]).next(C=>{f[m]=C,++y,y===l&&i(f)},C=>a(C))}})}static doWhile(e,n){return new re((i,a)=>{const l=()=>{e()===!0?n().next(()=>{l()},a):i()};l()})}}function s3(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function ca(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>n.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Xc.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const md=-1;function qc(t){return t==null}function gc(t){return t===0&&1/t==-1/0}function o3(t){return typeof t=="number"&&Number.isInteger(t)&&!gc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ry="";function a3(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Sg(e)),e=l3(t.get(n),e);return Sg(e)}function l3(t,e){let n=e;const i=t.length;for(let a=0;a<i;a++){const l=t.charAt(a);switch(l){case"\0":n+="";break;case ry:n+="";break;default:n+=l}}return n}function Sg(t){return t+ry+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rg(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ts(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function u3(t,e){const n=[];for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&n.push(e(t[i],i,t));return n}function iy(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e,n){this.comparator=e,this.root=n||yn.EMPTY}insert(e,n){return new Mt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,yn.BLACK,null,null))}remove(e){return new Mt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,yn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(e){let n=0,i=this.root;for(;!i.isEmpty();){const a=this.comparator(e,i.key);if(a===0)return n+i.left.size;a<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,i)=>(e(n,i),!1))}toString(){const e=[];return this.inorderTraversal((n,i)=>(e.push(`${n}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new wu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new wu(this.root,e,this.comparator,!1)}getReverseIterator(){return new wu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new wu(this.root,e,this.comparator,!0)}}class wu{constructor(e,n,i,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=n?i(e.key,n):1,n&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class yn{constructor(e,n,i,a,l){this.key=e,this.value=n,this.color=i??yn.RED,this.left=a??yn.EMPTY,this.right=l??yn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,i,a,l){return new yn(e??this.key,n??this.value,i??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let a=this;const l=i(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,n,i),null):l===0?a.copy(null,n,null,null,null):a.copy(null,null,null,null,a.right.insert(e,n,i)),a.fixUp()}removeMin(){if(this.left.isEmpty())return yn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let i,a=this;if(n(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,n),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),n(e,a.key)===0){if(a.right.isEmpty())return yn.EMPTY;i=a.right.min(),a=a.copy(i.key,i.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,n))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,yn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,yn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Re(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Re(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Re(27949);return e+(this.isRed()?0:1)}}yn.EMPTY=null,yn.RED=!0,yn.BLACK=!1;yn.EMPTY=new class{constructor(){this.size=0}get key(){throw Re(57766)}get value(){throw Re(16141)}get color(){throw Re(16727)}get left(){throw Re(29726)}get right(){throw Re(36894)}copy(e,n,i,a,l){return this}insert(e,n,i){return new yn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.comparator=e,this.data=new Mt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,i)=>(e(n),!1))}forEachInRange(e,n){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const a=i.getNext();if(this.comparator(a.key,e[1])>=0)return;n(a.key)}}forEachWhile(e,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Ng(this.data.getIterator())}getIteratorFrom(e){return new Ng(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(i=>{n=n.add(i)}),n}isEqual(e){if(!(e instanceof en)||this.size!==e.size)return!1;const n=this.data.getIterator(),i=e.data.getIterator();for(;n.hasNext();){const a=n.getNext().key,l=i.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new en(this.comparator);return n.data=e,n}}class Ng{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(e){this.fields=e,e.sort(wn.comparator)}static empty(){return new ir([])}unionWith(e){let n=new en(wn.comparator);for(const i of this.fields)n=n.add(i);for(const i of e)n=n.add(i);return new ir(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Jo(this.fields,e.fields,(n,i)=>n.isEqual(i))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new sy("Invalid base64 string: "+l):l}}(e);return new _n(n)}static fromUint8Array(e){const n=function(a){let l="";for(let f=0;f<a.length;++f)l+=String.fromCharCode(a[f]);return l}(e);return new _n(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const i=new Uint8Array(n.length);for(let a=0;a<n.length;a++)i[a]=n.charCodeAt(a);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ge(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}_n.EMPTY_BYTE_STRING=new _n("");const c3=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ys(t){if(tt(!!t,39018),typeof t=="string"){let e=0;const n=c3.exec(t);if(tt(!!n,46558,{timestamp:t}),n[1]){let a=n[1];a=(a+"000000000").substr(0,9),e=Number(a)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Ht(t.seconds),nanos:Ht(t.nanos)}}function Ht(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ws(t){return typeof t=="string"?_n.fromBase64String(t):_n.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oy="server_timestamp",ay="__type__",ly="__previous_value__",uy="__local_write_time__";function yd(t){var n,i;return((i=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[ay])==null?void 0:i.stringValue)===oy}function Kc(t){const e=t.mapValue.fields[ly];return yd(e)?Kc(e):e}function Al(t){const e=ys(t.mapValue.fields[uy].timestampValue);return new Ct(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h3{constructor(e,n,i,a,l,f,y,x,m,C){this.databaseId=e,this.appId=n,this.persistenceKey=i,this.host=a,this.ssl=l,this.forceLongPolling=f,this.autoDetectLongPolling=y,this.longPollingOptions=x,this.useFetchStreams=m,this.isUsingEmulator=C}}const pc="(default)";class Cl{constructor(e,n){this.projectId=e,this.database=n||pc}static empty(){return new Cl("","")}get isDefaultDatabase(){return this.database===pc}isEqual(e){return e instanceof Cl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cy="__type__",hy="__max__",xu={mapValue:{fields:{__type__:{stringValue:hy}}}},fy="__vector__",mc="value";function xs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?yd(t)?4:d3(t)?9007199254740991:f3(t)?10:11:Re(28295,{value:t})}function hi(t,e){if(t===e)return!0;const n=xs(t);if(n!==xs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Al(t).isEqual(Al(e));case 3:return function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const f=ys(a.timestampValue),y=ys(l.timestampValue);return f.seconds===y.seconds&&f.nanos===y.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(a,l){return ws(a.bytesValue).isEqual(ws(l.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(a,l){return Ht(a.geoPointValue.latitude)===Ht(l.geoPointValue.latitude)&&Ht(a.geoPointValue.longitude)===Ht(l.geoPointValue.longitude)}(t,e);case 2:return function(a,l){if("integerValue"in a&&"integerValue"in l)return Ht(a.integerValue)===Ht(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const f=Ht(a.doubleValue),y=Ht(l.doubleValue);return f===y?gc(f)===gc(y):isNaN(f)&&isNaN(y)}return!1}(t,e);case 9:return Jo(t.arrayValue.values||[],e.arrayValue.values||[],hi);case 10:case 11:return function(a,l){const f=a.mapValue.fields||{},y=l.mapValue.fields||{};if(Rg(f)!==Rg(y))return!1;for(const x in f)if(f.hasOwnProperty(x)&&(y[x]===void 0||!hi(f[x],y[x])))return!1;return!0}(t,e);default:return Re(52216,{left:t})}}function Il(t,e){return(t.values||[]).find(n=>hi(n,e))!==void 0}function ea(t,e){if(t===e)return 0;const n=xs(t),i=xs(e);if(n!==i)return Ge(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ge(t.booleanValue,e.booleanValue);case 2:return function(l,f){const y=Ht(l.integerValue||l.doubleValue),x=Ht(f.integerValue||f.doubleValue);return y<x?-1:y>x?1:y===x?0:isNaN(y)?isNaN(x)?0:-1:1}(t,e);case 3:return bg(t.timestampValue,e.timestampValue);case 4:return bg(Al(t),Al(e));case 5:return Zf(t.stringValue,e.stringValue);case 6:return function(l,f){const y=ws(l),x=ws(f);return y.compareTo(x)}(t.bytesValue,e.bytesValue);case 7:return function(l,f){const y=l.split("/"),x=f.split("/");for(let m=0;m<y.length&&m<x.length;m++){const C=Ge(y[m],x[m]);if(C!==0)return C}return Ge(y.length,x.length)}(t.referenceValue,e.referenceValue);case 8:return function(l,f){const y=Ge(Ht(l.latitude),Ht(f.latitude));return y!==0?y:Ge(Ht(l.longitude),Ht(f.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Dg(t.arrayValue,e.arrayValue);case 10:return function(l,f){var D,V,Y,X;const y=l.fields||{},x=f.fields||{},m=(D=y[mc])==null?void 0:D.arrayValue,C=(V=x[mc])==null?void 0:V.arrayValue,v=Ge(((Y=m==null?void 0:m.values)==null?void 0:Y.length)||0,((X=C==null?void 0:C.values)==null?void 0:X.length)||0);return v!==0?v:Dg(m,C)}(t.mapValue,e.mapValue);case 11:return function(l,f){if(l===xu.mapValue&&f===xu.mapValue)return 0;if(l===xu.mapValue)return 1;if(f===xu.mapValue)return-1;const y=l.fields||{},x=Object.keys(y),m=f.fields||{},C=Object.keys(m);x.sort(),C.sort();for(let v=0;v<x.length&&v<C.length;++v){const D=Zf(x[v],C[v]);if(D!==0)return D;const V=ea(y[x[v]],m[C[v]]);if(V!==0)return V}return Ge(x.length,C.length)}(t.mapValue,e.mapValue);default:throw Re(23264,{he:n})}}function bg(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ge(t,e);const n=ys(t),i=ys(e),a=Ge(n.seconds,i.seconds);return a!==0?a:Ge(n.nanos,i.nanos)}function Dg(t,e){const n=t.values||[],i=e.values||[];for(let a=0;a<n.length&&a<i.length;++a){const l=ea(n[a],i[a]);if(l)return l}return Ge(n.length,i.length)}function ta(t){return $f(t)}function $f(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const i=ys(n);return`time(${i.seconds},${i.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ws(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Te.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let i="[",a=!0;for(const l of n.values||[])a?a=!1:i+=",",i+=$f(l);return i+"]"}(t.arrayValue):"mapValue"in t?function(n){const i=Object.keys(n.fields||{}).sort();let a="{",l=!0;for(const f of i)l?l=!1:a+=",",a+=`${f}:${$f(n.fields[f])}`;return a+"}"}(t.mapValue):Re(61005,{value:t})}function ku(t){switch(xs(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Kc(t);return e?16+ku(e):16;case 5:return 2*t.stringValue.length;case 6:return ws(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(i){return(i.values||[]).reduce((a,l)=>a+ku(l),0)}(t.arrayValue);case 10:case 11:return function(i){let a=0;return Ts(i.fields,(l,f)=>{a+=l.length+ku(f)}),a}(t.mapValue);default:throw Re(13486,{value:t})}}function Og(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Jf(t){return!!t&&"integerValue"in t}function wd(t){return!!t&&"arrayValue"in t}function Pg(t){return!!t&&"nullValue"in t}function Mg(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Lu(t){return!!t&&"mapValue"in t}function f3(t){var n,i;return((i=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[cy])==null?void 0:i.stringValue)===fy}function $a(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Ts(t.mapValue.fields,(n,i)=>e.mapValue.fields[n]=$a(i)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=$a(t.arrayValue.values[n]);return e}return{...t}}function d3(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===hy}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e){this.value=e}static empty(){return new Kn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let i=0;i<e.length-1;++i)if(n=(n.mapValue.fields||{})[e.get(i)],!Lu(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=$a(n)}setAll(e){let n=wn.emptyPath(),i={},a=[];e.forEach((f,y)=>{if(!n.isImmediateParentOf(y)){const x=this.getFieldsMap(n);this.applyChanges(x,i,a),i={},a=[],n=y.popLast()}f?i[y.lastSegment()]=$a(f):a.push(y.lastSegment())});const l=this.getFieldsMap(n);this.applyChanges(l,i,a)}delete(e){const n=this.field(e.popLast());Lu(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return hi(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<e.length;++i){let a=n.mapValue.fields[e.get(i)];Lu(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},n.mapValue.fields[e.get(i)]=a),n=a}return n.mapValue.fields}applyChanges(e,n,i){Ts(n,(a,l)=>e[a]=l);for(const a of i)delete e[a]}clone(){return new Kn($a(this.value))}}function dy(t){const e=[];return Ts(t.fields,(n,i)=>{const a=new wn([n]);if(Lu(i)){const l=dy(i.mapValue).fields;if(l.length===0)e.push(a);else for(const f of l)e.push(a.child(f))}else e.push(a)}),new ir(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e,n,i,a,l,f,y){this.key=e,this.documentType=n,this.version=i,this.readTime=a,this.createTime=l,this.data=f,this.documentState=y}static newInvalidDocument(e){return new bn(e,0,Oe.min(),Oe.min(),Oe.min(),Kn.empty(),0)}static newFoundDocument(e,n,i,a){return new bn(e,1,n,Oe.min(),i,a,0)}static newNoDocument(e,n){return new bn(e,2,n,Oe.min(),Oe.min(),Kn.empty(),0)}static newUnknownDocument(e,n){return new bn(e,3,n,Oe.min(),Oe.min(),Kn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Oe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Kn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Kn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Oe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof bn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new bn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yc{constructor(e,n){this.position=e,this.inclusive=n}}function kg(t,e,n){let i=0;for(let a=0;a<t.position.length;a++){const l=e[a],f=t.position[a];if(l.field.isKeyField()?i=Te.comparator(Te.fromName(f.referenceValue),n.key):i=ea(f,n.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function Lg(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!hi(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(e,n="asc"){this.field=e,this.dir=n}}function g3(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gy{}class Yt extends gy{constructor(e,n,i){super(),this.field=e,this.op=n,this.value=i}static create(e,n,i){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,i):new m3(e,n,i):n==="array-contains"?new x3(e,i):n==="in"?new E3(e,i):n==="not-in"?new _3(e,i):n==="array-contains-any"?new A3(e,i):new Yt(e,n,i)}static createKeyFieldInFilter(e,n,i){return n==="in"?new y3(e,i):new w3(e,i)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(ea(n,this.value)):n!==null&&xs(this.value)===xs(n)&&this.matchesComparison(ea(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Re(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Gr extends gy{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Gr(e,n)}matches(e){return py(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function py(t){return t.op==="and"}function my(t){return p3(t)&&py(t)}function p3(t){for(const e of t.filters)if(e instanceof Gr)return!1;return!0}function e1(t){if(t instanceof Yt)return t.field.canonicalString()+t.op.toString()+ta(t.value);if(my(t))return t.filters.map(e=>e1(e)).join(",");{const e=t.filters.map(n=>e1(n)).join(",");return`${t.op}(${e})`}}function yy(t,e){return t instanceof Yt?function(i,a){return a instanceof Yt&&i.op===a.op&&i.field.isEqual(a.field)&&hi(i.value,a.value)}(t,e):t instanceof Gr?function(i,a){return a instanceof Gr&&i.op===a.op&&i.filters.length===a.filters.length?i.filters.reduce((l,f,y)=>l&&yy(f,a.filters[y]),!0):!1}(t,e):void Re(19439)}function wy(t){return t instanceof Yt?function(n){return`${n.field.canonicalString()} ${n.op} ${ta(n.value)}`}(t):t instanceof Gr?function(n){return n.op.toString()+" {"+n.getFilters().map(wy).join(" ,")+"}"}(t):"Filter"}class m3 extends Yt{constructor(e,n,i){super(e,n,i),this.key=Te.fromName(i.referenceValue)}matches(e){const n=Te.comparator(e.key,this.key);return this.matchesComparison(n)}}class y3 extends Yt{constructor(e,n){super(e,"in",n),this.keys=xy("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class w3 extends Yt{constructor(e,n){super(e,"not-in",n),this.keys=xy("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function xy(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(i=>Te.fromName(i.referenceValue))}class x3 extends Yt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return wd(n)&&Il(n.arrayValue,this.value)}}class E3 extends Yt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Il(this.value.arrayValue,n)}}class _3 extends Yt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Il(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Il(this.value.arrayValue,n)}}class A3 extends Yt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!wd(n)||!n.arrayValue.values)&&n.arrayValue.values.some(i=>Il(this.value.arrayValue,i))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C3{constructor(e,n=null,i=[],a=[],l=null,f=null,y=null){this.path=e,this.collectionGroup=n,this.orderBy=i,this.filters=a,this.limit=l,this.startAt=f,this.endAt=y,this.Te=null}}function Bg(t,e=null,n=[],i=[],a=null,l=null,f=null){return new C3(t,e,n,i,a,l,f)}function xd(t){const e=De(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(i=>e1(i)).join(","),n+="|ob:",n+=e.orderBy.map(i=>function(l){return l.field.canonicalString()+l.dir}(i)).join(","),qc(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(i=>ta(i)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(i=>ta(i)).join(",")),e.Te=n}return e.Te}function Ed(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!g3(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!yy(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Lg(t.startAt,e.startAt)&&Lg(t.endAt,e.endAt)}function t1(t){return Te.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e,n=null,i=[],a=[],l=null,f="F",y=null,x=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=a,this.limit=l,this.limitType=f,this.startAt=y,this.endAt=x,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function I3(t,e,n,i,a,l,f,y){return new no(t,e,n,i,a,l,f,y)}function _d(t){return new no(t)}function Fg(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Ey(t){return t.collectionGroup!==null}function Ja(t){const e=De(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),n.add(l.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(f){let y=new en(wn.comparator);return f.filters.forEach(x=>{x.getFlattenedFilters().forEach(m=>{m.isInequality()&&(y=y.add(m.field))})}),y})(e).forEach(l=>{n.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Tl(l,i))}),n.has(wn.keyField().canonicalString())||e.Ie.push(new Tl(wn.keyField(),i))}return e.Ie}function ai(t){const e=De(t);return e.Ee||(e.Ee=_y(e,Ja(t))),e.Ee}function T3(t){const e=De(t);return e.de||(e.de=_y(e,t.explicitOrderBy)),e.de}function _y(t,e){if(t.limitType==="F")return Bg(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(a=>{const l=a.dir==="desc"?"asc":"desc";return new Tl(a.field,l)});const n=t.endAt?new yc(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new yc(t.startAt.position,t.startAt.inclusive):null;return Bg(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}function n1(t,e){const n=t.filters.concat([e]);return new no(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function wc(t,e,n){return new no(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Yc(t,e){return Ed(ai(t),ai(e))&&t.limitType===e.limitType}function Ay(t){return`${xd(ai(t))}|lt:${t.limitType}`}function _o(t){return`Query(target=${function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map(a=>wy(a)).join(", ")}]`),qc(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map(a=>function(f){return`${f.field.canonicalString()} (${f.dir})`}(a)).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map(a=>ta(a)).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map(a=>ta(a)).join(",")),`Target(${i})`}(ai(t))}; limitType=${t.limitType})`}function Qc(t,e){return e.isFoundDocument()&&function(i,a){const l=a.key.path;return i.collectionGroup!==null?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):Te.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)}(t,e)&&function(i,a){for(const l of Ja(i))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0}(t,e)&&function(i,a){for(const l of i.filters)if(!l.matches(a))return!1;return!0}(t,e)&&function(i,a){return!(i.startAt&&!function(f,y,x){const m=kg(f,y,x);return f.inclusive?m<=0:m<0}(i.startAt,Ja(i),a)||i.endAt&&!function(f,y,x){const m=kg(f,y,x);return f.inclusive?m>=0:m>0}(i.endAt,Ja(i),a))}(t,e)}function v3(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Cy(t){return(e,n)=>{let i=!1;for(const a of Ja(t)){const l=S3(a,e,n);if(l!==0)return l;i=i||a.field.isKeyField()}return 0}}function S3(t,e,n){const i=t.field.isKeyField()?Te.comparator(e.key,n.key):function(l,f,y){const x=f.data.field(l),m=y.data.field(l);return x!==null&&m!==null?ea(x,m):Re(42886)}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return Re(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i!==void 0){for(const[a,l]of i)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,n){const i=this.mapKeyFn(e),a=this.inner[i];if(a===void 0)return this.inner[i]=[[e,n]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,n]);a.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return!1;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return i.length===1?delete this.inner[n]:i.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Ts(this.inner,(n,i)=>{for(const[a,l]of i)e(a,l)})}isEmpty(){return iy(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R3=new Mt(Te.comparator);function Di(){return R3}const Iy=new Mt(Te.comparator);function Va(...t){let e=Iy;for(const n of t)e=e.insert(n.key,n);return e}function Ty(t){let e=Iy;return t.forEach((n,i)=>e=e.insert(n,i.overlayedDocument)),e}function Gs(){return el()}function vy(){return el()}function el(){return new ro(t=>t.toString(),(t,e)=>t.isEqual(e))}const N3=new Mt(Te.comparator),b3=new en(Te.comparator);function We(...t){let e=b3;for(const n of t)e=e.add(n);return e}const D3=new en(Ge);function O3(){return D3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ad(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:gc(e)?"-0":e}}function Sy(t){return{integerValue:""+t}}function P3(t,e){return o3(e)?Sy(e):Ad(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc{constructor(){this._=void 0}}function M3(t,e,n){return t instanceof xc?function(a,l){const f={fields:{[ay]:{stringValue:oy},[uy]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&yd(l)&&(l=Kc(l)),l&&(f.fields[ly]=l),{mapValue:f}}(n,e):t instanceof vl?Ny(t,e):t instanceof Sl?by(t,e):function(a,l){const f=Ry(a,l),y=Vg(f)+Vg(a.Ae);return Jf(f)&&Jf(a.Ae)?Sy(y):Ad(a.serializer,y)}(t,e)}function k3(t,e,n){return t instanceof vl?Ny(t,e):t instanceof Sl?by(t,e):n}function Ry(t,e){return t instanceof Ec?function(i){return Jf(i)||function(l){return!!l&&"doubleValue"in l}(i)}(e)?e:{integerValue:0}:null}class xc extends Zc{}class vl extends Zc{constructor(e){super(),this.elements=e}}function Ny(t,e){const n=Dy(e);for(const i of t.elements)n.some(a=>hi(a,i))||n.push(i);return{arrayValue:{values:n}}}class Sl extends Zc{constructor(e){super(),this.elements=e}}function by(t,e){let n=Dy(e);for(const i of t.elements)n=n.filter(a=>!hi(a,i));return{arrayValue:{values:n}}}class Ec extends Zc{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function Vg(t){return Ht(t.integerValue||t.doubleValue)}function Dy(t){return wd(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function L3(t,e){return t.field.isEqual(e.field)&&function(i,a){return i instanceof vl&&a instanceof vl||i instanceof Sl&&a instanceof Sl?Jo(i.elements,a.elements,hi):i instanceof Ec&&a instanceof Ec?hi(i.Ae,a.Ae):i instanceof xc&&a instanceof xc}(t.transform,e.transform)}class B3{constructor(e,n){this.version=e,this.transformResults=n}}class vr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new vr}static exists(e){return new vr(void 0,e)}static updateTime(e){return new vr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Bu(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class $c{}function Oy(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Cd(t.key,vr.none()):new Ml(t.key,t.data,vr.none());{const n=t.data,i=Kn.empty();let a=new en(wn.comparator);for(let l of e.fields)if(!a.has(l)){let f=n.field(l);f===null&&l.length>1&&(l=l.popLast(),f=n.field(l)),f===null?i.delete(l):i.set(l,f),a=a.add(l)}return new vs(t.key,i,new ir(a.toArray()),vr.none())}}function F3(t,e,n){t instanceof Ml?function(a,l,f){const y=a.value.clone(),x=zg(a.fieldTransforms,l,f.transformResults);y.setAll(x),l.convertToFoundDocument(f.version,y).setHasCommittedMutations()}(t,e,n):t instanceof vs?function(a,l,f){if(!Bu(a.precondition,l))return void l.convertToUnknownDocument(f.version);const y=zg(a.fieldTransforms,l,f.transformResults),x=l.data;x.setAll(Py(a)),x.setAll(y),l.convertToFoundDocument(f.version,x).setHasCommittedMutations()}(t,e,n):function(a,l,f){l.convertToNoDocument(f.version).setHasCommittedMutations()}(0,e,n)}function tl(t,e,n,i){return t instanceof Ml?function(l,f,y,x){if(!Bu(l.precondition,f))return y;const m=l.value.clone(),C=Hg(l.fieldTransforms,x,f);return m.setAll(C),f.convertToFoundDocument(f.version,m).setHasLocalMutations(),null}(t,e,n,i):t instanceof vs?function(l,f,y,x){if(!Bu(l.precondition,f))return y;const m=Hg(l.fieldTransforms,x,f),C=f.data;return C.setAll(Py(l)),C.setAll(m),f.convertToFoundDocument(f.version,C).setHasLocalMutations(),y===null?null:y.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map(v=>v.field))}(t,e,n,i):function(l,f,y){return Bu(l.precondition,f)?(f.convertToNoDocument(f.version).setHasLocalMutations(),null):y}(t,e,n)}function V3(t,e){let n=null;for(const i of t.fieldTransforms){const a=e.data.field(i.field),l=Ry(i.transform,a||null);l!=null&&(n===null&&(n=Kn.empty()),n.set(i.field,l))}return n||null}function Ug(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(i,a){return i===void 0&&a===void 0||!(!i||!a)&&Jo(i,a,(l,f)=>L3(l,f))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ml extends $c{constructor(e,n,i,a=[]){super(),this.key=e,this.value=n,this.precondition=i,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class vs extends $c{constructor(e,n,i,a,l=[]){super(),this.key=e,this.data=n,this.fieldMask=i,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function Py(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}}),e}function zg(t,e,n){const i=new Map;tt(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let a=0;a<n.length;a++){const l=t[a],f=l.transform,y=e.data.field(l.field);i.set(l.field,k3(f,y,n[a]))}return i}function Hg(t,e,n){const i=new Map;for(const a of t){const l=a.transform,f=n.data.field(a.field);i.set(a.field,M3(l,f,e))}return i}class Cd extends $c{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class U3 extends $c{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z3{constructor(e,n,i,a){this.batchId=e,this.localWriteTime=n,this.baseMutations=i,this.mutations=a}applyToRemoteDocument(e,n){const i=n.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&F3(l,e,i[a])}}applyToLocalView(e,n){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(n=tl(i,e,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(n=tl(i,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const i=vy();return this.mutations.forEach(a=>{const l=e.get(a.key),f=l.overlayedDocument;let y=this.applyToLocalView(f,l.mutatedFields);y=n.has(a.key)?null:y;const x=Oy(f,y);x!==null&&i.set(a.key,x),f.isValidDocument()||f.convertToNoDocument(Oe.min())}),i}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),We())}isEqual(e){return this.batchId===e.batchId&&Jo(this.mutations,e.mutations,(n,i)=>Ug(n,i))&&Jo(this.baseMutations,e.baseMutations,(n,i)=>Ug(n,i))}}class Id{constructor(e,n,i,a){this.batch=e,this.commitVersion=n,this.mutationResults=i,this.docVersions=a}static from(e,n,i){tt(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let a=function(){return N3}();const l=e.mutations;for(let f=0;f<l.length;f++)a=a.insert(l[f].key,i[f].version);return new Id(e,n,i,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H3{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G3{constructor(e,n,i){this.alias=e,this.aggregateType=n,this.fieldPath=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W3{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qt,Ye;function j3(t){switch(t){case te.OK:return Re(64938);case te.CANCELLED:case te.UNKNOWN:case te.DEADLINE_EXCEEDED:case te.RESOURCE_EXHAUSTED:case te.INTERNAL:case te.UNAVAILABLE:case te.UNAUTHENTICATED:return!1;case te.INVALID_ARGUMENT:case te.NOT_FOUND:case te.ALREADY_EXISTS:case te.PERMISSION_DENIED:case te.FAILED_PRECONDITION:case te.ABORTED:case te.OUT_OF_RANGE:case te.UNIMPLEMENTED:case te.DATA_LOSS:return!0;default:return Re(15467,{code:t})}}function My(t){if(t===void 0)return bi("GRPC error has no .code"),te.UNKNOWN;switch(t){case qt.OK:return te.OK;case qt.CANCELLED:return te.CANCELLED;case qt.UNKNOWN:return te.UNKNOWN;case qt.DEADLINE_EXCEEDED:return te.DEADLINE_EXCEEDED;case qt.RESOURCE_EXHAUSTED:return te.RESOURCE_EXHAUSTED;case qt.INTERNAL:return te.INTERNAL;case qt.UNAVAILABLE:return te.UNAVAILABLE;case qt.UNAUTHENTICATED:return te.UNAUTHENTICATED;case qt.INVALID_ARGUMENT:return te.INVALID_ARGUMENT;case qt.NOT_FOUND:return te.NOT_FOUND;case qt.ALREADY_EXISTS:return te.ALREADY_EXISTS;case qt.PERMISSION_DENIED:return te.PERMISSION_DENIED;case qt.FAILED_PRECONDITION:return te.FAILED_PRECONDITION;case qt.ABORTED:return te.ABORTED;case qt.OUT_OF_RANGE:return te.OUT_OF_RANGE;case qt.UNIMPLEMENTED:return te.UNIMPLEMENTED;case qt.DATA_LOSS:return te.DATA_LOSS;default:return Re(39323,{code:t})}}(Ye=qt||(qt={}))[Ye.OK=0]="OK",Ye[Ye.CANCELLED=1]="CANCELLED",Ye[Ye.UNKNOWN=2]="UNKNOWN",Ye[Ye.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ye[Ye.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ye[Ye.NOT_FOUND=5]="NOT_FOUND",Ye[Ye.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ye[Ye.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ye[Ye.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ye[Ye.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ye[Ye.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ye[Ye.ABORTED=10]="ABORTED",Ye[Ye.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ye[Ye.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ye[Ye.INTERNAL=13]="INTERNAL",Ye[Ye.UNAVAILABLE=14]="UNAVAILABLE",Ye[Ye.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X3(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q3=new fs([4294967295,4294967295],0);function Gg(t){const e=X3().encode(t),n=new K2;return n.update(e),new Uint8Array(n.digest())}function Wg(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new fs([n,i],0),new fs([a,l],0)]}class Td{constructor(e,n,i){if(this.bitmap=e,this.padding=n,this.hashCount=i,n<0||n>=8)throw new Ua(`Invalid padding: ${n}`);if(i<0)throw new Ua(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Ua(`Invalid hash count: ${i}`);if(e.length===0&&n!==0)throw new Ua(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=fs.fromNumber(this.ge)}ye(e,n,i){let a=e.add(n.multiply(fs.fromNumber(i)));return a.compare(q3)===1&&(a=new fs([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=Gg(e),[i,a]=Wg(n);for(let l=0;l<this.hashCount;l++){const f=this.ye(i,a,l);if(!this.we(f))return!1}return!0}static create(e,n,i){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),f=new Td(l,a,n);return i.forEach(y=>f.insert(y)),f}insert(e){if(this.ge===0)return;const n=Gg(e),[i,a]=Wg(n);for(let l=0;l<this.hashCount;l++){const f=this.ye(i,a,l);this.Se(f)}}Se(e){const n=Math.floor(e/8),i=e%8;this.bitmap[n]|=1<<i}}class Ua extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,n,i,a,l){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,n,i){const a=new Map;return a.set(e,kl.createSynthesizedTargetChangeForCurrentChange(e,n,i)),new Jc(Oe.min(),a,new Mt(Ge),Di(),We())}}class kl{constructor(e,n,i,a,l){this.resumeToken=e,this.current=n,this.addedDocuments=i,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,n,i){return new kl(i,n,We(),We(),We())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(e,n,i,a){this.be=e,this.removedTargetIds=n,this.key=i,this.De=a}}class ky{constructor(e,n){this.targetId=e,this.Ce=n}}class Ly{constructor(e,n,i=_n.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=n,this.resumeToken=i,this.cause=a}}class jg{constructor(){this.ve=0,this.Fe=Xg(),this.Me=_n.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=We(),n=We(),i=We();return this.Fe.forEach((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:n=n.add(a);break;case 1:i=i.add(a);break;default:Re(38017,{changeType:l})}}),new kl(this.Me,this.xe,e,n,i)}qe(){this.Oe=!1,this.Fe=Xg()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,tt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class K3{constructor(e){this.Ge=e,this.ze=new Map,this.je=Di(),this.Je=Eu(),this.He=Eu(),this.Ye=new Mt(Ge)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const i=this.nt(n);switch(e.state){case 0:this.rt(n)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),i.Le(e.resumeToken));break;default:Re(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((i,a)=>{this.rt(a)&&n(a)})}st(e){const n=e.targetId,i=e.Ce.count,a=this.ot(n);if(a){const l=a.target;if(t1(l))if(i===0){const f=new Te(l.path);this.et(n,f,bn.newNoDocument(f,Oe.min()))}else tt(i===1,20013,{expectedCount:i});else{const f=this._t(n);if(f!==i){const y=this.ut(e),x=y?this.ct(y,e,f):1;if(x!==0){this.it(n);const m=x===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,m)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:a=0},hashCount:l=0}=n;let f,y;try{f=ws(i).toUint8Array()}catch(x){if(x instanceof sy)return $o("Decoding the base64 bloom filter in existence filter failed ("+x.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw x}try{y=new Td(f,a,l)}catch(x){return $o(x instanceof Ua?"BloomFilter error: ":"Applying bloom filter failed: ",x),null}return y.ge===0?null:y}ct(e,n,i){return n.Ce.count===i-this.Pt(e,n.targetId)?0:2}Pt(e,n){const i=this.Ge.getRemoteKeysForTarget(n);let a=0;return i.forEach(l=>{const f=this.Ge.ht(),y=`projects/${f.projectId}/databases/${f.database}/documents/${l.path.canonicalString()}`;e.mightContain(y)||(this.et(n,l,null),a++)}),a}Tt(e){const n=new Map;this.ze.forEach((l,f)=>{const y=this.ot(f);if(y){if(l.current&&t1(y.target)){const x=new Te(y.target.path);this.It(x).has(f)||this.Et(f,x)||this.et(f,x,bn.newNoDocument(x,e))}l.Be&&(n.set(f,l.ke()),l.qe())}});let i=We();this.He.forEach((l,f)=>{let y=!0;f.forEachWhile(x=>{const m=this.ot(x);return!m||m.purpose==="TargetPurposeLimboResolution"||(y=!1,!1)}),y&&(i=i.add(l))}),this.je.forEach((l,f)=>f.setReadTime(e));const a=new Jc(e,n,this.Ye,this.je,i);return this.je=Di(),this.Je=Eu(),this.He=Eu(),this.Ye=new Mt(Ge),a}Xe(e,n){if(!this.rt(e))return;const i=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,i),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,i){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,n)?a.Qe(n,1):a.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),i&&(this.je=this.je.insert(n,i))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new jg,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new en(Ge),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new en(Ge),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ye("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new jg),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Eu(){return new Mt(Te.comparator)}function Xg(){return new Mt(Te.comparator)}const Y3=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),Q3=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),Z3=(()=>({and:"AND",or:"OR"}))();class $3{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function r1(t,e){return t.useProto3Json||qc(e)?e:{value:e}}function _c(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function By(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function J3(t,e){return _c(t,e.toTimestamp())}function li(t){return tt(!!t,49232),Oe.fromTimestamp(function(n){const i=ys(n);return new Ct(i.seconds,i.nanos)}(t))}function vd(t,e){return i1(t,e).canonicalString()}function i1(t,e){const n=function(a){return new pt(["projects",a.projectId,"databases",a.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Fy(t){const e=pt.fromString(t);return tt(Wy(e),10190,{key:e.toString()}),e}function s1(t,e){return vd(t.databaseId,e.path)}function Kh(t,e){const n=Fy(e);if(n.get(1)!==t.databaseId.projectId)throw new pe(te.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new pe(te.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Te(Uy(n))}function Vy(t,e){return vd(t.databaseId,e)}function eC(t){const e=Fy(t);return e.length===4?pt.emptyPath():Uy(e)}function o1(t){return new pt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Uy(t){return tt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function qg(t,e,n){return{name:s1(t,e),fields:n.value.mapValue.fields}}function tC(t,e){let n;if("targetChange"in e){e.targetChange;const i=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Re(39313,{state:m})}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=function(m,C){return m.useProto3Json?(tt(C===void 0||typeof C=="string",58123),_n.fromBase64String(C||"")):(tt(C===void 0||C instanceof Buffer||C instanceof Uint8Array,16193),_n.fromUint8Array(C||new Uint8Array))}(t,e.targetChange.resumeToken),f=e.targetChange.cause,y=f&&function(m){const C=m.code===void 0?te.UNKNOWN:My(m.code);return new pe(C,m.message||"")}(f);n=new Ly(i,a,l,y||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const a=Kh(t,i.document.name),l=li(i.document.updateTime),f=i.document.createTime?li(i.document.createTime):Oe.min(),y=new Kn({mapValue:{fields:i.document.fields}}),x=bn.newFoundDocument(a,l,f,y),m=i.targetIds||[],C=i.removedTargetIds||[];n=new Fu(m,C,x.key,x)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const a=Kh(t,i.document),l=i.readTime?li(i.readTime):Oe.min(),f=bn.newNoDocument(a,l),y=i.removedTargetIds||[];n=new Fu([],y,f.key,f)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const a=Kh(t,i.document),l=i.removedTargetIds||[];n=new Fu([],l,a,null)}else{if(!("filter"in e))return Re(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:a=0,unchangedNames:l}=i,f=new W3(a,l),y=i.targetId;n=new ky(y,f)}}return n}function nC(t,e){let n;if(e instanceof Ml)n={update:qg(t,e.key,e.value)};else if(e instanceof Cd)n={delete:s1(t,e.key)};else if(e instanceof vs)n={update:qg(t,e.key,e.data),updateMask:hC(e.fieldMask)};else{if(!(e instanceof U3))return Re(16599,{Vt:e.type});n={verify:s1(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(i=>function(l,f){const y=f.transform;if(y instanceof xc)return{fieldPath:f.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(y instanceof vl)return{fieldPath:f.field.canonicalString(),appendMissingElements:{values:y.elements}};if(y instanceof Sl)return{fieldPath:f.field.canonicalString(),removeAllFromArray:{values:y.elements}};if(y instanceof Ec)return{fieldPath:f.field.canonicalString(),increment:y.Ae};throw Re(20930,{transform:f.transform})}(0,i))),e.precondition.isNone||(n.currentDocument=function(a,l){return l.updateTime!==void 0?{updateTime:J3(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Re(27497)}(t,e.precondition)),n}function rC(t,e){return t&&t.length>0?(tt(e!==void 0,14353),t.map(n=>function(a,l){let f=a.updateTime?li(a.updateTime):li(l);return f.isEqual(Oe.min())&&(f=li(l)),new B3(f,a.transformResults||[])}(n,e))):[]}function iC(t,e){return{documents:[Vy(t,e.path)]}}function zy(t,e){const n={structuredQuery:{}},i=e.path;let a;e.collectionGroup!==null?(a=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=Vy(t,a);const l=function(m){if(m.length!==0)return Gy(Gr.create(m,"and"))}(e.filters);l&&(n.structuredQuery.where=l);const f=function(m){if(m.length!==0)return m.map(C=>function(D){return{field:$i(D.field),direction:lC(D.dir)}}(C))}(e.orderBy);f&&(n.structuredQuery.orderBy=f);const y=r1(t,e.limit);return y!==null&&(n.structuredQuery.limit=y),e.startAt&&(n.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{ft:n,parent:a}}function sC(t,e,n,i){const{ft:a,parent:l}=zy(t,e),f={},y=[];let x=0;return n.forEach(m=>{const C=i?m.alias:"aggregate_"+x++;f[C]=m.alias,m.aggregateType==="count"?y.push({alias:C,count:{}}):m.aggregateType==="avg"?y.push({alias:C,avg:{field:$i(m.fieldPath)}}):m.aggregateType==="sum"&&y.push({alias:C,sum:{field:$i(m.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:y,structuredQuery:a.structuredQuery},parent:a.parent},gt:f,parent:l}}function oC(t){let e=eC(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let a=null;if(i>0){tt(i===1,65062);const C=n.from[0];C.allDescendants?a=C.collectionId:e=e.child(C.collectionId)}let l=[];n.where&&(l=function(v){const D=Hy(v);return D instanceof Gr&&my(D)?D.getFilters():[D]}(n.where));let f=[];n.orderBy&&(f=function(v){return v.map(D=>function(Y){return new Tl(Ao(Y.field),function(ne){switch(ne){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(Y.direction))}(D))}(n.orderBy));let y=null;n.limit&&(y=function(v){let D;return D=typeof v=="object"?v.value:v,qc(D)?null:D}(n.limit));let x=null;n.startAt&&(x=function(v){const D=!!v.before,V=v.values||[];return new yc(V,D)}(n.startAt));let m=null;return n.endAt&&(m=function(v){const D=!v.before,V=v.values||[];return new yc(V,D)}(n.endAt)),I3(e,a,f,l,y,"F",x,m)}function aC(t,e){const n=function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Re(28987,{purpose:a})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Hy(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=Ao(n.unaryFilter.field);return Yt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const a=Ao(n.unaryFilter.field);return Yt.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=Ao(n.unaryFilter.field);return Yt.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const f=Ao(n.unaryFilter.field);return Yt.create(f,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Re(61313);default:return Re(60726)}}(t):t.fieldFilter!==void 0?function(n){return Yt.create(Ao(n.fieldFilter.field),function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Re(58110);default:return Re(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Gr.create(n.compositeFilter.filters.map(i=>Hy(i)),function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Re(1026)}}(n.compositeFilter.op))}(t):Re(30097,{filter:t})}function lC(t){return Y3[t]}function uC(t){return Q3[t]}function cC(t){return Z3[t]}function $i(t){return{fieldPath:t.canonicalString()}}function Ao(t){return wn.fromServerFormat(t.fieldPath)}function Gy(t){return t instanceof Yt?function(n){if(n.op==="=="){if(Mg(n.value))return{unaryFilter:{field:$i(n.field),op:"IS_NAN"}};if(Pg(n.value))return{unaryFilter:{field:$i(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Mg(n.value))return{unaryFilter:{field:$i(n.field),op:"IS_NOT_NAN"}};if(Pg(n.value))return{unaryFilter:{field:$i(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:$i(n.field),op:uC(n.op),value:n.value}}}(t):t instanceof Gr?function(n){const i=n.getFilters().map(a=>Gy(a));return i.length===1?i[0]:{compositeFilter:{op:cC(n.op),filters:i}}}(t):Re(54877,{filter:t})}function hC(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Wy(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts{constructor(e,n,i,a,l=Oe.min(),f=Oe.min(),y=_n.EMPTY_BYTE_STRING,x=null){this.target=e,this.targetId=n,this.purpose=i,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=f,this.resumeToken=y,this.expectedCount=x}withSequenceNumber(e){return new ts(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ts(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ts(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ts(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fC{constructor(e){this.yt=e}}function dC(t){const e=oC({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?wc(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(){this.Cn=new pC}addToCollectionParentIndex(e,n){return this.Cn.add(n),re.resolve()}getCollectionParents(e,n){return re.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return re.resolve()}deleteFieldIndex(e,n){return re.resolve()}deleteAllFieldIndexes(e){return re.resolve()}createTargetIndexes(e,n){return re.resolve()}getDocumentsMatchingTarget(e,n){return re.resolve(null)}getIndexType(e,n){return re.resolve(0)}getFieldIndexes(e,n){return re.resolve([])}getNextCollectionGroupToUpdate(e){return re.resolve(null)}getMinOffset(e,n){return re.resolve(ms.min())}getMinOffsetFromCollectionGroup(e,n){return re.resolve(ms.min())}updateCollectionGroup(e,n,i){return re.resolve()}updateIndexEntries(e,n){return re.resolve()}}class pC{constructor(){this.index={}}add(e){const n=e.lastSegment(),i=e.popLast(),a=this.index[n]||new en(pt.comparator),l=!a.has(i);return this.index[n]=a.add(i),l}has(e){const n=e.lastSegment(),i=e.popLast(),a=this.index[n];return a&&a.has(i)}getEntries(e){return(this.index[e]||new en(pt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kg={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},jy=41943040;class Xn{static withCacheSize(e){return new Xn(e,Xn.DEFAULT_COLLECTION_PERCENTILE,Xn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xn.DEFAULT_COLLECTION_PERCENTILE=10,Xn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Xn.DEFAULT=new Xn(jy,Xn.DEFAULT_COLLECTION_PERCENTILE,Xn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Xn.DISABLED=new Xn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class na{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new na(0)}static cr(){return new na(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yg="LruGarbageCollector",mC=1048576;function Qg([t,e],[n,i]){const a=Ge(t,n);return a===0?Ge(e,i):a}class yC{constructor(e){this.Ir=e,this.buffer=new en(Qg),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();Qg(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class wC{constructor(e,n,i){this.garbageCollector=e,this.asyncQueue=n,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ye(Yg,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ca(n)?ye(Yg,"Ignoring IndexedDB error during garbage collection: ",n):await ua(n)}await this.Vr(3e5)})}}class xC{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(i=>Math.floor(n/100*i))}nthSequenceNumber(e,n){if(n===0)return re.resolve(Xc.ce);const i=new yC(n);return this.mr.forEachTarget(e,a=>i.Ar(a.sequenceNumber)).next(()=>this.mr.pr(e,a=>i.Ar(a))).next(()=>i.maxValue)}removeTargets(e,n,i){return this.mr.removeTargets(e,n,i)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ye("LruGarbageCollector","Garbage collection skipped; disabled"),re.resolve(Kg)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(ye("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Kg):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let i,a,l,f,y,x,m;const C=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(v=>(v>this.params.maximumSequenceNumbersToCollect?(ye("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),a=this.params.maximumSequenceNumbersToCollect):a=v,f=Date.now(),this.nthSequenceNumber(e,a))).next(v=>(i=v,y=Date.now(),this.removeTargets(e,i,n))).next(v=>(l=v,x=Date.now(),this.removeOrphanedDocuments(e,i))).next(v=>(m=Date.now(),Eo()<=Qe.DEBUG&&ye("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${f-C}ms
	Determined least recently used ${a} in `+(y-f)+`ms
	Removed ${l} targets in `+(x-y)+`ms
	Removed ${v} documents in `+(m-x)+`ms
Total Duration: ${m-C}ms`),re.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:v})))}}function EC(t,e){return new xC(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(){this.changes=new ro(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,bn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?re.resolve(i):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AC{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CC{constructor(e,n,i,a){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=a}getDocument(e,n){let i=null;return this.documentOverlayCache.getOverlay(e,n).next(a=>(i=a,this.remoteDocumentCache.getEntry(e,n))).next(a=>(i!==null&&tl(i.mutation,a,ir.empty(),Ct.now()),a))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(i=>this.getLocalViewOfDocuments(e,i,We()).next(()=>i))}getLocalViewOfDocuments(e,n,i=We()){const a=Gs();return this.populateOverlays(e,a,n).next(()=>this.computeViews(e,n,a,i).next(l=>{let f=Va();return l.forEach((y,x)=>{f=f.insert(y,x.overlayedDocument)}),f}))}getOverlayedDocuments(e,n){const i=Gs();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,We()))}populateOverlays(e,n,i){const a=[];return i.forEach(l=>{n.has(l)||a.push(l)}),this.documentOverlayCache.getOverlays(e,a).next(l=>{l.forEach((f,y)=>{n.set(f,y)})})}computeViews(e,n,i,a){let l=Di();const f=el(),y=function(){return el()}();return n.forEach((x,m)=>{const C=i.get(m.key);a.has(m.key)&&(C===void 0||C.mutation instanceof vs)?l=l.insert(m.key,m):C!==void 0?(f.set(m.key,C.mutation.getFieldMask()),tl(C.mutation,m,C.mutation.getFieldMask(),Ct.now())):f.set(m.key,ir.empty())}),this.recalculateAndSaveOverlays(e,l).next(x=>(x.forEach((m,C)=>f.set(m,C)),n.forEach((m,C)=>y.set(m,new AC(C,f.get(m)??null))),y))}recalculateAndSaveOverlays(e,n){const i=el();let a=new Mt((f,y)=>f-y),l=We();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(f=>{for(const y of f)y.keys().forEach(x=>{const m=n.get(x);if(m===null)return;let C=i.get(x)||ir.empty();C=y.applyToLocalView(m,C),i.set(x,C);const v=(a.get(y.batchId)||We()).add(x);a=a.insert(y.batchId,v)})}).next(()=>{const f=[],y=a.getReverseIterator();for(;y.hasNext();){const x=y.getNext(),m=x.key,C=x.value,v=vy();C.forEach(D=>{if(!l.has(D)){const V=Oy(n.get(D),i.get(D));V!==null&&v.set(D,V),l=l.add(D)}}),f.push(this.documentOverlayCache.saveOverlays(e,m,v))}return re.waitFor(f)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(i=>this.recalculateAndSaveOverlays(e,i))}getDocumentsMatchingQuery(e,n,i,a){return function(f){return Te.isDocumentKey(f.path)&&f.collectionGroup===null&&f.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Ey(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,i,a):this.getDocumentsMatchingCollectionQuery(e,n,i,a)}getNextDocuments(e,n,i,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,i,a).next(l=>{const f=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,i.largestBatchId,a-l.size):re.resolve(Gs());let y=_l,x=l;return f.next(m=>re.forEach(m,(C,v)=>(y<v.largestBatchId&&(y=v.largestBatchId),l.get(C)?re.resolve():this.remoteDocumentCache.getEntry(e,C).next(D=>{x=x.insert(C,D)}))).next(()=>this.populateOverlays(e,m,l)).next(()=>this.computeViews(e,x,m,We())).next(C=>({batchId:y,changes:Ty(C)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Te(n)).next(i=>{let a=Va();return i.isFoundDocument()&&(a=a.insert(i.key,i)),a})}getDocumentsMatchingCollectionGroupQuery(e,n,i,a){const l=n.collectionGroup;let f=Va();return this.indexManager.getCollectionParents(e,l).next(y=>re.forEach(y,x=>{const m=function(v,D){return new no(D,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)}(n,x.child(l));return this.getDocumentsMatchingCollectionQuery(e,m,i,a).next(C=>{C.forEach((v,D)=>{f=f.insert(v,D)})})}).next(()=>f))}getDocumentsMatchingCollectionQuery(e,n,i,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,i.largestBatchId).next(f=>(l=f,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,i,l,a))).next(f=>{l.forEach((x,m)=>{const C=m.getKey();f.get(C)===null&&(f=f.insert(C,bn.newInvalidDocument(C)))});let y=Va();return f.forEach((x,m)=>{const C=l.get(x);C!==void 0&&tl(C.mutation,m,ir.empty(),Ct.now()),Qc(n,m)&&(y=y.insert(x,m))}),y})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return re.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(a){return{id:a.id,version:a.version,createTime:li(a.createTime)}}(n)),re.resolve()}getNamedQuery(e,n){return re.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(a){return{name:a.name,query:dC(a.bundledQuery),readTime:li(a.readTime)}}(n)),re.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC{constructor(){this.overlays=new Mt(Te.comparator),this.qr=new Map}getOverlay(e,n){return re.resolve(this.overlays.get(n))}getOverlays(e,n){const i=Gs();return re.forEach(n,a=>this.getOverlay(e,a).next(l=>{l!==null&&i.set(a,l)})).next(()=>i)}saveOverlays(e,n,i){return i.forEach((a,l)=>{this.St(e,n,l)}),re.resolve()}removeOverlaysForBatchId(e,n,i){const a=this.qr.get(i);return a!==void 0&&(a.forEach(l=>this.overlays=this.overlays.remove(l)),this.qr.delete(i)),re.resolve()}getOverlaysForCollection(e,n,i){const a=Gs(),l=n.length+1,f=new Te(n.child("")),y=this.overlays.getIteratorFrom(f);for(;y.hasNext();){const x=y.getNext().value,m=x.getKey();if(!n.isPrefixOf(m.path))break;m.path.length===l&&x.largestBatchId>i&&a.set(x.getKey(),x)}return re.resolve(a)}getOverlaysForCollectionGroup(e,n,i,a){let l=new Mt((m,C)=>m-C);const f=this.overlays.getIterator();for(;f.hasNext();){const m=f.getNext().value;if(m.getKey().getCollectionGroup()===n&&m.largestBatchId>i){let C=l.get(m.largestBatchId);C===null&&(C=Gs(),l=l.insert(m.largestBatchId,C)),C.set(m.getKey(),m)}}const y=Gs(),x=l.getIterator();for(;x.hasNext()&&(x.getNext().value.forEach((m,C)=>y.set(m,C)),!(y.size()>=a)););return re.resolve(y)}St(e,n,i){const a=this.overlays.get(i.key);if(a!==null){const f=this.qr.get(a.largestBatchId).delete(i.key);this.qr.set(a.largestBatchId,f)}this.overlays=this.overlays.insert(i.key,new H3(n,i));let l=this.qr.get(n);l===void 0&&(l=We(),this.qr.set(n,l)),this.qr.set(n,l.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(){this.sessionToken=_n.EMPTY_BYTE_STRING}getSessionToken(e){return re.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,re.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sd{constructor(){this.Qr=new en(ln.$r),this.Ur=new en(ln.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const i=new ln(e,n);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,n){e.forEach(i=>this.addReference(i,n))}removeReference(e,n){this.Gr(new ln(e,n))}zr(e,n){e.forEach(i=>this.removeReference(i,n))}jr(e){const n=new Te(new pt([])),i=new ln(n,e),a=new ln(n,e+1),l=[];return this.Ur.forEachInRange([i,a],f=>{this.Gr(f),l.push(f.key)}),l}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new Te(new pt([])),i=new ln(n,e),a=new ln(n,e+1);let l=We();return this.Ur.forEachInRange([i,a],f=>{l=l.add(f.key)}),l}containsKey(e){const n=new ln(e,0),i=this.Qr.firstAfterOrEqual(n);return i!==null&&e.isEqual(i.key)}}class ln{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return Te.comparator(e.key,n.key)||Ge(e.Yr,n.Yr)}static Kr(e,n){return Ge(e.Yr,n.Yr)||Te.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new en(ln.$r)}checkEmpty(e){return re.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,i,a){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const f=new z3(l,n,i,a);this.mutationQueue.push(f);for(const y of a)this.Zr=this.Zr.add(new ln(y.key,l)),this.indexManager.addToCollectionParentIndex(e,y.key.path.popLast());return re.resolve(f)}lookupMutationBatch(e,n){return re.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const i=n+1,a=this.ei(i),l=a<0?0:a;return re.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return re.resolve(this.mutationQueue.length===0?md:this.tr-1)}getAllMutationBatches(e){return re.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const i=new ln(n,0),a=new ln(n,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([i,a],f=>{const y=this.Xr(f.Yr);l.push(y)}),re.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,n){let i=new en(Ge);return n.forEach(a=>{const l=new ln(a,0),f=new ln(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,f],y=>{i=i.add(y.Yr)})}),re.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,n){const i=n.path,a=i.length+1;let l=i;Te.isDocumentKey(l)||(l=l.child(""));const f=new ln(new Te(l),0);let y=new en(Ge);return this.Zr.forEachWhile(x=>{const m=x.key.path;return!!i.isPrefixOf(m)&&(m.length===a&&(y=y.add(x.Yr)),!0)},f),re.resolve(this.ti(y))}ti(e){const n=[];return e.forEach(i=>{const a=this.Xr(i);a!==null&&n.push(a)}),n}removeMutationBatch(e,n){tt(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return re.forEach(n.mutations,a=>{const l=new ln(a.key,n.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.Zr=i})}ir(e){}containsKey(e,n){const i=new ln(n,0),a=this.Zr.firstAfterOrEqual(i);return re.resolve(n.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,re.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RC{constructor(e){this.ri=e,this.docs=function(){return new Mt(Te.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const i=n.key,a=this.docs.get(i),l=a?a.size:0,f=this.ri(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:f}),this.size+=f-l,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const i=this.docs.get(n);return re.resolve(i?i.document.mutableCopy():bn.newInvalidDocument(n))}getEntries(e,n){let i=Di();return n.forEach(a=>{const l=this.docs.get(a);i=i.insert(a,l?l.document.mutableCopy():bn.newInvalidDocument(a))}),re.resolve(i)}getDocumentsMatchingQuery(e,n,i,a){let l=Di();const f=n.path,y=new Te(f.child("__id-9223372036854775808__")),x=this.docs.getIteratorFrom(y);for(;x.hasNext();){const{key:m,value:{document:C}}=x.getNext();if(!f.isPrefixOf(m.path))break;m.path.length>f.length+1||n3(t3(C),i)<=0||(a.has(C.key)||Qc(n,C))&&(l=l.insert(C.key,C.mutableCopy()))}return re.resolve(l)}getAllFromCollectionGroup(e,n,i,a){Re(9500)}ii(e,n){return re.forEach(this.docs,i=>n(i))}newChangeBuffer(e){return new NC(this)}getSize(e){return re.resolve(this.size)}}class NC extends _C{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((i,a)=>{a.isValidDocument()?n.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(i)}),re.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bC{constructor(e){this.persistence=e,this.si=new ro(n=>xd(n),Ed),this.lastRemoteSnapshotVersion=Oe.min(),this.highestTargetId=0,this.oi=0,this._i=new Sd,this.targetCount=0,this.ai=na.ur()}forEachTarget(e,n){return this.si.forEach((i,a)=>n(a)),re.resolve()}getLastRemoteSnapshotVersion(e){return re.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return re.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),re.resolve(this.highestTargetId)}setTargetsMetadata(e,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.oi&&(this.oi=n),re.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new na(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,re.resolve()}updateTargetData(e,n){return this.Pr(n),re.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,re.resolve()}removeTargets(e,n,i){let a=0;const l=[];return this.si.forEach((f,y)=>{y.sequenceNumber<=n&&i.get(y.targetId)===null&&(this.si.delete(f),l.push(this.removeMatchingKeysForTargetId(e,y.targetId)),a++)}),re.waitFor(l).next(()=>a)}getTargetCount(e){return re.resolve(this.targetCount)}getTargetData(e,n){const i=this.si.get(n)||null;return re.resolve(i)}addMatchingKeys(e,n,i){return this._i.Wr(n,i),re.resolve()}removeMatchingKeys(e,n,i){this._i.zr(n,i);const a=this.persistence.referenceDelegate,l=[];return a&&n.forEach(f=>{l.push(a.markPotentiallyOrphaned(e,f))}),re.waitFor(l)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),re.resolve()}getMatchingKeysForTargetId(e,n){const i=this._i.Hr(n);return re.resolve(i)}containsKey(e,n){return re.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xy{constructor(e,n){this.ui={},this.overlays={},this.ci=new Xc(0),this.li=!1,this.li=!0,this.hi=new vC,this.referenceDelegate=e(this),this.Pi=new bC(this),this.indexManager=new gC,this.remoteDocumentCache=function(a){return new RC(a)}(i=>this.referenceDelegate.Ti(i)),this.serializer=new fC(n),this.Ii=new IC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new TC,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let i=this.ui[e.toKey()];return i||(i=new SC(n,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,i){ye("MemoryPersistence","Starting transaction:",e);const a=new DC(this.ci.next());return this.referenceDelegate.Ei(),i(a).next(l=>this.referenceDelegate.di(a).next(()=>l)).toPromise().then(l=>(a.raiseOnCommittedEvent(),l))}Ai(e,n){return re.or(Object.values(this.ui).map(i=>()=>i.containsKey(e,n)))}}class DC extends i3{constructor(e){super(),this.currentSequenceNumber=e}}class Rd{constructor(e){this.persistence=e,this.Ri=new Sd,this.Vi=null}static mi(e){return new Rd(e)}get fi(){if(this.Vi)return this.Vi;throw Re(60996)}addReference(e,n,i){return this.Ri.addReference(i,n),this.fi.delete(i.toString()),re.resolve()}removeReference(e,n,i){return this.Ri.removeReference(i,n),this.fi.add(i.toString()),re.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),re.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(a=>this.fi.add(a.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,n.targetId).next(a=>{a.forEach(l=>this.fi.add(l.toString()))}).next(()=>i.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return re.forEach(this.fi,i=>{const a=Te.fromPath(i);return this.gi(e,a).next(l=>{l||n.removeEntry(a,Oe.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(i=>{i?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return re.or([()=>re.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Ac{constructor(e,n){this.persistence=e,this.pi=new ro(i=>a3(i.path),(i,a)=>i.isEqual(a)),this.garbageCollector=EC(this,n)}static mi(e,n){return new Ac(e,n)}Ei(){}di(e){return re.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(i=>n.next(a=>i+a))}wr(e){let n=0;return this.pr(e,i=>{n++}).next(()=>n)}pr(e,n){return re.forEach(this.pi,(i,a)=>this.br(e,i,a).next(l=>l?re.resolve():n(a)))}removeTargets(e,n,i){return this.persistence.getTargetCache().removeTargets(e,n,i)}removeOrphanedDocuments(e,n){let i=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ii(e,f=>this.br(e,f,n).next(y=>{y||(i++,l.removeEntry(f,Oe.min()))})).next(()=>l.apply(e)).next(()=>i)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),re.resolve()}removeTarget(e,n){const i=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),re.resolve()}removeReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),re.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),re.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=ku(e.data.value)),n}br(e,n,i){return re.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const a=this.pi.get(n);return re.resolve(a!==void 0&&a>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(e,n,i,a){this.targetId=e,this.fromCache=n,this.Es=i,this.ds=a}static As(e,n){let i=We(),a=We();for(const l of n.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new Nd(e,n.fromCache,i,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OC{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return x_()?8:s3(hd())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,i,a){const l={result:null};return this.ys(e,n).next(f=>{l.result=f}).next(()=>{if(!l.result)return this.ws(e,n,a,i).next(f=>{l.result=f})}).next(()=>{if(l.result)return;const f=new OC;return this.Ss(e,n,f).next(y=>{if(l.result=y,this.Vs)return this.bs(e,n,f,y.size)})}).next(()=>l.result)}bs(e,n,i,a){return i.documentReadCount<this.fs?(Eo()<=Qe.DEBUG&&ye("QueryEngine","SDK will not create cache indexes for query:",_o(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),re.resolve()):(Eo()<=Qe.DEBUG&&ye("QueryEngine","Query:",_o(n),"scans",i.documentReadCount,"local documents and returns",a,"documents as results."),i.documentReadCount>this.gs*a?(Eo()<=Qe.DEBUG&&ye("QueryEngine","The SDK decides to create cache indexes for query:",_o(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ai(n))):re.resolve())}ys(e,n){if(Fg(n))return re.resolve(null);let i=ai(n);return this.indexManager.getIndexType(e,i).next(a=>a===0?null:(n.limit!==null&&a===1&&(n=wc(n,null,"F"),i=ai(n)),this.indexManager.getDocumentsMatchingTarget(e,i).next(l=>{const f=We(...l);return this.ps.getDocuments(e,f).next(y=>this.indexManager.getMinOffset(e,i).next(x=>{const m=this.Ds(n,y);return this.Cs(n,m,f,x.readTime)?this.ys(e,wc(n,null,"F")):this.vs(e,m,n,x)}))})))}ws(e,n,i,a){return Fg(n)||a.isEqual(Oe.min())?re.resolve(null):this.ps.getDocuments(e,i).next(l=>{const f=this.Ds(n,l);return this.Cs(n,f,i,a)?re.resolve(null):(Eo()<=Qe.DEBUG&&ye("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),_o(n)),this.vs(e,f,n,e3(a,_l)).next(y=>y))})}Ds(e,n){let i=new en(Cy(e));return n.forEach((a,l)=>{Qc(e,l)&&(i=i.add(l))}),i}Cs(e,n,i,a){if(e.limit===null)return!1;if(i.size!==n.size)return!0;const l=e.limitType==="F"?n.last():n.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}Ss(e,n,i){return Eo()<=Qe.DEBUG&&ye("QueryEngine","Using full collection scan to execute query:",_o(n)),this.ps.getDocumentsMatchingQuery(e,n,ms.min(),i)}vs(e,n,i,a){return this.ps.getDocumentsMatchingQuery(e,i,a).next(l=>(n.forEach(f=>{l=l.insert(f.key,f)}),l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bd="LocalStore",MC=3e8;class kC{constructor(e,n,i,a){this.persistence=e,this.Fs=n,this.serializer=a,this.Ms=new Mt(Ge),this.xs=new ro(l=>xd(l),Ed),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new CC(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function LC(t,e,n,i){return new kC(t,e,n,i)}async function qy(t,e){const n=De(t);return await n.persistence.runTransaction("Handle user change","readonly",i=>{let a;return n.mutationQueue.getAllMutationBatches(i).next(l=>(a=l,n.Bs(e),n.mutationQueue.getAllMutationBatches(i))).next(l=>{const f=[],y=[];let x=We();for(const m of a){f.push(m.batchId);for(const C of m.mutations)x=x.add(C.key)}for(const m of l){y.push(m.batchId);for(const C of m.mutations)x=x.add(C.key)}return n.localDocuments.getDocuments(i,x).next(m=>({Ls:m,removedBatchIds:f,addedBatchIds:y}))})})}function BC(t,e){const n=De(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const a=e.batch.keys(),l=n.Ns.newChangeBuffer({trackRemovals:!0});return function(y,x,m,C){const v=m.batch,D=v.keys();let V=re.resolve();return D.forEach(Y=>{V=V.next(()=>C.getEntry(x,Y)).next(X=>{const ne=m.docVersions.get(Y);tt(ne!==null,48541),X.version.compareTo(ne)<0&&(v.applyToRemoteDocument(X,m),X.isValidDocument()&&(X.setReadTime(m.commitVersion),C.addEntry(X)))})}),V.next(()=>y.mutationQueue.removeMutationBatch(x,v))}(n,i,e,l).next(()=>l.apply(i)).next(()=>n.mutationQueue.performConsistencyCheck(i)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(i,a,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(y){let x=We();for(let m=0;m<y.mutationResults.length;++m)y.mutationResults[m].transformResults.length>0&&(x=x.add(y.batch.mutations[m].key));return x}(e))).next(()=>n.localDocuments.getDocuments(i,a))})}function Ky(t){const e=De(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function FC(t,e){const n=De(t),i=e.snapshotVersion;let a=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",l=>{const f=n.Ns.newChangeBuffer({trackRemovals:!0});a=n.Ms;const y=[];e.targetChanges.forEach((C,v)=>{const D=a.get(v);if(!D)return;y.push(n.Pi.removeMatchingKeys(l,C.removedDocuments,v).next(()=>n.Pi.addMatchingKeys(l,C.addedDocuments,v)));let V=D.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(v)!==null?V=V.withResumeToken(_n.EMPTY_BYTE_STRING,Oe.min()).withLastLimboFreeSnapshotVersion(Oe.min()):C.resumeToken.approximateByteSize()>0&&(V=V.withResumeToken(C.resumeToken,i)),a=a.insert(v,V),function(X,ne,H){return X.resumeToken.approximateByteSize()===0||ne.snapshotVersion.toMicroseconds()-X.snapshotVersion.toMicroseconds()>=MC?!0:H.addedDocuments.size+H.modifiedDocuments.size+H.removedDocuments.size>0}(D,V,C)&&y.push(n.Pi.updateTargetData(l,V))});let x=Di(),m=We();if(e.documentUpdates.forEach(C=>{e.resolvedLimboDocuments.has(C)&&y.push(n.persistence.referenceDelegate.updateLimboDocument(l,C))}),y.push(VC(l,f,e.documentUpdates).next(C=>{x=C.ks,m=C.qs})),!i.isEqual(Oe.min())){const C=n.Pi.getLastRemoteSnapshotVersion(l).next(v=>n.Pi.setTargetsMetadata(l,l.currentSequenceNumber,i));y.push(C)}return re.waitFor(y).next(()=>f.apply(l)).next(()=>n.localDocuments.getLocalViewOfDocuments(l,x,m)).next(()=>x)}).then(l=>(n.Ms=a,l))}function VC(t,e,n){let i=We(),a=We();return n.forEach(l=>i=i.add(l)),e.getEntries(t,i).next(l=>{let f=Di();return n.forEach((y,x)=>{const m=l.get(y);x.isFoundDocument()!==m.isFoundDocument()&&(a=a.add(y)),x.isNoDocument()&&x.version.isEqual(Oe.min())?(e.removeEntry(y,x.readTime),f=f.insert(y,x)):!m.isValidDocument()||x.version.compareTo(m.version)>0||x.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(x),f=f.insert(y,x)):ye(bd,"Ignoring outdated watch update for ",y,". Current version:",m.version," Watch version:",x.version)}),{ks:f,qs:a}})}function UC(t,e){const n=De(t);return n.persistence.runTransaction("Get next mutation batch","readonly",i=>(e===void 0&&(e=md),n.mutationQueue.getNextMutationBatchAfterBatchId(i,e)))}function zC(t,e){const n=De(t);return n.persistence.runTransaction("Allocate target","readwrite",i=>{let a;return n.Pi.getTargetData(i,e).next(l=>l?(a=l,re.resolve(a)):n.Pi.allocateTargetId(i).next(f=>(a=new ts(e,f,"TargetPurposeListen",i.currentSequenceNumber),n.Pi.addTargetData(i,a).next(()=>a))))}).then(i=>{const a=n.Ms.get(i.targetId);return(a===null||i.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(i.targetId,i),n.xs.set(e,i.targetId)),i})}async function a1(t,e,n){const i=De(t),a=i.Ms.get(e),l=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",l,f=>i.persistence.referenceDelegate.removeTarget(f,a))}catch(f){if(!ca(f))throw f;ye(bd,`Failed to update sequence numbers for target ${e}: ${f}`)}i.Ms=i.Ms.remove(e),i.xs.delete(a.target)}function Zg(t,e,n){const i=De(t);let a=Oe.min(),l=We();return i.persistence.runTransaction("Execute query","readwrite",f=>function(x,m,C){const v=De(x),D=v.xs.get(C);return D!==void 0?re.resolve(v.Ms.get(D)):v.Pi.getTargetData(m,C)}(i,f,ai(e)).next(y=>{if(y)return a=y.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(f,y.targetId).next(x=>{l=x})}).next(()=>i.Fs.getDocumentsMatchingQuery(f,e,n?a:Oe.min(),n?l:We())).next(y=>(HC(i,v3(e),y),{documents:y,Qs:l})))}function HC(t,e,n){let i=t.Os.get(e)||Oe.min();n.forEach((a,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)}),t.Os.set(e,i)}class $g{constructor(){this.activeTargetIds=O3()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class GC{constructor(){this.Mo=new $g,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,i){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,i){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new $g,Promise.resolve()}handleUserChange(e,n,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WC{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jg="ConnectivityMonitor";class ep{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ye(Jg,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ye(Jg,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _u=null;function l1(){return _u===null?_u=function(){return 268435456+Math.round(2147483648*Math.random())}():_u++,"0x"+_u.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yh="RestConnection",jC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class XC{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${i}/databases/${a}`,this.Wo=this.databaseId.database===pc?`project_id=${i}`:`project_id=${i}&database_id=${a}`}Go(e,n,i,a,l){const f=l1(),y=this.zo(e,n.toUriEncodedString());ye(Yh,`Sending RPC '${e}' ${f}:`,y,i);const x={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(x,a,l);const{host:m}=new URL(y),C=cd(m);return this.Jo(e,y,x,i,C).then(v=>(ye(Yh,`Received RPC '${e}' ${f}: `,v),v),v=>{throw $o(Yh,`RPC '${e}' ${f} failed with error: `,v,"url: ",y,"request:",i),v})}Ho(e,n,i,a,l,f){return this.Go(e,n,i,a,l)}jo(e,n,i){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+la}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((a,l)=>e[l]=a),i&&i.headers.forEach((a,l)=>e[l]=a)}zo(e,n){const i=jC[e];return`${this.Uo}/v1/${n}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sn="WebChannelConnection";class KC extends XC{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,i,a,l){const f=l1();return new Promise((y,x)=>{const m=new Y2;m.setWithCredentials(!0),m.listenOnce(Q2.COMPLETE,()=>{try{switch(m.getLastErrorCode()){case Mu.NO_ERROR:const v=m.getResponseJson();ye(Sn,`XHR for RPC '${e}' ${f} received:`,JSON.stringify(v)),y(v);break;case Mu.TIMEOUT:ye(Sn,`RPC '${e}' ${f} timed out`),x(new pe(te.DEADLINE_EXCEEDED,"Request time out"));break;case Mu.HTTP_ERROR:const D=m.getStatus();if(ye(Sn,`RPC '${e}' ${f} failed with status:`,D,"response text:",m.getResponseText()),D>0){let V=m.getResponseJson();Array.isArray(V)&&(V=V[0]);const Y=V==null?void 0:V.error;if(Y&&Y.status&&Y.message){const X=function(H){const k=H.toLowerCase().replace(/_/g,"-");return Object.values(te).indexOf(k)>=0?k:te.UNKNOWN}(Y.status);x(new pe(X,Y.message))}else x(new pe(te.UNKNOWN,"Server responded with status "+m.getStatus()))}else x(new pe(te.UNAVAILABLE,"Connection failed."));break;default:Re(9055,{l_:e,streamId:f,h_:m.getLastErrorCode(),P_:m.getLastError()})}}finally{ye(Sn,`RPC '${e}' ${f} completed.`)}});const C=JSON.stringify(a);ye(Sn,`RPC '${e}' ${f} sending request:`,a),m.send(n,"POST",C,i,15)})}T_(e,n,i){const a=l1(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],f=J2(),y=$2(),x={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(x.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(x.useFetchStreams=!0),this.jo(x.initMessageHeaders,n,i),x.encodeInitMessageHeaders=!0;const C=l.join("");ye(Sn,`Creating RPC '${e}' stream ${a}: ${C}`,x);const v=f.createWebChannel(C,x);this.I_(v);let D=!1,V=!1;const Y=new qC({Yo:ne=>{V?ye(Sn,`Not sending because RPC '${e}' stream ${a} is closed:`,ne):(D||(ye(Sn,`Opening RPC '${e}' stream ${a} transport.`),v.open(),D=!0),ye(Sn,`RPC '${e}' stream ${a} sending:`,ne),v.send(ne))},Zo:()=>v.close()}),X=(ne,H,k)=>{ne.listen(H,B=>{try{k(B)}catch($){setTimeout(()=>{throw $},0)}})};return X(v,Fa.EventType.OPEN,()=>{V||(ye(Sn,`RPC '${e}' stream ${a} transport opened.`),Y.o_())}),X(v,Fa.EventType.CLOSE,()=>{V||(V=!0,ye(Sn,`RPC '${e}' stream ${a} transport closed`),Y.a_(),this.E_(v))}),X(v,Fa.EventType.ERROR,ne=>{V||(V=!0,$o(Sn,`RPC '${e}' stream ${a} transport errored. Name:`,ne.name,"Message:",ne.message),Y.a_(new pe(te.UNAVAILABLE,"The operation could not be completed")))}),X(v,Fa.EventType.MESSAGE,ne=>{var H;if(!V){const k=ne.data[0];tt(!!k,16349);const B=k,$=(B==null?void 0:B.error)||((H=B[0])==null?void 0:H.error);if($){ye(Sn,`RPC '${e}' stream ${a} received error:`,$);const ce=$.status;let se=function(b){const F=qt[b];if(F!==void 0)return My(F)}(ce),N=$.message;se===void 0&&(se=te.INTERNAL,N="Unknown error status: "+ce+" with message "+$.message),V=!0,Y.a_(new pe(se,N)),v.close()}else ye(Sn,`RPC '${e}' stream ${a} received:`,k),Y.u_(k)}}),X(y,Z2.STAT_EVENT,ne=>{ne.stat===Qf.PROXY?ye(Sn,`RPC '${e}' stream ${a} detected buffering proxy`):ne.stat===Qf.NOPROXY&&ye(Sn,`RPC '${e}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{Y.__()},0),Y}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function Qh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eh(t){return new $3(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yy{constructor(e,n,i=1e3,a=1.5,l=6e4){this.Mi=e,this.timerId=n,this.d_=i,this.A_=a,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),a=Math.max(0,n-i);a>0&&ye("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tp="PersistentStream";class Qy{constructor(e,n,i,a,l,f,y,x){this.Mi=e,this.S_=i,this.b_=a,this.connection=l,this.authCredentialsProvider=f,this.appCheckCredentialsProvider=y,this.listener=x,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Yy(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===te.RESOURCE_EXHAUSTED?(bi(n.toString()),bi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===te.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,a])=>{this.D_===n&&this.G_(i,a)},i=>{e(()=>{const a=new pe(te.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(a)})})}G_(e,n){const i=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{i(()=>this.listener.Xo())}),this.stream.t_(()=>{i(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(a=>{i(()=>this.z_(a))}),this.stream.onMessage(a=>{i(()=>++this.F_==1?this.J_(a):this.onNext(a))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ye(tp,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(ye(tp,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class YC extends Qy{constructor(e,n,i,a,l,f){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,a,f),this.serializer=l}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=tC(this.serializer,e),i=function(l){if(!("targetChange"in l))return Oe.min();const f=l.targetChange;return f.targetIds&&f.targetIds.length?Oe.min():f.readTime?li(f.readTime):Oe.min()}(e);return this.listener.H_(n,i)}Y_(e){const n={};n.database=o1(this.serializer),n.addTarget=function(l,f){let y;const x=f.target;if(y=t1(x)?{documents:iC(l,x)}:{query:zy(l,x).ft},y.targetId=f.targetId,f.resumeToken.approximateByteSize()>0){y.resumeToken=By(l,f.resumeToken);const m=r1(l,f.expectedCount);m!==null&&(y.expectedCount=m)}else if(f.snapshotVersion.compareTo(Oe.min())>0){y.readTime=_c(l,f.snapshotVersion.toTimestamp());const m=r1(l,f.expectedCount);m!==null&&(y.expectedCount=m)}return y}(this.serializer,e);const i=aC(this.serializer,e);i&&(n.labels=i),this.q_(n)}Z_(e){const n={};n.database=o1(this.serializer),n.removeTarget=e,this.q_(n)}}class QC extends Qy{constructor(e,n,i,a,l,f){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,a,f),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return tt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,tt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){tt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=rC(e.writeResults,e.commitTime),i=li(e.commitTime);return this.listener.na(i,n)}ra(){const e={};e.database=o1(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(i=>nC(this.serializer,i))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{}class $C extends ZC{constructor(e,n,i,a){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=i,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new pe(te.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([l,f])=>this.connection.Go(e,i1(n,i),a,l,f)).catch(l=>{throw l.name==="FirebaseError"?(l.code===te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new pe(te.UNKNOWN,l.toString())})}Ho(e,n,i,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([f,y])=>this.connection.Ho(e,i1(n,i),a,f,y,l)).catch(f=>{throw f.name==="FirebaseError"?(f.code===te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),f):new pe(te.UNKNOWN,f.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class JC{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(bi(n),this.aa=!1):ye("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Js="RemoteStore";class eI{constructor(e,n,i,a,l){this.localStore=e,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo(f=>{i.enqueueAndForget(async()=>{io(this)&&(ye(Js,"Restarting streams for network reachability change."),await async function(x){const m=De(x);m.Ea.add(4),await Ll(m),m.Ra.set("Unknown"),m.Ea.delete(4),await th(m)}(this))})}),this.Ra=new JC(i,a)}}async function th(t){if(io(t))for(const e of t.da)await e(!0)}async function Ll(t){for(const e of t.da)await e(!1)}function Zy(t,e){const n=De(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Md(n)?Pd(n):ha(n).O_()&&Od(n,e))}function Dd(t,e){const n=De(t),i=ha(n);n.Ia.delete(e),i.O_()&&$y(n,e),n.Ia.size===0&&(i.O_()?i.L_():io(n)&&n.Ra.set("Unknown"))}function Od(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Oe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ha(t).Y_(e)}function $y(t,e){t.Va.Ue(e),ha(t).Z_(e)}function Pd(t){t.Va=new K3({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),ha(t).start(),t.Ra.ua()}function Md(t){return io(t)&&!ha(t).x_()&&t.Ia.size>0}function io(t){return De(t).Ea.size===0}function Jy(t){t.Va=void 0}async function tI(t){t.Ra.set("Online")}async function nI(t){t.Ia.forEach((e,n)=>{Od(t,e)})}async function rI(t,e){Jy(t),Md(t)?(t.Ra.ha(e),Pd(t)):t.Ra.set("Unknown")}async function iI(t,e,n){if(t.Ra.set("Online"),e instanceof Ly&&e.state===2&&e.cause)try{await async function(a,l){const f=l.cause;for(const y of l.targetIds)a.Ia.has(y)&&(await a.remoteSyncer.rejectListen(y,f),a.Ia.delete(y),a.Va.removeTarget(y))}(t,e)}catch(i){ye(Js,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Cc(t,i)}else if(e instanceof Fu?t.Va.Ze(e):e instanceof ky?t.Va.st(e):t.Va.tt(e),!n.isEqual(Oe.min()))try{const i=await Ky(t.localStore);n.compareTo(i)>=0&&await function(l,f){const y=l.Va.Tt(f);return y.targetChanges.forEach((x,m)=>{if(x.resumeToken.approximateByteSize()>0){const C=l.Ia.get(m);C&&l.Ia.set(m,C.withResumeToken(x.resumeToken,f))}}),y.targetMismatches.forEach((x,m)=>{const C=l.Ia.get(x);if(!C)return;l.Ia.set(x,C.withResumeToken(_n.EMPTY_BYTE_STRING,C.snapshotVersion)),$y(l,x);const v=new ts(C.target,x,m,C.sequenceNumber);Od(l,v)}),l.remoteSyncer.applyRemoteEvent(y)}(t,n)}catch(i){ye(Js,"Failed to raise snapshot:",i),await Cc(t,i)}}async function Cc(t,e,n){if(!ca(e))throw e;t.Ea.add(1),await Ll(t),t.Ra.set("Offline"),n||(n=()=>Ky(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ye(Js,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await th(t)})}function ew(t,e){return e().catch(n=>Cc(t,n,e))}async function nh(t){const e=De(t),n=Es(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:md;for(;sI(e);)try{const a=await UC(e.localStore,i);if(a===null){e.Ta.length===0&&n.L_();break}i=a.batchId,oI(e,a)}catch(a){await Cc(e,a)}tw(e)&&nw(e)}function sI(t){return io(t)&&t.Ta.length<10}function oI(t,e){t.Ta.push(e);const n=Es(t);n.O_()&&n.X_&&n.ea(e.mutations)}function tw(t){return io(t)&&!Es(t).x_()&&t.Ta.length>0}function nw(t){Es(t).start()}async function aI(t){Es(t).ra()}async function lI(t){const e=Es(t);for(const n of t.Ta)e.ea(n.mutations)}async function uI(t,e,n){const i=t.Ta.shift(),a=Id.from(i,e,n);await ew(t,()=>t.remoteSyncer.applySuccessfulWrite(a)),await nh(t)}async function cI(t,e){e&&Es(t).X_&&await async function(i,a){if(function(f){return j3(f)&&f!==te.ABORTED}(a.code)){const l=i.Ta.shift();Es(i).B_(),await ew(i,()=>i.remoteSyncer.rejectFailedWrite(l.batchId,a)),await nh(i)}}(t,e),tw(t)&&nw(t)}async function np(t,e){const n=De(t);n.asyncQueue.verifyOperationInProgress(),ye(Js,"RemoteStore received new credentials");const i=io(n);n.Ea.add(3),await Ll(n),i&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await th(n)}async function hI(t,e){const n=De(t);e?(n.Ea.delete(2),await th(n)):e||(n.Ea.add(2),await Ll(n),n.Ra.set("Unknown"))}function ha(t){return t.ma||(t.ma=function(n,i,a){const l=De(n);return l.sa(),new YC(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)}(t.datastore,t.asyncQueue,{Xo:tI.bind(null,t),t_:nI.bind(null,t),r_:rI.bind(null,t),H_:iI.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Md(t)?Pd(t):t.Ra.set("Unknown")):(await t.ma.stop(),Jy(t))})),t.ma}function Es(t){return t.fa||(t.fa=function(n,i,a){const l=De(n);return l.sa(),new QC(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:aI.bind(null,t),r_:cI.bind(null,t),ta:lI.bind(null,t),na:uI.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await nh(t)):(await t.fa.stop(),t.Ta.length>0&&(ye(Js,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kd{constructor(e,n,i,a,l){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=i,this.op=a,this.removalCallback=l,this.deferred=new oi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(f=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,i,a,l){const f=Date.now()+i,y=new kd(e,n,f,a,l);return y.start(i),y}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new pe(te.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ld(t,e){if(bi("AsyncQueue",`${e}: ${t}`),ca(t))return new pe(te.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go{static emptySet(e){return new Go(e.comparator)}constructor(e){this.comparator=e?(n,i)=>e(n,i)||Te.comparator(n.key,i.key):(n,i)=>Te.comparator(n.key,i.key),this.keyedMap=Va(),this.sortedSet=new Mt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,i)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Go)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;n.hasNext();){const a=n.getNext().key,l=i.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const i=new Go;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=n,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rp{constructor(){this.ga=new Mt(Te.comparator)}track(e){const n=e.doc.key,i=this.ga.get(n);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(n,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(n,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(n):e.type===1&&i.type===2?this.ga=this.ga.insert(n,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Re(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,i)=>{e.push(i)}),e}}class ra{constructor(e,n,i,a,l,f,y,x,m){this.query=e,this.docs=n,this.oldDocs=i,this.docChanges=a,this.mutatedKeys=l,this.fromCache=f,this.syncStateChanged=y,this.excludesMetadataChanges=x,this.hasCachedResults=m}static fromInitialDocuments(e,n,i,a,l){const f=[];return n.forEach(y=>{f.push({type:0,doc:y})}),new ra(e,n,Go.emptySet(n),f,i,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Yc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,i=e.docChanges;if(n.length!==i.length)return!1;for(let a=0;a<n.length;a++)if(n[a].type!==i[a].type||!n[a].doc.isEqual(i[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fI{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class dI{constructor(){this.queries=ip(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,i){const a=De(n),l=a.queries;a.queries=ip(),l.forEach((f,y)=>{for(const x of y.Sa)x.onError(i)})})(this,new pe(te.ABORTED,"Firestore shutting down"))}}function ip(){return new ro(t=>Ay(t),Yc)}async function rw(t,e){const n=De(t);let i=3;const a=e.query;let l=n.queries.get(a);l?!l.ba()&&e.Da()&&(i=2):(l=new fI,i=e.Da()?0:1);try{switch(i){case 0:l.wa=await n.onListen(a,!0);break;case 1:l.wa=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(f){const y=Ld(f,`Initialization of query '${_o(e.query)}' failed`);return void e.onError(y)}n.queries.set(a,l),l.Sa.push(e),e.va(n.onlineState),l.wa&&e.Fa(l.wa)&&Bd(n)}async function iw(t,e){const n=De(t),i=e.query;let a=3;const l=n.queries.get(i);if(l){const f=l.Sa.indexOf(e);f>=0&&(l.Sa.splice(f,1),l.Sa.length===0?a=e.Da()?0:1:!l.ba()&&e.Da()&&(a=2))}switch(a){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function gI(t,e){const n=De(t);let i=!1;for(const a of e){const l=a.query,f=n.queries.get(l);if(f){for(const y of f.Sa)y.Fa(a)&&(i=!0);f.wa=a}}i&&Bd(n)}function pI(t,e,n){const i=De(t),a=i.queries.get(e);if(a)for(const l of a.Sa)l.onError(n);i.queries.delete(e)}function Bd(t){t.Ca.forEach(e=>{e.next()})}var u1,sp;(sp=u1||(u1={})).Ma="default",sp.Cache="cache";class sw{constructor(e,n,i){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const a of e.docChanges)a.type!==3&&i.push(a);e=new ra(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const i=n!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=ra.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==u1.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ow{constructor(e){this.key=e}}class aw{constructor(e){this.key=e}}class mI{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=We(),this.mutatedKeys=We(),this.eu=Cy(e),this.tu=new Go(this.eu)}get nu(){return this.Ya}ru(e,n){const i=n?n.iu:new rp,a=n?n.tu:this.tu;let l=n?n.mutatedKeys:this.mutatedKeys,f=a,y=!1;const x=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,m=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((C,v)=>{const D=a.get(C),V=Qc(this.query,v)?v:null,Y=!!D&&this.mutatedKeys.has(D.key),X=!!V&&(V.hasLocalMutations||this.mutatedKeys.has(V.key)&&V.hasCommittedMutations);let ne=!1;D&&V?D.data.isEqual(V.data)?Y!==X&&(i.track({type:3,doc:V}),ne=!0):this.su(D,V)||(i.track({type:2,doc:V}),ne=!0,(x&&this.eu(V,x)>0||m&&this.eu(V,m)<0)&&(y=!0)):!D&&V?(i.track({type:0,doc:V}),ne=!0):D&&!V&&(i.track({type:1,doc:D}),ne=!0,(x||m)&&(y=!0)),ne&&(V?(f=f.add(V),l=X?l.add(C):l.delete(C)):(f=f.delete(C),l=l.delete(C)))}),this.query.limit!==null)for(;f.size>this.query.limit;){const C=this.query.limitType==="F"?f.last():f.first();f=f.delete(C.key),l=l.delete(C.key),i.track({type:1,doc:C})}return{tu:f,iu:i,Cs:y,mutatedKeys:l}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,i,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const f=e.iu.ya();f.sort((C,v)=>function(V,Y){const X=ne=>{switch(ne){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Re(20277,{Rt:ne})}};return X(V)-X(Y)}(C.type,v.type)||this.eu(C.doc,v.doc)),this.ou(i),a=a??!1;const y=n&&!a?this._u():[],x=this.Xa.size===0&&this.current&&!a?1:0,m=x!==this.Za;return this.Za=x,f.length!==0||m?{snapshot:new ra(this.query,e.tu,l,f,e.mutatedKeys,x===0,m,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:y}:{au:y}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new rp,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=We(),this.tu.forEach(i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))});const n=[];return e.forEach(i=>{this.Xa.has(i)||n.push(new aw(i))}),this.Xa.forEach(i=>{e.has(i)||n.push(new ow(i))}),n}cu(e){this.Ya=e.Qs,this.Xa=We();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return ra.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Fd="SyncEngine";class yI{constructor(e,n,i){this.query=e,this.targetId=n,this.view=i}}class wI{constructor(e){this.key=e,this.hu=!1}}class xI{constructor(e,n,i,a,l,f){this.localStore=e,this.remoteStore=n,this.eventManager=i,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=f,this.Pu={},this.Tu=new ro(y=>Ay(y),Yc),this.Iu=new Map,this.Eu=new Set,this.du=new Mt(Te.comparator),this.Au=new Map,this.Ru=new Sd,this.Vu={},this.mu=new Map,this.fu=na.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function EI(t,e,n=!0){const i=dw(t);let a;const l=i.Tu.get(e);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await lw(i,e,n,!0),a}async function _I(t,e){const n=dw(t);await lw(n,e,!0,!1)}async function lw(t,e,n,i){const a=await zC(t.localStore,ai(e)),l=a.targetId,f=t.sharedClientState.addLocalQueryTarget(l,n);let y;return i&&(y=await AI(t,e,l,f==="current",a.resumeToken)),t.isPrimaryClient&&n&&Zy(t.remoteStore,a),y}async function AI(t,e,n,i,a){t.pu=(v,D,V)=>async function(X,ne,H,k){let B=ne.view.ru(H);B.Cs&&(B=await Zg(X.localStore,ne.query,!1).then(({documents:N})=>ne.view.ru(N,B)));const $=k&&k.targetChanges.get(ne.targetId),ce=k&&k.targetMismatches.get(ne.targetId)!=null,se=ne.view.applyChanges(B,X.isPrimaryClient,$,ce);return ap(X,ne.targetId,se.au),se.snapshot}(t,v,D,V);const l=await Zg(t.localStore,e,!0),f=new mI(e,l.Qs),y=f.ru(l.documents),x=kl.createSynthesizedTargetChangeForCurrentChange(n,i&&t.onlineState!=="Offline",a),m=f.applyChanges(y,t.isPrimaryClient,x);ap(t,n,m.au);const C=new yI(e,n,f);return t.Tu.set(e,C),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),m.snapshot}async function CI(t,e,n){const i=De(t),a=i.Tu.get(e),l=i.Iu.get(a.targetId);if(l.length>1)return i.Iu.set(a.targetId,l.filter(f=>!Yc(f,e))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(a.targetId),i.sharedClientState.isActiveQueryTarget(a.targetId)||await a1(i.localStore,a.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(a.targetId),n&&Dd(i.remoteStore,a.targetId),c1(i,a.targetId)}).catch(ua)):(c1(i,a.targetId),await a1(i.localStore,a.targetId,!0))}async function II(t,e){const n=De(t),i=n.Tu.get(e),a=n.Iu.get(i.targetId);n.isPrimaryClient&&a.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),Dd(n.remoteStore,i.targetId))}async function TI(t,e,n){const i=OI(t);try{const a=await function(f,y){const x=De(f),m=Ct.now(),C=y.reduce((V,Y)=>V.add(Y.key),We());let v,D;return x.persistence.runTransaction("Locally write mutations","readwrite",V=>{let Y=Di(),X=We();return x.Ns.getEntries(V,C).next(ne=>{Y=ne,Y.forEach((H,k)=>{k.isValidDocument()||(X=X.add(H))})}).next(()=>x.localDocuments.getOverlayedDocuments(V,Y)).next(ne=>{v=ne;const H=[];for(const k of y){const B=V3(k,v.get(k.key).overlayedDocument);B!=null&&H.push(new vs(k.key,B,dy(B.value.mapValue),vr.exists(!0)))}return x.mutationQueue.addMutationBatch(V,m,H,y)}).next(ne=>{D=ne;const H=ne.applyToLocalDocumentSet(v,X);return x.documentOverlayCache.saveOverlays(V,ne.batchId,H)})}).then(()=>({batchId:D.batchId,changes:Ty(v)}))}(i.localStore,e);i.sharedClientState.addPendingMutation(a.batchId),function(f,y,x){let m=f.Vu[f.currentUser.toKey()];m||(m=new Mt(Ge)),m=m.insert(y,x),f.Vu[f.currentUser.toKey()]=m}(i,a.batchId,n),await Bl(i,a.changes),await nh(i.remoteStore)}catch(a){const l=Ld(a,"Failed to persist write");n.reject(l)}}async function uw(t,e){const n=De(t);try{const i=await FC(n.localStore,e);e.targetChanges.forEach((a,l)=>{const f=n.Au.get(l);f&&(tt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?f.hu=!0:a.modifiedDocuments.size>0?tt(f.hu,14607):a.removedDocuments.size>0&&(tt(f.hu,42227),f.hu=!1))}),await Bl(n,i,e)}catch(i){await ua(i)}}function op(t,e,n){const i=De(t);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const a=[];i.Tu.forEach((l,f)=>{const y=f.view.va(e);y.snapshot&&a.push(y.snapshot)}),function(f,y){const x=De(f);x.onlineState=y;let m=!1;x.queries.forEach((C,v)=>{for(const D of v.Sa)D.va(y)&&(m=!0)}),m&&Bd(x)}(i.eventManager,e),a.length&&i.Pu.H_(a),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function vI(t,e,n){const i=De(t);i.sharedClientState.updateQueryState(e,"rejected",n);const a=i.Au.get(e),l=a&&a.key;if(l){let f=new Mt(Te.comparator);f=f.insert(l,bn.newNoDocument(l,Oe.min()));const y=We().add(l),x=new Jc(Oe.min(),new Map,new Mt(Ge),f,y);await uw(i,x),i.du=i.du.remove(l),i.Au.delete(e),Vd(i)}else await a1(i.localStore,e,!1).then(()=>c1(i,e,n)).catch(ua)}async function SI(t,e){const n=De(t),i=e.batch.batchId;try{const a=await BC(n.localStore,e);hw(n,i,null),cw(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await Bl(n,a)}catch(a){await ua(a)}}async function RI(t,e,n){const i=De(t);try{const a=await function(f,y){const x=De(f);return x.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let C;return x.mutationQueue.lookupMutationBatch(m,y).next(v=>(tt(v!==null,37113),C=v.keys(),x.mutationQueue.removeMutationBatch(m,v))).next(()=>x.mutationQueue.performConsistencyCheck(m)).next(()=>x.documentOverlayCache.removeOverlaysForBatchId(m,C,y)).next(()=>x.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,C)).next(()=>x.localDocuments.getDocuments(m,C))})}(i.localStore,e);hw(i,e,n),cw(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await Bl(i,a)}catch(a){await ua(a)}}function cw(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function hw(t,e,n){const i=De(t);let a=i.Vu[i.currentUser.toKey()];if(a){const l=a.get(e);l&&(n?l.reject(n):l.resolve(),a=a.remove(e)),i.Vu[i.currentUser.toKey()]=a}}function c1(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.Iu.get(e))t.Tu.delete(i),n&&t.Pu.yu(i,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(i=>{t.Ru.containsKey(i)||fw(t,i)})}function fw(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Dd(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),Vd(t))}function ap(t,e,n){for(const i of n)i instanceof ow?(t.Ru.addReference(i.key,e),NI(t,i)):i instanceof aw?(ye(Fd,"Document no longer in limbo: "+i.key),t.Ru.removeReference(i.key,e),t.Ru.containsKey(i.key)||fw(t,i.key)):Re(19791,{wu:i})}function NI(t,e){const n=e.key,i=n.path.canonicalString();t.du.get(n)||t.Eu.has(i)||(ye(Fd,"New document in limbo: "+n),t.Eu.add(i),Vd(t))}function Vd(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new Te(pt.fromString(e)),i=t.fu.next();t.Au.set(i,new wI(n)),t.du=t.du.insert(n,i),Zy(t.remoteStore,new ts(ai(_d(n.path)),i,"TargetPurposeLimboResolution",Xc.ce))}}async function Bl(t,e,n){const i=De(t),a=[],l=[],f=[];i.Tu.isEmpty()||(i.Tu.forEach((y,x)=>{f.push(i.pu(x,e,n).then(m=>{var C;if((m||n)&&i.isPrimaryClient){const v=m?!m.fromCache:(C=n==null?void 0:n.targetChanges.get(x.targetId))==null?void 0:C.current;i.sharedClientState.updateQueryState(x.targetId,v?"current":"not-current")}if(m){a.push(m);const v=Nd.As(x.targetId,m);l.push(v)}}))}),await Promise.all(f),i.Pu.H_(a),await async function(x,m){const C=De(x);try{await C.persistence.runTransaction("notifyLocalViewChanges","readwrite",v=>re.forEach(m,D=>re.forEach(D.Es,V=>C.persistence.referenceDelegate.addReference(v,D.targetId,V)).next(()=>re.forEach(D.ds,V=>C.persistence.referenceDelegate.removeReference(v,D.targetId,V)))))}catch(v){if(!ca(v))throw v;ye(bd,"Failed to update sequence numbers: "+v)}for(const v of m){const D=v.targetId;if(!v.fromCache){const V=C.Ms.get(D),Y=V.snapshotVersion,X=V.withLastLimboFreeSnapshotVersion(Y);C.Ms=C.Ms.insert(D,X)}}}(i.localStore,l))}async function bI(t,e){const n=De(t);if(!n.currentUser.isEqual(e)){ye(Fd,"User change. New user:",e.toKey());const i=await qy(n.localStore,e);n.currentUser=e,function(l,f){l.mu.forEach(y=>{y.forEach(x=>{x.reject(new pe(te.CANCELLED,f))})}),l.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Bl(n,i.Ls)}}function DI(t,e){const n=De(t),i=n.Au.get(e);if(i&&i.hu)return We().add(i.key);{let a=We();const l=n.Iu.get(e);if(!l)return a;for(const f of l){const y=n.Tu.get(f);a=a.unionWith(y.view.nu)}return a}}function dw(t){const e=De(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=uw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=DI.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=vI.bind(null,e),e.Pu.H_=gI.bind(null,e.eventManager),e.Pu.yu=pI.bind(null,e.eventManager),e}function OI(t){const e=De(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=SI.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=RI.bind(null,e),e}class Ic{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=eh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return LC(this.persistence,new PC,e.initialUser,this.serializer)}Cu(e){return new Xy(Rd.mi,this.serializer)}Du(e){return new GC}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ic.provider={build:()=>new Ic};class PI extends Ic{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){tt(this.persistence.referenceDelegate instanceof Ac,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new wC(i,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Xn.withCacheSize(this.cacheSizeBytes):Xn.DEFAULT;return new Xy(i=>Ac.mi(i,n),this.serializer)}}class h1{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>op(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=bI.bind(null,this.syncEngine),await hI(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new dI}()}createDatastore(e){const n=eh(e.databaseInfo.databaseId),i=function(l){return new KC(l)}(e.databaseInfo);return function(l,f,y,x){return new $C(l,f,y,x)}(e.authCredentials,e.appCheckCredentials,i,n)}createRemoteStore(e){return function(i,a,l,f,y){return new eI(i,a,l,f,y)}(this.localStore,this.datastore,e.asyncQueue,n=>op(this.syncEngine,n,0),function(){return ep.v()?new ep:new WC}())}createSyncEngine(e,n){return function(a,l,f,y,x,m,C){const v=new xI(a,l,f,y,x,m);return C&&(v.gu=!0),v}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(a){const l=De(a);ye(Js,"RemoteStore shutting down."),l.Ea.add(5),await Ll(l),l.Aa.shutdown(),l.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}h1.provider={build:()=>new h1};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):bi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _s="FirestoreClient";class MI{constructor(e,n,i,a,l){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=a,this.user=Rn.UNAUTHENTICATED,this.clientId=gd.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,async f=>{ye(_s,"Received user=",f.uid),await this.authCredentialListener(f),this.user=f}),this.appCheckCredentials.start(i,f=>(ye(_s,"Received new app check token=",f),this.appCheckCredentialListener(f,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new oi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const i=Ld(n,"Failed to shutdown persistence");e.reject(i)}}),e.promise}}async function Zh(t,e){t.asyncQueue.verifyOperationInProgress(),ye(_s,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener(async a=>{i.isEqual(a)||(await qy(e.localStore,a),i=a)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function lp(t,e){t.asyncQueue.verifyOperationInProgress();const n=await kI(t);ye(_s,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(i=>np(e.remoteStore,i)),t.setAppCheckTokenChangeListener((i,a)=>np(e.remoteStore,a)),t._onlineComponents=e}async function kI(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ye(_s,"Using user provided OfflineComponentProvider");try{await Zh(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(a){return a.name==="FirebaseError"?a.code===te.FAILED_PRECONDITION||a.code===te.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11}(n))throw n;$o("Error using user provided cache. Falling back to memory cache: "+n),await Zh(t,new Ic)}}else ye(_s,"Using default OfflineComponentProvider"),await Zh(t,new PI(void 0));return t._offlineComponents}async function Ud(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ye(_s,"Using user provided OnlineComponentProvider"),await lp(t,t._uninitializedComponentsProvider._online)):(ye(_s,"Using default OnlineComponentProvider"),await lp(t,new h1))),t._onlineComponents}function LI(t){return Ud(t).then(e=>e.syncEngine)}function BI(t){return Ud(t).then(e=>e.datastore)}async function pw(t){const e=await Ud(t),n=e.eventManager;return n.onListen=EI.bind(null,e.syncEngine),n.onUnlisten=CI.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=_I.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=II.bind(null,e.syncEngine),n}function FI(t,e,n={}){const i=new oi;return t.asyncQueue.enqueueAndForget(async()=>function(l,f,y,x,m){const C=new gw({next:D=>{C.Nu(),f.enqueueAndForget(()=>iw(l,v));const V=D.docs.has(y);!V&&D.fromCache?m.reject(new pe(te.UNAVAILABLE,"Failed to get document because the client is offline.")):V&&D.fromCache&&x&&x.source==="server"?m.reject(new pe(te.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(D)},error:D=>m.reject(D)}),v=new sw(_d(y.path),C,{includeMetadataChanges:!0,qa:!0});return rw(l,v)}(await pw(t),t.asyncQueue,e,n,i)),i.promise}function VI(t,e,n={}){const i=new oi;return t.asyncQueue.enqueueAndForget(async()=>function(l,f,y,x,m){const C=new gw({next:D=>{C.Nu(),f.enqueueAndForget(()=>iw(l,v)),D.fromCache&&x.source==="server"?m.reject(new pe(te.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(D)},error:D=>m.reject(D)}),v=new sw(y,C,{includeMetadataChanges:!0,qa:!0});return rw(l,v)}(await pw(t),t.asyncQueue,e,n,i)),i.promise}function UI(t,e,n){const i=new oi;return t.asyncQueue.enqueueAndForget(async()=>{try{const a=await BI(t);i.resolve(async function(f,y,x){var X;const m=De(f),{request:C,gt:v,parent:D}=sC(m.serializer,T3(y),x);m.connection.$o||delete C.parent;const V=(await m.Ho("RunAggregationQuery",m.serializer.databaseId,D,C,1)).filter(ne=>!!ne.result);tt(V.length===1,64727);const Y=(X=V[0].result)==null?void 0:X.aggregateFields;return Object.keys(Y).reduce((ne,H)=>(ne[v[H]]=Y[H],ne),{})}(a,e,n))}catch(a){i.reject(a)}}),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const up=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yw="firestore.googleapis.com",cp=!0;class hp{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new pe(te.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=yw,this.ssl=cp}else this.host=e.host,this.ssl=e.ssl??cp;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=jy;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<mC)throw new pe(te.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$A("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=mw(e.experimentalLongPollingOptions??{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new pe(te.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new pe(te.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new pe(te.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,a){return i.timeoutSeconds===a.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Fl{constructor(e,n,i,a){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=i,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new hp({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new pe(te.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new pe(te.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new hp(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new HA;switch(i.type){case"firstParty":return new XA(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new pe(te.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const i=up.get(n);i&&(ye("ComponentProvider","Removing Datastore"),up.delete(n),i.terminate())}(this),Promise.resolve()}}function zI(t,e,n,i={}){var m;t=ar(t,Fl);const a=cd(e),l=t._getSettings(),f={...l,emulatorOptions:t._getEmulatorOptions()},y=`${e}:${n}`;a&&(d_(`https://${y}`),y_("Firestore",!0)),l.host!==yw&&l.host!==y&&$o("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const x={...l,host:y,ssl:a,emulatorOptions:i};if(!hc(x,f)&&(t._setSettings(x),i.mockUserToken)){let C,v;if(typeof i.mockUserToken=="string")C=i.mockUserToken,v=Rn.MOCK_USER;else{C=g_(i.mockUserToken,(m=t._app)==null?void 0:m.options.projectId);const D=i.mockUserToken.sub||i.mockUserToken.user_id;if(!D)throw new pe(te.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");v=new Rn(D)}t._authCredentials=new GA(new ty(C,v))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi{constructor(e,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Pi(this.firestore,e,this._query)}}class Wt{constructor(e,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ds(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Wt(this.firestore,e,this._key)}toJSON(){return{type:Wt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,i){if(Pl(n,Wt._jsonSchema))return new Wt(e,i||null,new Te(pt.fromString(n.referencePath)))}}Wt._jsonSchemaVersion="firestore/documentReference/1.0",Wt._jsonSchema={type:Qt("string",Wt._jsonSchemaVersion),referencePath:Qt("string")};class ds extends Pi{constructor(e,n,i){super(e,n,_d(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Wt(this.firestore,null,new Te(e))}withConverter(e){return new ds(this.firestore,e,this._path)}}function WT(t,e,...n){if(t=Ri(t),pd("collection","path",e),t instanceof Fl){const i=pt.fromString(e,...n);return Ig(i),new ds(t,null,i)}{if(!(t instanceof Wt||t instanceof ds))throw new pe(te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(pt.fromString(e,...n));return Ig(i),new ds(t.firestore,null,i)}}function jT(t,e){if(t=ar(t,Fl),pd("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new pe(te.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Pi(t,null,function(i){return new no(pt.emptyPath(),i)}(e))}function HI(t,e,...n){if(t=Ri(t),arguments.length===1&&(e=gd.newId()),pd("doc","path",e),t instanceof Fl){const i=pt.fromString(e,...n);return Cg(i),new Wt(t,null,new Te(i))}{if(!(t instanceof Wt||t instanceof ds))throw new pe(te.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(pt.fromString(e,...n));return Cg(i),new Wt(t.firestore,t instanceof ds?t.converter:null,new Te(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fp="AsyncQueue";class dp{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Yy(this,"async_queue_retry"),this._c=()=>{const i=Qh();i&&ye(fp,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const n=Qh();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Qh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new oi;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!ca(e))throw e;ye(fp,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(i=>{throw this.nc=i,this.rc=!1,bi("INTERNAL UNHANDLED ERROR: ",gp(i)),i}).then(i=>(this.rc=!1,i))));return this.ac=n,n}enqueueAfterDelay(e,n,i){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const a=kd.createAndSchedule(this,e,n,i,l=>this.hc(l));return this.tc.push(a),a}uc(){this.nc&&Re(47125,{Pc:gp(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,i)=>n.targetTimeMs-i.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function gp(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Ss extends Fl{constructor(e,n,i,a){super(e,n,i,a),this.type="firestore",this._queue=new dp,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new dp(e),this._firestoreClient=void 0,await e}}}function XT(t,e){const n=typeof t=="object"?t:NA(),i=typeof t=="string"?t:e||pc,a=CA(n,"firestore").getImmediate({identifier:i});if(!a._initialized){const l=h_("firestore");l&&zI(a,...l)}return a}function rh(t){if(t._terminated)throw new pe(te.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||GI(t),t._firestoreClient}function GI(t){var i,a,l;const e=t._freezeSettings(),n=function(y,x,m,C){return new h3(y,x,m,C.host,C.ssl,C.experimentalForceLongPolling,C.experimentalAutoDetectLongPolling,mw(C.experimentalLongPollingOptions),C.useFetchStreams,C.isUsingEmulator)}(t._databaseId,((i=t._app)==null?void 0:i.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(a=e.localCache)!=null&&a._offlineComponentProvider&&((l=e.localCache)!=null&&l._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new MI(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(y){const x=y==null?void 0:y._online.build();return{_offline:y==null?void 0:y._offline.build(x),_online:x}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WI{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class jI{constructor(e,n,i){this._userDataWriter=n,this._data=i,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Cr(_n.fromBase64String(e))}catch(n){throw new pe(te.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Cr(_n.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Cr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Pl(e,Cr._jsonSchema))return Cr.fromBase64String(e.bytes)}}Cr._jsonSchemaVersion="firestore/bytes/1.0",Cr._jsonSchema={type:Qt("string",Cr._jsonSchemaVersion),bytes:Qt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ih{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new pe(te.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new wn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new pe(te.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new pe(te.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ge(this._lat,e._lat)||Ge(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ui._jsonSchemaVersion}}static fromJSON(e){if(Pl(e,ui._jsonSchema))return new ui(e.latitude,e.longitude)}}ui._jsonSchemaVersion="firestore/geoPoint/1.0",ui._jsonSchema={type:Qt("string",ui._jsonSchemaVersion),latitude:Qt("number"),longitude:Qt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(i,a){if(i.length!==a.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==a[l])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ci._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Pl(e,ci._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new ci(e.vectorValues);throw new pe(te.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ci._jsonSchemaVersion="firestore/vectorValue/1.0",ci._jsonSchema={type:Qt("string",ci._jsonSchemaVersion),vectorValues:Qt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XI=/^__.*__$/;class qI{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return this.fieldMask!==null?new vs(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ml(e,this.data,n,this.fieldTransforms)}}class ww{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return new vs(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function xw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Re(40011,{Ac:t})}}class Hd{constructor(e,n,i,a,l,f){this.settings=e,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=a,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=f||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Hd({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var a;const n=(a=this.path)==null?void 0:a.child(e),i=this.Vc({path:n,fc:!1});return i.gc(e),i}yc(e){var a;const n=(a=this.path)==null?void 0:a.child(e),i=this.Vc({path:n,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Tc(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(xw(this.Ac)&&XI.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class KI{constructor(e,n,i){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=i||eh(e)}Cc(e,n,i,a=!1){return new Hd({Ac:e,methodName:n,Dc:i,path:wn.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function sh(t){const e=t._freezeSettings(),n=eh(t._databaseId);return new KI(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Ew(t,e,n,i,a,l={}){const f=t.Cc(l.merge||l.mergeFields?2:0,e,n,a);Gd("Data must be an object, but it was:",f,i);const y=_w(i,f);let x,m;if(l.merge)x=new ir(f.fieldMask),m=f.fieldTransforms;else if(l.mergeFields){const C=[];for(const v of l.mergeFields){const D=f1(e,v,n);if(!f.contains(D))throw new pe(te.INVALID_ARGUMENT,`Field '${D}' is specified in your field mask but missing from your input data.`);Cw(C,D)||C.push(D)}x=new ir(C),m=f.fieldTransforms.filter(v=>x.covers(v.field))}else x=null,m=f.fieldTransforms;return new qI(new Kn(y),x,m)}class oh extends zd{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof oh}}function YI(t,e,n,i){const a=t.Cc(1,e,n);Gd("Data must be an object, but it was:",a,i);const l=[],f=Kn.empty();Ts(i,(x,m)=>{const C=Wd(e,x,n);m=Ri(m);const v=a.yc(C);if(m instanceof oh)l.push(C);else{const D=Vl(m,v);D!=null&&(l.push(C),f.set(C,D))}});const y=new ir(l);return new ww(f,y,a.fieldTransforms)}function QI(t,e,n,i,a,l){const f=t.Cc(1,e,n),y=[f1(e,i,n)],x=[a];if(l.length%2!=0)throw new pe(te.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let D=0;D<l.length;D+=2)y.push(f1(e,l[D])),x.push(l[D+1]);const m=[],C=Kn.empty();for(let D=y.length-1;D>=0;--D)if(!Cw(m,y[D])){const V=y[D];let Y=x[D];Y=Ri(Y);const X=f.yc(V);if(Y instanceof oh)m.push(V);else{const ne=Vl(Y,X);ne!=null&&(m.push(V),C.set(V,ne))}}const v=new ir(m);return new ww(C,v,f.fieldTransforms)}function ZI(t,e,n,i=!1){return Vl(n,t.Cc(i?4:3,e))}function Vl(t,e){if(Aw(t=Ri(t)))return Gd("Unsupported field value:",e,t),_w(t,e);if(t instanceof zd)return function(i,a){if(!xw(a.Ac))throw a.Sc(`${i._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(a);l&&a.fieldTransforms.push(l)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(i,a){const l=[];let f=0;for(const y of i){let x=Vl(y,a.wc(f));x==null&&(x={nullValue:"NULL_VALUE"}),l.push(x),f++}return{arrayValue:{values:l}}}(t,e)}return function(i,a){if((i=Ri(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return P3(a.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=Ct.fromDate(i);return{timestampValue:_c(a.serializer,l)}}if(i instanceof Ct){const l=new Ct(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:_c(a.serializer,l)}}if(i instanceof ui)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Cr)return{bytesValue:By(a.serializer,i._byteString)};if(i instanceof Wt){const l=a.databaseId,f=i.firestore._databaseId;if(!f.isEqual(l))throw a.Sc(`Document reference is for database ${f.projectId}/${f.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:vd(i.firestore._databaseId||a.databaseId,i._key.path)}}if(i instanceof ci)return function(f,y){return{mapValue:{fields:{[cy]:{stringValue:fy},[mc]:{arrayValue:{values:f.toArray().map(m=>{if(typeof m!="number")throw y.Sc("VectorValues must only contain numeric values.");return Ad(y.serializer,m)})}}}}}}(i,a);throw a.Sc(`Unsupported field value: ${jc(i)}`)}(t,e)}function _w(t,e){const n={};return iy(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ts(t,(i,a)=>{const l=Vl(a,e.mc(i));l!=null&&(n[i]=l)}),{mapValue:{fields:n}}}function Aw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ct||t instanceof ui||t instanceof Cr||t instanceof Wt||t instanceof zd||t instanceof ci)}function Gd(t,e,n){if(!Aw(n)||!ny(n)){const i=jc(n);throw i==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+i)}}function f1(t,e,n){if((e=Ri(e))instanceof ih)return e._internalPath;if(typeof e=="string")return Wd(t,e);throw Tc("Field path arguments must be of type string or ",t,!1,void 0,n)}const $I=new RegExp("[~\\*/\\[\\]]");function Wd(t,e,n){if(e.search($I)>=0)throw Tc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new ih(...e.split("."))._internalPath}catch{throw Tc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Tc(t,e,n,i,a){const l=i&&!i.isEmpty(),f=a!==void 0;let y=`Function ${e}() called with invalid data`;n&&(y+=" (via `toFirestore()`)"),y+=". ";let x="";return(l||f)&&(x+=" (found",l&&(x+=` in field ${i}`),f&&(x+=` in document ${a}`),x+=")"),new pe(te.INVALID_ARGUMENT,y+t+x)}function Cw(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw{constructor(e,n,i,a,l){this._firestore=e,this._userDataWriter=n,this._key=i,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Wt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new JI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(ah("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class JI extends Iw{data(){return super.data()}}function ah(t,e){return typeof e=="string"?Wd(t,e):e instanceof ih?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eT(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new pe(te.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class jd{}class Xd extends jd{}function qT(t,e,...n){let i=[];e instanceof jd&&i.push(e),i=i.concat(n),function(l){const f=l.filter(x=>x instanceof qd).length,y=l.filter(x=>x instanceof lh).length;if(f>1||f>0&&y>0)throw new pe(te.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(const a of i)t=a._apply(t);return t}class lh extends Xd{constructor(e,n,i){super(),this._field=e,this._op=n,this._value=i,this.type="where"}static _create(e,n,i){return new lh(e,n,i)}_apply(e){const n=this._parse(e);return Tw(e._query,n),new Pi(e.firestore,e.converter,n1(e._query,n))}_parse(e){const n=sh(e.firestore);return function(l,f,y,x,m,C,v){let D;if(m.isKeyField()){if(C==="array-contains"||C==="array-contains-any")throw new pe(te.INVALID_ARGUMENT,`Invalid Query. You can't perform '${C}' queries on documentId().`);if(C==="in"||C==="not-in"){mp(v,C);const Y=[];for(const X of v)Y.push(pp(x,l,X));D={arrayValue:{values:Y}}}else D=pp(x,l,v)}else C!=="in"&&C!=="not-in"&&C!=="array-contains-any"||mp(v,C),D=ZI(y,f,v,C==="in"||C==="not-in");return Yt.create(m,C,D)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function KT(t,e,n){const i=e,a=ah("where",t);return lh._create(a,i,n)}class qd extends jd{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new qd(e,n)}_parse(e){const n=this._queryConstraints.map(i=>i._parse(e)).filter(i=>i.getFilters().length>0);return n.length===1?n[0]:Gr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(a,l){let f=a;const y=l.getFlattenedFilters();for(const x of y)Tw(f,x),f=n1(f,x)}(e._query,n),new Pi(e.firestore,e.converter,n1(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Kd extends Xd{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Kd(e,n)}_apply(e){const n=function(a,l,f){if(a.startAt!==null)throw new pe(te.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new pe(te.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Tl(l,f)}(e._query,this._field,this._direction);return new Pi(e.firestore,e.converter,function(a,l){const f=a.explicitOrderBy.concat([l]);return new no(a.path,a.collectionGroup,f,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)}(e._query,n))}}function YT(t,e="asc"){const n=e,i=ah("orderBy",t);return Kd._create(i,n)}class Yd extends Xd{constructor(e,n,i){super(),this.type=e,this._limit=n,this._limitType=i}static _create(e,n,i){return new Yd(e,n,i)}_apply(e){return new Pi(e.firestore,e.converter,wc(e._query,this._limit,this._limitType))}}function QT(t){return JA("limit",t),Yd._create("limit",t,"F")}function pp(t,e,n){if(typeof(n=Ri(n))=="string"){if(n==="")throw new pe(te.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ey(e)&&n.indexOf("/")!==-1)throw new pe(te.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(pt.fromString(n));if(!Te.isDocumentKey(i))throw new pe(te.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Og(t,new Te(i))}if(n instanceof Wt)return Og(t,n._key);throw new pe(te.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${jc(n)}.`)}function mp(t,e){if(!Array.isArray(t)||t.length===0)throw new pe(te.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Tw(t,e){const n=function(a,l){for(const f of a)for(const y of f.getFlattenedFilters())if(l.indexOf(y.op)>=0)return y.op;return null}(t.filters,function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new pe(te.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new pe(te.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class tT{convertValue(e,n="none"){switch(xs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ht(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ws(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Re(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const i={};return Ts(e,(a,l)=>{i[a]=this.convertValue(l,n)}),i}convertVectorValue(e){var i,a,l;const n=(l=(a=(i=e.fields)==null?void 0:i[mc].arrayValue)==null?void 0:a.values)==null?void 0:l.map(f=>Ht(f.doubleValue));return new ci(n)}convertGeoPoint(e){return new ui(Ht(e.latitude),Ht(e.longitude))}convertArray(e,n){return(e.values||[]).map(i=>this.convertValue(i,n))}convertServerTimestamp(e,n){switch(n){case"previous":const i=Kc(e);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(Al(e));default:return null}}convertTimestamp(e){const n=ys(e);return new Ct(n.seconds,n.nanos)}convertDocumentKey(e,n){const i=pt.fromString(e);tt(Wy(i),9688,{name:e});const a=new Cl(i.get(1),i.get(3)),l=new Te(i.popFirst(5));return a.isEqual(n)||bi(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vw(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}function nT(){return new WI("count")}class za{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Xs extends Iw{constructor(e,n,i,a,l,f){super(e,n,i,a,f),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Vu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const i=this._document.data.field(ah("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new pe(te.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Xs._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Xs._jsonSchemaVersion="firestore/documentSnapshot/1.0",Xs._jsonSchema={type:Qt("string",Xs._jsonSchemaVersion),bundleSource:Qt("string","DocumentSnapshot"),bundleName:Qt("string"),bundle:Qt("string")};class Vu extends Xs{data(e={}){return super.data(e)}}class Wo{constructor(e,n,i,a){this._firestore=e,this._userDataWriter=n,this._snapshot=a,this.metadata=new za(a.hasPendingWrites,a.fromCache),this.query=i}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(i=>{e.call(n,new Vu(this._firestore,this._userDataWriter,i.key,i,new za(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new pe(te.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(a,l){if(a._snapshot.oldDocs.isEmpty()){let f=0;return a._snapshot.docChanges.map(y=>{const x=new Vu(a._firestore,a._userDataWriter,y.doc.key,y.doc,new za(a._snapshot.mutatedKeys.has(y.doc.key),a._snapshot.fromCache),a.query.converter);return y.doc,{type:"added",doc:x,oldIndex:-1,newIndex:f++}})}{let f=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(y=>l||y.type!==3).map(y=>{const x=new Vu(a._firestore,a._userDataWriter,y.doc.key,y.doc,new za(a._snapshot.mutatedKeys.has(y.doc.key),a._snapshot.fromCache),a.query.converter);let m=-1,C=-1;return y.type!==0&&(m=f.indexOf(y.doc.key),f=f.delete(y.doc.key)),y.type!==1&&(f=f.add(y.doc),C=f.indexOf(y.doc.key)),{type:rT(y.type),doc:x,oldIndex:m,newIndex:C}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new pe(te.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Wo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=gd.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],i=[],a=[];return this.docs.forEach(l=>{l._document!==null&&(n.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function rT(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Re(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZT(t){t=ar(t,Wt);const e=ar(t.firestore,Ss);return FI(rh(e),t._key).then(n=>iT(e,t,n))}Wo._jsonSchemaVersion="firestore/querySnapshot/1.0",Wo._jsonSchema={type:Qt("string",Wo._jsonSchemaVersion),bundleSource:Qt("string","QuerySnapshot"),bundleName:Qt("string"),bundle:Qt("string")};class Qd extends tT{constructor(e){super(),this.firestore=e}convertBytes(e){return new Cr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Wt(this.firestore,null,n)}}function $T(t){t=ar(t,Pi);const e=ar(t.firestore,Ss),n=rh(e),i=new Qd(e);return eT(t._query),VI(n,t._query).then(a=>new Wo(e,i,t,a))}function JT(t,e,n){t=ar(t,Wt);const i=ar(t.firestore,Ss),a=vw(t.converter,e,n);return uh(i,[Ew(sh(i),"setDoc",t._key,a,t.converter!==null,n).toMutation(t._key,vr.none())])}function ev(t,e,n,...i){t=ar(t,Wt);const a=ar(t.firestore,Ss),l=sh(a);let f;return f=typeof(e=Ri(e))=="string"||e instanceof ih?QI(l,"updateDoc",t._key,e,n,i):YI(l,"updateDoc",t._key,e),uh(a,[f.toMutation(t._key,vr.exists(!0))])}function tv(t){return uh(ar(t.firestore,Ss),[new Cd(t._key,vr.none())])}function nv(t,e){const n=ar(t.firestore,Ss),i=HI(t),a=vw(t.converter,e);return uh(n,[Ew(sh(t.firestore),"addDoc",i._key,a,t.converter!==null,{}).toMutation(i._key,vr.exists(!1))]).then(()=>i)}function uh(t,e){return function(i,a){const l=new oi;return i.asyncQueue.enqueueAndForget(async()=>TI(await LI(i),a,l)),l.promise}(rh(t),e)}function iT(t,e,n){const i=n.docs.get(e._key),a=new Qd(t);return new Xs(t,a,e._key,i,new za(n.hasPendingWrites,n.fromCache),e.converter)}function rv(t){return sT(t,{count:nT()})}function sT(t,e){const n=ar(t.firestore,Ss),i=rh(n),a=u3(e,(l,f)=>new G3(f,l.aggregateType,l._internalFieldPath));return UI(i,t._query,a).then(l=>function(y,x,m){const C=new Qd(y);return new jI(x,C,m)}(n,t,l))}(function(e,n=!0){(function(a){la=a})(SA),dc(new xl("firestore",(i,{instanceIdentifier:a,options:l})=>{const f=i.getProvider("app").getImmediate(),y=new Ss(new WA(i.getProvider("auth-internal")),new qA(f,i.getProvider("app-check-internal")),function(m,C){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new pe(te.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Cl(m.options.projectId,C)}(f,a),f);return l={useFetchStreams:n,...l},y._setSettings(l),y},"PUBLIC").setMultipleInstances(!0)),Ho(xg,Eg,e),Ho(xg,Eg,"esm2020")})();var we;(function(t){t[t.QR_CODE=0]="QR_CODE",t[t.AZTEC=1]="AZTEC",t[t.CODABAR=2]="CODABAR",t[t.CODE_39=3]="CODE_39",t[t.CODE_93=4]="CODE_93",t[t.CODE_128=5]="CODE_128",t[t.DATA_MATRIX=6]="DATA_MATRIX",t[t.MAXICODE=7]="MAXICODE",t[t.ITF=8]="ITF",t[t.EAN_13=9]="EAN_13",t[t.EAN_8=10]="EAN_8",t[t.PDF_417=11]="PDF_417",t[t.RSS_14=12]="RSS_14",t[t.RSS_EXPANDED=13]="RSS_EXPANDED",t[t.UPC_A=14]="UPC_A",t[t.UPC_E=15]="UPC_E",t[t.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(we||(we={}));var yp=new Map([[we.QR_CODE,"QR_CODE"],[we.AZTEC,"AZTEC"],[we.CODABAR,"CODABAR"],[we.CODE_39,"CODE_39"],[we.CODE_93,"CODE_93"],[we.CODE_128,"CODE_128"],[we.DATA_MATRIX,"DATA_MATRIX"],[we.MAXICODE,"MAXICODE"],[we.ITF,"ITF"],[we.EAN_13,"EAN_13"],[we.EAN_8,"EAN_8"],[we.PDF_417,"PDF_417"],[we.RSS_14,"RSS_14"],[we.RSS_EXPANDED,"RSS_EXPANDED"],[we.UPC_A,"UPC_A"],[we.UPC_E,"UPC_E"],[we.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),wp;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.URL=1]="URL"})(wp||(wp={}));function oT(t){return Object.values(we).includes(t)}var vc;(function(t){t[t.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",t[t.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(vc||(vc={}));var aT=function(){function t(){}return t.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",t.SCAN_DEFAULT_FPS=2,t.DEFAULT_DISABLE_FLIP=!1,t.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,t.DEFAULT_SUPPORTED_SCAN_TYPE=[vc.SCAN_TYPE_CAMERA,vc.SCAN_TYPE_FILE],t}(),Sw=function(){function t(e,n){this.format=e,this.formatName=n}return t.prototype.toString=function(){return this.formatName},t.create=function(e){if(!yp.has(e))throw"".concat(e," not in html5QrcodeSupportedFormatsTextMap");return new t(e,yp.get(e))},t}(),xp=function(){function t(){}return t.createFromText=function(e){var n={text:e};return{decodedText:e,result:n}},t.createFromQrcodeResult=function(e){return{decodedText:e.text,result:e}},t}(),d1;(function(t){t[t.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",t[t.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",t[t.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(d1||(d1={}));var lT=function(){function t(){}return t.createFrom=function(e){return{errorMessage:e,type:d1.UNKWOWN_ERROR}},t}(),uT=function(){function t(e){this.verbose=e}return t.prototype.log=function(e){this.verbose&&console.log(e)},t.prototype.warn=function(e){this.verbose&&console.warn(e)},t.prototype.logError=function(e,n){(this.verbose||n===!0)&&console.error(e)},t.prototype.logErrors=function(e){if(e.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(e)},t}();function wi(t){return typeof t>"u"||t===null}var ko=function(){function t(){}return t.codeParseError=function(e){return"QR code parse error, error = ".concat(e)},t.errorGettingUserMedia=function(e){return"Error getting userMedia, error = ".concat(e)},t.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},t.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},t.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},t.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},t.scannerPaused=function(){return"Scanner paused"},t}(),Rw=function(){function t(){}return t.isMediaStreamConstraintsValid=function(e,n){if(typeof e!="object"){var i=typeof e;return n.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(i,"."),!0),!1}for(var a=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],l=new Set(a),f=Object.keys(e),y=0,x=f;y<x.length;y++){var m=x[y];if(l.has(m))return n.logError("".concat(m," is not supported videoConstaints."),!0),!1}return!0},t}(),g1={exports:{}};(function(t,e){(function(n,i){i(e)})(Ta,function(n){function i(I){return I==null}var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,r){I.__proto__=r}||function(I,r){for(var s in r)r.hasOwnProperty(s)&&(I[s]=r[s])};function l(I,r){a(I,r);function s(){this.constructor=I}I.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}function f(I,r){var s=Object.setPrototypeOf;s?s(I,r):I.__proto__=r}function y(I,r){r===void 0&&(r=I.constructor);var s=Error.captureStackTrace;s&&s(I,r)}var x=function(I){l(r,I);function r(s){var o=this.constructor,u=I.call(this,s)||this;return Object.defineProperty(u,"name",{value:o.name,enumerable:!1}),f(u,o.prototype),y(u),u}return r}(Error);class m extends x{constructor(r=void 0){super(r),this.message=r}getKind(){return this.constructor.kind}}m.kind="Exception";class C extends m{}C.kind="ArgumentException";class v extends m{}v.kind="IllegalArgumentException";class D{constructor(r){if(this.binarizer=r,r===null)throw new v("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(r,s){return this.binarizer.getBlackRow(r,s)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(r,s,o,u){const c=this.binarizer.getLuminanceSource().crop(r,s,o,u);return new D(this.binarizer.createBinarizer(c))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const r=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new D(this.binarizer.createBinarizer(r))}rotateCounterClockwise45(){const r=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new D(this.binarizer.createBinarizer(r))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class V extends m{static getChecksumInstance(){return new V}}V.kind="ChecksumException";class Y{constructor(r){this.source=r}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class X{static arraycopy(r,s,o,u,c){for(;c--;)o[u++]=r[s++]}static currentTimeMillis(){return Date.now()}}class ne extends m{}ne.kind="IndexOutOfBoundsException";class H extends ne{constructor(r=void 0,s=void 0){super(s),this.index=r,this.message=s}}H.kind="ArrayIndexOutOfBoundsException";class k{static fill(r,s){for(let o=0,u=r.length;o<u;o++)r[o]=s}static fillWithin(r,s,o,u){k.rangeCheck(r.length,s,o);for(let c=s;c<o;c++)r[c]=u}static rangeCheck(r,s,o){if(s>o)throw new v("fromIndex("+s+") > toIndex("+o+")");if(s<0)throw new H(s);if(o>r)throw new H(o)}static asList(...r){return r}static create(r,s,o){return Array.from({length:r}).map(c=>Array.from({length:s}).fill(o))}static createInt32Array(r,s,o){return Array.from({length:r}).map(c=>Int32Array.from({length:s}).fill(o))}static equals(r,s){if(!r||!s||!r.length||!s.length||r.length!==s.length)return!1;for(let o=0,u=r.length;o<u;o++)if(r[o]!==s[o])return!1;return!0}static hashCode(r){if(r===null)return 0;let s=1;for(const o of r)s=31*s+o;return s}static fillUint8Array(r,s){for(let o=0;o!==r.length;o++)r[o]=s}static copyOf(r,s){return r.slice(0,s)}static copyOfUint8Array(r,s){if(r.length<=s){const o=new Uint8Array(s);return o.set(r),o}return r.slice(0,s)}static copyOfRange(r,s,o){const u=o-s,c=new Int32Array(u);return X.arraycopy(r,s,c,0,u),c}static binarySearch(r,s,o){o===void 0&&(o=k.numberComparator);let u=0,c=r.length-1;for(;u<=c;){const h=c+u>>1,d=o(s,r[h]);if(d>0)u=h+1;else if(d<0)c=h-1;else return h}return-u-1}static numberComparator(r,s){return r-s}}class B{static numberOfTrailingZeros(r){let s;if(r===0)return 32;let o=31;return s=r<<16,s!==0&&(o-=16,r=s),s=r<<8,s!==0&&(o-=8,r=s),s=r<<4,s!==0&&(o-=4,r=s),s=r<<2,s!==0&&(o-=2,r=s),o-(r<<1>>>31)}static numberOfLeadingZeros(r){if(r===0)return 32;let s=1;return r>>>16||(s+=16,r<<=16),r>>>24||(s+=8,r<<=8),r>>>28||(s+=4,r<<=4),r>>>30||(s+=2,r<<=2),s-=r>>>31,s}static toHexString(r){return r.toString(16)}static toBinaryString(r){return String(parseInt(String(r),2))}static bitCount(r){return r=r-(r>>>1&1431655765),r=(r&858993459)+(r>>>2&858993459),r=r+(r>>>4)&252645135,r=r+(r>>>8),r=r+(r>>>16),r&63}static truncDivision(r,s){return Math.trunc(r/s)}static parseInt(r,s=void 0){return parseInt(r,s)}}B.MIN_VALUE_32_BITS=-2147483648,B.MAX_VALUE=Number.MAX_SAFE_INTEGER;class ${constructor(r,s){r===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=r,s==null?this.bits=$.makeArray(r):this.bits=s)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(r){if(r>this.bits.length*32){const s=$.makeArray(r);X.arraycopy(this.bits,0,s,0,this.bits.length),this.bits=s}}get(r){return(this.bits[Math.floor(r/32)]&1<<(r&31))!==0}set(r){this.bits[Math.floor(r/32)]|=1<<(r&31)}flip(r){this.bits[Math.floor(r/32)]^=1<<(r&31)}getNextSet(r){const s=this.size;if(r>=s)return s;const o=this.bits;let u=Math.floor(r/32),c=o[u];c&=~((1<<(r&31))-1);const h=o.length;for(;c===0;){if(++u===h)return s;c=o[u]}const d=u*32+B.numberOfTrailingZeros(c);return d>s?s:d}getNextUnset(r){const s=this.size;if(r>=s)return s;const o=this.bits;let u=Math.floor(r/32),c=~o[u];c&=~((1<<(r&31))-1);const h=o.length;for(;c===0;){if(++u===h)return s;c=~o[u]}const d=u*32+B.numberOfTrailingZeros(c);return d>s?s:d}setBulk(r,s){this.bits[Math.floor(r/32)]=s}setRange(r,s){if(s<r||r<0||s>this.size)throw new v;if(s===r)return;s--;const o=Math.floor(r/32),u=Math.floor(s/32),c=this.bits;for(let h=o;h<=u;h++){const d=h>o?0:r&31,w=(2<<(h<u?31:s&31))-(1<<d);c[h]|=w}}clear(){const r=this.bits.length,s=this.bits;for(let o=0;o<r;o++)s[o]=0}isRange(r,s,o){if(s<r||r<0||s>this.size)throw new v;if(s===r)return!0;s--;const u=Math.floor(r/32),c=Math.floor(s/32),h=this.bits;for(let d=u;d<=c;d++){const p=d>u?0:r&31,_=(2<<(d<c?31:s&31))-(1<<p)&4294967295;if((h[d]&_)!==(o?_:0))return!1}return!0}appendBit(r){this.ensureCapacity(this.size+1),r&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(r,s){if(s<0||s>32)throw new v("Num bits must be between 0 and 32");this.ensureCapacity(this.size+s);for(let o=s;o>0;o--)this.appendBit((r>>o-1&1)===1)}appendBitArray(r){const s=r.size;this.ensureCapacity(this.size+s);for(let o=0;o<s;o++)this.appendBit(r.get(o))}xor(r){if(this.size!==r.size)throw new v("Sizes don't match");const s=this.bits;for(let o=0,u=s.length;o<u;o++)s[o]^=r.bits[o]}toBytes(r,s,o,u){for(let c=0;c<u;c++){let h=0;for(let d=0;d<8;d++)this.get(r)&&(h|=1<<7-d),r++;s[o+c]=h}}getBitArray(){return this.bits}reverse(){const r=new Int32Array(this.bits.length),s=Math.floor((this.size-1)/32),o=s+1,u=this.bits;for(let c=0;c<o;c++){let h=u[c];h=h>>1&1431655765|(h&1431655765)<<1,h=h>>2&858993459|(h&858993459)<<2,h=h>>4&252645135|(h&252645135)<<4,h=h>>8&16711935|(h&16711935)<<8,h=h>>16&65535|(h&65535)<<16,r[s-c]=h}if(this.size!==o*32){const c=o*32-this.size;let h=r[0]>>>c;for(let d=1;d<o;d++){const p=r[d];h|=p<<32-c,r[d-1]=h,h=p>>>c}r[o-1]=h}this.bits=r}static makeArray(r){return new Int32Array(Math.floor((r+31)/32))}equals(r){if(!(r instanceof $))return!1;const s=r;return this.size===s.size&&k.equals(this.bits,s.bits)}hashCode(){return 31*this.size+k.hashCode(this.bits)}toString(){let r="";for(let s=0,o=this.size;s<o;s++)s&7||(r+=" "),r+=this.get(s)?"X":".";return r}clone(){return new $(this.size,this.bits.slice())}}var ce;(function(I){I[I.OTHER=0]="OTHER",I[I.PURE_BARCODE=1]="PURE_BARCODE",I[I.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",I[I.TRY_HARDER=3]="TRY_HARDER",I[I.CHARACTER_SET=4]="CHARACTER_SET",I[I.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",I[I.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",I[I.ASSUME_GS1=7]="ASSUME_GS1",I[I.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",I[I.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",I[I.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(ce||(ce={}));var se=ce;class N extends m{static getFormatInstance(){return new N}}N.kind="FormatException";var O;(function(I){I[I.Cp437=0]="Cp437",I[I.ISO8859_1=1]="ISO8859_1",I[I.ISO8859_2=2]="ISO8859_2",I[I.ISO8859_3=3]="ISO8859_3",I[I.ISO8859_4=4]="ISO8859_4",I[I.ISO8859_5=5]="ISO8859_5",I[I.ISO8859_6=6]="ISO8859_6",I[I.ISO8859_7=7]="ISO8859_7",I[I.ISO8859_8=8]="ISO8859_8",I[I.ISO8859_9=9]="ISO8859_9",I[I.ISO8859_10=10]="ISO8859_10",I[I.ISO8859_11=11]="ISO8859_11",I[I.ISO8859_13=12]="ISO8859_13",I[I.ISO8859_14=13]="ISO8859_14",I[I.ISO8859_15=14]="ISO8859_15",I[I.ISO8859_16=15]="ISO8859_16",I[I.SJIS=16]="SJIS",I[I.Cp1250=17]="Cp1250",I[I.Cp1251=18]="Cp1251",I[I.Cp1252=19]="Cp1252",I[I.Cp1256=20]="Cp1256",I[I.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",I[I.UTF8=22]="UTF8",I[I.ASCII=23]="ASCII",I[I.Big5=24]="Big5",I[I.GB18030=25]="GB18030",I[I.EUC_KR=26]="EUC_KR"})(O||(O={}));class b{constructor(r,s,o,...u){this.valueIdentifier=r,this.name=o,typeof s=="number"?this.values=Int32Array.from([s]):this.values=s,this.otherEncodingNames=u,b.VALUE_IDENTIFIER_TO_ECI.set(r,this),b.NAME_TO_ECI.set(o,this);const c=this.values;for(let h=0,d=c.length;h!==d;h++){const p=c[h];b.VALUES_TO_ECI.set(p,this)}for(const h of u)b.NAME_TO_ECI.set(h,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(r){if(r<0||r>=900)throw new N("incorect value");const s=b.VALUES_TO_ECI.get(r);if(s===void 0)throw new N("incorect value");return s}static getCharacterSetECIByName(r){const s=b.NAME_TO_ECI.get(r);if(s===void 0)throw new N("incorect value");return s}equals(r){if(!(r instanceof b))return!1;const s=r;return this.getName()===s.getName()}}b.VALUE_IDENTIFIER_TO_ECI=new Map,b.VALUES_TO_ECI=new Map,b.NAME_TO_ECI=new Map,b.Cp437=new b(O.Cp437,Int32Array.from([0,2]),"Cp437"),b.ISO8859_1=new b(O.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),b.ISO8859_2=new b(O.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),b.ISO8859_3=new b(O.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),b.ISO8859_4=new b(O.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),b.ISO8859_5=new b(O.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),b.ISO8859_6=new b(O.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),b.ISO8859_7=new b(O.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),b.ISO8859_8=new b(O.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),b.ISO8859_9=new b(O.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),b.ISO8859_10=new b(O.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),b.ISO8859_11=new b(O.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),b.ISO8859_13=new b(O.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),b.ISO8859_14=new b(O.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),b.ISO8859_15=new b(O.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),b.ISO8859_16=new b(O.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),b.SJIS=new b(O.SJIS,20,"SJIS","Shift_JIS"),b.Cp1250=new b(O.Cp1250,21,"Cp1250","windows-1250"),b.Cp1251=new b(O.Cp1251,22,"Cp1251","windows-1251"),b.Cp1252=new b(O.Cp1252,23,"Cp1252","windows-1252"),b.Cp1256=new b(O.Cp1256,24,"Cp1256","windows-1256"),b.UnicodeBigUnmarked=new b(O.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),b.UTF8=new b(O.UTF8,26,"UTF8","UTF-8"),b.ASCII=new b(O.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),b.Big5=new b(O.Big5,28,"Big5"),b.GB18030=new b(O.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),b.EUC_KR=new b(O.EUC_KR,30,"EUC_KR","EUC-KR");class F extends m{}F.kind="UnsupportedOperationException";class U{static decode(r,s){const o=this.encodingName(s);return this.customDecoder?this.customDecoder(r,o):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(o)?this.decodeFallback(r,o):new TextDecoder(o).decode(r)}static shouldDecodeOnFallback(r){return!U.isBrowser()&&r==="ISO-8859-1"}static encode(r,s){const o=this.encodingName(s);return this.customEncoder?this.customEncoder(r,o):typeof TextEncoder>"u"?this.encodeFallback(r):new TextEncoder().encode(r)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(r){return typeof r=="string"?r:r.getName()}static encodingCharacterSet(r){return r instanceof b?r:b.getCharacterSetECIByName(r)}static decodeFallback(r,s){const o=this.encodingCharacterSet(s);if(U.isDecodeFallbackSupported(o)){let u="";for(let c=0,h=r.length;c<h;c++){let d=r[c].toString(16);d.length<2&&(d="0"+d),u+="%"+d}return decodeURIComponent(u)}if(o.equals(b.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(r.buffer));throw new F(`Encoding ${this.encodingName(s)} not supported by fallback.`)}static isDecodeFallbackSupported(r){return r.equals(b.UTF8)||r.equals(b.ISO8859_1)||r.equals(b.ASCII)}static encodeFallback(r){const o=btoa(unescape(encodeURIComponent(r))).split(""),u=[];for(let c=0;c<o.length;c++)u.push(o[c].charCodeAt(0));return new Uint8Array(u)}}class G{static castAsNonUtf8Char(r,s=null){const o=s?s.getName():this.ISO88591;return U.decode(new Uint8Array([r]),o)}static guessEncoding(r,s){if(s!=null&&s.get(se.CHARACTER_SET)!==void 0)return s.get(se.CHARACTER_SET).toString();const o=r.length;let u=!0,c=!0,h=!0,d=0,p=0,w=0,_=0,T=0,S=0,M=0,z=0,W=0,q=0,J=0;const le=r.length>3&&r[0]===239&&r[1]===187&&r[2]===191;for(let ue=0;ue<o&&(u||c||h);ue++){const oe=r[ue]&255;h&&(d>0?oe&128?d--:h=!1:oe&128&&(oe&64?(d++,oe&32?(d++,oe&16?(d++,oe&8?h=!1:_++):w++):p++):h=!1)),u&&(oe>127&&oe<160?u=!1:oe>159&&(oe<192||oe===215||oe===247)&&J++),c&&(T>0?oe<64||oe===127||oe>252?c=!1:T--:oe===128||oe===160||oe>239?c=!1:oe>160&&oe<224?(S++,z=0,M++,M>W&&(W=M)):oe>127?(T++,M=0,z++,z>q&&(q=z)):(M=0,z=0))}return h&&d>0&&(h=!1),c&&T>0&&(c=!1),h&&(le||p+w+_>0)?G.UTF8:c&&(G.ASSUME_SHIFT_JIS||W>=3||q>=3)?G.SHIFT_JIS:u&&c?W===2&&S===2||J*10>=o?G.SHIFT_JIS:G.ISO88591:u?G.ISO88591:c?G.SHIFT_JIS:h?G.UTF8:G.PLATFORM_DEFAULT_ENCODING}static format(r,...s){let o=-1;function u(h,d,p,w,_,T){if(h==="%%")return"%";if(s[++o]===void 0)return;h=w?parseInt(w.substr(1)):void 0;let S=_?parseInt(_.substr(1)):void 0,M;switch(T){case"s":M=s[o];break;case"c":M=s[o][0];break;case"f":M=parseFloat(s[o]).toFixed(h);break;case"p":M=parseFloat(s[o]).toPrecision(h);break;case"e":M=parseFloat(s[o]).toExponential(h);break;case"x":M=parseInt(s[o]).toString(S||16);break;case"d":M=parseFloat(parseInt(s[o],S||10).toPrecision(h)).toFixed(0);break}M=typeof M=="object"?JSON.stringify(M):(+M).toString(S);let z=parseInt(p),W=p&&p[0]+""=="0"?"0":" ";for(;M.length<z;)M=d!==void 0?M+W:W+M;return M}let c=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return r.replace(c,u)}static getBytes(r,s){return U.encode(r,s)}static getCharCode(r,s=0){return r.charCodeAt(s)}static getCharAt(r){return String.fromCharCode(r)}}G.SHIFT_JIS=b.SJIS.getName(),G.GB2312="GB2312",G.ISO88591=b.ISO8859_1.getName(),G.EUC_JP="EUC_JP",G.UTF8=b.UTF8.getName(),G.PLATFORM_DEFAULT_ENCODING=G.UTF8,G.ASSUME_SHIFT_JIS=!1;class L{constructor(r=""){this.value=r}enableDecoding(r){return this.encoding=r,this}append(r){return typeof r=="string"?this.value+=r.toString():this.encoding?this.value+=G.castAsNonUtf8Char(r,this.encoding):this.value+=String.fromCharCode(r),this}appendChars(r,s,o){for(let u=s;s<s+o;u++)this.append(r[u]);return this}length(){return this.value.length}charAt(r){return this.value.charAt(r)}deleteCharAt(r){this.value=this.value.substr(0,r)+this.value.substring(r+1)}setCharAt(r,s){this.value=this.value.substr(0,r)+s+this.value.substr(r+1)}substring(r,s){return this.value.substring(r,s)}setLengthToZero(){this.value=""}toString(){return this.value}insert(r,s){this.value=this.value.substr(0,r)+s+this.value.substr(r+s.length)}}class ze{constructor(r,s,o,u){if(this.width=r,this.height=s,this.rowSize=o,this.bits=u,s==null&&(s=r),this.height=s,r<1||s<1)throw new v("Both dimensions must be greater than 0");o==null&&(o=Math.floor((r+31)/32)),this.rowSize=o,u==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(r){const s=r.length,o=r[0].length,u=new ze(o,s);for(let c=0;c<s;c++){const h=r[c];for(let d=0;d<o;d++)h[d]&&u.set(d,c)}return u}static parseFromString(r,s,o){if(r===null)throw new v("stringRepresentation cannot be null");const u=new Array(r.length);let c=0,h=0,d=-1,p=0,w=0;for(;w<r.length;)if(r.charAt(w)===`
`||r.charAt(w)==="\r"){if(c>h){if(d===-1)d=c-h;else if(c-h!==d)throw new v("row lengths do not match");h=c,p++}w++}else if(r.substring(w,w+s.length)===s)w+=s.length,u[c]=!0,c++;else if(r.substring(w,w+o.length)===o)w+=o.length,u[c]=!1,c++;else throw new v("illegal character encountered: "+r.substring(w));if(c>h){if(d===-1)d=c-h;else if(c-h!==d)throw new v("row lengths do not match");p++}const _=new ze(d,p);for(let T=0;T<c;T++)u[T]&&_.set(Math.floor(T%d),Math.floor(T/d));return _}get(r,s){const o=s*this.rowSize+Math.floor(r/32);return(this.bits[o]>>>(r&31)&1)!==0}set(r,s){const o=s*this.rowSize+Math.floor(r/32);this.bits[o]|=1<<(r&31)&4294967295}unset(r,s){const o=s*this.rowSize+Math.floor(r/32);this.bits[o]&=~(1<<(r&31)&4294967295)}flip(r,s){const o=s*this.rowSize+Math.floor(r/32);this.bits[o]^=1<<(r&31)&4294967295}xor(r){if(this.width!==r.getWidth()||this.height!==r.getHeight()||this.rowSize!==r.getRowSize())throw new v("input matrix dimensions do not match");const s=new $(Math.floor(this.width/32)+1),o=this.rowSize,u=this.bits;for(let c=0,h=this.height;c<h;c++){const d=c*o,p=r.getRow(c,s).getBitArray();for(let w=0;w<o;w++)u[d+w]^=p[w]}}clear(){const r=this.bits,s=r.length;for(let o=0;o<s;o++)r[o]=0}setRegion(r,s,o,u){if(s<0||r<0)throw new v("Left and top must be nonnegative");if(u<1||o<1)throw new v("Height and width must be at least 1");const c=r+o,h=s+u;if(h>this.height||c>this.width)throw new v("The region must fit inside the matrix");const d=this.rowSize,p=this.bits;for(let w=s;w<h;w++){const _=w*d;for(let T=r;T<c;T++)p[_+Math.floor(T/32)]|=1<<(T&31)&4294967295}}getRow(r,s){s==null||s.getSize()<this.width?s=new $(this.width):s.clear();const o=this.rowSize,u=this.bits,c=r*o;for(let h=0;h<o;h++)s.setBulk(h*32,u[c+h]);return s}setRow(r,s){X.arraycopy(s.getBitArray(),0,this.bits,r*this.rowSize,this.rowSize)}rotate180(){const r=this.getWidth(),s=this.getHeight();let o=new $(r),u=new $(r);for(let c=0,h=Math.floor((s+1)/2);c<h;c++)o=this.getRow(c,o),u=this.getRow(s-1-c,u),o.reverse(),u.reverse(),this.setRow(c,u),this.setRow(s-1-c,o)}getEnclosingRectangle(){const r=this.width,s=this.height,o=this.rowSize,u=this.bits;let c=r,h=s,d=-1,p=-1;for(let w=0;w<s;w++)for(let _=0;_<o;_++){const T=u[w*o+_];if(T!==0){if(w<h&&(h=w),w>p&&(p=w),_*32<c){let S=0;for(;!(T<<31-S&4294967295);)S++;_*32+S<c&&(c=_*32+S)}if(_*32+31>d){let S=31;for(;!(T>>>S);)S--;_*32+S>d&&(d=_*32+S)}}}return d<c||p<h?null:Int32Array.from([c,h,d-c+1,p-h+1])}getTopLeftOnBit(){const r=this.rowSize,s=this.bits;let o=0;for(;o<s.length&&s[o]===0;)o++;if(o===s.length)return null;const u=o/r;let c=o%r*32;const h=s[o];let d=0;for(;!(h<<31-d&4294967295);)d++;return c+=d,Int32Array.from([c,u])}getBottomRightOnBit(){const r=this.rowSize,s=this.bits;let o=s.length-1;for(;o>=0&&s[o]===0;)o--;if(o<0)return null;const u=Math.floor(o/r);let c=Math.floor(o%r)*32;const h=s[o];let d=31;for(;!(h>>>d);)d--;return c+=d,Int32Array.from([c,u])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(r){if(!(r instanceof ze))return!1;const s=r;return this.width===s.width&&this.height===s.height&&this.rowSize===s.rowSize&&k.equals(this.bits,s.bits)}hashCode(){let r=this.width;return r=31*r+this.width,r=31*r+this.height,r=31*r+this.rowSize,r=31*r+k.hashCode(this.bits),r}toString(r="X ",s="  ",o=`
`){return this.buildToString(r,s,o)}buildToString(r,s,o){let u=new L;for(let c=0,h=this.height;c<h;c++){for(let d=0,p=this.width;d<p;d++)u.append(this.get(d,c)?r:s);u.append(o)}return u.toString()}clone(){return new ze(this.width,this.height,this.rowSize,this.bits.slice())}}class ee extends m{static getNotFoundInstance(){return new ee}}ee.kind="NotFoundException";class Tt extends Y{constructor(r){super(r),this.luminances=Tt.EMPTY,this.buckets=new Int32Array(Tt.LUMINANCE_BUCKETS)}getBlackRow(r,s){const o=this.getLuminanceSource(),u=o.getWidth();s==null||s.getSize()<u?s=new $(u):s.clear(),this.initArrays(u);const c=o.getRow(r,this.luminances),h=this.buckets;for(let p=0;p<u;p++)h[(c[p]&255)>>Tt.LUMINANCE_SHIFT]++;const d=Tt.estimateBlackPoint(h);if(u<3)for(let p=0;p<u;p++)(c[p]&255)<d&&s.set(p);else{let p=c[0]&255,w=c[1]&255;for(let _=1;_<u-1;_++){const T=c[_+1]&255;(w*4-p-T)/2<d&&s.set(_),p=w,w=T}}return s}getBlackMatrix(){const r=this.getLuminanceSource(),s=r.getWidth(),o=r.getHeight(),u=new ze(s,o);this.initArrays(s);const c=this.buckets;for(let p=1;p<5;p++){const w=Math.floor(o*p/5),_=r.getRow(w,this.luminances),T=Math.floor(s*4/5);for(let S=Math.floor(s/5);S<T;S++){const M=_[S]&255;c[M>>Tt.LUMINANCE_SHIFT]++}}const h=Tt.estimateBlackPoint(c),d=r.getMatrix();for(let p=0;p<o;p++){const w=p*s;for(let _=0;_<s;_++)(d[w+_]&255)<h&&u.set(_,p)}return u}createBinarizer(r){return new Tt(r)}initArrays(r){this.luminances.length<r&&(this.luminances=new Uint8ClampedArray(r));const s=this.buckets;for(let o=0;o<Tt.LUMINANCE_BUCKETS;o++)s[o]=0}static estimateBlackPoint(r){const s=r.length;let o=0,u=0,c=0;for(let _=0;_<s;_++)r[_]>c&&(u=_,c=r[_]),r[_]>o&&(o=r[_]);let h=0,d=0;for(let _=0;_<s;_++){const T=_-u,S=r[_]*T*T;S>d&&(h=_,d=S)}if(u>h){const _=u;u=h,h=_}if(h-u<=s/16)throw new ee;let p=h-1,w=-1;for(let _=h-1;_>u;_--){const T=_-u,S=T*T*(h-_)*(o-r[_]);S>w&&(p=_,w=S)}return p<<Tt.LUMINANCE_SHIFT}}Tt.LUMINANCE_BITS=5,Tt.LUMINANCE_SHIFT=8-Tt.LUMINANCE_BITS,Tt.LUMINANCE_BUCKETS=1<<Tt.LUMINANCE_BITS,Tt.EMPTY=Uint8ClampedArray.from([0]);class Ne extends Tt{constructor(r){super(r),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const r=this.getLuminanceSource(),s=r.getWidth(),o=r.getHeight();if(s>=Ne.MINIMUM_DIMENSION&&o>=Ne.MINIMUM_DIMENSION){const u=r.getMatrix();let c=s>>Ne.BLOCK_SIZE_POWER;s&Ne.BLOCK_SIZE_MASK&&c++;let h=o>>Ne.BLOCK_SIZE_POWER;o&Ne.BLOCK_SIZE_MASK&&h++;const d=Ne.calculateBlackPoints(u,c,h,s,o),p=new ze(s,o);Ne.calculateThresholdForBlock(u,c,h,s,o,d,p),this.matrix=p}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(r){return new Ne(r)}static calculateThresholdForBlock(r,s,o,u,c,h,d){const p=c-Ne.BLOCK_SIZE,w=u-Ne.BLOCK_SIZE;for(let _=0;_<o;_++){let T=_<<Ne.BLOCK_SIZE_POWER;T>p&&(T=p);const S=Ne.cap(_,2,o-3);for(let M=0;M<s;M++){let z=M<<Ne.BLOCK_SIZE_POWER;z>w&&(z=w);const W=Ne.cap(M,2,s-3);let q=0;for(let le=-2;le<=2;le++){const ue=h[S+le];q+=ue[W-2]+ue[W-1]+ue[W]+ue[W+1]+ue[W+2]}const J=q/25;Ne.thresholdBlock(r,z,T,J,u,d)}}}static cap(r,s,o){return r<s?s:r>o?o:r}static thresholdBlock(r,s,o,u,c,h){for(let d=0,p=o*c+s;d<Ne.BLOCK_SIZE;d++,p+=c)for(let w=0;w<Ne.BLOCK_SIZE;w++)(r[p+w]&255)<=u&&h.set(s+w,o+d)}static calculateBlackPoints(r,s,o,u,c){const h=c-Ne.BLOCK_SIZE,d=u-Ne.BLOCK_SIZE,p=new Array(o);for(let w=0;w<o;w++){p[w]=new Int32Array(s);let _=w<<Ne.BLOCK_SIZE_POWER;_>h&&(_=h);for(let T=0;T<s;T++){let S=T<<Ne.BLOCK_SIZE_POWER;S>d&&(S=d);let M=0,z=255,W=0;for(let J=0,le=_*u+S;J<Ne.BLOCK_SIZE;J++,le+=u){for(let ue=0;ue<Ne.BLOCK_SIZE;ue++){const oe=r[le+ue]&255;M+=oe,oe<z&&(z=oe),oe>W&&(W=oe)}if(W-z>Ne.MIN_DYNAMIC_RANGE)for(J++,le+=u;J<Ne.BLOCK_SIZE;J++,le+=u)for(let ue=0;ue<Ne.BLOCK_SIZE;ue++)M+=r[le+ue]&255}let q=M>>Ne.BLOCK_SIZE_POWER*2;if(W-z<=Ne.MIN_DYNAMIC_RANGE&&(q=z/2,w>0&&T>0)){const J=(p[w-1][T]+2*p[w][T-1]+p[w-1][T-1])/4;z<J&&(q=J)}p[w][T]=q}}return p}}Ne.BLOCK_SIZE_POWER=3,Ne.BLOCK_SIZE=1<<Ne.BLOCK_SIZE_POWER,Ne.BLOCK_SIZE_MASK=Ne.BLOCK_SIZE-1,Ne.MINIMUM_DIMENSION=Ne.BLOCK_SIZE*5,Ne.MIN_DYNAMIC_RANGE=24;class ge{constructor(r,s){this.width=r,this.height=s}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(r,s,o,u){throw new F("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new F("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new F("This luminance source does not support rotation by 45 degrees.")}toString(){const r=new Uint8ClampedArray(this.width);let s=new L;for(let o=0;o<this.height;o++){const u=this.getRow(o,r);for(let c=0;c<this.width;c++){const h=u[c]&255;let d;h<64?d="#":h<128?d="+":h<192?d=".":d=" ",s.append(d)}s.append(`
`)}return s.toString()}}class Ie extends ge{constructor(r){super(r.getWidth(),r.getHeight()),this.delegate=r}getRow(r,s){const o=this.delegate.getRow(r,s),u=this.getWidth();for(let c=0;c<u;c++)o[c]=255-(o[c]&255);return o}getMatrix(){const r=this.delegate.getMatrix(),s=this.getWidth()*this.getHeight(),o=new Uint8ClampedArray(s);for(let u=0;u<s;u++)o[u]=255-(r[u]&255);return o}isCropSupported(){return this.delegate.isCropSupported()}crop(r,s,o,u){return new Ie(this.delegate.crop(r,s,o,u))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new Ie(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new Ie(this.delegate.rotateCounterClockwise45())}}class Se extends ge{constructor(r){super(r.width,r.height),this.canvas=r,this.tempCanvasElement=null,this.buffer=Se.makeBufferFromCanvasImageData(r)}static makeBufferFromCanvasImageData(r){const s=r.getContext("2d").getImageData(0,0,r.width,r.height);return Se.toGrayscaleBuffer(s.data,r.width,r.height)}static toGrayscaleBuffer(r,s,o){const u=new Uint8ClampedArray(s*o);for(let c=0,h=0,d=r.length;c<d;c+=4,h++){let p;if(r[c+3]===0)p=255;else{const _=r[c],T=r[c+1],S=r[c+2];p=306*_+601*T+117*S+512>>10}u[h]=p}return u}getRow(r,s){if(r<0||r>=this.getHeight())throw new v("Requested row is outside the image: "+r);const o=this.getWidth(),u=r*o;return s===null?s=this.buffer.slice(u,u+o):(s.length<o&&(s=new Uint8ClampedArray(o)),s.set(this.buffer.slice(u,u+o))),s}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(r,s,o,u){return super.crop(r,s,o,u),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement}rotate(r){const s=this.getTempCanvasElement(),o=s.getContext("2d"),u=r*Se.DEGREE_TO_RADIANS,c=this.canvas.width,h=this.canvas.height,d=Math.ceil(Math.abs(Math.cos(u))*c+Math.abs(Math.sin(u))*h),p=Math.ceil(Math.abs(Math.sin(u))*c+Math.abs(Math.cos(u))*h);return s.width=d,s.height=p,o.translate(d/2,p/2),o.rotate(u),o.drawImage(this.canvas,c/-2,h/-2),this.buffer=Se.makeBufferFromCanvasImageData(s),this}invert(){return new Ie(this)}}Se.DEGREE_TO_RADIANS=Math.PI/180;class ht{constructor(r,s,o){this.deviceId=r,this.label=s,this.kind="videoinput",this.groupId=o||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var Be=(globalThis||Ta||self||window||void 0)&&(globalThis||Ta||self||window||void 0).__awaiter||function(I,r,s,o){function u(c){return c instanceof s?c:new s(function(h){h(c)})}return new(s||(s=Promise))(function(c,h){function d(_){try{w(o.next(_))}catch(T){h(T)}}function p(_){try{w(o.throw(_))}catch(T){h(T)}}function w(_){_.done?c(_.value):u(_.value).then(d,p)}w((o=o.apply(I,r||[])).next())})};class On{constructor(r,s=500,o){this.reader=r,this.timeBetweenScansMillis=s,this._hints=o,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(r){this._timeBetweenDecodingAttempts=r<0?0:r}set hints(r){this._hints=r||null}get hints(){return this._hints}listVideoInputDevices(){return Be(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const r=yield navigator.mediaDevices.enumerateDevices(),s=[];for(const o of r){const u=o.kind==="video"?"videoinput":o.kind;if(u!=="videoinput")continue;const c=o.deviceId||o.id,h=o.label||`Video device ${s.length+1}`,d=o.groupId,p={deviceId:c,label:h,kind:u,groupId:d};s.push(p)}return s})}getVideoInputDevices(){return Be(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(s=>new ht(s.deviceId,s.label))})}findDeviceById(r){return Be(this,void 0,void 0,function*(){const s=yield this.listVideoInputDevices();return s?s.find(o=>o.deviceId===r):null})}decodeFromInputVideoDevice(r,s){return Be(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(r,s)})}decodeOnceFromVideoDevice(r,s){return Be(this,void 0,void 0,function*(){this.reset();let o;r?o={deviceId:{exact:r}}:o={facingMode:"environment"};const u={video:o};return yield this.decodeOnceFromConstraints(u,s)})}decodeOnceFromConstraints(r,s){return Be(this,void 0,void 0,function*(){const o=yield navigator.mediaDevices.getUserMedia(r);return yield this.decodeOnceFromStream(o,s)})}decodeOnceFromStream(r,s){return Be(this,void 0,void 0,function*(){this.reset();const o=yield this.attachStreamToVideo(r,s);return yield this.decodeOnce(o)})}decodeFromInputVideoDeviceContinuously(r,s,o){return Be(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(r,s,o)})}decodeFromVideoDevice(r,s,o){return Be(this,void 0,void 0,function*(){let u;r?u={deviceId:{exact:r}}:u={facingMode:"environment"};const c={video:u};return yield this.decodeFromConstraints(c,s,o)})}decodeFromConstraints(r,s,o){return Be(this,void 0,void 0,function*(){const u=yield navigator.mediaDevices.getUserMedia(r);return yield this.decodeFromStream(u,s,o)})}decodeFromStream(r,s,o){return Be(this,void 0,void 0,function*(){this.reset();const u=yield this.attachStreamToVideo(r,s);return yield this.decodeContinuously(u,o)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(r,s){return Be(this,void 0,void 0,function*(){const o=this.prepareVideoElement(s);return this.addVideoSource(o,r),this.videoElement=o,this.stream=r,yield this.playVideoOnLoadAsync(o),o})}playVideoOnLoadAsync(r){return new Promise((s,o)=>this.playVideoOnLoad(r,()=>s()))}playVideoOnLoad(r,s){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(r),r.addEventListener("ended",this.videoEndedListener),r.addEventListener("canplay",this.videoCanPlayListener),r.addEventListener("playing",s),this.tryPlayVideo(r)}isVideoPlaying(r){return r.currentTime>0&&!r.paused&&!r.ended&&r.readyState>2}tryPlayVideo(r){return Be(this,void 0,void 0,function*(){if(this.isVideoPlaying(r)){console.warn("Trying to play video that is already playing.");return}try{yield r.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(r,s){const o=document.getElementById(r);if(!o)throw new C(`element with id '${r}' not found`);if(o.nodeName.toLowerCase()!==s.toLowerCase())throw new C(`element with id '${r}' must be an ${s} element`);return o}decodeFromImage(r,s){if(!r&&!s)throw new C("either imageElement with a src set or an url must be provided");return s&&!r?this.decodeFromImageUrl(s):this.decodeFromImageElement(r)}decodeFromVideo(r,s){if(!r&&!s)throw new C("Either an element with a src set or an URL must be provided");return s&&!r?this.decodeFromVideoUrl(s):this.decodeFromVideoElement(r)}decodeFromVideoContinuously(r,s,o){if(r===void 0&&s===void 0)throw new C("Either an element with a src set or an URL must be provided");return s&&!r?this.decodeFromVideoUrlContinuously(s,o):this.decodeFromVideoElementContinuously(r,o)}decodeFromImageElement(r){if(!r)throw new C("An image element must be provided.");this.reset();const s=this.prepareImageElement(r);this.imageElement=s;let o;return this.isImageLoaded(s)?o=this.decodeOnce(s,!1,!0):o=this._decodeOnLoadImage(s),o}decodeFromVideoElement(r){const s=this._decodeFromVideoElementSetup(r);return this._decodeOnLoadVideo(s)}decodeFromVideoElementContinuously(r,s){const o=this._decodeFromVideoElementSetup(r);return this._decodeOnLoadVideoContinuously(o,s)}_decodeFromVideoElementSetup(r){if(!r)throw new C("A video element must be provided.");this.reset();const s=this.prepareVideoElement(r);return this.videoElement=s,s}decodeFromImageUrl(r){if(!r)throw new C("An URL must be provided.");this.reset();const s=this.prepareImageElement();this.imageElement=s;const o=this._decodeOnLoadImage(s);return s.src=r,o}decodeFromVideoUrl(r){if(!r)throw new C("An URL must be provided.");this.reset();const s=this.prepareVideoElement(),o=this.decodeFromVideoElement(s);return s.src=r,o}decodeFromVideoUrlContinuously(r,s){if(!r)throw new C("An URL must be provided.");this.reset();const o=this.prepareVideoElement(),u=this.decodeFromVideoElementContinuously(o,s);return o.src=r,u}_decodeOnLoadImage(r){return new Promise((s,o)=>{this.imageLoadedListener=()=>this.decodeOnce(r,!1,!0).then(s,o),r.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(r){return Be(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(r),yield this.decodeOnce(r)})}_decodeOnLoadVideoContinuously(r,s){return Be(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(r),this.decodeContinuously(r,s)})}isImageLoaded(r){return!(!r.complete||r.naturalWidth===0)}prepareImageElement(r){let s;return typeof r>"u"&&(s=document.createElement("img"),s.width=200,s.height=200),typeof r=="string"&&(s=this.getMediaElement(r,"img")),r instanceof HTMLImageElement&&(s=r),s}prepareVideoElement(r){let s;return!r&&typeof document<"u"&&(s=document.createElement("video"),s.width=200,s.height=200),typeof r=="string"&&(s=this.getMediaElement(r,"video")),r instanceof HTMLVideoElement&&(s=r),s.setAttribute("autoplay","true"),s.setAttribute("muted","true"),s.setAttribute("playsinline","true"),s}decodeOnce(r,s=!0,o=!0){this._stopAsyncDecode=!1;const u=(c,h)=>{if(this._stopAsyncDecode){h(new ee("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const d=this.decode(r);c(d)}catch(d){const p=s&&d instanceof ee,_=(d instanceof V||d instanceof N)&&o;if(p||_)return setTimeout(u,this._timeBetweenDecodingAttempts,c,h);h(d)}};return new Promise((c,h)=>u(c,h))}decodeContinuously(r,s){this._stopContinuousDecode=!1;const o=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const u=this.decode(r);s(u,null),setTimeout(o,this.timeBetweenScansMillis)}catch(u){s(null,u);const c=u instanceof V||u instanceof N,h=u instanceof ee;(c||h)&&setTimeout(o,this._timeBetweenDecodingAttempts)}};o()}decode(r){const s=this.createBinaryBitmap(r);return this.decodeBitmap(s)}_isHTMLVideoElement(r){return r.videoWidth!==0}drawFrameOnCanvas(r,s,o){s||(s={sx:0,sy:0,sWidth:r.videoWidth,sHeight:r.videoHeight,dx:0,dy:0,dWidth:r.videoWidth,dHeight:r.videoHeight}),o||(o=this.captureCanvasContext),o.drawImage(r,s.sx,s.sy,s.sWidth,s.sHeight,s.dx,s.dy,s.dWidth,s.dHeight)}drawImageOnCanvas(r,s,o=this.captureCanvasContext){s||(s={sx:0,sy:0,sWidth:r.naturalWidth,sHeight:r.naturalHeight,dx:0,dy:0,dWidth:r.naturalWidth,dHeight:r.naturalHeight}),o||(o=this.captureCanvasContext),o.drawImage(r,s.sx,s.sy,s.sWidth,s.sHeight,s.dx,s.dy,s.dWidth,s.dHeight)}createBinaryBitmap(r){this.getCaptureCanvasContext(r),this._isHTMLVideoElement(r)?this.drawFrameOnCanvas(r):this.drawImageOnCanvas(r);const s=this.getCaptureCanvas(r),o=new Se(s),u=new Ne(o);return new D(u)}getCaptureCanvasContext(r){if(!this.captureCanvasContext){const o=this.getCaptureCanvas(r).getContext("2d");this.captureCanvasContext=o}return this.captureCanvasContext}getCaptureCanvas(r){if(!this.captureCanvas){const s=this.createCaptureCanvas(r);this.captureCanvas=s}return this.captureCanvas}decodeBitmap(r){return this.reader.decode(r,this._hints)}createCaptureCanvas(r){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const s=document.createElement("canvas");let o,u;return typeof r<"u"&&(r instanceof HTMLVideoElement?(o=r.videoWidth,u=r.videoHeight):r instanceof HTMLImageElement&&(o=r.naturalWidth||r.width,u=r.naturalHeight||r.height)),s.style.width=o+"px",s.style.height=u+"px",s.width=o,s.height=u,s}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(r=>r.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(r,s){try{r.srcObject=s}catch{r.src=URL.createObjectURL(s)}}cleanVideoSource(r){try{r.srcObject=null}catch{r.src=""}this.videoElement.removeAttribute("src")}}class ut{constructor(r,s,o=s==null?0:8*s.length,u,c,h=X.currentTimeMillis()){this.text=r,this.rawBytes=s,this.numBits=o,this.resultPoints=u,this.format=c,this.timestamp=h,this.text=r,this.rawBytes=s,o==null?this.numBits=s==null?0:8*s.length:this.numBits=o,this.resultPoints=u,this.format=c,this.resultMetadata=null,h==null?this.timestamp=X.currentTimeMillis():this.timestamp=h}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(r,s){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(r,s)}putAllMetadata(r){r!==null&&(this.resultMetadata===null?this.resultMetadata=r:this.resultMetadata=new Map(r))}addResultPoints(r){const s=this.resultPoints;if(s===null)this.resultPoints=r;else if(r!==null&&r.length>0){const o=new Array(s.length+r.length);X.arraycopy(s,0,o,0,s.length),X.arraycopy(r,0,o,s.length,r.length),this.resultPoints=o}}getTimestamp(){return this.timestamp}toString(){return this.text}}var Nr;(function(I){I[I.AZTEC=0]="AZTEC",I[I.CODABAR=1]="CODABAR",I[I.CODE_39=2]="CODE_39",I[I.CODE_93=3]="CODE_93",I[I.CODE_128=4]="CODE_128",I[I.DATA_MATRIX=5]="DATA_MATRIX",I[I.EAN_8=6]="EAN_8",I[I.EAN_13=7]="EAN_13",I[I.ITF=8]="ITF",I[I.MAXICODE=9]="MAXICODE",I[I.PDF_417=10]="PDF_417",I[I.QR_CODE=11]="QR_CODE",I[I.RSS_14=12]="RSS_14",I[I.RSS_EXPANDED=13]="RSS_EXPANDED",I[I.UPC_A=14]="UPC_A",I[I.UPC_E=15]="UPC_E",I[I.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Nr||(Nr={}));var Ee=Nr,cr;(function(I){I[I.OTHER=0]="OTHER",I[I.ORIENTATION=1]="ORIENTATION",I[I.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",I[I.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",I[I.ISSUE_NUMBER=4]="ISSUE_NUMBER",I[I.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",I[I.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",I[I.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",I[I.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",I[I.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",I[I.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(cr||(cr={}));var kt=cr;class Mi{constructor(r,s,o,u,c=-1,h=-1){this.rawBytes=r,this.text=s,this.byteSegments=o,this.ecLevel=u,this.structuredAppendSequenceNumber=c,this.structuredAppendParity=h,this.numBits=r==null?0:8*r.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(r){this.numBits=r}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(r){this.errorsCorrected=r}getErasures(){return this.erasures}setErasures(r){this.erasures=r}getOther(){return this.other}setOther(r){this.other=r}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class ki{exp(r){return this.expTable[r]}log(r){if(r===0)throw new v;return this.logTable[r]}static addOrSubtract(r,s){return r^s}}class An{constructor(r,s){if(s.length===0)throw new v;this.field=r;const o=s.length;if(o>1&&s[0]===0){let u=1;for(;u<o&&s[u]===0;)u++;u===o?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(o-u),X.arraycopy(s,u,this.coefficients,0,this.coefficients.length))}else this.coefficients=s}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(r){return this.coefficients[this.coefficients.length-1-r]}evaluateAt(r){if(r===0)return this.getCoefficient(0);const s=this.coefficients;let o;if(r===1){o=0;for(let h=0,d=s.length;h!==d;h++){const p=s[h];o=ki.addOrSubtract(o,p)}return o}o=s[0];const u=s.length,c=this.field;for(let h=1;h<u;h++)o=ki.addOrSubtract(c.multiply(r,o),s[h]);return o}addOrSubtract(r){if(!this.field.equals(r.field))throw new v("GenericGFPolys do not have same GenericGF field");if(this.isZero())return r;if(r.isZero())return this;let s=this.coefficients,o=r.coefficients;if(s.length>o.length){const h=s;s=o,o=h}let u=new Int32Array(o.length);const c=o.length-s.length;X.arraycopy(o,0,u,0,c);for(let h=c;h<o.length;h++)u[h]=ki.addOrSubtract(s[h-c],o[h]);return new An(this.field,u)}multiply(r){if(!this.field.equals(r.field))throw new v("GenericGFPolys do not have same GenericGF field");if(this.isZero()||r.isZero())return this.field.getZero();const s=this.coefficients,o=s.length,u=r.coefficients,c=u.length,h=new Int32Array(o+c-1),d=this.field;for(let p=0;p<o;p++){const w=s[p];for(let _=0;_<c;_++)h[p+_]=ki.addOrSubtract(h[p+_],d.multiply(w,u[_]))}return new An(d,h)}multiplyScalar(r){if(r===0)return this.field.getZero();if(r===1)return this;const s=this.coefficients.length,o=this.field,u=new Int32Array(s),c=this.coefficients;for(let h=0;h<s;h++)u[h]=o.multiply(c[h],r);return new An(o,u)}multiplyByMonomial(r,s){if(r<0)throw new v;if(s===0)return this.field.getZero();const o=this.coefficients,u=o.length,c=new Int32Array(u+r),h=this.field;for(let d=0;d<u;d++)c[d]=h.multiply(o[d],s);return new An(h,c)}divide(r){if(!this.field.equals(r.field))throw new v("GenericGFPolys do not have same GenericGF field");if(r.isZero())throw new v("Divide by 0");const s=this.field;let o=s.getZero(),u=this;const c=r.getCoefficient(r.getDegree()),h=s.inverse(c);for(;u.getDegree()>=r.getDegree()&&!u.isZero();){const d=u.getDegree()-r.getDegree(),p=s.multiply(u.getCoefficient(u.getDegree()),h),w=r.multiplyByMonomial(d,p),_=s.buildMonomial(d,p);o=o.addOrSubtract(_),u=u.addOrSubtract(w)}return[o,u]}toString(){let r="";for(let s=this.getDegree();s>=0;s--){let o=this.getCoefficient(s);if(o!==0){if(o<0?(r+=" - ",o=-o):r.length>0&&(r+=" + "),s===0||o!==1){const u=this.field.log(o);u===0?r+="1":u===1?r+="a":(r+="a^",r+=u)}s!==0&&(s===1?r+="x":(r+="x^",r+=s))}}return r}}class Rs extends m{}Rs.kind="ArithmeticException";class je extends ki{constructor(r,s,o){super(),this.primitive=r,this.size=s,this.generatorBase=o;const u=new Int32Array(s);let c=1;for(let d=0;d<s;d++)u[d]=c,c*=2,c>=s&&(c^=r,c&=s-1);this.expTable=u;const h=new Int32Array(s);for(let d=0;d<s-1;d++)h[u[d]]=d;this.logTable=h,this.zero=new An(this,Int32Array.from([0])),this.one=new An(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(r,s){if(r<0)throw new v;if(s===0)return this.zero;const o=new Int32Array(r+1);return o[0]=s,new An(this,o)}inverse(r){if(r===0)throw new Rs;return this.expTable[this.size-this.logTable[r]-1]}multiply(r,s){return r===0||s===0?0:this.expTable[(this.logTable[r]+this.logTable[s])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+B.toHexString(this.primitive)+","+this.size+")"}equals(r){return r===this}}je.AZTEC_DATA_12=new je(4201,4096,1),je.AZTEC_DATA_10=new je(1033,1024,1),je.AZTEC_DATA_6=new je(67,64,1),je.AZTEC_PARAM=new je(19,16,1),je.QR_CODE_FIELD_256=new je(285,256,0),je.DATA_MATRIX_FIELD_256=new je(301,256,1),je.AZTEC_DATA_8=je.DATA_MATRIX_FIELD_256,je.MAXICODE_FIELD_64=je.AZTEC_DATA_6;class Wr extends m{}Wr.kind="ReedSolomonException";class Jn extends m{}Jn.kind="IllegalStateException";class Ns{constructor(r){this.field=r}decode(r,s){const o=this.field,u=new An(o,r),c=new Int32Array(s);let h=!0;for(let M=0;M<s;M++){const z=u.evaluateAt(o.exp(M+o.getGeneratorBase()));c[c.length-1-M]=z,z!==0&&(h=!1)}if(h)return;const d=new An(o,c),p=this.runEuclideanAlgorithm(o.buildMonomial(s,1),d,s),w=p[0],_=p[1],T=this.findErrorLocations(w),S=this.findErrorMagnitudes(_,T);for(let M=0;M<T.length;M++){const z=r.length-1-o.log(T[M]);if(z<0)throw new Wr("Bad error location");r[z]=je.addOrSubtract(r[z],S[M])}}runEuclideanAlgorithm(r,s,o){if(r.getDegree()<s.getDegree()){const M=r;r=s,s=M}const u=this.field;let c=r,h=s,d=u.getZero(),p=u.getOne();for(;h.getDegree()>=(o/2|0);){let M=c,z=d;if(c=h,d=p,c.isZero())throw new Wr("r_{i-1} was zero");h=M;let W=u.getZero();const q=c.getCoefficient(c.getDegree()),J=u.inverse(q);for(;h.getDegree()>=c.getDegree()&&!h.isZero();){const le=h.getDegree()-c.getDegree(),ue=u.multiply(h.getCoefficient(h.getDegree()),J);W=W.addOrSubtract(u.buildMonomial(le,ue)),h=h.addOrSubtract(c.multiplyByMonomial(le,ue))}if(p=W.multiply(d).addOrSubtract(z),h.getDegree()>=c.getDegree())throw new Jn("Division algorithm failed to reduce polynomial?")}const w=p.getCoefficient(0);if(w===0)throw new Wr("sigmaTilde(0) was zero");const _=u.inverse(w),T=p.multiplyScalar(_),S=h.multiplyScalar(_);return[T,S]}findErrorLocations(r){const s=r.getDegree();if(s===1)return Int32Array.from([r.getCoefficient(1)]);const o=new Int32Array(s);let u=0;const c=this.field;for(let h=1;h<c.getSize()&&u<s;h++)r.evaluateAt(h)===0&&(o[u]=c.inverse(h),u++);if(u!==s)throw new Wr("Error locator degree does not match number of roots");return o}findErrorMagnitudes(r,s){const o=s.length,u=new Int32Array(o),c=this.field;for(let h=0;h<o;h++){const d=c.inverse(s[h]);let p=1;for(let w=0;w<o;w++)if(h!==w){const _=c.multiply(s[w],d),T=_&1?_&-2:_|1;p=c.multiply(p,T)}u[h]=c.multiply(r.evaluateAt(d),c.inverse(p)),c.getGeneratorBase()!==0&&(u[h]=c.multiply(u[h],d))}return u}}var Vt;(function(I){I[I.UPPER=0]="UPPER",I[I.LOWER=1]="LOWER",I[I.MIXED=2]="MIXED",I[I.DIGIT=3]="DIGIT",I[I.PUNCT=4]="PUNCT",I[I.BINARY=5]="BINARY"})(Vt||(Vt={}));class nt{decode(r){this.ddata=r;let s=r.getBits(),o=this.extractBits(s),u=this.correctBits(o),c=nt.convertBoolArrayToByteArray(u),h=nt.getEncodedData(u),d=new Mi(c,h,null,null);return d.setNumBits(u.length),d}static highLevelDecode(r){return this.getEncodedData(r)}static getEncodedData(r){let s=r.length,o=Vt.UPPER,u=Vt.UPPER,c="",h=0;for(;h<s;)if(u===Vt.BINARY){if(s-h<5)break;let d=nt.readCode(r,h,5);if(h+=5,d===0){if(s-h<11)break;d=nt.readCode(r,h,11)+31,h+=11}for(let p=0;p<d;p++){if(s-h<8){h=s;break}const w=nt.readCode(r,h,8);c+=G.castAsNonUtf8Char(w),h+=8}u=o}else{let d=u===Vt.DIGIT?4:5;if(s-h<d)break;let p=nt.readCode(r,h,d);h+=d;let w=nt.getCharacter(u,p);w.startsWith("CTRL_")?(o=u,u=nt.getTable(w.charAt(5)),w.charAt(6)==="L"&&(o=u)):(c+=w,u=o)}return c}static getTable(r){switch(r){case"L":return Vt.LOWER;case"P":return Vt.PUNCT;case"M":return Vt.MIXED;case"D":return Vt.DIGIT;case"B":return Vt.BINARY;case"U":default:return Vt.UPPER}}static getCharacter(r,s){switch(r){case Vt.UPPER:return nt.UPPER_TABLE[s];case Vt.LOWER:return nt.LOWER_TABLE[s];case Vt.MIXED:return nt.MIXED_TABLE[s];case Vt.PUNCT:return nt.PUNCT_TABLE[s];case Vt.DIGIT:return nt.DIGIT_TABLE[s];default:throw new Jn("Bad table")}}correctBits(r){let s,o;this.ddata.getNbLayers()<=2?(o=6,s=je.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(o=8,s=je.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(o=10,s=je.AZTEC_DATA_10):(o=12,s=je.AZTEC_DATA_12);let u=this.ddata.getNbDatablocks(),c=r.length/o;if(c<u)throw new N;let h=r.length%o,d=new Int32Array(c);for(let S=0;S<c;S++,h+=o)d[S]=nt.readCode(r,h,o);try{new Ns(s).decode(d,c-u)}catch(S){throw new N(S)}let p=(1<<o)-1,w=0;for(let S=0;S<u;S++){let M=d[S];if(M===0||M===p)throw new N;(M===1||M===p-1)&&w++}let _=new Array(u*o-w),T=0;for(let S=0;S<u;S++){let M=d[S];if(M===1||M===p-1)_.fill(M>1,T,T+o-1),T+=o-1;else for(let z=o-1;z>=0;--z)_[T++]=(M&1<<z)!==0}return _}extractBits(r){let s=this.ddata.isCompact(),o=this.ddata.getNbLayers(),u=(s?11:14)+o*4,c=new Int32Array(u),h=new Array(this.totalBitsInLayer(o,s));if(s)for(let d=0;d<c.length;d++)c[d]=d;else{let d=u+1+2*B.truncDivision(B.truncDivision(u,2)-1,15),p=u/2,w=B.truncDivision(d,2);for(let _=0;_<p;_++){let T=_+B.truncDivision(_,15);c[p-_-1]=w-T-1,c[p+_]=w+T+1}}for(let d=0,p=0;d<o;d++){let w=(o-d)*4+(s?9:12),_=d*2,T=u-1-_;for(let S=0;S<w;S++){let M=S*2;for(let z=0;z<2;z++)h[p+M+z]=r.get(c[_+z],c[_+S]),h[p+2*w+M+z]=r.get(c[_+S],c[T-z]),h[p+4*w+M+z]=r.get(c[T-z],c[T-S]),h[p+6*w+M+z]=r.get(c[T-S],c[_+z])}p+=w*8}return h}static readCode(r,s,o){let u=0;for(let c=s;c<s+o;c++)u<<=1,r[c]&&(u|=1);return u}static readByte(r,s){let o=r.length-s;return o>=8?nt.readCode(r,s,8):nt.readCode(r,s,o)<<8-o}static convertBoolArrayToByteArray(r){let s=new Uint8Array((r.length+7)/8);for(let o=0;o<s.length;o++)s[o]=nt.readByte(r,8*o);return s}totalBitsInLayer(r,s){return((s?88:112)+16*r)*r}}nt.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],nt.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],nt.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],nt.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],nt.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class Fe{constructor(){}static round(r){return r===NaN?0:r<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:r>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:r+(r<0?-.5:.5)|0}static distance(r,s,o,u){const c=r-o,h=s-u;return Math.sqrt(c*c+h*h)}static sum(r){let s=0;for(let o=0,u=r.length;o!==u;o++){const c=r[o];s+=c}return s}}class Ut{static floatToIntBits(r){return r}}Ut.MAX_VALUE=Number.MAX_SAFE_INTEGER;class de{constructor(r,s){this.x=r,this.y=s}getX(){return this.x}getY(){return this.y}equals(r){if(r instanceof de){const s=r;return this.x===s.x&&this.y===s.y}return!1}hashCode(){return 31*Ut.floatToIntBits(this.x)+Ut.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(r){const s=this.distance(r[0],r[1]),o=this.distance(r[1],r[2]),u=this.distance(r[0],r[2]);let c,h,d;if(o>=s&&o>=u?(h=r[0],c=r[1],d=r[2]):u>=o&&u>=s?(h=r[1],c=r[0],d=r[2]):(h=r[2],c=r[0],d=r[1]),this.crossProductZ(c,h,d)<0){const p=c;c=d,d=p}r[0]=c,r[1]=h,r[2]=d}static distance(r,s){return Fe.distance(r.x,r.y,s.x,s.y)}static crossProductZ(r,s,o){const u=s.x,c=s.y;return(o.x-u)*(r.y-c)-(o.y-c)*(r.x-u)}}class fi{constructor(r,s){this.bits=r,this.points=s}getBits(){return this.bits}getPoints(){return this.points}}class Ul extends fi{constructor(r,s,o,u,c){super(r,s),this.compact=o,this.nbDatablocks=u,this.nbLayers=c}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class hr{constructor(r,s,o,u){this.image=r,this.height=r.getHeight(),this.width=r.getWidth(),s==null&&(s=hr.INIT_SIZE),o==null&&(o=r.getWidth()/2|0),u==null&&(u=r.getHeight()/2|0);const c=s/2|0;if(this.leftInit=o-c,this.rightInit=o+c,this.upInit=u-c,this.downInit=u+c,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new ee}detect(){let r=this.leftInit,s=this.rightInit,o=this.upInit,u=this.downInit,c=!1,h=!0,d=!1,p=!1,w=!1,_=!1,T=!1;const S=this.width,M=this.height;for(;h;){h=!1;let z=!0;for(;(z||!p)&&s<S;)z=this.containsBlackPoint(o,u,s,!1),z?(s++,h=!0,p=!0):p||s++;if(s>=S){c=!0;break}let W=!0;for(;(W||!w)&&u<M;)W=this.containsBlackPoint(r,s,u,!0),W?(u++,h=!0,w=!0):w||u++;if(u>=M){c=!0;break}let q=!0;for(;(q||!_)&&r>=0;)q=this.containsBlackPoint(o,u,r,!1),q?(r--,h=!0,_=!0):_||r--;if(r<0){c=!0;break}let J=!0;for(;(J||!T)&&o>=0;)J=this.containsBlackPoint(r,s,o,!0),J?(o--,h=!0,T=!0):T||o--;if(o<0){c=!0;break}h&&(d=!0)}if(!c&&d){const z=s-r;let W=null;for(let ue=1;W===null&&ue<z;ue++)W=this.getBlackPointOnSegment(r,u-ue,r+ue,u);if(W==null)throw new ee;let q=null;for(let ue=1;q===null&&ue<z;ue++)q=this.getBlackPointOnSegment(r,o+ue,r+ue,o);if(q==null)throw new ee;let J=null;for(let ue=1;J===null&&ue<z;ue++)J=this.getBlackPointOnSegment(s,o+ue,s-ue,o);if(J==null)throw new ee;let le=null;for(let ue=1;le===null&&ue<z;ue++)le=this.getBlackPointOnSegment(s,u-ue,s-ue,u);if(le==null)throw new ee;return this.centerEdges(le,W,J,q)}else throw new ee}getBlackPointOnSegment(r,s,o,u){const c=Fe.round(Fe.distance(r,s,o,u)),h=(o-r)/c,d=(u-s)/c,p=this.image;for(let w=0;w<c;w++){const _=Fe.round(r+w*h),T=Fe.round(s+w*d);if(p.get(_,T))return new de(_,T)}return null}centerEdges(r,s,o,u){const c=r.getX(),h=r.getY(),d=s.getX(),p=s.getY(),w=o.getX(),_=o.getY(),T=u.getX(),S=u.getY(),M=hr.CORR;return c<this.width/2?[new de(T-M,S+M),new de(d+M,p+M),new de(w-M,_-M),new de(c+M,h-M)]:[new de(T+M,S+M),new de(d+M,p-M),new de(w-M,_+M),new de(c-M,h-M)]}containsBlackPoint(r,s,o,u){const c=this.image;if(u){for(let h=r;h<=s;h++)if(c.get(h,o))return!0}else for(let h=r;h<=s;h++)if(c.get(o,h))return!0;return!1}}hr.INIT_SIZE=10,hr.CORR=1;class fa{static checkAndNudgePoints(r,s){const o=r.getWidth(),u=r.getHeight();let c=!0;for(let h=0;h<s.length&&c;h+=2){const d=Math.floor(s[h]),p=Math.floor(s[h+1]);if(d<-1||d>o||p<-1||p>u)throw new ee;c=!1,d===-1?(s[h]=0,c=!0):d===o&&(s[h]=o-1,c=!0),p===-1?(s[h+1]=0,c=!0):p===u&&(s[h+1]=u-1,c=!0)}c=!0;for(let h=s.length-2;h>=0&&c;h-=2){const d=Math.floor(s[h]),p=Math.floor(s[h+1]);if(d<-1||d>o||p<-1||p>u)throw new ee;c=!1,d===-1?(s[h]=0,c=!0):d===o&&(s[h]=o-1,c=!0),p===-1?(s[h+1]=0,c=!0):p===u&&(s[h+1]=u-1,c=!0)}}}class hn{constructor(r,s,o,u,c,h,d,p,w){this.a11=r,this.a21=s,this.a31=o,this.a12=u,this.a22=c,this.a32=h,this.a13=d,this.a23=p,this.a33=w}static quadrilateralToQuadrilateral(r,s,o,u,c,h,d,p,w,_,T,S,M,z,W,q){const J=hn.quadrilateralToSquare(r,s,o,u,c,h,d,p);return hn.squareToQuadrilateral(w,_,T,S,M,z,W,q).times(J)}transformPoints(r){const s=r.length,o=this.a11,u=this.a12,c=this.a13,h=this.a21,d=this.a22,p=this.a23,w=this.a31,_=this.a32,T=this.a33;for(let S=0;S<s;S+=2){const M=r[S],z=r[S+1],W=c*M+p*z+T;r[S]=(o*M+h*z+w)/W,r[S+1]=(u*M+d*z+_)/W}}transformPointsWithValues(r,s){const o=this.a11,u=this.a12,c=this.a13,h=this.a21,d=this.a22,p=this.a23,w=this.a31,_=this.a32,T=this.a33,S=r.length;for(let M=0;M<S;M++){const z=r[M],W=s[M],q=c*z+p*W+T;r[M]=(o*z+h*W+w)/q,s[M]=(u*z+d*W+_)/q}}static squareToQuadrilateral(r,s,o,u,c,h,d,p){const w=r-o+c-d,_=s-u+h-p;if(w===0&&_===0)return new hn(o-r,c-o,r,u-s,h-u,s,0,0,1);{const T=o-c,S=d-c,M=u-h,z=p-h,W=T*z-S*M,q=(w*z-S*_)/W,J=(T*_-w*M)/W;return new hn(o-r+q*o,d-r+J*d,r,u-s+q*u,p-s+J*p,s,q,J,1)}}static quadrilateralToSquare(r,s,o,u,c,h,d,p){return hn.squareToQuadrilateral(r,s,o,u,c,h,d,p).buildAdjoint()}buildAdjoint(){return new hn(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(r){return new hn(this.a11*r.a11+this.a21*r.a12+this.a31*r.a13,this.a11*r.a21+this.a21*r.a22+this.a31*r.a23,this.a11*r.a31+this.a21*r.a32+this.a31*r.a33,this.a12*r.a11+this.a22*r.a12+this.a32*r.a13,this.a12*r.a21+this.a22*r.a22+this.a32*r.a23,this.a12*r.a31+this.a22*r.a32+this.a32*r.a33,this.a13*r.a11+this.a23*r.a12+this.a33*r.a13,this.a13*r.a21+this.a23*r.a22+this.a33*r.a23,this.a13*r.a31+this.a23*r.a32+this.a33*r.a33)}}class da extends fa{sampleGrid(r,s,o,u,c,h,d,p,w,_,T,S,M,z,W,q,J,le,ue){const oe=hn.quadrilateralToQuadrilateral(u,c,h,d,p,w,_,T,S,M,z,W,q,J,le,ue);return this.sampleGridWithTransform(r,s,o,oe)}sampleGridWithTransform(r,s,o,u){if(s<=0||o<=0)throw new ee;const c=new ze(s,o),h=new Float32Array(2*s);for(let d=0;d<o;d++){const p=h.length,w=d+.5;for(let _=0;_<p;_+=2)h[_]=_/2+.5,h[_+1]=w;u.transformPoints(h),fa.checkAndNudgePoints(r,h);try{for(let _=0;_<p;_+=2)r.get(Math.floor(h[_]),Math.floor(h[_+1]))&&c.set(_/2,d)}catch{throw new ee}}return c}}class br{static setGridSampler(r){br.gridSampler=r}static getInstance(){return br.gridSampler}}br.gridSampler=new da;class Zt{constructor(r,s){this.x=r,this.y=s}toResultPoint(){return new de(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class zl{constructor(r){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=r}detect(){return this.detectMirror(!1)}detectMirror(r){let s=this.getMatrixCenter(),o=this.getBullsEyeCorners(s);if(r){let h=o[0];o[0]=o[2],o[2]=h}this.extractParameters(o);let u=this.sampleGrid(this.image,o[this.shift%4],o[(this.shift+1)%4],o[(this.shift+2)%4],o[(this.shift+3)%4]),c=this.getMatrixCornerPoints(o);return new Ul(u,c,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(r){if(!this.isValidPoint(r[0])||!this.isValidPoint(r[1])||!this.isValidPoint(r[2])||!this.isValidPoint(r[3]))throw new ee;let s=2*this.nbCenterLayers,o=new Int32Array([this.sampleLine(r[0],r[1],s),this.sampleLine(r[1],r[2],s),this.sampleLine(r[2],r[3],s),this.sampleLine(r[3],r[0],s)]);this.shift=this.getRotation(o,s);let u=0;for(let h=0;h<4;h++){let d=o[(this.shift+h)%4];this.compact?(u<<=7,u+=d>>1&127):(u<<=10,u+=(d>>2&992)+(d>>1&31))}let c=this.getCorrectedParameterData(u,this.compact);this.compact?(this.nbLayers=(c>>6)+1,this.nbDataBlocks=(c&63)+1):(this.nbLayers=(c>>11)+1,this.nbDataBlocks=(c&2047)+1)}getRotation(r,s){let o=0;r.forEach((u,c,h)=>{let d=(u>>s-2<<1)+(u&1);o=(o<<3)+d}),o=((o&1)<<11)+(o>>1);for(let u=0;u<4;u++)if(B.bitCount(o^this.EXPECTED_CORNER_BITS[u])<=2)return u;throw new ee}getCorrectedParameterData(r,s){let o,u;s?(o=7,u=2):(o=10,u=4);let c=o-u,h=new Int32Array(o);for(let p=o-1;p>=0;--p)h[p]=r&15,r>>=4;try{new Ns(je.AZTEC_PARAM).decode(h,c)}catch{throw new ee}let d=0;for(let p=0;p<u;p++)d=(d<<4)+h[p];return d}getBullsEyeCorners(r){let s=r,o=r,u=r,c=r,h=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let T=this.getFirstDifferent(s,h,1,-1),S=this.getFirstDifferent(o,h,1,1),M=this.getFirstDifferent(u,h,-1,1),z=this.getFirstDifferent(c,h,-1,-1);if(this.nbCenterLayers>2){let W=this.distancePoint(z,T)*this.nbCenterLayers/(this.distancePoint(c,s)*(this.nbCenterLayers+2));if(W<.75||W>1.25||!this.isWhiteOrBlackRectangle(T,S,M,z))break}s=T,o=S,u=M,c=z,h=!h}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new ee;this.compact=this.nbCenterLayers===5;let d=new de(s.getX()+.5,s.getY()-.5),p=new de(o.getX()+.5,o.getY()+.5),w=new de(u.getX()-.5,u.getY()+.5),_=new de(c.getX()-.5,c.getY()-.5);return this.expandSquare([d,p,w,_],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let r,s,o,u;try{let d=new hr(this.image).detect();r=d[0],s=d[1],o=d[2],u=d[3]}catch{let p=this.image.getWidth()/2,w=this.image.getHeight()/2;r=this.getFirstDifferent(new Zt(p+7,w-7),!1,1,-1).toResultPoint(),s=this.getFirstDifferent(new Zt(p+7,w+7),!1,1,1).toResultPoint(),o=this.getFirstDifferent(new Zt(p-7,w+7),!1,-1,1).toResultPoint(),u=this.getFirstDifferent(new Zt(p-7,w-7),!1,-1,-1).toResultPoint()}let c=Fe.round((r.getX()+u.getX()+s.getX()+o.getX())/4),h=Fe.round((r.getY()+u.getY()+s.getY()+o.getY())/4);try{let d=new hr(this.image,15,c,h).detect();r=d[0],s=d[1],o=d[2],u=d[3]}catch{r=this.getFirstDifferent(new Zt(c+7,h-7),!1,1,-1).toResultPoint(),s=this.getFirstDifferent(new Zt(c+7,h+7),!1,1,1).toResultPoint(),o=this.getFirstDifferent(new Zt(c-7,h+7),!1,-1,1).toResultPoint(),u=this.getFirstDifferent(new Zt(c-7,h-7),!1,-1,-1).toResultPoint()}return c=Fe.round((r.getX()+u.getX()+s.getX()+o.getX())/4),h=Fe.round((r.getY()+u.getY()+s.getY()+o.getY())/4),new Zt(c,h)}getMatrixCornerPoints(r){return this.expandSquare(r,2*this.nbCenterLayers,this.getDimension())}sampleGrid(r,s,o,u,c){let h=br.getInstance(),d=this.getDimension(),p=d/2-this.nbCenterLayers,w=d/2+this.nbCenterLayers;return h.sampleGrid(r,d,d,p,p,w,p,w,w,p,w,s.getX(),s.getY(),o.getX(),o.getY(),u.getX(),u.getY(),c.getX(),c.getY())}sampleLine(r,s,o){let u=0,c=this.distanceResultPoint(r,s),h=c/o,d=r.getX(),p=r.getY(),w=h*(s.getX()-r.getX())/c,_=h*(s.getY()-r.getY())/c;for(let T=0;T<o;T++)this.image.get(Fe.round(d+T*w),Fe.round(p+T*_))&&(u|=1<<o-T-1);return u}isWhiteOrBlackRectangle(r,s,o,u){let c=3;r=new Zt(r.getX()-c,r.getY()+c),s=new Zt(s.getX()-c,s.getY()-c),o=new Zt(o.getX()+c,o.getY()-c),u=new Zt(u.getX()+c,u.getY()+c);let h=this.getColor(u,r);if(h===0)return!1;let d=this.getColor(r,s);return d!==h||(d=this.getColor(s,o),d!==h)?!1:(d=this.getColor(o,u),d===h)}getColor(r,s){let o=this.distancePoint(r,s),u=(s.getX()-r.getX())/o,c=(s.getY()-r.getY())/o,h=0,d=r.getX(),p=r.getY(),w=this.image.get(r.getX(),r.getY()),_=Math.ceil(o);for(let S=0;S<_;S++)d+=u,p+=c,this.image.get(Fe.round(d),Fe.round(p))!==w&&h++;let T=h/o;return T>.1&&T<.9?0:T<=.1===w?1:-1}getFirstDifferent(r,s,o,u){let c=r.getX()+o,h=r.getY()+u;for(;this.isValid(c,h)&&this.image.get(c,h)===s;)c+=o,h+=u;for(c-=o,h-=u;this.isValid(c,h)&&this.image.get(c,h)===s;)c+=o;for(c-=o;this.isValid(c,h)&&this.image.get(c,h)===s;)h+=u;return h-=u,new Zt(c,h)}expandSquare(r,s,o){let u=o/(2*s),c=r[0].getX()-r[2].getX(),h=r[0].getY()-r[2].getY(),d=(r[0].getX()+r[2].getX())/2,p=(r[0].getY()+r[2].getY())/2,w=new de(d+u*c,p+u*h),_=new de(d-u*c,p-u*h);c=r[1].getX()-r[3].getX(),h=r[1].getY()-r[3].getY(),d=(r[1].getX()+r[3].getX())/2,p=(r[1].getY()+r[3].getY())/2;let T=new de(d+u*c,p+u*h),S=new de(d-u*c,p-u*h);return[w,T,_,S]}isValid(r,s){return r>=0&&r<this.image.getWidth()&&s>0&&s<this.image.getHeight()}isValidPoint(r){let s=Fe.round(r.getX()),o=Fe.round(r.getY());return this.isValid(s,o)}distancePoint(r,s){return Fe.distance(r.getX(),r.getY(),s.getX(),s.getY())}distanceResultPoint(r,s){return Fe.distance(r.getX(),r.getY(),s.getX(),s.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(B.truncDivision(this.nbLayers-4,8)+1)+15}}class so{decode(r,s=null){let o=null,u=new zl(r.getBlackMatrix()),c=null,h=null;try{let _=u.detectMirror(!1);c=_.getPoints(),this.reportFoundResultPoints(s,c),h=new nt().decode(_)}catch(_){o=_}if(h==null)try{let _=u.detectMirror(!0);c=_.getPoints(),this.reportFoundResultPoints(s,c),h=new nt().decode(_)}catch(_){throw o??_}let d=new ut(h.getText(),h.getRawBytes(),h.getNumBits(),c,Ee.AZTEC,X.currentTimeMillis()),p=h.getByteSegments();p!=null&&d.putMetadata(kt.BYTE_SEGMENTS,p);let w=h.getECLevel();return w!=null&&d.putMetadata(kt.ERROR_CORRECTION_LEVEL,w),d}reportFoundResultPoints(r,s){if(r!=null){let o=r.get(se.NEED_RESULT_POINT_CALLBACK);o!=null&&s.forEach((u,c,h)=>{o.foundPossibleResultPoint(u)})}}reset(){}}class Hl extends On{constructor(r=500){super(new so,r)}}class St{decode(r,s){try{return this.doDecode(r,s)}catch{if(s&&s.get(se.TRY_HARDER)===!0&&r.isRotateSupported()){const c=r.rotateCounterClockwise(),h=this.doDecode(c,s),d=h.getResultMetadata();let p=270;d!==null&&d.get(kt.ORIENTATION)===!0&&(p=p+d.get(kt.ORIENTATION)%360),h.putMetadata(kt.ORIENTATION,p);const w=h.getResultPoints();if(w!==null){const _=c.getHeight();for(let T=0;T<w.length;T++)w[T]=new de(_-w[T].getY()-1,w[T].getX())}return h}else throw new ee}}reset(){}doDecode(r,s){const o=r.getWidth(),u=r.getHeight();let c=new $(o);const h=s&&s.get(se.TRY_HARDER)===!0,d=Math.max(1,u>>(h?8:5));let p;h?p=u:p=15;const w=Math.trunc(u/2);for(let _=0;_<p;_++){const T=Math.trunc((_+1)/2),S=(_&1)===0,M=w+d*(S?T:-T);if(M<0||M>=u)break;try{c=r.getBlackRow(M,c)}catch{continue}for(let z=0;z<2;z++){if(z===1&&(c.reverse(),s&&s.get(se.NEED_RESULT_POINT_CALLBACK)===!0)){const W=new Map;s.forEach((q,J)=>W.set(J,q)),W.delete(se.NEED_RESULT_POINT_CALLBACK),s=W}try{const W=this.decodeRow(M,c,s);if(z===1){W.putMetadata(kt.ORIENTATION,180);const q=W.getResultPoints();q!==null&&(q[0]=new de(o-q[0].getX()-1,q[0].getY()),q[1]=new de(o-q[1].getX()-1,q[1].getY()))}return W}catch{}}}throw new ee}static recordPattern(r,s,o){const u=o.length;for(let w=0;w<u;w++)o[w]=0;const c=r.getSize();if(s>=c)throw new ee;let h=!r.get(s),d=0,p=s;for(;p<c;){if(r.get(p)!==h)o[d]++;else{if(++d===u)break;o[d]=1,h=!h}p++}if(!(d===u||d===u-1&&p===c))throw new ee}static recordPatternInReverse(r,s,o){let u=o.length,c=r.get(s);for(;s>0&&u>=0;)r.get(--s)!==c&&(u--,c=!c);if(u>=0)throw new ee;St.recordPattern(r,s+1,o)}static patternMatchVariance(r,s,o){const u=r.length;let c=0,h=0;for(let w=0;w<u;w++)c+=r[w],h+=s[w];if(c<h)return Number.POSITIVE_INFINITY;const d=c/h;o*=d;let p=0;for(let w=0;w<u;w++){const _=r[w],T=s[w]*d,S=_>T?_-T:T-_;if(S>o)return Number.POSITIVE_INFINITY;p+=S}return p/c}}class he extends St{static findStartPattern(r){const s=r.getSize(),o=r.getNextSet(0);let u=0,c=Int32Array.from([0,0,0,0,0,0]),h=o,d=!1;const p=6;for(let w=o;w<s;w++)if(r.get(w)!==d)c[u]++;else{if(u===p-1){let _=he.MAX_AVG_VARIANCE,T=-1;for(let S=he.CODE_START_A;S<=he.CODE_START_C;S++){const M=St.patternMatchVariance(c,he.CODE_PATTERNS[S],he.MAX_INDIVIDUAL_VARIANCE);M<_&&(_=M,T=S)}if(T>=0&&r.isRange(Math.max(0,h-(w-h)/2),h,!1))return Int32Array.from([h,w,T]);h+=c[0]+c[1],c=c.slice(2,c.length-1),c[u-1]=0,c[u]=0,u--}else u++;c[u]=1,d=!d}throw new ee}static decodeCode(r,s,o){St.recordPattern(r,o,s);let u=he.MAX_AVG_VARIANCE,c=-1;for(let h=0;h<he.CODE_PATTERNS.length;h++){const d=he.CODE_PATTERNS[h],p=this.patternMatchVariance(s,d,he.MAX_INDIVIDUAL_VARIANCE);p<u&&(u=p,c=h)}if(c>=0)return c;throw new ee}decodeRow(r,s,o){const u=o&&o.get(se.ASSUME_GS1)===!0,c=he.findStartPattern(s),h=c[2];let d=0;const p=new Uint8Array(20);p[d++]=h;let w;switch(h){case he.CODE_START_A:w=he.CODE_CODE_A;break;case he.CODE_START_B:w=he.CODE_CODE_B;break;case he.CODE_START_C:w=he.CODE_CODE_C;break;default:throw new N}let _=!1,T=!1,S="",M=c[0],z=c[1];const W=Int32Array.from([0,0,0,0,0,0]);let q=0,J=0,le=h,ue=0,oe=!0,He=!1,ke=!1;for(;!_;){const wo=T;switch(T=!1,q=J,J=he.decodeCode(s,W,z),p[d++]=J,J!==he.CODE_STOP&&(oe=!0),J!==he.CODE_STOP&&(ue++,le+=ue*J),M=z,z+=W.reduce((Pw,Mw)=>Pw+Mw,0),J){case he.CODE_START_A:case he.CODE_START_B:case he.CODE_START_C:throw new N}switch(w){case he.CODE_CODE_A:if(J<64)ke===He?S+=String.fromCharCode(" ".charCodeAt(0)+J):S+=String.fromCharCode(" ".charCodeAt(0)+J+128),ke=!1;else if(J<96)ke===He?S+=String.fromCharCode(J-64):S+=String.fromCharCode(J+64),ke=!1;else switch(J!==he.CODE_STOP&&(oe=!1),J){case he.CODE_FNC_1:u&&(S.length===0?S+="]C1":S+=String.fromCharCode(29));break;case he.CODE_FNC_2:case he.CODE_FNC_3:break;case he.CODE_FNC_4_A:!He&&ke?(He=!0,ke=!1):He&&ke?(He=!1,ke=!1):ke=!0;break;case he.CODE_SHIFT:T=!0,w=he.CODE_CODE_B;break;case he.CODE_CODE_B:w=he.CODE_CODE_B;break;case he.CODE_CODE_C:w=he.CODE_CODE_C;break;case he.CODE_STOP:_=!0;break}break;case he.CODE_CODE_B:if(J<96)ke===He?S+=String.fromCharCode(" ".charCodeAt(0)+J):S+=String.fromCharCode(" ".charCodeAt(0)+J+128),ke=!1;else switch(J!==he.CODE_STOP&&(oe=!1),J){case he.CODE_FNC_1:u&&(S.length===0?S+="]C1":S+=String.fromCharCode(29));break;case he.CODE_FNC_2:case he.CODE_FNC_3:break;case he.CODE_FNC_4_B:!He&&ke?(He=!0,ke=!1):He&&ke?(He=!1,ke=!1):ke=!0;break;case he.CODE_SHIFT:T=!0,w=he.CODE_CODE_A;break;case he.CODE_CODE_A:w=he.CODE_CODE_A;break;case he.CODE_CODE_C:w=he.CODE_CODE_C;break;case he.CODE_STOP:_=!0;break}break;case he.CODE_CODE_C:if(J<100)J<10&&(S+="0"),S+=J;else switch(J!==he.CODE_STOP&&(oe=!1),J){case he.CODE_FNC_1:u&&(S.length===0?S+="]C1":S+=String.fromCharCode(29));break;case he.CODE_CODE_A:w=he.CODE_CODE_A;break;case he.CODE_CODE_B:w=he.CODE_CODE_B;break;case he.CODE_STOP:_=!0;break}break}wo&&(w=w===he.CODE_CODE_A?he.CODE_CODE_B:he.CODE_CODE_A)}const Wn=z-M;if(z=s.getNextUnset(z),!s.isRange(z,Math.min(s.getSize(),z+(z-M)/2),!1))throw new ee;if(le-=ue*q,le%103!==q)throw new V;const kr=S.length;if(kr===0)throw new ee;kr>0&&oe&&(w===he.CODE_CODE_C?S=S.substring(0,kr-2):S=S.substring(0,kr-1));const jn=(c[1]+c[0])/2,gt=M+Wn/2,pn=p.length,er=new Uint8Array(pn);for(let wo=0;wo<pn;wo++)er[wo]=p[wo];const yo=[new de(jn,r),new de(gt,r)];return new ut(S,er,0,yo,Ee.CODE_128,new Date().getTime())}}he.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],he.MAX_AVG_VARIANCE=.25,he.MAX_INDIVIDUAL_VARIANCE=.7,he.CODE_SHIFT=98,he.CODE_CODE_C=99,he.CODE_CODE_B=100,he.CODE_CODE_A=101,he.CODE_FNC_1=102,he.CODE_FNC_2=97,he.CODE_FNC_3=96,he.CODE_FNC_4_A=101,he.CODE_FNC_4_B=100,he.CODE_START_A=103,he.CODE_START_B=104,he.CODE_START_C=105,he.CODE_STOP=106;class Rt extends St{constructor(r=!1,s=!1){super(),this.usingCheckDigit=r,this.extendedMode=s,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(r,s,o){let u=this.counters;u.fill(0),this.decodeRowResult="";let c=Rt.findAsteriskPattern(s,u),h=s.getNextSet(c[1]),d=s.getSize(),p,w;do{Rt.recordPattern(s,h,u);let W=Rt.toNarrowWidePattern(u);if(W<0)throw new ee;p=Rt.patternToChar(W),this.decodeRowResult+=p,w=h;for(let q of u)h+=q;h=s.getNextSet(h)}while(p!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let _=0;for(let W of u)_+=W;let T=h-w-_;if(h!==d&&T*2<_)throw new ee;if(this.usingCheckDigit){let W=this.decodeRowResult.length-1,q=0;for(let J=0;J<W;J++)q+=Rt.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(J));if(this.decodeRowResult.charAt(W)!==Rt.ALPHABET_STRING.charAt(q%43))throw new V;this.decodeRowResult=this.decodeRowResult.substring(0,W)}if(this.decodeRowResult.length===0)throw new ee;let S;this.extendedMode?S=Rt.decodeExtended(this.decodeRowResult):S=this.decodeRowResult;let M=(c[1]+c[0])/2,z=w+_/2;return new ut(S,null,0,[new de(M,r),new de(z,r)],Ee.CODE_39,new Date().getTime())}static findAsteriskPattern(r,s){let o=r.getSize(),u=r.getNextSet(0),c=0,h=u,d=!1,p=s.length;for(let w=u;w<o;w++)if(r.get(w)!==d)s[c]++;else{if(c===p-1){if(this.toNarrowWidePattern(s)===Rt.ASTERISK_ENCODING&&r.isRange(Math.max(0,h-Math.floor((w-h)/2)),h,!1))return[h,w];h+=s[0]+s[1],s.copyWithin(0,2,2+c-1),s[c-1]=0,s[c]=0,c--}else c++;s[c]=1,d=!d}throw new ee}static toNarrowWidePattern(r){let s=r.length,o=0,u;do{let c=2147483647;for(let p of r)p<c&&p>o&&(c=p);o=c,u=0;let h=0,d=0;for(let p=0;p<s;p++){let w=r[p];w>o&&(d|=1<<s-1-p,u++,h+=w)}if(u===3){for(let p=0;p<s&&u>0;p++){let w=r[p];if(w>o&&(u--,w*2>=h))return-1}return d}}while(u>3);return-1}static patternToChar(r){for(let s=0;s<Rt.CHARACTER_ENCODINGS.length;s++)if(Rt.CHARACTER_ENCODINGS[s]===r)return Rt.ALPHABET_STRING.charAt(s);if(r===Rt.ASTERISK_ENCODING)return"*";throw new ee}static decodeExtended(r){let s=r.length,o="";for(let u=0;u<s;u++){let c=r.charAt(u);if(c==="+"||c==="$"||c==="%"||c==="/"){let h=r.charAt(u+1),d="\0";switch(c){case"+":if(h>="A"&&h<="Z")d=String.fromCharCode(h.charCodeAt(0)+32);else throw new N;break;case"$":if(h>="A"&&h<="Z")d=String.fromCharCode(h.charCodeAt(0)-64);else throw new N;break;case"%":if(h>="A"&&h<="E")d=String.fromCharCode(h.charCodeAt(0)-38);else if(h>="F"&&h<="J")d=String.fromCharCode(h.charCodeAt(0)-11);else if(h>="K"&&h<="O")d=String.fromCharCode(h.charCodeAt(0)+16);else if(h>="P"&&h<="T")d=String.fromCharCode(h.charCodeAt(0)+43);else if(h==="U")d="\0";else if(h==="V")d="@";else if(h==="W")d="`";else if(h==="X"||h==="Y"||h==="Z")d="";else throw new N;break;case"/":if(h>="A"&&h<="O")d=String.fromCharCode(h.charCodeAt(0)-32);else if(h==="Z")d=":";else throw new N;break}o+=d,u++}else o+=c}return o}}Rt.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",Rt.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],Rt.ASTERISK_ENCODING=148;class et extends St{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(r,s,o){let u=this.decodeStart(s),c=this.decodeEnd(s),h=new L;et.decodeMiddle(s,u[1],c[0],h);let d=h.toString(),p=null;o!=null&&(p=o.get(se.ALLOWED_LENGTHS)),p==null&&(p=et.DEFAULT_ALLOWED_LENGTHS);let w=d.length,_=!1,T=0;for(let z of p){if(w===z){_=!0;break}z>T&&(T=z)}if(!_&&w>T&&(_=!0),!_)throw new N;const S=[new de(u[1],r),new de(c[0],r)];return new ut(d,null,0,S,Ee.ITF,new Date().getTime())}static decodeMiddle(r,s,o,u){let c=new Int32Array(10),h=new Int32Array(5),d=new Int32Array(5);for(c.fill(0),h.fill(0),d.fill(0);s<o;){St.recordPattern(r,s,c);for(let w=0;w<5;w++){let _=2*w;h[w]=c[_],d[w]=c[_+1]}let p=et.decodeDigit(h);u.append(p.toString()),p=this.decodeDigit(d),u.append(p.toString()),c.forEach(function(w){s+=w})}}decodeStart(r){let s=et.skipWhiteSpace(r),o=et.findGuardPattern(r,s,et.START_PATTERN);return this.narrowLineWidth=(o[1]-o[0])/4,this.validateQuietZone(r,o[0]),o}validateQuietZone(r,s){let o=this.narrowLineWidth*10;o=o<s?o:s;for(let u=s-1;o>0&&u>=0&&!r.get(u);u--)o--;if(o!==0)throw new ee}static skipWhiteSpace(r){const s=r.getSize(),o=r.getNextSet(0);if(o===s)throw new ee;return o}decodeEnd(r){r.reverse();try{let s=et.skipWhiteSpace(r),o;try{o=et.findGuardPattern(r,s,et.END_PATTERN_REVERSED[0])}catch(c){c instanceof ee&&(o=et.findGuardPattern(r,s,et.END_PATTERN_REVERSED[1]))}this.validateQuietZone(r,o[0]);let u=o[0];return o[0]=r.getSize()-o[1],o[1]=r.getSize()-u,o}finally{r.reverse()}}static findGuardPattern(r,s,o){let u=o.length,c=new Int32Array(u),h=r.getSize(),d=!1,p=0,w=s;c.fill(0);for(let _=s;_<h;_++)if(r.get(_)!==d)c[p]++;else{if(p===u-1){if(St.patternMatchVariance(c,o,et.MAX_INDIVIDUAL_VARIANCE)<et.MAX_AVG_VARIANCE)return[w,_];w+=c[0]+c[1],X.arraycopy(c,2,c,0,p-1),c[p-1]=0,c[p]=0,p--}else p++;c[p]=1,d=!d}throw new ee}static decodeDigit(r){let s=et.MAX_AVG_VARIANCE,o=-1,u=et.PATTERNS.length;for(let c=0;c<u;c++){let h=et.PATTERNS[c],d=St.patternMatchVariance(r,h,et.MAX_INDIVIDUAL_VARIANCE);d<s?(s=d,o=c):d===s&&(o=-1)}if(o>=0)return o%10;throw new ee}}et.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],et.MAX_AVG_VARIANCE=.38,et.MAX_INDIVIDUAL_VARIANCE=.5,et.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],et.START_PATTERN=Int32Array.from([1,1,1,1]),et.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class rt extends St{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(r){let s=!1,o,u=0,c=Int32Array.from([0,0,0]);for(;!s;){c=Int32Array.from([0,0,0]),o=rt.findGuardPattern(r,u,!1,this.START_END_PATTERN,c);let h=o[0];u=o[1];let d=h-(u-h);d>=0&&(s=r.isRange(d,h,!1))}return o}static checkChecksum(r){return rt.checkStandardUPCEANChecksum(r)}static checkStandardUPCEANChecksum(r){let s=r.length;if(s===0)return!1;let o=parseInt(r.charAt(s-1),10);return rt.getStandardUPCEANChecksum(r.substring(0,s-1))===o}static getStandardUPCEANChecksum(r){let s=r.length,o=0;for(let u=s-1;u>=0;u-=2){let c=r.charAt(u).charCodeAt(0)-"0".charCodeAt(0);if(c<0||c>9)throw new N;o+=c}o*=3;for(let u=s-2;u>=0;u-=2){let c=r.charAt(u).charCodeAt(0)-"0".charCodeAt(0);if(c<0||c>9)throw new N;o+=c}return(1e3-o)%10}static decodeEnd(r,s){return rt.findGuardPattern(r,s,!1,rt.START_END_PATTERN,new Int32Array(rt.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(r,s,o,u){return this.findGuardPattern(r,s,o,u,new Int32Array(u.length))}static findGuardPattern(r,s,o,u,c){let h=r.getSize();s=o?r.getNextUnset(s):r.getNextSet(s);let d=0,p=s,w=u.length,_=o;for(let T=s;T<h;T++)if(r.get(T)!==_)c[d]++;else{if(d===w-1){if(St.patternMatchVariance(c,u,rt.MAX_INDIVIDUAL_VARIANCE)<rt.MAX_AVG_VARIANCE)return Int32Array.from([p,T]);p+=c[0]+c[1];let S=c.slice(2,c.length-1);for(let M=0;M<d-1;M++)c[M]=S[M];c[d-1]=0,c[d]=0,d--}else d++;c[d]=1,_=!_}throw new ee}static decodeDigit(r,s,o,u){this.recordPattern(r,o,s);let c=this.MAX_AVG_VARIANCE,h=-1,d=u.length;for(let p=0;p<d;p++){let w=u[p],_=St.patternMatchVariance(s,w,rt.MAX_INDIVIDUAL_VARIANCE);_<c&&(c=_,h=p)}if(h>=0)return h;throw new ee}}rt.MAX_AVG_VARIANCE=.48,rt.MAX_INDIVIDUAL_VARIANCE=.7,rt.START_END_PATTERN=Int32Array.from([1,1,1]),rt.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),rt.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),rt.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class Li{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(r,s,o){let u=this.decodeRowStringBuffer,c=this.decodeMiddle(s,o,u),h=u.toString(),d=Li.parseExtensionString(h),p=[new de((o[0]+o[1])/2,r),new de(c,r)],w=new ut(h,null,0,p,Ee.UPC_EAN_EXTENSION,new Date().getTime());return d!=null&&w.putAllMetadata(d),w}decodeMiddle(r,s,o){let u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let c=r.getSize(),h=s[1],d=0;for(let w=0;w<5&&h<c;w++){let _=rt.decodeDigit(r,u,h,rt.L_AND_G_PATTERNS);o+=String.fromCharCode("0".charCodeAt(0)+_%10);for(let T of u)h+=T;_>=10&&(d|=1<<4-w),w!==4&&(h=r.getNextSet(h),h=r.getNextUnset(h))}if(o.length!==5)throw new ee;let p=this.determineCheckDigit(d);if(Li.extensionChecksum(o.toString())!==p)throw new ee;return h}static extensionChecksum(r){let s=r.length,o=0;for(let u=s-2;u>=0;u-=2)o+=r.charAt(u).charCodeAt(0)-"0".charCodeAt(0);o*=3;for(let u=s-1;u>=0;u-=2)o+=r.charAt(u).charCodeAt(0)-"0".charCodeAt(0);return o*=3,o%10}determineCheckDigit(r){for(let s=0;s<10;s++)if(r===this.CHECK_DIGIT_ENCODINGS[s])return s;throw new ee}static parseExtensionString(r){if(r.length!==5)return null;let s=Li.parseExtension5String(r);return s==null?null:new Map([[kt.SUGGESTED_PRICE,s]])}static parseExtension5String(r){let s;switch(r.charAt(0)){case"0":s="";break;case"5":s="$";break;case"9":switch(r){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}s="";break;default:s="";break}let o=parseInt(r.substring(1)),u=(o/100).toString(),c=o%100,h=c<10?"0"+c:c.toString();return s+u+"."+h}}class Bi{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(r,s,o){let u=this.decodeRowStringBuffer,c=this.decodeMiddle(s,o,u),h=u.toString(),d=Bi.parseExtensionString(h),p=[new de((o[0]+o[1])/2,r),new de(c,r)],w=new ut(h,null,0,p,Ee.UPC_EAN_EXTENSION,new Date().getTime());return d!=null&&w.putAllMetadata(d),w}decodeMiddle(r,s,o){let u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let c=r.getSize(),h=s[1],d=0;for(let p=0;p<2&&h<c;p++){let w=rt.decodeDigit(r,u,h,rt.L_AND_G_PATTERNS);o+=String.fromCharCode("0".charCodeAt(0)+w%10);for(let _ of u)h+=_;w>=10&&(d|=1<<1-p),p!==1&&(h=r.getNextSet(h),h=r.getNextUnset(h))}if(o.length!==2)throw new ee;if(parseInt(o.toString())%4!==d)throw new ee;return h}static parseExtensionString(r){return r.length!==2?null:new Map([[kt.ISSUE_NUMBER,parseInt(r)]])}}class ga{static decodeRow(r,s,o){let u=rt.findGuardPattern(s,o,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new Li().decodeRow(r,s,u)}catch{return new Bi().decodeRow(r,s,u)}}}ga.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Ve extends rt{constructor(){super(),this.decodeRowStringBuffer="",Ve.L_AND_G_PATTERNS=Ve.L_PATTERNS.map(r=>Int32Array.from(r));for(let r=10;r<20;r++){let s=Ve.L_PATTERNS[r-10],o=new Int32Array(s.length);for(let u=0;u<s.length;u++)o[u]=s[s.length-u-1];Ve.L_AND_G_PATTERNS[r]=o}}decodeRow(r,s,o){let u=Ve.findStartGuardPattern(s),c=o==null?null:o.get(se.NEED_RESULT_POINT_CALLBACK);if(c!=null){const oe=new de((u[0]+u[1])/2,r);c.foundPossibleResultPoint(oe)}let h=this.decodeMiddle(s,u,this.decodeRowStringBuffer),d=h.rowOffset,p=h.resultString;if(c!=null){const oe=new de(d,r);c.foundPossibleResultPoint(oe)}let w=this.decodeEnd(s,d);if(c!=null){const oe=new de((w[0]+w[1])/2,r);c.foundPossibleResultPoint(oe)}let _=w[1],T=_+(_-w[0]);if(T>=s.getSize()||!s.isRange(_,T,!1))throw new ee;let S=p.toString();if(S.length<8)throw new N;if(!Ve.checkChecksum(S))throw new V;let M=(u[1]+u[0])/2,z=(w[1]+w[0])/2,W=this.getBarcodeFormat(),q=[new de(M,r),new de(z,r)],J=new ut(S,null,0,q,W,new Date().getTime()),le=0;try{let oe=ga.decodeRow(r,s,w[1]);J.putMetadata(kt.UPC_EAN_EXTENSION,oe.getText()),J.putAllMetadata(oe.getResultMetadata()),J.addResultPoints(oe.getResultPoints()),le=oe.getText().length}catch{}let ue=o==null?null:o.get(se.ALLOWED_EAN_EXTENSIONS);if(ue!=null){let oe=!1;for(let He in ue)if(le.toString()===He){oe=!0;break}if(!oe)throw new ee}return J}decodeEnd(r,s){return Ve.findGuardPattern(r,s,!1,Ve.START_END_PATTERN,new Int32Array(Ve.START_END_PATTERN.length).fill(0))}static checkChecksum(r){return Ve.checkStandardUPCEANChecksum(r)}static checkStandardUPCEANChecksum(r){let s=r.length;if(s===0)return!1;let o=parseInt(r.charAt(s-1),10);return Ve.getStandardUPCEANChecksum(r.substring(0,s-1))===o}static getStandardUPCEANChecksum(r){let s=r.length,o=0;for(let u=s-1;u>=0;u-=2){let c=r.charAt(u).charCodeAt(0)-"0".charCodeAt(0);if(c<0||c>9)throw new N;o+=c}o*=3;for(let u=s-2;u>=0;u-=2){let c=r.charAt(u).charCodeAt(0)-"0".charCodeAt(0);if(c<0||c>9)throw new N;o+=c}return(1e3-o)%10}}class jr extends Ve{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(r,s,o){let u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let c=r.getSize(),h=s[1],d=0;for(let w=0;w<6&&h<c;w++){let _=Ve.decodeDigit(r,u,h,Ve.L_AND_G_PATTERNS);o+=String.fromCharCode("0".charCodeAt(0)+_%10);for(let T of u)h+=T;_>=10&&(d|=1<<5-w)}o=jr.determineFirstDigit(o,d),h=Ve.findGuardPattern(r,h,!0,Ve.MIDDLE_PATTERN,new Int32Array(Ve.MIDDLE_PATTERN.length).fill(0))[1];for(let w=0;w<6&&h<c;w++){let _=Ve.decodeDigit(r,u,h,Ve.L_PATTERNS);o+=String.fromCharCode("0".charCodeAt(0)+_);for(let T of u)h+=T}return{rowOffset:h,resultString:o}}getBarcodeFormat(){return Ee.EAN_13}static determineFirstDigit(r,s){for(let o=0;o<10;o++)if(s===this.FIRST_DIGIT_ENCODINGS[o])return r=String.fromCharCode("0".charCodeAt(0)+o)+r,r;throw new ee}}jr.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class tn extends Ve{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(r,s,o){const u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let c=r.getSize(),h=s[1];for(let p=0;p<4&&h<c;p++){let w=Ve.decodeDigit(r,u,h,Ve.L_PATTERNS);o+=String.fromCharCode("0".charCodeAt(0)+w);for(let _ of u)h+=_}h=Ve.findGuardPattern(r,h,!0,Ve.MIDDLE_PATTERN,new Int32Array(Ve.MIDDLE_PATTERN.length).fill(0))[1];for(let p=0;p<4&&h<c;p++){let w=Ve.decodeDigit(r,u,h,Ve.L_PATTERNS);o+=String.fromCharCode("0".charCodeAt(0)+w);for(let _ of u)h+=_}return{rowOffset:h,resultString:o}}getBarcodeFormat(){return Ee.EAN_8}}class pa extends Ve{constructor(){super(...arguments),this.ean13Reader=new jr}getBarcodeFormat(){return Ee.UPC_A}decode(r,s){return this.maybeReturnResult(this.ean13Reader.decode(r))}decodeRow(r,s,o){return this.maybeReturnResult(this.ean13Reader.decodeRow(r,s,o))}decodeMiddle(r,s,o){return this.ean13Reader.decodeMiddle(r,s,o)}maybeReturnResult(r){let s=r.getText();if(s.charAt(0)==="0"){let o=new ut(s.substring(1),null,null,r.getResultPoints(),Ee.UPC_A);return r.getResultMetadata()!=null&&o.putAllMetadata(r.getResultMetadata()),o}else throw new ee}reset(){this.ean13Reader.reset()}}class fn extends Ve{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(r,s,o){const u=this.decodeMiddleCounters.map(w=>w);u[0]=0,u[1]=0,u[2]=0,u[3]=0;const c=r.getSize();let h=s[1],d=0;for(let w=0;w<6&&h<c;w++){const _=fn.decodeDigit(r,u,h,fn.L_AND_G_PATTERNS);o+=String.fromCharCode("0".charCodeAt(0)+_%10);for(let T of u)h+=T;_>=10&&(d|=1<<5-w)}let p=fn.determineNumSysAndCheckDigit(o,d);return{rowOffset:h,resultString:p}}decodeEnd(r,s){return fn.findGuardPatternWithoutCounters(r,s,!0,fn.MIDDLE_END_PATTERN)}checkChecksum(r){return Ve.checkChecksum(fn.convertUPCEtoUPCA(r))}static determineNumSysAndCheckDigit(r,s){for(let o=0;o<=1;o++)for(let u=0;u<10;u++)if(s===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[o][u]){let c=String.fromCharCode("0".charCodeAt(0)+o),h=String.fromCharCode("0".charCodeAt(0)+u);return c+r+h}throw ee.getNotFoundInstance()}getBarcodeFormat(){return Ee.UPC_E}static convertUPCEtoUPCA(r){const s=r.slice(1,7).split("").map(c=>c.charCodeAt(0)),o=new L;o.append(r.charAt(0));let u=s[5];switch(u){case 0:case 1:case 2:o.appendChars(s,0,2),o.append(u),o.append("0000"),o.appendChars(s,2,3);break;case 3:o.appendChars(s,0,3),o.append("00000"),o.appendChars(s,3,2);break;case 4:o.appendChars(s,0,4),o.append("00000"),o.append(s[4]);break;default:o.appendChars(s,0,5),o.append("0000"),o.append(u);break}return r.length>=8&&o.append(r.charAt(7)),o.toString()}}fn.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),fn.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class di extends St{constructor(r){super();let s=r==null?null:r.get(se.POSSIBLE_FORMATS),o=[];i(s)?(o.push(new jr),o.push(new pa),o.push(new tn),o.push(new fn)):(s.indexOf(Ee.EAN_13)>-1&&o.push(new jr),s.indexOf(Ee.UPC_A)>-1&&o.push(new pa),s.indexOf(Ee.EAN_8)>-1&&o.push(new tn),s.indexOf(Ee.UPC_E)>-1&&o.push(new fn)),this.readers=o}decodeRow(r,s,o){for(let u of this.readers)try{const c=u.decodeRow(r,s,o),h=c.getBarcodeFormat()===Ee.EAN_13&&c.getText().charAt(0)==="0",d=o==null?null:o.get(se.POSSIBLE_FORMATS),p=d==null||d.includes(Ee.UPC_A);if(h&&p){const w=c.getRawBytes(),_=new ut(c.getText().substring(1),w,w?w.length:null,c.getResultPoints(),Ee.UPC_A);return _.putAllMetadata(c.getResultMetadata()),_}return c}catch{}throw new ee}reset(){for(let r of this.readers)r.reset()}}class nn extends St{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(r,s){for(let o=0;o<s.length;o++)if(St.patternMatchVariance(r,s[o],nn.MAX_INDIVIDUAL_VARIANCE)<nn.MAX_AVG_VARIANCE)return o;throw new ee}static count(r){return Fe.sum(new Int32Array(r))}static increment(r,s){let o=0,u=s[0];for(let c=1;c<r.length;c++)s[c]>u&&(u=s[c],o=c);r[o]++}static decrement(r,s){let o=0,u=s[0];for(let c=1;c<r.length;c++)s[c]<u&&(u=s[c],o=c);r[o]--}static isFinderPattern(r){let s=r[0]+r[1],o=s+r[2]+r[3],u=s/o;if(u>=nn.MIN_FINDER_PATTERN_RATIO&&u<=nn.MAX_FINDER_PATTERN_RATIO){let c=Number.MAX_SAFE_INTEGER,h=Number.MIN_SAFE_INTEGER;for(let d of r)d>h&&(h=d),d<c&&(c=d);return h<10*c}return!1}}nn.MAX_AVG_VARIANCE=.2,nn.MAX_INDIVIDUAL_VARIANCE=.45,nn.MIN_FINDER_PATTERN_RATIO=9.5/12,nn.MAX_FINDER_PATTERN_RATIO=12.5/14;class Fi{constructor(r,s){this.value=r,this.checksumPortion=s}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(r){if(!(r instanceof Fi))return!1;const s=r;return this.value===s.value&&this.checksumPortion===s.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class Dr{constructor(r,s,o,u,c){this.value=r,this.startEnd=s,this.value=r,this.startEnd=s,this.resultPoints=new Array,this.resultPoints.push(new de(o,c)),this.resultPoints.push(new de(u,c))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(r){if(!(r instanceof Dr))return!1;const s=r;return this.value===s.value}hashCode(){return this.value}}class fr{constructor(){}static getRSSvalue(r,s,o){let u=0;for(let p of r)u+=p;let c=0,h=0,d=r.length;for(let p=0;p<d-1;p++){let w;for(w=1,h|=1<<p;w<r[p];w++,h&=~(1<<p)){let _=fr.combins(u-w-1,d-p-2);if(o&&h===0&&u-w-(d-p-1)>=d-p-1&&(_-=fr.combins(u-w-(d-p),d-p-2)),d-p-1>1){let T=0;for(let S=u-w-(d-p-2);S>s;S--)T+=fr.combins(u-w-S-1,d-p-3);_-=T*(d-1-p)}else u-w>s&&_--;c+=_}u-=w}return c}static combins(r,s){let o,u;r-s>s?(u=s,o=r-s):(u=r-s,o=s);let c=1,h=1;for(let d=r;d>o;d--)c*=d,h<=u&&(c/=h,h++);for(;h<=u;)c/=h,h++;return c}}class ch{static buildBitArray(r){let s=r.length*2-1;r[r.length-1].getRightChar()==null&&(s-=1);let o=12*s,u=new $(o),c=0,d=r[0].getRightChar().getValue();for(let p=11;p>=0;--p)d&1<<p&&u.set(c),c++;for(let p=1;p<r.length;++p){let w=r[p],_=w.getLeftChar().getValue();for(let T=11;T>=0;--T)_&1<<T&&u.set(c),c++;if(w.getRightChar()!=null){let T=w.getRightChar().getValue();for(let S=11;S>=0;--S)T&1<<S&&u.set(c),c++}}return u}}class dr{constructor(r,s){s?this.decodedInformation=null:(this.finished=r,this.decodedInformation=s)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class oo{constructor(r){this.newPosition=r}getNewPosition(){return this.newPosition}}class dn extends oo{constructor(r,s){super(r),this.value=s}getValue(){return this.value}isFNC1(){return this.value===dn.FNC1}}dn.FNC1="$";class Or extends oo{constructor(r,s,o){super(r),o?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=s}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class rn extends oo{constructor(r,s,o){if(super(r),s<0||s>10||o<0||o>10)throw new N;this.firstDigit=s,this.secondDigit=o}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===rn.FNC1}isSecondDigitFNC1(){return this.secondDigit===rn.FNC1}isAnyFNC1(){return this.firstDigit===rn.FNC1||this.secondDigit===rn.FNC1}}rn.FNC1=10;class me{constructor(){}static parseFieldsInGeneralPurpose(r){if(!r)return null;if(r.length<2)throw new ee;let s=r.substring(0,2);for(let c of me.TWO_DIGIT_DATA_LENGTH)if(c[0]===s)return c[1]===me.VARIABLE_LENGTH?me.processVariableAI(2,c[2],r):me.processFixedAI(2,c[1],r);if(r.length<3)throw new ee;let o=r.substring(0,3);for(let c of me.THREE_DIGIT_DATA_LENGTH)if(c[0]===o)return c[1]===me.VARIABLE_LENGTH?me.processVariableAI(3,c[2],r):me.processFixedAI(3,c[1],r);for(let c of me.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(c[0]===o)return c[1]===me.VARIABLE_LENGTH?me.processVariableAI(4,c[2],r):me.processFixedAI(4,c[1],r);if(r.length<4)throw new ee;let u=r.substring(0,4);for(let c of me.FOUR_DIGIT_DATA_LENGTH)if(c[0]===u)return c[1]===me.VARIABLE_LENGTH?me.processVariableAI(4,c[2],r):me.processFixedAI(4,c[1],r);throw new ee}static processFixedAI(r,s,o){if(o.length<r)throw new ee;let u=o.substring(0,r);if(o.length<r+s)throw new ee;let c=o.substring(r,r+s),h=o.substring(r+s),d="("+u+")"+c,p=me.parseFieldsInGeneralPurpose(h);return p==null?d:d+p}static processVariableAI(r,s,o){let u=o.substring(0,r),c;o.length<r+s?c=o.length:c=r+s;let h=o.substring(r,c),d=o.substring(c),p="("+u+")"+h,w=me.parseFieldsInGeneralPurpose(d);return w==null?p:p+w}}me.VARIABLE_LENGTH=[],me.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",me.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",me.VARIABLE_LENGTH,20],["22",me.VARIABLE_LENGTH,29],["30",me.VARIABLE_LENGTH,8],["37",me.VARIABLE_LENGTH,8],["90",me.VARIABLE_LENGTH,30],["91",me.VARIABLE_LENGTH,30],["92",me.VARIABLE_LENGTH,30],["93",me.VARIABLE_LENGTH,30],["94",me.VARIABLE_LENGTH,30],["95",me.VARIABLE_LENGTH,30],["96",me.VARIABLE_LENGTH,30],["97",me.VARIABLE_LENGTH,3],["98",me.VARIABLE_LENGTH,30],["99",me.VARIABLE_LENGTH,30]],me.THREE_DIGIT_DATA_LENGTH=[["240",me.VARIABLE_LENGTH,30],["241",me.VARIABLE_LENGTH,30],["242",me.VARIABLE_LENGTH,6],["250",me.VARIABLE_LENGTH,30],["251",me.VARIABLE_LENGTH,30],["253",me.VARIABLE_LENGTH,17],["254",me.VARIABLE_LENGTH,20],["400",me.VARIABLE_LENGTH,30],["401",me.VARIABLE_LENGTH,30],["402",17],["403",me.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",me.VARIABLE_LENGTH,20],["421",me.VARIABLE_LENGTH,15],["422",3],["423",me.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],me.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",me.VARIABLE_LENGTH,15],["391",me.VARIABLE_LENGTH,18],["392",me.VARIABLE_LENGTH,15],["393",me.VARIABLE_LENGTH,18],["703",me.VARIABLE_LENGTH,30]],me.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",me.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",me.VARIABLE_LENGTH,20],["8003",me.VARIABLE_LENGTH,30],["8004",me.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",me.VARIABLE_LENGTH,30],["8008",me.VARIABLE_LENGTH,12],["8018",18],["8020",me.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",me.VARIABLE_LENGTH,70],["8200",me.VARIABLE_LENGTH,70]];class Pn{constructor(r){this.buffer=new L,this.information=r}decodeAllCodes(r,s){let o=s,u=null;do{let c=this.decodeGeneralPurposeField(o,u),h=me.parseFieldsInGeneralPurpose(c.getNewString());if(h!=null&&r.append(h),c.isRemaining()?u=""+c.getRemainingValue():u=null,o===c.getNewPosition())break;o=c.getNewPosition()}while(!0);return r.toString()}isStillNumeric(r){if(r+7>this.information.getSize())return r+4<=this.information.getSize();for(let s=r;s<r+3;++s)if(this.information.get(s))return!0;return this.information.get(r+3)}decodeNumeric(r){if(r+7>this.information.getSize()){let c=this.extractNumericValueFromBitArray(r,4);return c===0?new rn(this.information.getSize(),rn.FNC1,rn.FNC1):new rn(this.information.getSize(),c-1,rn.FNC1)}let s=this.extractNumericValueFromBitArray(r,7),o=(s-8)/11,u=(s-8)%11;return new rn(r+7,o,u)}extractNumericValueFromBitArray(r,s){return Pn.extractNumericValueFromBitArray(this.information,r,s)}static extractNumericValueFromBitArray(r,s,o){let u=0;for(let c=0;c<o;++c)r.get(s+c)&&(u|=1<<o-c-1);return u}decodeGeneralPurposeField(r,s){this.buffer.setLengthToZero(),s!=null&&this.buffer.append(s),this.current.setPosition(r);let o=this.parseBlocks();return o!=null&&o.isRemaining()?new Or(this.current.getPosition(),this.buffer.toString(),o.getRemainingValue()):new Or(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let r,s;do{let o=this.current.getPosition();if(this.current.isAlpha()?(s=this.parseAlphaBlock(),r=s.isFinished()):this.current.isIsoIec646()?(s=this.parseIsoIec646Block(),r=s.isFinished()):(s=this.parseNumericBlock(),r=s.isFinished()),!(o!==this.current.getPosition())&&!r)break}while(!r);return s.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let r=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFirstDigitFNC1()){let s;return r.isSecondDigitFNC1()?s=new Or(this.current.getPosition(),this.buffer.toString()):s=new Or(this.current.getPosition(),this.buffer.toString(),r.getSecondDigit()),new dr(!0,s)}if(this.buffer.append(r.getFirstDigit()),r.isSecondDigitFNC1()){let s=new Or(this.current.getPosition(),this.buffer.toString());return new dr(!0,s)}this.buffer.append(r.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new dr(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let r=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFNC1()){let s=new Or(this.current.getPosition(),this.buffer.toString());return new dr(!0,s)}this.buffer.append(r.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new dr(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let r=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFNC1()){let s=new Or(this.current.getPosition(),this.buffer.toString());return new dr(!0,s)}this.buffer.append(r.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new dr(!1)}isStillIsoIec646(r){if(r+5>this.information.getSize())return!1;let s=this.extractNumericValueFromBitArray(r,5);if(s>=5&&s<16)return!0;if(r+7>this.information.getSize())return!1;let o=this.extractNumericValueFromBitArray(r,7);if(o>=64&&o<116)return!0;if(r+8>this.information.getSize())return!1;let u=this.extractNumericValueFromBitArray(r,8);return u>=232&&u<253}decodeIsoIec646(r){let s=this.extractNumericValueFromBitArray(r,5);if(s===15)return new dn(r+5,dn.FNC1);if(s>=5&&s<15)return new dn(r+5,"0"+(s-5));let o=this.extractNumericValueFromBitArray(r,7);if(o>=64&&o<90)return new dn(r+7,""+(o+1));if(o>=90&&o<116)return new dn(r+7,""+(o+7));let u=this.extractNumericValueFromBitArray(r,8),c;switch(u){case 232:c="!";break;case 233:c='"';break;case 234:c="%";break;case 235:c="&";break;case 236:c="'";break;case 237:c="(";break;case 238:c=")";break;case 239:c="*";break;case 240:c="+";break;case 241:c=",";break;case 242:c="-";break;case 243:c=".";break;case 244:c="/";break;case 245:c=":";break;case 246:c=";";break;case 247:c="<";break;case 248:c="=";break;case 249:c=">";break;case 250:c="?";break;case 251:c="_";break;case 252:c=" ";break;default:throw new N}return new dn(r+8,c)}isStillAlpha(r){if(r+5>this.information.getSize())return!1;let s=this.extractNumericValueFromBitArray(r,5);if(s>=5&&s<16)return!0;if(r+6>this.information.getSize())return!1;let o=this.extractNumericValueFromBitArray(r,6);return o>=16&&o<63}decodeAlphanumeric(r){let s=this.extractNumericValueFromBitArray(r,5);if(s===15)return new dn(r+5,dn.FNC1);if(s>=5&&s<15)return new dn(r+5,"0"+(s-5));let o=this.extractNumericValueFromBitArray(r,6);if(o>=32&&o<58)return new dn(r+6,""+(o+33));let u;switch(o){case 58:u="*";break;case 59:u=",";break;case 60:u="-";break;case 61:u=".";break;case 62:u="/";break;default:throw new Jn("Decoding invalid alphanumeric value: "+o)}return new dn(r+6,u)}isAlphaTo646ToAlphaLatch(r){if(r+1>this.information.getSize())return!1;for(let s=0;s<5&&s+r<this.information.getSize();++s)if(s===2){if(!this.information.get(r+2))return!1}else if(this.information.get(r+s))return!1;return!0}isAlphaOr646ToNumericLatch(r){if(r+3>this.information.getSize())return!1;for(let s=r;s<r+3;++s)if(this.information.get(s))return!1;return!0}isNumericToAlphaNumericLatch(r){if(r+1>this.information.getSize())return!1;for(let s=0;s<4&&s+r<this.information.getSize();++s)if(this.information.get(r+s))return!1;return!0}}class ao{constructor(r){this.information=r,this.generalDecoder=new Pn(r)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class gn extends ao{constructor(r){super(r)}encodeCompressedGtin(r,s){r.append("(01)");let o=r.length();r.append("9"),this.encodeCompressedGtinWithoutAI(r,s,o)}encodeCompressedGtinWithoutAI(r,s,o){for(let u=0;u<4;++u){let c=this.getGeneralDecoder().extractNumericValueFromBitArray(s+10*u,10);c/100===0&&r.append("0"),c/10===0&&r.append("0"),r.append(c)}gn.appendCheckDigit(r,o)}static appendCheckDigit(r,s){let o=0;for(let u=0;u<13;u++){let c=r.charAt(u+s).charCodeAt(0)-"0".charCodeAt(0);o+=u&1?c:3*c}o=10-o%10,o===10&&(o=0),r.append(o)}}gn.GTIN_SIZE=40;class Xr extends gn{constructor(r){super(r)}parseInformation(){let r=new L;r.append("(01)");let s=r.length(),o=this.getGeneralDecoder().extractNumericValueFromBitArray(Xr.HEADER_SIZE,4);return r.append(o),this.encodeCompressedGtinWithoutAI(r,Xr.HEADER_SIZE+4,s),this.getGeneralDecoder().decodeAllCodes(r,Xr.HEADER_SIZE+44)}}Xr.HEADER_SIZE=1+1+2;class Vi extends ao{constructor(r){super(r)}parseInformation(){let r=new L;return this.getGeneralDecoder().decodeAllCodes(r,Vi.HEADER_SIZE)}}Vi.HEADER_SIZE=2+1+2;class bs extends gn{constructor(r){super(r)}encodeCompressedWeight(r,s,o){let u=this.getGeneralDecoder().extractNumericValueFromBitArray(s,o);this.addWeightCode(r,u);let c=this.checkWeight(u),h=1e5;for(let d=0;d<5;++d)c/h===0&&r.append("0"),h/=10;r.append(c)}}class gr extends bs{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()!=gr.HEADER_SIZE+bs.GTIN_SIZE+gr.WEIGHT_SIZE)throw new ee;let r=new L;return this.encodeCompressedGtin(r,gr.HEADER_SIZE),this.encodeCompressedWeight(r,gr.HEADER_SIZE+bs.GTIN_SIZE,gr.WEIGHT_SIZE),r.toString()}}gr.HEADER_SIZE=4+1,gr.WEIGHT_SIZE=15;class Gl extends gr{constructor(r){super(r)}addWeightCode(r,s){r.append("(3103)")}checkWeight(r){return r}}class hh extends gr{constructor(r){super(r)}addWeightCode(r,s){s<1e4?r.append("(3202)"):r.append("(3203)")}checkWeight(r){return r<1e4?r:r-1e4}}class Mn extends gn{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()<Mn.HEADER_SIZE+gn.GTIN_SIZE)throw new ee;let r=new L;this.encodeCompressedGtin(r,Mn.HEADER_SIZE);let s=this.getGeneralDecoder().extractNumericValueFromBitArray(Mn.HEADER_SIZE+gn.GTIN_SIZE,Mn.LAST_DIGIT_SIZE);r.append("(392"),r.append(s),r.append(")");let o=this.getGeneralDecoder().decodeGeneralPurposeField(Mn.HEADER_SIZE+gn.GTIN_SIZE+Mn.LAST_DIGIT_SIZE,null);return r.append(o.getNewString()),r.toString()}}Mn.HEADER_SIZE=5+1+2,Mn.LAST_DIGIT_SIZE=2;class sn extends gn{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()<sn.HEADER_SIZE+gn.GTIN_SIZE)throw new ee;let r=new L;this.encodeCompressedGtin(r,sn.HEADER_SIZE);let s=this.getGeneralDecoder().extractNumericValueFromBitArray(sn.HEADER_SIZE+gn.GTIN_SIZE,sn.LAST_DIGIT_SIZE);r.append("(393"),r.append(s),r.append(")");let o=this.getGeneralDecoder().extractNumericValueFromBitArray(sn.HEADER_SIZE+gn.GTIN_SIZE+sn.LAST_DIGIT_SIZE,sn.FIRST_THREE_DIGITS_SIZE);o/100==0&&r.append("0"),o/10==0&&r.append("0"),r.append(o);let u=this.getGeneralDecoder().decodeGeneralPurposeField(sn.HEADER_SIZE+gn.GTIN_SIZE+sn.LAST_DIGIT_SIZE+sn.FIRST_THREE_DIGITS_SIZE,null);return r.append(u.getNewString()),r.toString()}}sn.HEADER_SIZE=5+1+2,sn.LAST_DIGIT_SIZE=2,sn.FIRST_THREE_DIGITS_SIZE=10;class ct extends bs{constructor(r,s,o){super(r),this.dateCode=o,this.firstAIdigits=s}parseInformation(){if(this.getInformation().getSize()!=ct.HEADER_SIZE+ct.GTIN_SIZE+ct.WEIGHT_SIZE+ct.DATE_SIZE)throw new ee;let r=new L;return this.encodeCompressedGtin(r,ct.HEADER_SIZE),this.encodeCompressedWeight(r,ct.HEADER_SIZE+ct.GTIN_SIZE,ct.WEIGHT_SIZE),this.encodeCompressedDate(r,ct.HEADER_SIZE+ct.GTIN_SIZE+ct.WEIGHT_SIZE),r.toString()}encodeCompressedDate(r,s){let o=this.getGeneralDecoder().extractNumericValueFromBitArray(s,ct.DATE_SIZE);if(o==38400)return;r.append("("),r.append(this.dateCode),r.append(")");let u=o%32;o/=32;let c=o%12+1;o/=12;let h=o;h/10==0&&r.append("0"),r.append(h),c/10==0&&r.append("0"),r.append(c),u/10==0&&r.append("0"),r.append(u)}addWeightCode(r,s){r.append("("),r.append(this.firstAIdigits),r.append(s/1e5),r.append(")")}checkWeight(r){return r%1e5}}ct.HEADER_SIZE=7+1,ct.WEIGHT_SIZE=20,ct.DATE_SIZE=16;function Ui(I){try{if(I.get(1))return new Xr(I);if(!I.get(2))return new Vi(I);switch(Pn.extractNumericValueFromBitArray(I,1,4)){case 4:return new Gl(I);case 5:return new hh(I)}switch(Pn.extractNumericValueFromBitArray(I,1,5)){case 12:return new Mn(I);case 13:return new sn(I)}switch(Pn.extractNumericValueFromBitArray(I,1,7)){case 56:return new ct(I,"310","11");case 57:return new ct(I,"320","11");case 58:return new ct(I,"310","13");case 59:return new ct(I,"320","13");case 60:return new ct(I,"310","15");case 61:return new ct(I,"320","15");case 62:return new ct(I,"310","17");case 63:return new ct(I,"320","17")}}catch(r){throw console.log(r),new Jn("unknown decoder: "+I)}}class Cn{constructor(r,s,o,u){this.leftchar=r,this.rightchar=s,this.finderpattern=o,this.maybeLast=u}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(r,s){return r instanceof Cn?Cn.equalsOrNull(r.leftchar,s.leftchar)&&Cn.equalsOrNull(r.rightchar,s.rightchar)&&Cn.equalsOrNull(r.finderpattern,s.finderpattern):!1}static equalsOrNull(r,s){return r===null?s===null:Cn.equals(r,s)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class Ds{constructor(r,s,o){this.pairs=r,this.rowNumber=s,this.wasReversed=o}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(r){return this.checkEqualitity(this,r)}toString(){return"{ "+this.pairs+" }"}equals(r,s){return r instanceof Ds?this.checkEqualitity(r,s)&&r.wasReversed===s.wasReversed:!1}checkEqualitity(r,s){if(!r||!s)return;let o;return r.forEach((u,c)=>{s.forEach(h=>{u.getLeftChar().getValue()===h.getLeftChar().getValue()&&u.getRightChar().getValue()===h.getRightChar().getValue()&&u.getFinderPatter().getValue()===h.getFinderPatter().getValue()&&(o=!0)})}),o}}class ie extends nn{constructor(r){super(...arguments),this.pairs=new Array(ie.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=r===!0}decodeRow(r,s,o){this.pairs.length=0,this.startFromEven=!1;try{return ie.constructResult(this.decodeRow2pairs(r,s))}catch(u){this.verbose&&console.log(u)}return this.pairs.length=0,this.startFromEven=!0,ie.constructResult(this.decodeRow2pairs(r,s))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(r,s){let o=!1;for(;!o;)try{this.pairs.push(this.retrieveNextPair(s,this.pairs,r))}catch(c){if(c instanceof ee){if(!this.pairs.length)throw new ee;o=!0}}if(this.checkChecksum())return this.pairs;let u;if(this.rows.length?u=!0:u=!1,this.storeRow(r,!1),u){let c=this.checkRowsBoolean(!1);if(c!=null||(c=this.checkRowsBoolean(!0),c!=null))return c}throw new ee}checkRowsBoolean(r){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,r&&(this.rows=this.rows.reverse());let s=null;try{s=this.checkRows(new Array,0)}catch(o){this.verbose&&console.log(o)}return r&&(this.rows=this.rows.reverse()),s}checkRows(r,s){for(let o=s;o<this.rows.length;o++){let u=this.rows[o];this.pairs.length=0;for(let h of r)this.pairs.push(h.getPairs());if(this.pairs.push(u.getPairs()),!ie.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let c=new Array(r);c.push(u);try{return this.checkRows(c,o+1)}catch(h){this.verbose&&console.log(h)}}throw new ee}static isValidSequence(r){for(let s of ie.FINDER_PATTERN_SEQUENCES){if(r.length>s.length)continue;let o=!0;for(let u=0;u<r.length;u++)if(r[u].getFinderPattern().getValue()!=s[u]){o=!1;break}if(o)return!0}return!1}storeRow(r,s){let o=0,u=!1,c=!1;for(;o<this.rows.length;){let h=this.rows[o];if(h.getRowNumber()>r){c=h.isEquivalent(this.pairs);break}u=h.isEquivalent(this.pairs),o++}c||u||ie.isPartialRow(this.pairs,this.rows)||(this.rows.push(o,new Ds(this.pairs,r,s)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(r,s){for(let o of s)if(o.getPairs().length!==r.length){for(let u of o.getPairs())for(let c of r)if(Cn.equals(u,c))break}}static isPartialRow(r,s){for(let o of s){let u=!0;for(let c of r){let h=!1;for(let d of o.getPairs())if(c.equals(d)){h=!0;break}if(!h){u=!1;break}}if(u)return!0}return!1}getRows(){return this.rows}static constructResult(r){let s=ch.buildBitArray(r),u=Ui(s).parseInformation(),c=r[0].getFinderPattern().getResultPoints(),h=r[r.length-1].getFinderPattern().getResultPoints(),d=[c[0],c[1],h[0],h[1]];return new ut(u,null,null,d,Ee.RSS_EXPANDED,null)}checkChecksum(){let r=this.pairs.get(0),s=r.getLeftChar(),o=r.getRightChar();if(o==null)return!1;let u=o.getChecksumPortion(),c=2;for(let d=1;d<this.pairs.size();++d){let p=this.pairs.get(d);u+=p.getLeftChar().getChecksumPortion(),c++;let w=p.getRightChar();w!=null&&(u+=w.getChecksumPortion(),c++)}return u%=211,211*(c-4)+u==s.getValue()}static getNextSecondBar(r,s){let o;return r.get(s)?(o=r.getNextUnset(s),o=r.getNextSet(o)):(o=r.getNextSet(s),o=r.getNextUnset(o)),o}retrieveNextPair(r,s,o){let u=s.length%2==0;this.startFromEven&&(u=!u);let c,h=!0,d=-1;do this.findNextPair(r,s,d),c=this.parseFoundFinderPattern(r,o,u),c==null?d=ie.getNextSecondBar(r,this.startEnd[0]):h=!1;while(h);let p=this.decodeDataCharacter(r,c,u,!0);if(!this.isEmptyPair(s)&&s[s.length-1].mustBeLast())throw new ee;let w;try{w=this.decodeDataCharacter(r,c,u,!1)}catch(_){w=null,this.verbose&&console.log(_)}return new Cn(p,w,c,!0)}isEmptyPair(r){return r.length===0}findNextPair(r,s,o){let u=this.getDecodeFinderCounters();u[0]=0,u[1]=0,u[2]=0,u[3]=0;let c=r.getSize(),h;o>=0?h=o:this.isEmptyPair(s)?h=0:h=s[s.length-1].getFinderPattern().getStartEnd()[1];let d=s.length%2!=0;this.startFromEven&&(d=!d);let p=!1;for(;h<c&&(p=!r.get(h),!!p);)h++;let w=0,_=h;for(let T=h;T<c;T++)if(r.get(T)!=p)u[w]++;else{if(w==3){if(d&&ie.reverseCounters(u),ie.isFinderPattern(u)){this.startEnd[0]=_,this.startEnd[1]=T;return}d&&ie.reverseCounters(u),_+=u[0]+u[1],u[0]=u[2],u[1]=u[3],u[2]=0,u[3]=0,w--}else w++;u[w]=1,p=!p}throw new ee}static reverseCounters(r){let s=r.length;for(let o=0;o<s/2;++o){let u=r[o];r[o]=r[s-o-1],r[s-o-1]=u}}parseFoundFinderPattern(r,s,o){let u,c,h;if(o){let w=this.startEnd[0]-1;for(;w>=0&&!r.get(w);)w--;w++,u=this.startEnd[0]-w,c=w,h=this.startEnd[1]}else c=this.startEnd[0],h=r.getNextUnset(this.startEnd[1]+1),u=h-this.startEnd[1];let d=this.getDecodeFinderCounters();X.arraycopy(d,0,d,1,d.length-1),d[0]=u;let p;try{p=this.parseFinderValue(d,ie.FINDER_PATTERNS)}catch{return null}return new Dr(p,[c,h],c,h,s)}decodeDataCharacter(r,s,o,u){let c=this.getDataCharacterCounters();for(let gt=0;gt<c.length;gt++)c[gt]=0;if(u)ie.recordPatternInReverse(r,s.getStartEnd()[0],c);else{ie.recordPattern(r,s.getStartEnd()[1],c);for(let gt=0,pn=c.length-1;gt<pn;gt++,pn--){let er=c[gt];c[gt]=c[pn],c[pn]=er}}let h=17,d=Fe.sum(new Int32Array(c))/h,p=(s.getStartEnd()[1]-s.getStartEnd()[0])/15;if(Math.abs(d-p)/p>.3)throw new ee;let w=this.getOddCounts(),_=this.getEvenCounts(),T=this.getOddRoundingErrors(),S=this.getEvenRoundingErrors();for(let gt=0;gt<c.length;gt++){let pn=1*c[gt]/d,er=pn+.5;if(er<1){if(pn<.3)throw new ee;er=1}else if(er>8){if(pn>8.7)throw new ee;er=8}let yo=gt/2;gt&1?(_[yo]=er,S[yo]=pn-er):(w[yo]=er,T[yo]=pn-er)}this.adjustOddEvenCounts(h);let M=4*s.getValue()+(o?0:2)+(u?0:1)-1,z=0,W=0;for(let gt=w.length-1;gt>=0;gt--){if(ie.isNotA1left(s,o,u)){let pn=ie.WEIGHTS[M][2*gt];W+=w[gt]*pn}z+=w[gt]}let q=0;for(let gt=_.length-1;gt>=0;gt--)if(ie.isNotA1left(s,o,u)){let pn=ie.WEIGHTS[M][2*gt+1];q+=_[gt]*pn}let J=W+q;if(z&1||z>13||z<4)throw new ee;let le=(13-z)/2,ue=ie.SYMBOL_WIDEST[le],oe=9-ue,He=fr.getRSSvalue(w,ue,!0),ke=fr.getRSSvalue(_,oe,!1),Wn=ie.EVEN_TOTAL_SUBSET[le],kr=ie.GSUM[le],jn=He*Wn+ke+kr;return new Fi(jn,J)}static isNotA1left(r,s,o){return!(r.getValue()==0&&s&&o)}adjustOddEvenCounts(r){let s=Fe.sum(new Int32Array(this.getOddCounts())),o=Fe.sum(new Int32Array(this.getEvenCounts())),u=!1,c=!1;s>13?c=!0:s<4&&(u=!0);let h=!1,d=!1;o>13?d=!0:o<4&&(h=!0);let p=s+o-r,w=(s&1)==1,_=(o&1)==0;if(p==1)if(w){if(_)throw new ee;c=!0}else{if(!_)throw new ee;d=!0}else if(p==-1)if(w){if(_)throw new ee;u=!0}else{if(!_)throw new ee;h=!0}else if(p==0){if(w){if(!_)throw new ee;s<o?(u=!0,d=!0):(c=!0,h=!0)}else if(_)throw new ee}else throw new ee;if(u){if(c)throw new ee;ie.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(c&&ie.decrement(this.getOddCounts(),this.getOddRoundingErrors()),h){if(d)throw new ee;ie.increment(this.getEvenCounts(),this.getOddRoundingErrors())}d&&ie.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}ie.SYMBOL_WIDEST=[7,5,4,3,1],ie.EVEN_TOTAL_SUBSET=[4,20,52,104,204],ie.GSUM=[0,348,1388,2948,3988],ie.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],ie.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],ie.FINDER_PAT_A=0,ie.FINDER_PAT_B=1,ie.FINDER_PAT_C=2,ie.FINDER_PAT_D=3,ie.FINDER_PAT_E=4,ie.FINDER_PAT_F=5,ie.FINDER_PATTERN_SEQUENCES=[[ie.FINDER_PAT_A,ie.FINDER_PAT_A],[ie.FINDER_PAT_A,ie.FINDER_PAT_B,ie.FINDER_PAT_B],[ie.FINDER_PAT_A,ie.FINDER_PAT_C,ie.FINDER_PAT_B,ie.FINDER_PAT_D],[ie.FINDER_PAT_A,ie.FINDER_PAT_E,ie.FINDER_PAT_B,ie.FINDER_PAT_D,ie.FINDER_PAT_C],[ie.FINDER_PAT_A,ie.FINDER_PAT_E,ie.FINDER_PAT_B,ie.FINDER_PAT_D,ie.FINDER_PAT_D,ie.FINDER_PAT_F],[ie.FINDER_PAT_A,ie.FINDER_PAT_E,ie.FINDER_PAT_B,ie.FINDER_PAT_D,ie.FINDER_PAT_E,ie.FINDER_PAT_F,ie.FINDER_PAT_F],[ie.FINDER_PAT_A,ie.FINDER_PAT_A,ie.FINDER_PAT_B,ie.FINDER_PAT_B,ie.FINDER_PAT_C,ie.FINDER_PAT_C,ie.FINDER_PAT_D,ie.FINDER_PAT_D],[ie.FINDER_PAT_A,ie.FINDER_PAT_A,ie.FINDER_PAT_B,ie.FINDER_PAT_B,ie.FINDER_PAT_C,ie.FINDER_PAT_C,ie.FINDER_PAT_D,ie.FINDER_PAT_E,ie.FINDER_PAT_E],[ie.FINDER_PAT_A,ie.FINDER_PAT_A,ie.FINDER_PAT_B,ie.FINDER_PAT_B,ie.FINDER_PAT_C,ie.FINDER_PAT_C,ie.FINDER_PAT_D,ie.FINDER_PAT_E,ie.FINDER_PAT_F,ie.FINDER_PAT_F],[ie.FINDER_PAT_A,ie.FINDER_PAT_A,ie.FINDER_PAT_B,ie.FINDER_PAT_B,ie.FINDER_PAT_C,ie.FINDER_PAT_D,ie.FINDER_PAT_D,ie.FINDER_PAT_E,ie.FINDER_PAT_E,ie.FINDER_PAT_F,ie.FINDER_PAT_F]],ie.MAX_PAIRS=11;class Wl extends Fi{constructor(r,s,o){super(r,s),this.count=0,this.finderPattern=o}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class wt extends nn{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(r,s,o){const u=this.decodePair(s,!1,r,o);wt.addOrTally(this.possibleLeftPairs,u),s.reverse();let c=this.decodePair(s,!0,r,o);wt.addOrTally(this.possibleRightPairs,c),s.reverse();for(let h of this.possibleLeftPairs)if(h.getCount()>1){for(let d of this.possibleRightPairs)if(d.getCount()>1&&wt.checkChecksum(h,d))return wt.constructResult(h,d)}throw new ee}static addOrTally(r,s){if(s==null)return;let o=!1;for(let u of r)if(u.getValue()===s.getValue()){u.incrementCount(),o=!0;break}o||r.push(s)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(r,s){let o=4537077*r.getValue()+s.getValue(),u=new String(o).toString(),c=new L;for(let w=13-u.length;w>0;w--)c.append("0");c.append(u);let h=0;for(let w=0;w<13;w++){let _=c.charAt(w).charCodeAt(0)-"0".charCodeAt(0);h+=w&1?_:3*_}h=10-h%10,h===10&&(h=0),c.append(h.toString());let d=r.getFinderPattern().getResultPoints(),p=s.getFinderPattern().getResultPoints();return new ut(c.toString(),null,0,[d[0],d[1],p[0],p[1]],Ee.RSS_14,new Date().getTime())}static checkChecksum(r,s){let o=(r.getChecksumPortion()+16*s.getChecksumPortion())%79,u=9*r.getFinderPattern().getValue()+s.getFinderPattern().getValue();return u>72&&u--,u>8&&u--,o===u}decodePair(r,s,o,u){try{let c=this.findFinderPattern(r,s),h=this.parseFoundFinderPattern(r,o,s,c),d=u==null?null:u.get(se.NEED_RESULT_POINT_CALLBACK);if(d!=null){let _=(c[0]+c[1])/2;s&&(_=r.getSize()-1-_),d.foundPossibleResultPoint(new de(_,o))}let p=this.decodeDataCharacter(r,h,!0),w=this.decodeDataCharacter(r,h,!1);return new Wl(1597*p.getValue()+w.getValue(),p.getChecksumPortion()+4*w.getChecksumPortion(),h)}catch{return null}}decodeDataCharacter(r,s,o){let u=this.getDataCharacterCounters();for(let q=0;q<u.length;q++)u[q]=0;if(o)St.recordPatternInReverse(r,s.getStartEnd()[0],u);else{St.recordPattern(r,s.getStartEnd()[1]+1,u);for(let q=0,J=u.length-1;q<J;q++,J--){let le=u[q];u[q]=u[J],u[J]=le}}let c=o?16:15,h=Fe.sum(new Int32Array(u))/c,d=this.getOddCounts(),p=this.getEvenCounts(),w=this.getOddRoundingErrors(),_=this.getEvenRoundingErrors();for(let q=0;q<u.length;q++){let J=u[q]/h,le=Math.floor(J+.5);le<1?le=1:le>8&&(le=8);let ue=Math.floor(q/2);q&1?(p[ue]=le,_[ue]=J-le):(d[ue]=le,w[ue]=J-le)}this.adjustOddEvenCounts(o,c);let T=0,S=0;for(let q=d.length-1;q>=0;q--)S*=9,S+=d[q],T+=d[q];let M=0,z=0;for(let q=p.length-1;q>=0;q--)M*=9,M+=p[q],z+=p[q];let W=S+3*M;if(o){if(T&1||T>12||T<4)throw new ee;let q=(12-T)/2,J=wt.OUTSIDE_ODD_WIDEST[q],le=9-J,ue=fr.getRSSvalue(d,J,!1),oe=fr.getRSSvalue(p,le,!0),He=wt.OUTSIDE_EVEN_TOTAL_SUBSET[q],ke=wt.OUTSIDE_GSUM[q];return new Fi(ue*He+oe+ke,W)}else{if(z&1||z>10||z<4)throw new ee;let q=(10-z)/2,J=wt.INSIDE_ODD_WIDEST[q],le=9-J,ue=fr.getRSSvalue(d,J,!0),oe=fr.getRSSvalue(p,le,!1),He=wt.INSIDE_ODD_TOTAL_SUBSET[q],ke=wt.INSIDE_GSUM[q];return new Fi(oe*He+ue+ke,W)}}findFinderPattern(r,s){let o=this.getDecodeFinderCounters();o[0]=0,o[1]=0,o[2]=0,o[3]=0;let u=r.getSize(),c=!1,h=0;for(;h<u&&(c=!r.get(h),s!==c);)h++;let d=0,p=h;for(let w=h;w<u;w++)if(r.get(w)!==c)o[d]++;else{if(d===3){if(nn.isFinderPattern(o))return[p,w];p+=o[0]+o[1],o[0]=o[2],o[1]=o[3],o[2]=0,o[3]=0,d--}else d++;o[d]=1,c=!c}throw new ee}parseFoundFinderPattern(r,s,o,u){let c=r.get(u[0]),h=u[0]-1;for(;h>=0&&c!==r.get(h);)h--;h++;const d=u[0]-h,p=this.getDecodeFinderCounters(),w=new Int32Array(p.length);X.arraycopy(p,0,w,1,p.length-1),w[0]=d;const _=this.parseFinderValue(w,wt.FINDER_PATTERNS);let T=h,S=u[1];return o&&(T=r.getSize()-1-T,S=r.getSize()-1-S),new Dr(_,[h,u[1]],T,S,s)}adjustOddEvenCounts(r,s){let o=Fe.sum(new Int32Array(this.getOddCounts())),u=Fe.sum(new Int32Array(this.getEvenCounts())),c=!1,h=!1,d=!1,p=!1;r?(o>12?h=!0:o<4&&(c=!0),u>12?p=!0:u<4&&(d=!0)):(o>11?h=!0:o<5&&(c=!0),u>10?p=!0:u<4&&(d=!0));let w=o+u-s,_=(o&1)===(r?1:0),T=(u&1)===1;if(w===1)if(_){if(T)throw new ee;h=!0}else{if(!T)throw new ee;p=!0}else if(w===-1)if(_){if(T)throw new ee;c=!0}else{if(!T)throw new ee;d=!0}else if(w===0){if(_){if(!T)throw new ee;o<u?(c=!0,p=!0):(h=!0,d=!0)}else if(T)throw new ee}else throw new ee;if(c){if(h)throw new ee;nn.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(h&&nn.decrement(this.getOddCounts(),this.getOddRoundingErrors()),d){if(p)throw new ee;nn.increment(this.getEvenCounts(),this.getOddRoundingErrors())}p&&nn.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}wt.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],wt.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],wt.OUTSIDE_GSUM=[0,161,961,2015,2715],wt.INSIDE_GSUM=[0,336,1036,1516],wt.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],wt.INSIDE_ODD_WIDEST=[2,4,6,8],wt.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class gi extends St{constructor(r,s){super(),this.readers=[],this.verbose=s===!0;const o=r?r.get(se.POSSIBLE_FORMATS):null,u=r&&r.get(se.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;o?((o.includes(Ee.EAN_13)||o.includes(Ee.UPC_A)||o.includes(Ee.EAN_8)||o.includes(Ee.UPC_E))&&this.readers.push(new di(r)),o.includes(Ee.CODE_39)&&this.readers.push(new Rt(u)),o.includes(Ee.CODE_128)&&this.readers.push(new he),o.includes(Ee.ITF)&&this.readers.push(new et),o.includes(Ee.RSS_14)&&this.readers.push(new wt),o.includes(Ee.RSS_EXPANDED)&&this.readers.push(new ie(this.verbose))):(this.readers.push(new di(r)),this.readers.push(new Rt),this.readers.push(new di(r)),this.readers.push(new he),this.readers.push(new et),this.readers.push(new wt),this.readers.push(new ie(this.verbose)))}decodeRow(r,s,o){for(let u=0;u<this.readers.length;u++)try{return this.readers[u].decodeRow(r,s,o)}catch{}throw new ee}reset(){this.readers.forEach(r=>r.reset())}}class ma extends On{constructor(r=500,s){super(new gi(s),r,s)}}class Xe{constructor(r,s,o){this.ecCodewords=r,this.ecBlocks=[s],o&&this.ecBlocks.push(o)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class qe{constructor(r,s){this.count=r,this.dataCodewords=s}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Le{constructor(r,s,o,u,c,h){this.versionNumber=r,this.symbolSizeRows=s,this.symbolSizeColumns=o,this.dataRegionSizeRows=u,this.dataRegionSizeColumns=c,this.ecBlocks=h;let d=0;const p=h.getECCodewords(),w=h.getECBlocks();for(let _ of w)d+=_.getCount()*(_.getDataCodewords()+p);this.totalCodewords=d}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(r,s){if(r&1||s&1)throw new N;for(let o of Le.VERSIONS)if(o.symbolSizeRows===r&&o.symbolSizeColumns===s)return o;throw new N}toString(){return""+this.versionNumber}static buildVersions(){return[new Le(1,10,10,8,8,new Xe(5,new qe(1,3))),new Le(2,12,12,10,10,new Xe(7,new qe(1,5))),new Le(3,14,14,12,12,new Xe(10,new qe(1,8))),new Le(4,16,16,14,14,new Xe(12,new qe(1,12))),new Le(5,18,18,16,16,new Xe(14,new qe(1,18))),new Le(6,20,20,18,18,new Xe(18,new qe(1,22))),new Le(7,22,22,20,20,new Xe(20,new qe(1,30))),new Le(8,24,24,22,22,new Xe(24,new qe(1,36))),new Le(9,26,26,24,24,new Xe(28,new qe(1,44))),new Le(10,32,32,14,14,new Xe(36,new qe(1,62))),new Le(11,36,36,16,16,new Xe(42,new qe(1,86))),new Le(12,40,40,18,18,new Xe(48,new qe(1,114))),new Le(13,44,44,20,20,new Xe(56,new qe(1,144))),new Le(14,48,48,22,22,new Xe(68,new qe(1,174))),new Le(15,52,52,24,24,new Xe(42,new qe(2,102))),new Le(16,64,64,14,14,new Xe(56,new qe(2,140))),new Le(17,72,72,16,16,new Xe(36,new qe(4,92))),new Le(18,80,80,18,18,new Xe(48,new qe(4,114))),new Le(19,88,88,20,20,new Xe(56,new qe(4,144))),new Le(20,96,96,22,22,new Xe(68,new qe(4,174))),new Le(21,104,104,24,24,new Xe(56,new qe(6,136))),new Le(22,120,120,18,18,new Xe(68,new qe(6,175))),new Le(23,132,132,20,20,new Xe(62,new qe(8,163))),new Le(24,144,144,22,22,new Xe(62,new qe(8,156),new qe(2,155))),new Le(25,8,18,6,16,new Xe(7,new qe(1,5))),new Le(26,8,32,6,14,new Xe(11,new qe(1,10))),new Le(27,12,26,10,24,new Xe(14,new qe(1,16))),new Le(28,12,36,10,16,new Xe(18,new qe(1,22))),new Le(29,16,36,14,16,new Xe(24,new qe(1,32))),new Le(30,16,48,14,22,new Xe(28,new qe(1,49)))]}}Le.VERSIONS=Le.buildVersions();class lo{constructor(r){const s=r.getHeight();if(s<8||s>144||s&1)throw new N;this.version=lo.readVersion(r),this.mappingBitMatrix=this.extractDataRegion(r),this.readMappingMatrix=new ze(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(r){const s=r.getHeight(),o=r.getWidth();return Le.getVersionForDimensions(s,o)}readCodewords(){const r=new Int8Array(this.version.getTotalCodewords());let s=0,o=4,u=0;const c=this.mappingBitMatrix.getHeight(),h=this.mappingBitMatrix.getWidth();let d=!1,p=!1,w=!1,_=!1;do if(o===c&&u===0&&!d)r[s++]=this.readCorner1(c,h)&255,o-=2,u+=2,d=!0;else if(o===c-2&&u===0&&h&3&&!p)r[s++]=this.readCorner2(c,h)&255,o-=2,u+=2,p=!0;else if(o===c+4&&u===2&&!(h&7)&&!w)r[s++]=this.readCorner3(c,h)&255,o-=2,u+=2,w=!0;else if(o===c-2&&u===0&&(h&7)===4&&!_)r[s++]=this.readCorner4(c,h)&255,o-=2,u+=2,_=!0;else{do o<c&&u>=0&&!this.readMappingMatrix.get(u,o)&&(r[s++]=this.readUtah(o,u,c,h)&255),o-=2,u+=2;while(o>=0&&u<h);o+=1,u+=3;do o>=0&&u<h&&!this.readMappingMatrix.get(u,o)&&(r[s++]=this.readUtah(o,u,c,h)&255),o+=2,u-=2;while(o<c&&u>=0);o+=3,u+=1}while(o<c||u<h);if(s!==this.version.getTotalCodewords())throw new N;return r}readModule(r,s,o,u){return r<0&&(r+=o,s+=4-(o+4&7)),s<0&&(s+=u,r+=4-(u+4&7)),this.readMappingMatrix.set(s,r),this.mappingBitMatrix.get(s,r)}readUtah(r,s,o,u){let c=0;return this.readModule(r-2,s-2,o,u)&&(c|=1),c<<=1,this.readModule(r-2,s-1,o,u)&&(c|=1),c<<=1,this.readModule(r-1,s-2,o,u)&&(c|=1),c<<=1,this.readModule(r-1,s-1,o,u)&&(c|=1),c<<=1,this.readModule(r-1,s,o,u)&&(c|=1),c<<=1,this.readModule(r,s-2,o,u)&&(c|=1),c<<=1,this.readModule(r,s-1,o,u)&&(c|=1),c<<=1,this.readModule(r,s,o,u)&&(c|=1),c}readCorner1(r,s){let o=0;return this.readModule(r-1,0,r,s)&&(o|=1),o<<=1,this.readModule(r-1,1,r,s)&&(o|=1),o<<=1,this.readModule(r-1,2,r,s)&&(o|=1),o<<=1,this.readModule(0,s-2,r,s)&&(o|=1),o<<=1,this.readModule(0,s-1,r,s)&&(o|=1),o<<=1,this.readModule(1,s-1,r,s)&&(o|=1),o<<=1,this.readModule(2,s-1,r,s)&&(o|=1),o<<=1,this.readModule(3,s-1,r,s)&&(o|=1),o}readCorner2(r,s){let o=0;return this.readModule(r-3,0,r,s)&&(o|=1),o<<=1,this.readModule(r-2,0,r,s)&&(o|=1),o<<=1,this.readModule(r-1,0,r,s)&&(o|=1),o<<=1,this.readModule(0,s-4,r,s)&&(o|=1),o<<=1,this.readModule(0,s-3,r,s)&&(o|=1),o<<=1,this.readModule(0,s-2,r,s)&&(o|=1),o<<=1,this.readModule(0,s-1,r,s)&&(o|=1),o<<=1,this.readModule(1,s-1,r,s)&&(o|=1),o}readCorner3(r,s){let o=0;return this.readModule(r-1,0,r,s)&&(o|=1),o<<=1,this.readModule(r-1,s-1,r,s)&&(o|=1),o<<=1,this.readModule(0,s-3,r,s)&&(o|=1),o<<=1,this.readModule(0,s-2,r,s)&&(o|=1),o<<=1,this.readModule(0,s-1,r,s)&&(o|=1),o<<=1,this.readModule(1,s-3,r,s)&&(o|=1),o<<=1,this.readModule(1,s-2,r,s)&&(o|=1),o<<=1,this.readModule(1,s-1,r,s)&&(o|=1),o}readCorner4(r,s){let o=0;return this.readModule(r-3,0,r,s)&&(o|=1),o<<=1,this.readModule(r-2,0,r,s)&&(o|=1),o<<=1,this.readModule(r-1,0,r,s)&&(o|=1),o<<=1,this.readModule(0,s-2,r,s)&&(o|=1),o<<=1,this.readModule(0,s-1,r,s)&&(o|=1),o<<=1,this.readModule(1,s-1,r,s)&&(o|=1),o<<=1,this.readModule(2,s-1,r,s)&&(o|=1),o<<=1,this.readModule(3,s-1,r,s)&&(o|=1),o}extractDataRegion(r){const s=this.version.getSymbolSizeRows(),o=this.version.getSymbolSizeColumns();if(r.getHeight()!==s)throw new v("Dimension of bitMatrix must match the version size");const u=this.version.getDataRegionSizeRows(),c=this.version.getDataRegionSizeColumns(),h=s/u|0,d=o/c|0,p=h*u,w=d*c,_=new ze(w,p);for(let T=0;T<h;++T){const S=T*u;for(let M=0;M<d;++M){const z=M*c;for(let W=0;W<u;++W){const q=T*(u+2)+1+W,J=S+W;for(let le=0;le<c;++le){const ue=M*(c+2)+1+le;if(r.get(ue,q)){const oe=z+le;_.set(oe,J)}}}}}return _}}class ya{constructor(r,s){this.numDataCodewords=r,this.codewords=s}static getDataBlocks(r,s){const o=s.getECBlocks();let u=0;const c=o.getECBlocks();for(let W of c)u+=W.getCount();const h=new Array(u);let d=0;for(let W of c)for(let q=0;q<W.getCount();q++){const J=W.getDataCodewords(),le=o.getECCodewords()+J;h[d++]=new ya(J,new Uint8Array(le))}const w=h[0].codewords.length-o.getECCodewords(),_=w-1;let T=0;for(let W=0;W<_;W++)for(let q=0;q<d;q++)h[q].codewords[W]=r[T++];const S=s.getVersionNumber()===24,M=S?8:d;for(let W=0;W<M;W++)h[W].codewords[w-1]=r[T++];const z=h[0].codewords.length;for(let W=w;W<z;W++)for(let q=0;q<d;q++){const J=S?(q+8)%d:q,le=S&&J>7?W-1:W;h[J].codewords[le]=r[T++]}if(T!==r.length)throw new v;return h}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class pr{constructor(r){this.bytes=r,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(r){if(r<1||r>32||r>this.available())throw new v(""+r);let s=0,o=this.bitOffset,u=this.byteOffset;const c=this.bytes;if(o>0){const h=8-o,d=r<h?r:h,p=h-d,w=255>>8-d<<p;s=(c[u]&w)>>p,r-=d,o+=d,o===8&&(o=0,u++)}if(r>0){for(;r>=8;)s=s<<8|c[u]&255,u++,r-=8;if(r>0){const h=8-r,d=255>>h<<h;s=s<<r|(c[u]&d)>>h,o+=r}}return this.bitOffset=o,this.byteOffset=u,s}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var it;(function(I){I[I.PAD_ENCODE=0]="PAD_ENCODE",I[I.ASCII_ENCODE=1]="ASCII_ENCODE",I[I.C40_ENCODE=2]="C40_ENCODE",I[I.TEXT_ENCODE=3]="TEXT_ENCODE",I[I.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",I[I.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",I[I.BASE256_ENCODE=6]="BASE256_ENCODE"})(it||(it={}));class Un{static decode(r){const s=new pr(r),o=new L,u=new L,c=new Array;let h=it.ASCII_ENCODE;do if(h===it.ASCII_ENCODE)h=this.decodeAsciiSegment(s,o,u);else{switch(h){case it.C40_ENCODE:this.decodeC40Segment(s,o);break;case it.TEXT_ENCODE:this.decodeTextSegment(s,o);break;case it.ANSIX12_ENCODE:this.decodeAnsiX12Segment(s,o);break;case it.EDIFACT_ENCODE:this.decodeEdifactSegment(s,o);break;case it.BASE256_ENCODE:this.decodeBase256Segment(s,o,c);break;default:throw new N}h=it.ASCII_ENCODE}while(h!==it.PAD_ENCODE&&s.available()>0);return u.length()>0&&o.append(u.toString()),new Mi(r,o.toString(),c.length===0?null:c,null)}static decodeAsciiSegment(r,s,o){let u=!1;do{let c=r.readBits(8);if(c===0)throw new N;if(c<=128)return u&&(c+=128),s.append(String.fromCharCode(c-1)),it.ASCII_ENCODE;if(c===129)return it.PAD_ENCODE;if(c<=229){const h=c-130;h<10&&s.append("0"),s.append(""+h)}else switch(c){case 230:return it.C40_ENCODE;case 231:return it.BASE256_ENCODE;case 232:s.append(String.fromCharCode(29));break;case 233:case 234:break;case 235:u=!0;break;case 236:s.append("[)>05"),o.insert(0,"");break;case 237:s.append("[)>06"),o.insert(0,"");break;case 238:return it.ANSIX12_ENCODE;case 239:return it.TEXT_ENCODE;case 240:return it.EDIFACT_ENCODE;case 241:break;default:if(c!==254||r.available()!==0)throw new N;break}}while(r.available()>0);return it.ASCII_ENCODE}static decodeC40Segment(r,s){let o=!1;const u=[];let c=0;do{if(r.available()===8)return;const h=r.readBits(8);if(h===254)return;this.parseTwoBytes(h,r.readBits(8),u);for(let d=0;d<3;d++){const p=u[d];switch(c){case 0:if(p<3)c=p+1;else if(p<this.C40_BASIC_SET_CHARS.length){const w=this.C40_BASIC_SET_CHARS[p];o?(s.append(String.fromCharCode(w.charCodeAt(0)+128)),o=!1):s.append(w)}else throw new N;break;case 1:o?(s.append(String.fromCharCode(p+128)),o=!1):s.append(String.fromCharCode(p)),c=0;break;case 2:if(p<this.C40_SHIFT2_SET_CHARS.length){const w=this.C40_SHIFT2_SET_CHARS[p];o?(s.append(String.fromCharCode(w.charCodeAt(0)+128)),o=!1):s.append(w)}else switch(p){case 27:s.append(String.fromCharCode(29));break;case 30:o=!0;break;default:throw new N}c=0;break;case 3:o?(s.append(String.fromCharCode(p+224)),o=!1):s.append(String.fromCharCode(p+96)),c=0;break;default:throw new N}}}while(r.available()>0)}static decodeTextSegment(r,s){let o=!1,u=[],c=0;do{if(r.available()===8)return;const h=r.readBits(8);if(h===254)return;this.parseTwoBytes(h,r.readBits(8),u);for(let d=0;d<3;d++){const p=u[d];switch(c){case 0:if(p<3)c=p+1;else if(p<this.TEXT_BASIC_SET_CHARS.length){const w=this.TEXT_BASIC_SET_CHARS[p];o?(s.append(String.fromCharCode(w.charCodeAt(0)+128)),o=!1):s.append(w)}else throw new N;break;case 1:o?(s.append(String.fromCharCode(p+128)),o=!1):s.append(String.fromCharCode(p)),c=0;break;case 2:if(p<this.TEXT_SHIFT2_SET_CHARS.length){const w=this.TEXT_SHIFT2_SET_CHARS[p];o?(s.append(String.fromCharCode(w.charCodeAt(0)+128)),o=!1):s.append(w)}else switch(p){case 27:s.append(String.fromCharCode(29));break;case 30:o=!0;break;default:throw new N}c=0;break;case 3:if(p<this.TEXT_SHIFT3_SET_CHARS.length){const w=this.TEXT_SHIFT3_SET_CHARS[p];o?(s.append(String.fromCharCode(w.charCodeAt(0)+128)),o=!1):s.append(w),c=0}else throw new N;break;default:throw new N}}}while(r.available()>0)}static decodeAnsiX12Segment(r,s){const o=[];do{if(r.available()===8)return;const u=r.readBits(8);if(u===254)return;this.parseTwoBytes(u,r.readBits(8),o);for(let c=0;c<3;c++){const h=o[c];switch(h){case 0:s.append("\r");break;case 1:s.append("*");break;case 2:s.append(">");break;case 3:s.append(" ");break;default:if(h<14)s.append(String.fromCharCode(h+44));else if(h<40)s.append(String.fromCharCode(h+51));else throw new N;break}}}while(r.available()>0)}static parseTwoBytes(r,s,o){let u=(r<<8)+s-1,c=Math.floor(u/1600);o[0]=c,u-=c*1600,c=Math.floor(u/40),o[1]=c,o[2]=u-c*40}static decodeEdifactSegment(r,s){do{if(r.available()<=16)return;for(let o=0;o<4;o++){let u=r.readBits(6);if(u===31){const c=8-r.getBitOffset();c!==8&&r.readBits(c);return}u&32||(u|=64),s.append(String.fromCharCode(u))}}while(r.available()>0)}static decodeBase256Segment(r,s,o){let u=1+r.getByteOffset();const c=this.unrandomize255State(r.readBits(8),u++);let h;if(c===0?h=r.available()/8|0:c<250?h=c:h=250*(c-249)+this.unrandomize255State(r.readBits(8),u++),h<0)throw new N;const d=new Uint8Array(h);for(let p=0;p<h;p++){if(r.available()<8)throw new N;d[p]=this.unrandomize255State(r.readBits(8),u++)}o.push(d);try{s.append(U.decode(d,G.ISO88591))}catch(p){throw new Jn("Platform does not support required encoding: "+p.message)}}static unrandomize255State(r,s){const o=149*s%255+1,u=r-o;return u>=0?u:u+256}}Un.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Un.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Un.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Un.TEXT_SHIFT2_SET_CHARS=Un.C40_SHIFT2_SET_CHARS,Un.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",String.fromCharCode(127)];class Os{constructor(){this.rsDecoder=new Ns(je.DATA_MATRIX_FIELD_256)}decode(r){const s=new lo(r),o=s.getVersion(),u=s.readCodewords(),c=ya.getDataBlocks(u,o);let h=0;for(let w of c)h+=w.getNumDataCodewords();const d=new Uint8Array(h),p=c.length;for(let w=0;w<p;w++){const _=c[w],T=_.getCodewords(),S=_.getNumDataCodewords();this.correctErrors(T,S);for(let M=0;M<S;M++)d[M*p+w]=T[M]}return Un.decode(d)}correctErrors(r,s){const o=new Int32Array(r);try{this.rsDecoder.decode(o,r.length-s)}catch{throw new V}for(let u=0;u<s;u++)r[u]=o[u]}}class xt{constructor(r){this.image=r,this.rectangleDetector=new hr(this.image)}detect(){const r=this.rectangleDetector.detect();let s=this.detectSolid1(r);if(s=this.detectSolid2(s),s[3]=this.correctTopRight(s),!s[3])throw new ee;s=this.shiftToModuleCenter(s);const o=s[0],u=s[1],c=s[2],h=s[3];let d=this.transitionsBetween(o,h)+1,p=this.transitionsBetween(c,h)+1;(d&1)===1&&(d+=1),(p&1)===1&&(p+=1),4*d<7*p&&4*p<7*d&&(d=p=Math.max(d,p));let w=xt.sampleGrid(this.image,o,u,c,h,d,p);return new fi(w,[o,u,c,h])}static shiftPoint(r,s,o){let u=(s.getX()-r.getX())/(o+1),c=(s.getY()-r.getY())/(o+1);return new de(r.getX()+u,r.getY()+c)}static moveAway(r,s,o){let u=r.getX(),c=r.getY();return u<s?u-=1:u+=1,c<o?c-=1:c+=1,new de(u,c)}detectSolid1(r){let s=r[0],o=r[1],u=r[3],c=r[2],h=this.transitionsBetween(s,o),d=this.transitionsBetween(o,u),p=this.transitionsBetween(u,c),w=this.transitionsBetween(c,s),_=h,T=[c,s,o,u];return _>d&&(_=d,T[0]=s,T[1]=o,T[2]=u,T[3]=c),_>p&&(_=p,T[0]=o,T[1]=u,T[2]=c,T[3]=s),_>w&&(T[0]=u,T[1]=c,T[2]=s,T[3]=o),T}detectSolid2(r){let s=r[0],o=r[1],u=r[2],c=r[3],h=this.transitionsBetween(s,c),d=xt.shiftPoint(o,u,(h+1)*4),p=xt.shiftPoint(u,o,(h+1)*4),w=this.transitionsBetween(d,s),_=this.transitionsBetween(p,c);return w<_?(r[0]=s,r[1]=o,r[2]=u,r[3]=c):(r[0]=o,r[1]=u,r[2]=c,r[3]=s),r}correctTopRight(r){let s=r[0],o=r[1],u=r[2],c=r[3],h=this.transitionsBetween(s,c),d=this.transitionsBetween(o,c),p=xt.shiftPoint(s,o,(d+1)*4),w=xt.shiftPoint(u,o,(h+1)*4);h=this.transitionsBetween(p,c),d=this.transitionsBetween(w,c);let _=new de(c.getX()+(u.getX()-o.getX())/(h+1),c.getY()+(u.getY()-o.getY())/(h+1)),T=new de(c.getX()+(s.getX()-o.getX())/(d+1),c.getY()+(s.getY()-o.getY())/(d+1));if(!this.isValid(_))return this.isValid(T)?T:null;if(!this.isValid(T))return _;let S=this.transitionsBetween(p,_)+this.transitionsBetween(w,_),M=this.transitionsBetween(p,T)+this.transitionsBetween(w,T);return S>M?_:T}shiftToModuleCenter(r){let s=r[0],o=r[1],u=r[2],c=r[3],h=this.transitionsBetween(s,c)+1,d=this.transitionsBetween(u,c)+1,p=xt.shiftPoint(s,o,d*4),w=xt.shiftPoint(u,o,h*4);h=this.transitionsBetween(p,c)+1,d=this.transitionsBetween(w,c)+1,(h&1)===1&&(h+=1),(d&1)===1&&(d+=1);let _=(s.getX()+o.getX()+u.getX()+c.getX())/4,T=(s.getY()+o.getY()+u.getY()+c.getY())/4;s=xt.moveAway(s,_,T),o=xt.moveAway(o,_,T),u=xt.moveAway(u,_,T),c=xt.moveAway(c,_,T);let S,M;return p=xt.shiftPoint(s,o,d*4),p=xt.shiftPoint(p,c,h*4),S=xt.shiftPoint(o,s,d*4),S=xt.shiftPoint(S,u,h*4),w=xt.shiftPoint(u,c,d*4),w=xt.shiftPoint(w,o,h*4),M=xt.shiftPoint(c,u,d*4),M=xt.shiftPoint(M,s,h*4),[p,S,w,M]}isValid(r){return r.getX()>=0&&r.getX()<this.image.getWidth()&&r.getY()>0&&r.getY()<this.image.getHeight()}static sampleGrid(r,s,o,u,c,h,d){return br.getInstance().sampleGrid(r,h,d,.5,.5,h-.5,.5,h-.5,d-.5,.5,d-.5,s.getX(),s.getY(),c.getX(),c.getY(),u.getX(),u.getY(),o.getX(),o.getY())}transitionsBetween(r,s){let o=Math.trunc(r.getX()),u=Math.trunc(r.getY()),c=Math.trunc(s.getX()),h=Math.trunc(s.getY()),d=Math.abs(h-u)>Math.abs(c-o);if(d){let W=o;o=u,u=W,W=c,c=h,h=W}let p=Math.abs(c-o),w=Math.abs(h-u),_=-p/2,T=u<h?1:-1,S=o<c?1:-1,M=0,z=this.image.get(d?u:o,d?o:u);for(let W=o,q=u;W!==c;W+=S){let J=this.image.get(d?q:W,d?W:q);if(J!==z&&(M++,z=J),_+=w,_>0){if(q===h)break;q+=T,_-=p}}return M}}class Ke{constructor(){this.decoder=new Os}decode(r,s=null){let o,u;if(s!=null&&s.has(se.PURE_BARCODE)){const w=Ke.extractPureBits(r.getBlackMatrix());o=this.decoder.decode(w),u=Ke.NO_POINTS}else{const w=new xt(r.getBlackMatrix()).detect();o=this.decoder.decode(w.getBits()),u=w.getPoints()}const c=o.getRawBytes(),h=new ut(o.getText(),c,8*c.length,u,Ee.DATA_MATRIX,X.currentTimeMillis()),d=o.getByteSegments();d!=null&&h.putMetadata(kt.BYTE_SEGMENTS,d);const p=o.getECLevel();return p!=null&&h.putMetadata(kt.ERROR_CORRECTION_LEVEL,p),h}reset(){}static extractPureBits(r){const s=r.getTopLeftOnBit(),o=r.getBottomRightOnBit();if(s==null||o==null)throw new ee;const u=this.moduleSize(s,r);let c=s[1];const h=o[1];let d=s[0];const w=(o[0]-d+1)/u,_=(h-c+1)/u;if(w<=0||_<=0)throw new ee;const T=u/2;c+=T,d+=T;const S=new ze(w,_);for(let M=0;M<_;M++){const z=c+M*u;for(let W=0;W<w;W++)r.get(d+W*u,z)&&S.set(W,M)}return S}static moduleSize(r,s){const o=s.getWidth();let u=r[0];const c=r[1];for(;u<o&&s.get(u,c);)u++;if(u===o)throw new ee;const h=u-r[0];if(h===0)throw new ee;return h}}Ke.NO_POINTS=[];class uo extends On{constructor(r=500){super(new Ke,r)}}var mr;(function(I){I[I.L=0]="L",I[I.M=1]="M",I[I.Q=2]="Q",I[I.H=3]="H"})(mr||(mr={}));class Je{constructor(r,s,o){this.value=r,this.stringValue=s,this.bits=o,Je.FOR_BITS.set(o,this),Je.FOR_VALUE.set(r,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(r){switch(r){case"L":return Je.L;case"M":return Je.M;case"Q":return Je.Q;case"H":return Je.H;default:throw new C(r+"not available")}}toString(){return this.stringValue}equals(r){if(!(r instanceof Je))return!1;const s=r;return this.value===s.value}static forBits(r){if(r<0||r>=Je.FOR_BITS.size)throw new v;return Je.FOR_BITS.get(r)}}Je.FOR_BITS=new Map,Je.FOR_VALUE=new Map,Je.L=new Je(mr.L,"L",1),Je.M=new Je(mr.M,"M",0),Je.Q=new Je(mr.Q,"Q",3),Je.H=new Je(mr.H,"H",2);class on{constructor(r){this.errorCorrectionLevel=Je.forBits(r>>3&3),this.dataMask=r&7}static numBitsDiffering(r,s){return B.bitCount(r^s)}static decodeFormatInformation(r,s){const o=on.doDecodeFormatInformation(r,s);return o!==null?o:on.doDecodeFormatInformation(r^on.FORMAT_INFO_MASK_QR,s^on.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(r,s){let o=Number.MAX_SAFE_INTEGER,u=0;for(const c of on.FORMAT_INFO_DECODE_LOOKUP){const h=c[0];if(h===r||h===s)return new on(c[1]);let d=on.numBitsDiffering(r,h);d<o&&(u=c[1],o=d),r!==s&&(d=on.numBitsDiffering(s,h),d<o&&(u=c[1],o=d))}return o<=3?new on(u):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(r){if(!(r instanceof on))return!1;const s=r;return this.errorCorrectionLevel===s.errorCorrectionLevel&&this.dataMask===s.dataMask}}on.FORMAT_INFO_MASK_QR=21522,on.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class K{constructor(r,...s){this.ecCodewordsPerBlock=r,this.ecBlocks=s}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let r=0;const s=this.ecBlocks;for(const o of s)r+=o.getCount();return r}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class P{constructor(r,s){this.count=r,this.dataCodewords=s}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class _e{constructor(r,s,...o){this.versionNumber=r,this.alignmentPatternCenters=s,this.ecBlocks=o;let u=0;const c=o[0].getECCodewordsPerBlock(),h=o[0].getECBlocks();for(const d of h)u+=d.getCount()*(d.getDataCodewords()+c);this.totalCodewords=u}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(r){return this.ecBlocks[r.getValue()]}static getProvisionalVersionForDimension(r){if(r%4!==1)throw new N;try{return this.getVersionForNumber((r-17)/4)}catch{throw new N}}static getVersionForNumber(r){if(r<1||r>40)throw new v;return _e.VERSIONS[r-1]}static decodeVersionInformation(r){let s=Number.MAX_SAFE_INTEGER,o=0;for(let u=0;u<_e.VERSION_DECODE_INFO.length;u++){const c=_e.VERSION_DECODE_INFO[u];if(c===r)return _e.getVersionForNumber(u+7);const h=on.numBitsDiffering(r,c);h<s&&(o=u+7,s=h)}return s<=3?_e.getVersionForNumber(o):null}buildFunctionPattern(){const r=this.getDimensionForVersion(),s=new ze(r);s.setRegion(0,0,9,9),s.setRegion(r-8,0,8,9),s.setRegion(0,r-8,9,8);const o=this.alignmentPatternCenters.length;for(let u=0;u<o;u++){const c=this.alignmentPatternCenters[u]-2;for(let h=0;h<o;h++)u===0&&(h===0||h===o-1)||u===o-1&&h===0||s.setRegion(this.alignmentPatternCenters[h]-2,c,5,5)}return s.setRegion(6,9,1,r-17),s.setRegion(9,6,r-17,1),this.versionNumber>6&&(s.setRegion(r-11,0,3,6),s.setRegion(0,r-11,6,3)),s}toString(){return""+this.versionNumber}}_e.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),_e.VERSIONS=[new _e(1,new Int32Array(0),new K(7,new P(1,19)),new K(10,new P(1,16)),new K(13,new P(1,13)),new K(17,new P(1,9))),new _e(2,Int32Array.from([6,18]),new K(10,new P(1,34)),new K(16,new P(1,28)),new K(22,new P(1,22)),new K(28,new P(1,16))),new _e(3,Int32Array.from([6,22]),new K(15,new P(1,55)),new K(26,new P(1,44)),new K(18,new P(2,17)),new K(22,new P(2,13))),new _e(4,Int32Array.from([6,26]),new K(20,new P(1,80)),new K(18,new P(2,32)),new K(26,new P(2,24)),new K(16,new P(4,9))),new _e(5,Int32Array.from([6,30]),new K(26,new P(1,108)),new K(24,new P(2,43)),new K(18,new P(2,15),new P(2,16)),new K(22,new P(2,11),new P(2,12))),new _e(6,Int32Array.from([6,34]),new K(18,new P(2,68)),new K(16,new P(4,27)),new K(24,new P(4,19)),new K(28,new P(4,15))),new _e(7,Int32Array.from([6,22,38]),new K(20,new P(2,78)),new K(18,new P(4,31)),new K(18,new P(2,14),new P(4,15)),new K(26,new P(4,13),new P(1,14))),new _e(8,Int32Array.from([6,24,42]),new K(24,new P(2,97)),new K(22,new P(2,38),new P(2,39)),new K(22,new P(4,18),new P(2,19)),new K(26,new P(4,14),new P(2,15))),new _e(9,Int32Array.from([6,26,46]),new K(30,new P(2,116)),new K(22,new P(3,36),new P(2,37)),new K(20,new P(4,16),new P(4,17)),new K(24,new P(4,12),new P(4,13))),new _e(10,Int32Array.from([6,28,50]),new K(18,new P(2,68),new P(2,69)),new K(26,new P(4,43),new P(1,44)),new K(24,new P(6,19),new P(2,20)),new K(28,new P(6,15),new P(2,16))),new _e(11,Int32Array.from([6,30,54]),new K(20,new P(4,81)),new K(30,new P(1,50),new P(4,51)),new K(28,new P(4,22),new P(4,23)),new K(24,new P(3,12),new P(8,13))),new _e(12,Int32Array.from([6,32,58]),new K(24,new P(2,92),new P(2,93)),new K(22,new P(6,36),new P(2,37)),new K(26,new P(4,20),new P(6,21)),new K(28,new P(7,14),new P(4,15))),new _e(13,Int32Array.from([6,34,62]),new K(26,new P(4,107)),new K(22,new P(8,37),new P(1,38)),new K(24,new P(8,20),new P(4,21)),new K(22,new P(12,11),new P(4,12))),new _e(14,Int32Array.from([6,26,46,66]),new K(30,new P(3,115),new P(1,116)),new K(24,new P(4,40),new P(5,41)),new K(20,new P(11,16),new P(5,17)),new K(24,new P(11,12),new P(5,13))),new _e(15,Int32Array.from([6,26,48,70]),new K(22,new P(5,87),new P(1,88)),new K(24,new P(5,41),new P(5,42)),new K(30,new P(5,24),new P(7,25)),new K(24,new P(11,12),new P(7,13))),new _e(16,Int32Array.from([6,26,50,74]),new K(24,new P(5,98),new P(1,99)),new K(28,new P(7,45),new P(3,46)),new K(24,new P(15,19),new P(2,20)),new K(30,new P(3,15),new P(13,16))),new _e(17,Int32Array.from([6,30,54,78]),new K(28,new P(1,107),new P(5,108)),new K(28,new P(10,46),new P(1,47)),new K(28,new P(1,22),new P(15,23)),new K(28,new P(2,14),new P(17,15))),new _e(18,Int32Array.from([6,30,56,82]),new K(30,new P(5,120),new P(1,121)),new K(26,new P(9,43),new P(4,44)),new K(28,new P(17,22),new P(1,23)),new K(28,new P(2,14),new P(19,15))),new _e(19,Int32Array.from([6,30,58,86]),new K(28,new P(3,113),new P(4,114)),new K(26,new P(3,44),new P(11,45)),new K(26,new P(17,21),new P(4,22)),new K(26,new P(9,13),new P(16,14))),new _e(20,Int32Array.from([6,34,62,90]),new K(28,new P(3,107),new P(5,108)),new K(26,new P(3,41),new P(13,42)),new K(30,new P(15,24),new P(5,25)),new K(28,new P(15,15),new P(10,16))),new _e(21,Int32Array.from([6,28,50,72,94]),new K(28,new P(4,116),new P(4,117)),new K(26,new P(17,42)),new K(28,new P(17,22),new P(6,23)),new K(30,new P(19,16),new P(6,17))),new _e(22,Int32Array.from([6,26,50,74,98]),new K(28,new P(2,111),new P(7,112)),new K(28,new P(17,46)),new K(30,new P(7,24),new P(16,25)),new K(24,new P(34,13))),new _e(23,Int32Array.from([6,30,54,78,102]),new K(30,new P(4,121),new P(5,122)),new K(28,new P(4,47),new P(14,48)),new K(30,new P(11,24),new P(14,25)),new K(30,new P(16,15),new P(14,16))),new _e(24,Int32Array.from([6,28,54,80,106]),new K(30,new P(6,117),new P(4,118)),new K(28,new P(6,45),new P(14,46)),new K(30,new P(11,24),new P(16,25)),new K(30,new P(30,16),new P(2,17))),new _e(25,Int32Array.from([6,32,58,84,110]),new K(26,new P(8,106),new P(4,107)),new K(28,new P(8,47),new P(13,48)),new K(30,new P(7,24),new P(22,25)),new K(30,new P(22,15),new P(13,16))),new _e(26,Int32Array.from([6,30,58,86,114]),new K(28,new P(10,114),new P(2,115)),new K(28,new P(19,46),new P(4,47)),new K(28,new P(28,22),new P(6,23)),new K(30,new P(33,16),new P(4,17))),new _e(27,Int32Array.from([6,34,62,90,118]),new K(30,new P(8,122),new P(4,123)),new K(28,new P(22,45),new P(3,46)),new K(30,new P(8,23),new P(26,24)),new K(30,new P(12,15),new P(28,16))),new _e(28,Int32Array.from([6,26,50,74,98,122]),new K(30,new P(3,117),new P(10,118)),new K(28,new P(3,45),new P(23,46)),new K(30,new P(4,24),new P(31,25)),new K(30,new P(11,15),new P(31,16))),new _e(29,Int32Array.from([6,30,54,78,102,126]),new K(30,new P(7,116),new P(7,117)),new K(28,new P(21,45),new P(7,46)),new K(30,new P(1,23),new P(37,24)),new K(30,new P(19,15),new P(26,16))),new _e(30,Int32Array.from([6,26,52,78,104,130]),new K(30,new P(5,115),new P(10,116)),new K(28,new P(19,47),new P(10,48)),new K(30,new P(15,24),new P(25,25)),new K(30,new P(23,15),new P(25,16))),new _e(31,Int32Array.from([6,30,56,82,108,134]),new K(30,new P(13,115),new P(3,116)),new K(28,new P(2,46),new P(29,47)),new K(30,new P(42,24),new P(1,25)),new K(30,new P(23,15),new P(28,16))),new _e(32,Int32Array.from([6,34,60,86,112,138]),new K(30,new P(17,115)),new K(28,new P(10,46),new P(23,47)),new K(30,new P(10,24),new P(35,25)),new K(30,new P(19,15),new P(35,16))),new _e(33,Int32Array.from([6,30,58,86,114,142]),new K(30,new P(17,115),new P(1,116)),new K(28,new P(14,46),new P(21,47)),new K(30,new P(29,24),new P(19,25)),new K(30,new P(11,15),new P(46,16))),new _e(34,Int32Array.from([6,34,62,90,118,146]),new K(30,new P(13,115),new P(6,116)),new K(28,new P(14,46),new P(23,47)),new K(30,new P(44,24),new P(7,25)),new K(30,new P(59,16),new P(1,17))),new _e(35,Int32Array.from([6,30,54,78,102,126,150]),new K(30,new P(12,121),new P(7,122)),new K(28,new P(12,47),new P(26,48)),new K(30,new P(39,24),new P(14,25)),new K(30,new P(22,15),new P(41,16))),new _e(36,Int32Array.from([6,24,50,76,102,128,154]),new K(30,new P(6,121),new P(14,122)),new K(28,new P(6,47),new P(34,48)),new K(30,new P(46,24),new P(10,25)),new K(30,new P(2,15),new P(64,16))),new _e(37,Int32Array.from([6,28,54,80,106,132,158]),new K(30,new P(17,122),new P(4,123)),new K(28,new P(29,46),new P(14,47)),new K(30,new P(49,24),new P(10,25)),new K(30,new P(24,15),new P(46,16))),new _e(38,Int32Array.from([6,32,58,84,110,136,162]),new K(30,new P(4,122),new P(18,123)),new K(28,new P(13,46),new P(32,47)),new K(30,new P(48,24),new P(14,25)),new K(30,new P(42,15),new P(32,16))),new _e(39,Int32Array.from([6,26,54,82,110,138,166]),new K(30,new P(20,117),new P(4,118)),new K(28,new P(40,47),new P(7,48)),new K(30,new P(43,24),new P(22,25)),new K(30,new P(10,15),new P(67,16))),new _e(40,Int32Array.from([6,30,58,86,114,142,170]),new K(30,new P(19,118),new P(6,119)),new K(28,new P(18,47),new P(31,48)),new K(30,new P(34,24),new P(34,25)),new K(30,new P(20,15),new P(61,16)))];var jt;(function(I){I[I.DATA_MASK_000=0]="DATA_MASK_000",I[I.DATA_MASK_001=1]="DATA_MASK_001",I[I.DATA_MASK_010=2]="DATA_MASK_010",I[I.DATA_MASK_011=3]="DATA_MASK_011",I[I.DATA_MASK_100=4]="DATA_MASK_100",I[I.DATA_MASK_101=5]="DATA_MASK_101",I[I.DATA_MASK_110=6]="DATA_MASK_110",I[I.DATA_MASK_111=7]="DATA_MASK_111"})(jt||(jt={}));class zn{constructor(r,s){this.value=r,this.isMasked=s}unmaskBitMatrix(r,s){for(let o=0;o<s;o++)for(let u=0;u<s;u++)this.isMasked(o,u)&&r.flip(u,o)}}zn.values=new Map([[jt.DATA_MASK_000,new zn(jt.DATA_MASK_000,(I,r)=>(I+r&1)===0)],[jt.DATA_MASK_001,new zn(jt.DATA_MASK_001,(I,r)=>(I&1)===0)],[jt.DATA_MASK_010,new zn(jt.DATA_MASK_010,(I,r)=>r%3===0)],[jt.DATA_MASK_011,new zn(jt.DATA_MASK_011,(I,r)=>(I+r)%3===0)],[jt.DATA_MASK_100,new zn(jt.DATA_MASK_100,(I,r)=>(Math.floor(I/2)+Math.floor(r/3)&1)===0)],[jt.DATA_MASK_101,new zn(jt.DATA_MASK_101,(I,r)=>I*r%6===0)],[jt.DATA_MASK_110,new zn(jt.DATA_MASK_110,(I,r)=>I*r%6<3)],[jt.DATA_MASK_111,new zn(jt.DATA_MASK_111,(I,r)=>(I+r+I*r%3&1)===0)]]);class Ps{constructor(r){const s=r.getHeight();if(s<21||(s&3)!==1)throw new N;this.bitMatrix=r}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let r=0;for(let c=0;c<6;c++)r=this.copyBit(c,8,r);r=this.copyBit(7,8,r),r=this.copyBit(8,8,r),r=this.copyBit(8,7,r);for(let c=5;c>=0;c--)r=this.copyBit(8,c,r);const s=this.bitMatrix.getHeight();let o=0;const u=s-7;for(let c=s-1;c>=u;c--)o=this.copyBit(8,c,o);for(let c=s-8;c<s;c++)o=this.copyBit(c,8,o);if(this.parsedFormatInfo=on.decodeFormatInformation(r,o),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new N}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const r=this.bitMatrix.getHeight(),s=Math.floor((r-17)/4);if(s<=6)return _e.getVersionForNumber(s);let o=0;const u=r-11;for(let h=5;h>=0;h--)for(let d=r-9;d>=u;d--)o=this.copyBit(d,h,o);let c=_e.decodeVersionInformation(o);if(c!==null&&c.getDimensionForVersion()===r)return this.parsedVersion=c,c;o=0;for(let h=5;h>=0;h--)for(let d=r-9;d>=u;d--)o=this.copyBit(h,d,o);if(c=_e.decodeVersionInformation(o),c!==null&&c.getDimensionForVersion()===r)return this.parsedVersion=c,c;throw new N}copyBit(r,s,o){return(this.isMirror?this.bitMatrix.get(s,r):this.bitMatrix.get(r,s))?o<<1|1:o<<1}readCodewords(){const r=this.readFormatInformation(),s=this.readVersion(),o=zn.values.get(r.getDataMask()),u=this.bitMatrix.getHeight();o.unmaskBitMatrix(this.bitMatrix,u);const c=s.buildFunctionPattern();let h=!0;const d=new Uint8Array(s.getTotalCodewords());let p=0,w=0,_=0;for(let T=u-1;T>0;T-=2){T===6&&T--;for(let S=0;S<u;S++){const M=h?u-1-S:S;for(let z=0;z<2;z++)c.get(T-z,M)||(_++,w<<=1,this.bitMatrix.get(T-z,M)&&(w|=1),_===8&&(d[p++]=w,_=0,w=0))}h=!h}if(p!==s.getTotalCodewords())throw new N;return d}remask(){if(this.parsedFormatInfo===null)return;const r=zn.values[this.parsedFormatInfo.getDataMask()],s=this.bitMatrix.getHeight();r.unmaskBitMatrix(this.bitMatrix,s)}setMirror(r){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=r}mirror(){const r=this.bitMatrix;for(let s=0,o=r.getWidth();s<o;s++)for(let u=s+1,c=r.getHeight();u<c;u++)r.get(s,u)!==r.get(u,s)&&(r.flip(u,s),r.flip(s,u))}}class Pr{constructor(r,s){this.numDataCodewords=r,this.codewords=s}static getDataBlocks(r,s,o){if(r.length!==s.getTotalCodewords())throw new v;const u=s.getECBlocksForLevel(o);let c=0;const h=u.getECBlocks();for(const z of h)c+=z.getCount();const d=new Array(c);let p=0;for(const z of h)for(let W=0;W<z.getCount();W++){const q=z.getDataCodewords(),J=u.getECCodewordsPerBlock()+q;d[p++]=new Pr(q,new Uint8Array(J))}const w=d[0].codewords.length;let _=d.length-1;for(;_>=0&&d[_].codewords.length!==w;)_--;_++;const T=w-u.getECCodewordsPerBlock();let S=0;for(let z=0;z<T;z++)for(let W=0;W<p;W++)d[W].codewords[z]=r[S++];for(let z=_;z<p;z++)d[z].codewords[T]=r[S++];const M=d[0].codewords.length;for(let z=T;z<M;z++)for(let W=0;W<p;W++){const q=W<_?z:z+1;d[W].codewords[q]=r[S++]}return d}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var kn;(function(I){I[I.TERMINATOR=0]="TERMINATOR",I[I.NUMERIC=1]="NUMERIC",I[I.ALPHANUMERIC=2]="ALPHANUMERIC",I[I.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",I[I.BYTE=4]="BYTE",I[I.ECI=5]="ECI",I[I.KANJI=6]="KANJI",I[I.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",I[I.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",I[I.HANZI=9]="HANZI"})(kn||(kn={}));class Ce{constructor(r,s,o,u){this.value=r,this.stringValue=s,this.characterCountBitsForVersions=o,this.bits=u,Ce.FOR_BITS.set(u,this),Ce.FOR_VALUE.set(r,this)}static forBits(r){const s=Ce.FOR_BITS.get(r);if(s===void 0)throw new v;return s}getCharacterCountBits(r){const s=r.getVersionNumber();let o;return s<=9?o=0:s<=26?o=1:o=2,this.characterCountBitsForVersions[o]}getValue(){return this.value}getBits(){return this.bits}equals(r){if(!(r instanceof Ce))return!1;const s=r;return this.value===s.value}toString(){return this.stringValue}}Ce.FOR_BITS=new Map,Ce.FOR_VALUE=new Map,Ce.TERMINATOR=new Ce(kn.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),Ce.NUMERIC=new Ce(kn.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),Ce.ALPHANUMERIC=new Ce(kn.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),Ce.STRUCTURED_APPEND=new Ce(kn.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),Ce.BYTE=new Ce(kn.BYTE,"BYTE",Int32Array.from([8,16,16]),4),Ce.ECI=new Ce(kn.ECI,"ECI",Int32Array.from([0,0,0]),7),Ce.KANJI=new Ce(kn.KANJI,"KANJI",Int32Array.from([8,10,12]),8),Ce.FNC1_FIRST_POSITION=new Ce(kn.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),Ce.FNC1_SECOND_POSITION=new Ce(kn.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),Ce.HANZI=new Ce(kn.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class mt{static decode(r,s,o,u){const c=new pr(r);let h=new L;const d=new Array;let p=-1,w=-1;try{let _=null,T=!1,S;do{if(c.available()<4)S=Ce.TERMINATOR;else{const M=c.readBits(4);S=Ce.forBits(M)}switch(S){case Ce.TERMINATOR:break;case Ce.FNC1_FIRST_POSITION:case Ce.FNC1_SECOND_POSITION:T=!0;break;case Ce.STRUCTURED_APPEND:if(c.available()<16)throw new N;p=c.readBits(8),w=c.readBits(8);break;case Ce.ECI:const M=mt.parseECIValue(c);if(_=b.getCharacterSetECIByValue(M),_===null)throw new N;break;case Ce.HANZI:const z=c.readBits(4),W=c.readBits(S.getCharacterCountBits(s));z===mt.GB2312_SUBSET&&mt.decodeHanziSegment(c,h,W);break;default:const q=c.readBits(S.getCharacterCountBits(s));switch(S){case Ce.NUMERIC:mt.decodeNumericSegment(c,h,q);break;case Ce.ALPHANUMERIC:mt.decodeAlphanumericSegment(c,h,q,T);break;case Ce.BYTE:mt.decodeByteSegment(c,h,q,_,d,u);break;case Ce.KANJI:mt.decodeKanjiSegment(c,h,q);break;default:throw new N}break}}while(S!==Ce.TERMINATOR)}catch{throw new N}return new Mi(r,h.toString(),d.length===0?null:d,o===null?null:o.toString(),p,w)}static decodeHanziSegment(r,s,o){if(o*13>r.available())throw new N;const u=new Uint8Array(2*o);let c=0;for(;o>0;){const h=r.readBits(13);let d=h/96<<8&4294967295|h%96;d<959?d+=41377:d+=42657,u[c]=d>>8&255,u[c+1]=d&255,c+=2,o--}try{s.append(U.decode(u,G.GB2312))}catch(h){throw new N(h)}}static decodeKanjiSegment(r,s,o){if(o*13>r.available())throw new N;const u=new Uint8Array(2*o);let c=0;for(;o>0;){const h=r.readBits(13);let d=h/192<<8&4294967295|h%192;d<7936?d+=33088:d+=49472,u[c]=d>>8,u[c+1]=d,c+=2,o--}try{s.append(U.decode(u,G.SHIFT_JIS))}catch(h){throw new N(h)}}static decodeByteSegment(r,s,o,u,c,h){if(8*o>r.available())throw new N;const d=new Uint8Array(o);for(let w=0;w<o;w++)d[w]=r.readBits(8);let p;u===null?p=G.guessEncoding(d,h):p=u.getName();try{s.append(U.decode(d,p))}catch(w){throw new N(w)}c.push(d)}static toAlphaNumericChar(r){if(r>=mt.ALPHANUMERIC_CHARS.length)throw new N;return mt.ALPHANUMERIC_CHARS[r]}static decodeAlphanumericSegment(r,s,o,u){const c=s.length();for(;o>1;){if(r.available()<11)throw new N;const h=r.readBits(11);s.append(mt.toAlphaNumericChar(Math.floor(h/45))),s.append(mt.toAlphaNumericChar(h%45)),o-=2}if(o===1){if(r.available()<6)throw new N;s.append(mt.toAlphaNumericChar(r.readBits(6)))}if(u)for(let h=c;h<s.length();h++)s.charAt(h)==="%"&&(h<s.length()-1&&s.charAt(h+1)==="%"?s.deleteCharAt(h+1):s.setCharAt(h,String.fromCharCode(29)))}static decodeNumericSegment(r,s,o){for(;o>=3;){if(r.available()<10)throw new N;const u=r.readBits(10);if(u>=1e3)throw new N;s.append(mt.toAlphaNumericChar(Math.floor(u/100))),s.append(mt.toAlphaNumericChar(Math.floor(u/10)%10)),s.append(mt.toAlphaNumericChar(u%10)),o-=3}if(o===2){if(r.available()<7)throw new N;const u=r.readBits(7);if(u>=100)throw new N;s.append(mt.toAlphaNumericChar(Math.floor(u/10))),s.append(mt.toAlphaNumericChar(u%10))}else if(o===1){if(r.available()<4)throw new N;const u=r.readBits(4);if(u>=10)throw new N;s.append(mt.toAlphaNumericChar(u))}}static parseECIValue(r){const s=r.readBits(8);if(!(s&128))return s&127;if((s&192)===128){const o=r.readBits(8);return(s&63)<<8&4294967295|o}if((s&224)===192){const o=r.readBits(16);return(s&31)<<16&4294967295|o}throw new N}}mt.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",mt.GB2312_SUBSET=1;class wa{constructor(r){this.mirrored=r}isMirrored(){return this.mirrored}applyMirroredCorrection(r){if(!this.mirrored||r===null||r.length<3)return;const s=r[0];r[0]=r[2],r[2]=s}}class jl{constructor(){this.rsDecoder=new Ns(je.QR_CODE_FIELD_256)}decodeBooleanArray(r,s){return this.decodeBitMatrix(ze.parseFromBooleanArray(r),s)}decodeBitMatrix(r,s){const o=new Ps(r);let u=null;try{return this.decodeBitMatrixParser(o,s)}catch(c){u=c}try{o.remask(),o.setMirror(!0),o.readVersion(),o.readFormatInformation(),o.mirror();const c=this.decodeBitMatrixParser(o,s);return c.setOther(new wa(!0)),c}catch(c){throw u!==null?u:c}}decodeBitMatrixParser(r,s){const o=r.readVersion(),u=r.readFormatInformation().getErrorCorrectionLevel(),c=r.readCodewords(),h=Pr.getDataBlocks(c,o,u);let d=0;for(const _ of h)d+=_.getNumDataCodewords();const p=new Uint8Array(d);let w=0;for(const _ of h){const T=_.getCodewords(),S=_.getNumDataCodewords();this.correctErrors(T,S);for(let M=0;M<S;M++)p[w++]=T[M]}return mt.decode(p,o,u,s)}correctErrors(r,s){const o=new Int32Array(r);try{this.rsDecoder.decode(o,r.length-s)}catch{throw new V}for(let u=0;u<s;u++)r[u]=o[u]}}class qr extends de{constructor(r,s,o){super(r,s),this.estimatedModuleSize=o}aboutEquals(r,s,o){if(Math.abs(s-this.getY())<=r&&Math.abs(o-this.getX())<=r){const u=Math.abs(r-this.estimatedModuleSize);return u<=1||u<=this.estimatedModuleSize}return!1}combineEstimate(r,s,o){const u=(this.getX()+s)/2,c=(this.getY()+r)/2,h=(this.estimatedModuleSize+o)/2;return new qr(u,c,h)}}class co{constructor(r,s,o,u,c,h,d){this.image=r,this.startX=s,this.startY=o,this.width=u,this.height=c,this.moduleSize=h,this.resultPointCallback=d,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const r=this.startX,s=this.height,o=this.width,u=r+o,c=this.startY+s/2,h=new Int32Array(3),d=this.image;for(let p=0;p<s;p++){const w=c+(p&1?-Math.floor((p+1)/2):Math.floor((p+1)/2));h[0]=0,h[1]=0,h[2]=0;let _=r;for(;_<u&&!d.get(_,w);)_++;let T=0;for(;_<u;){if(d.get(_,w))if(T===1)h[1]++;else if(T===2){if(this.foundPatternCross(h)){const S=this.handlePossibleCenter(h,w,_);if(S!==null)return S}h[0]=h[2],h[1]=1,h[2]=0,T=1}else h[++T]++;else T===1&&T++,h[T]++;_++}if(this.foundPatternCross(h)){const S=this.handlePossibleCenter(h,w,u);if(S!==null)return S}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new ee}static centerFromEnd(r,s){return s-r[2]-r[1]/2}foundPatternCross(r){const s=this.moduleSize,o=s/2;for(let u=0;u<3;u++)if(Math.abs(s-r[u])>=o)return!1;return!0}crossCheckVertical(r,s,o,u){const c=this.image,h=c.getHeight(),d=this.crossCheckStateCount;d[0]=0,d[1]=0,d[2]=0;let p=r;for(;p>=0&&c.get(s,p)&&d[1]<=o;)d[1]++,p--;if(p<0||d[1]>o)return NaN;for(;p>=0&&!c.get(s,p)&&d[0]<=o;)d[0]++,p--;if(d[0]>o)return NaN;for(p=r+1;p<h&&c.get(s,p)&&d[1]<=o;)d[1]++,p++;if(p===h||d[1]>o)return NaN;for(;p<h&&!c.get(s,p)&&d[2]<=o;)d[2]++,p++;if(d[2]>o)return NaN;const w=d[0]+d[1]+d[2];return 5*Math.abs(w-u)>=2*u?NaN:this.foundPatternCross(d)?co.centerFromEnd(d,p):NaN}handlePossibleCenter(r,s,o){const u=r[0]+r[1]+r[2],c=co.centerFromEnd(r,o),h=this.crossCheckVertical(s,c,2*r[1],u);if(!isNaN(h)){const d=(r[0]+r[1]+r[2])/3;for(const w of this.possibleCenters)if(w.aboutEquals(d,h,c))return w.combineEstimate(h,c,d);const p=new qr(c,h,d);this.possibleCenters.push(p),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(p)}return null}}class xa extends de{constructor(r,s,o,u){super(r,s),this.estimatedModuleSize=o,this.count=u,u===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(r,s,o){if(Math.abs(s-this.getY())<=r&&Math.abs(o-this.getX())<=r){const u=Math.abs(r-this.estimatedModuleSize);return u<=1||u<=this.estimatedModuleSize}return!1}combineEstimate(r,s,o){const u=this.count+1,c=(this.count*this.getX()+s)/u,h=(this.count*this.getY()+r)/u,d=(this.count*this.estimatedModuleSize+o)/u;return new xa(c,h,d,u)}}class fh{constructor(r){this.bottomLeft=r[0],this.topLeft=r[1],this.topRight=r[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class ft{constructor(r,s){this.image=r,this.resultPointCallback=s,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=s}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(r){const s=r!=null&&r.get(se.TRY_HARDER)!==void 0,o=r!=null&&r.get(se.PURE_BARCODE)!==void 0,u=this.image,c=u.getHeight(),h=u.getWidth();let d=Math.floor(3*c/(4*ft.MAX_MODULES));(d<ft.MIN_SKIP||s)&&(d=ft.MIN_SKIP);let p=!1;const w=new Int32Array(5);for(let T=d-1;T<c&&!p;T+=d){w[0]=0,w[1]=0,w[2]=0,w[3]=0,w[4]=0;let S=0;for(let M=0;M<h;M++)if(u.get(M,T))(S&1)===1&&S++,w[S]++;else if(S&1)w[S]++;else if(S===4)if(ft.foundPatternCross(w)){if(this.handlePossibleCenter(w,T,M,o)===!0)if(d=2,this.hasSkipped===!0)p=this.haveMultiplyConfirmedCenters();else{const W=this.findRowSkip();W>w[2]&&(T+=W-w[2]-d,M=h-1)}else{w[0]=w[2],w[1]=w[3],w[2]=w[4],w[3]=1,w[4]=0,S=3;continue}S=0,w[0]=0,w[1]=0,w[2]=0,w[3]=0,w[4]=0}else w[0]=w[2],w[1]=w[3],w[2]=w[4],w[3]=1,w[4]=0,S=3;else w[++S]++;ft.foundPatternCross(w)&&this.handlePossibleCenter(w,T,h,o)===!0&&(d=w[0],this.hasSkipped&&(p=this.haveMultiplyConfirmedCenters()))}const _=this.selectBestPatterns();return de.orderBestPatterns(_),new fh(_)}static centerFromEnd(r,s){return s-r[4]-r[3]-r[2]/2}static foundPatternCross(r){let s=0;for(let c=0;c<5;c++){const h=r[c];if(h===0)return!1;s+=h}if(s<7)return!1;const o=s/7,u=o/2;return Math.abs(o-r[0])<u&&Math.abs(o-r[1])<u&&Math.abs(3*o-r[2])<3*u&&Math.abs(o-r[3])<u&&Math.abs(o-r[4])<u}getCrossCheckStateCount(){const r=this.crossCheckStateCount;return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r}crossCheckDiagonal(r,s,o,u){const c=this.getCrossCheckStateCount();let h=0;const d=this.image;for(;r>=h&&s>=h&&d.get(s-h,r-h);)c[2]++,h++;if(r<h||s<h)return!1;for(;r>=h&&s>=h&&!d.get(s-h,r-h)&&c[1]<=o;)c[1]++,h++;if(r<h||s<h||c[1]>o)return!1;for(;r>=h&&s>=h&&d.get(s-h,r-h)&&c[0]<=o;)c[0]++,h++;if(c[0]>o)return!1;const p=d.getHeight(),w=d.getWidth();for(h=1;r+h<p&&s+h<w&&d.get(s+h,r+h);)c[2]++,h++;if(r+h>=p||s+h>=w)return!1;for(;r+h<p&&s+h<w&&!d.get(s+h,r+h)&&c[3]<o;)c[3]++,h++;if(r+h>=p||s+h>=w||c[3]>=o)return!1;for(;r+h<p&&s+h<w&&d.get(s+h,r+h)&&c[4]<o;)c[4]++,h++;if(c[4]>=o)return!1;const _=c[0]+c[1]+c[2]+c[3]+c[4];return Math.abs(_-u)<2*u&&ft.foundPatternCross(c)}crossCheckVertical(r,s,o,u){const c=this.image,h=c.getHeight(),d=this.getCrossCheckStateCount();let p=r;for(;p>=0&&c.get(s,p);)d[2]++,p--;if(p<0)return NaN;for(;p>=0&&!c.get(s,p)&&d[1]<=o;)d[1]++,p--;if(p<0||d[1]>o)return NaN;for(;p>=0&&c.get(s,p)&&d[0]<=o;)d[0]++,p--;if(d[0]>o)return NaN;for(p=r+1;p<h&&c.get(s,p);)d[2]++,p++;if(p===h)return NaN;for(;p<h&&!c.get(s,p)&&d[3]<o;)d[3]++,p++;if(p===h||d[3]>=o)return NaN;for(;p<h&&c.get(s,p)&&d[4]<o;)d[4]++,p++;if(d[4]>=o)return NaN;const w=d[0]+d[1]+d[2]+d[3]+d[4];return 5*Math.abs(w-u)>=2*u?NaN:ft.foundPatternCross(d)?ft.centerFromEnd(d,p):NaN}crossCheckHorizontal(r,s,o,u){const c=this.image,h=c.getWidth(),d=this.getCrossCheckStateCount();let p=r;for(;p>=0&&c.get(p,s);)d[2]++,p--;if(p<0)return NaN;for(;p>=0&&!c.get(p,s)&&d[1]<=o;)d[1]++,p--;if(p<0||d[1]>o)return NaN;for(;p>=0&&c.get(p,s)&&d[0]<=o;)d[0]++,p--;if(d[0]>o)return NaN;for(p=r+1;p<h&&c.get(p,s);)d[2]++,p++;if(p===h)return NaN;for(;p<h&&!c.get(p,s)&&d[3]<o;)d[3]++,p++;if(p===h||d[3]>=o)return NaN;for(;p<h&&c.get(p,s)&&d[4]<o;)d[4]++,p++;if(d[4]>=o)return NaN;const w=d[0]+d[1]+d[2]+d[3]+d[4];return 5*Math.abs(w-u)>=u?NaN:ft.foundPatternCross(d)?ft.centerFromEnd(d,p):NaN}handlePossibleCenter(r,s,o,u){const c=r[0]+r[1]+r[2]+r[3]+r[4];let h=ft.centerFromEnd(r,o),d=this.crossCheckVertical(s,Math.floor(h),r[2],c);if(!isNaN(d)&&(h=this.crossCheckHorizontal(Math.floor(h),Math.floor(d),r[2],c),!isNaN(h)&&(!u||this.crossCheckDiagonal(Math.floor(d),Math.floor(h),r[2],c)))){const p=c/7;let w=!1;const _=this.possibleCenters;for(let T=0,S=_.length;T<S;T++){const M=_[T];if(M.aboutEquals(p,d,h)){_[T]=M.combineEstimate(d,h,p),w=!0;break}}if(!w){const T=new xa(h,d,p);_.push(T),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(T)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let s=null;for(const o of this.possibleCenters)if(o.getCount()>=ft.CENTER_QUORUM)if(s==null)s=o;else return this.hasSkipped=!0,Math.floor((Math.abs(s.getX()-o.getX())-Math.abs(s.getY()-o.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let r=0,s=0;const o=this.possibleCenters.length;for(const h of this.possibleCenters)h.getCount()>=ft.CENTER_QUORUM&&(r++,s+=h.getEstimatedModuleSize());if(r<3)return!1;const u=s/o;let c=0;for(const h of this.possibleCenters)c+=Math.abs(h.getEstimatedModuleSize()-u);return c<=.05*s}selectBestPatterns(){const r=this.possibleCenters.length;if(r<3)throw new ee;const s=this.possibleCenters;let o;if(r>3){let u=0,c=0;for(const p of this.possibleCenters){const w=p.getEstimatedModuleSize();u+=w,c+=w*w}o=u/r;let h=Math.sqrt(c/r-o*o);s.sort((p,w)=>{const _=Math.abs(w.getEstimatedModuleSize()-o),T=Math.abs(p.getEstimatedModuleSize()-o);return _<T?-1:_>T?1:0});const d=Math.max(.2*o,h);for(let p=0;p<s.length&&s.length>3;p++){const w=s[p];Math.abs(w.getEstimatedModuleSize()-o)>d&&(s.splice(p,1),p--)}}if(s.length>3){let u=0;for(const c of s)u+=c.getEstimatedModuleSize();o=u/s.length,s.sort((c,h)=>{if(h.getCount()===c.getCount()){const d=Math.abs(h.getEstimatedModuleSize()-o),p=Math.abs(c.getEstimatedModuleSize()-o);return d<p?1:d>p?-1:0}else return h.getCount()-c.getCount()}),s.splice(3)}return[s[0],s[1],s[2]]}}ft.CENTER_QUORUM=2,ft.MIN_SKIP=3,ft.MAX_MODULES=57;class Ms{constructor(r){this.image=r}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(r){this.resultPointCallback=r==null?null:r.get(se.NEED_RESULT_POINT_CALLBACK);const o=new ft(this.image,this.resultPointCallback).find(r);return this.processFinderPatternInfo(o)}processFinderPatternInfo(r){const s=r.getTopLeft(),o=r.getTopRight(),u=r.getBottomLeft(),c=this.calculateModuleSize(s,o,u);if(c<1)throw new ee("No pattern found in proccess finder.");const h=Ms.computeDimension(s,o,u,c),d=_e.getProvisionalVersionForDimension(h),p=d.getDimensionForVersion()-7;let w=null;if(d.getAlignmentPatternCenters().length>0){const M=o.getX()-s.getX()+u.getX(),z=o.getY()-s.getY()+u.getY(),W=1-3/p,q=Math.floor(s.getX()+W*(M-s.getX())),J=Math.floor(s.getY()+W*(z-s.getY()));for(let le=4;le<=16;le<<=1)try{w=this.findAlignmentInRegion(c,q,J,le);break}catch(ue){if(!(ue instanceof ee))throw ue}}const _=Ms.createTransform(s,o,u,w,h),T=Ms.sampleGrid(this.image,_,h);let S;return w===null?S=[u,s,o]:S=[u,s,o,w],new fi(T,S)}static createTransform(r,s,o,u,c){const h=c-3.5;let d,p,w,_;return u!==null?(d=u.getX(),p=u.getY(),w=h-3,_=w):(d=s.getX()-r.getX()+o.getX(),p=s.getY()-r.getY()+o.getY(),w=h,_=h),hn.quadrilateralToQuadrilateral(3.5,3.5,h,3.5,w,_,3.5,h,r.getX(),r.getY(),s.getX(),s.getY(),d,p,o.getX(),o.getY())}static sampleGrid(r,s,o){return br.getInstance().sampleGridWithTransform(r,o,o,s)}static computeDimension(r,s,o,u){const c=Fe.round(de.distance(r,s)/u),h=Fe.round(de.distance(r,o)/u);let d=Math.floor((c+h)/2)+7;switch(d&3){case 0:d++;break;case 2:d--;break;case 3:throw new ee("Dimensions could be not found.")}return d}calculateModuleSize(r,s,o){return(this.calculateModuleSizeOneWay(r,s)+this.calculateModuleSizeOneWay(r,o))/2}calculateModuleSizeOneWay(r,s){const o=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(r.getX()),Math.floor(r.getY()),Math.floor(s.getX()),Math.floor(s.getY())),u=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(s.getX()),Math.floor(s.getY()),Math.floor(r.getX()),Math.floor(r.getY()));return isNaN(o)?u/7:isNaN(u)?o/7:(o+u)/14}sizeOfBlackWhiteBlackRunBothWays(r,s,o,u){let c=this.sizeOfBlackWhiteBlackRun(r,s,o,u),h=1,d=r-(o-r);d<0?(h=r/(r-d),d=0):d>=this.image.getWidth()&&(h=(this.image.getWidth()-1-r)/(d-r),d=this.image.getWidth()-1);let p=Math.floor(s-(u-s)*h);return h=1,p<0?(h=s/(s-p),p=0):p>=this.image.getHeight()&&(h=(this.image.getHeight()-1-s)/(p-s),p=this.image.getHeight()-1),d=Math.floor(r+(d-r)*h),c+=this.sizeOfBlackWhiteBlackRun(r,s,d,p),c-1}sizeOfBlackWhiteBlackRun(r,s,o,u){const c=Math.abs(u-s)>Math.abs(o-r);if(c){let M=r;r=s,s=M,M=o,o=u,u=M}const h=Math.abs(o-r),d=Math.abs(u-s);let p=-h/2;const w=r<o?1:-1,_=s<u?1:-1;let T=0;const S=o+w;for(let M=r,z=s;M!==S;M+=w){const W=c?z:M,q=c?M:z;if(T===1===this.image.get(W,q)){if(T===2)return Fe.distance(M,z,r,s);T++}if(p+=d,p>0){if(z===u)break;z+=_,p-=h}}return T===2?Fe.distance(o+w,u,r,s):NaN}findAlignmentInRegion(r,s,o,u){const c=Math.floor(u*r),h=Math.max(0,s-c),d=Math.min(this.image.getWidth()-1,s+c);if(d-h<r*3)throw new ee("Alignment top exceeds estimated module size.");const p=Math.max(0,o-c),w=Math.min(this.image.getHeight()-1,o+c);if(w-p<r*3)throw new ee("Alignment bottom exceeds estimated module size.");return new co(this.image,h,p,d-h,w-p,r,this.resultPointCallback).find()}}class yr{constructor(){this.decoder=new jl}getDecoder(){return this.decoder}decode(r,s){let o,u;if(s!=null&&s.get(se.PURE_BARCODE)!==void 0){const p=yr.extractPureBits(r.getBlackMatrix());o=this.decoder.decodeBitMatrix(p,s),u=yr.NO_POINTS}else{const p=new Ms(r.getBlackMatrix()).detect(s);o=this.decoder.decodeBitMatrix(p.getBits(),s),u=p.getPoints()}o.getOther()instanceof wa&&o.getOther().applyMirroredCorrection(u);const c=new ut(o.getText(),o.getRawBytes(),void 0,u,Ee.QR_CODE,void 0),h=o.getByteSegments();h!==null&&c.putMetadata(kt.BYTE_SEGMENTS,h);const d=o.getECLevel();return d!==null&&c.putMetadata(kt.ERROR_CORRECTION_LEVEL,d),o.hasStructuredAppend()&&(c.putMetadata(kt.STRUCTURED_APPEND_SEQUENCE,o.getStructuredAppendSequenceNumber()),c.putMetadata(kt.STRUCTURED_APPEND_PARITY,o.getStructuredAppendParity())),c}reset(){}static extractPureBits(r){const s=r.getTopLeftOnBit(),o=r.getBottomRightOnBit();if(s===null||o===null)throw new ee;const u=this.moduleSize(s,r);let c=s[1],h=o[1],d=s[0],p=o[0];if(d>=p||c>=h)throw new ee;if(h-c!==p-d&&(p=d+(h-c),p>=r.getWidth()))throw new ee;const w=Math.round((p-d+1)/u),_=Math.round((h-c+1)/u);if(w<=0||_<=0)throw new ee;if(_!==w)throw new ee;const T=Math.floor(u/2);c+=T,d+=T;const S=d+Math.floor((w-1)*u)-p;if(S>0){if(S>T)throw new ee;d-=S}const M=c+Math.floor((_-1)*u)-h;if(M>0){if(M>T)throw new ee;c-=M}const z=new ze(w,_);for(let W=0;W<_;W++){const q=c+Math.floor(W*u);for(let J=0;J<w;J++)r.get(d+Math.floor(J*u),q)&&z.set(J,W)}return z}static moduleSize(r,s){const o=s.getHeight(),u=s.getWidth();let c=r[0],h=r[1],d=!0,p=0;for(;c<u&&h<o;){if(d!==s.get(c,h)){if(++p===5)break;d=!d}c++,h++}if(c===u||h===o)throw new ee;return(c-r[0])/7}}yr.NO_POINTS=new Array;class ve{PDF417Common(){}static getBitCountSum(r){return Fe.sum(r)}static toIntArray(r){if(r==null||!r.length)return ve.EMPTY_INT_ARRAY;const s=new Int32Array(r.length);let o=0;for(const u of r)s[o++]=u;return s}static getCodeword(r){const s=k.binarySearch(ve.SYMBOL_TABLE,r&262143);return s<0?-1:(ve.CODEWORD_TABLE[s]-1)%ve.NUMBER_OF_CODEWORDS}}ve.NUMBER_OF_CODEWORDS=929,ve.MAX_CODEWORDS_IN_BARCODE=ve.NUMBER_OF_CODEWORDS-1,ve.MIN_ROWS_IN_BARCODE=3,ve.MAX_ROWS_IN_BARCODE=90,ve.MODULES_IN_CODEWORD=17,ve.MODULES_IN_STOP_PATTERN=18,ve.BARS_IN_MODULE=8,ve.EMPTY_INT_ARRAY=new Int32Array([]),ve.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),ve.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class Xl{constructor(r,s){this.bits=r,this.points=s}getBits(){return this.bits}getPoints(){return this.points}}class be{static detectMultiple(r,s,o){let u=r.getBlackMatrix(),c=be.detect(o,u);return c.length||(u=u.clone(),u.rotate180(),c=be.detect(o,u)),new Xl(u,c)}static detect(r,s){const o=new Array;let u=0,c=0,h=!1;for(;u<s.getHeight();){const d=be.findVertices(s,u,c);if(d[0]==null&&d[3]==null){if(!h)break;h=!1,c=0;for(const p of o)p[1]!=null&&(u=Math.trunc(Math.max(u,p[1].getY()))),p[3]!=null&&(u=Math.max(u,Math.trunc(p[3].getY())));u+=be.ROW_STEP;continue}if(h=!0,o.push(d),!r)break;d[2]!=null?(c=Math.trunc(d[2].getX()),u=Math.trunc(d[2].getY())):(c=Math.trunc(d[4].getX()),u=Math.trunc(d[4].getY()))}return o}static findVertices(r,s,o){const u=r.getHeight(),c=r.getWidth(),h=new Array(8);return be.copyToResult(h,be.findRowsWithPattern(r,u,c,s,o,be.START_PATTERN),be.INDEXES_START_PATTERN),h[4]!=null&&(o=Math.trunc(h[4].getX()),s=Math.trunc(h[4].getY())),be.copyToResult(h,be.findRowsWithPattern(r,u,c,s,o,be.STOP_PATTERN),be.INDEXES_STOP_PATTERN),h}static copyToResult(r,s,o){for(let u=0;u<o.length;u++)r[o[u]]=s[u]}static findRowsWithPattern(r,s,o,u,c,h){const d=new Array(4);let p=!1;const w=new Int32Array(h.length);for(;u<s;u+=be.ROW_STEP){let T=be.findGuardPattern(r,c,u,o,!1,h,w);if(T!=null){for(;u>0;){const S=be.findGuardPattern(r,c,--u,o,!1,h,w);if(S!=null)T=S;else{u++;break}}d[0]=new de(T[0],u),d[1]=new de(T[1],u),p=!0;break}}let _=u+1;if(p){let T=0,S=Int32Array.from([Math.trunc(d[0].getX()),Math.trunc(d[1].getX())]);for(;_<s;_++){const M=be.findGuardPattern(r,S[0],_,o,!1,h,w);if(M!=null&&Math.abs(S[0]-M[0])<be.MAX_PATTERN_DRIFT&&Math.abs(S[1]-M[1])<be.MAX_PATTERN_DRIFT)S=M,T=0;else{if(T>be.SKIPPED_ROW_COUNT_MAX)break;T++}}_-=T+1,d[2]=new de(S[0],_),d[3]=new de(S[1],_)}return _-u<be.BARCODE_MIN_HEIGHT&&k.fill(d,null),d}static findGuardPattern(r,s,o,u,c,h,d){k.fillWithin(d,0,d.length,0);let p=s,w=0;for(;r.get(p,o)&&p>0&&w++<be.MAX_PIXEL_DRIFT;)p--;let _=p,T=0,S=h.length;for(let M=c;_<u;_++)if(r.get(_,o)!==M)d[T]++;else{if(T===S-1){if(be.patternMatchVariance(d,h,be.MAX_INDIVIDUAL_VARIANCE)<be.MAX_AVG_VARIANCE)return new Int32Array([p,_]);p+=d[0]+d[1],X.arraycopy(d,2,d,0,T-1),d[T-1]=0,d[T]=0,T--}else T++;d[T]=1,M=!M}return T===S-1&&be.patternMatchVariance(d,h,be.MAX_INDIVIDUAL_VARIANCE)<be.MAX_AVG_VARIANCE?new Int32Array([p,_-1]):null}static patternMatchVariance(r,s,o){let u=r.length,c=0,h=0;for(let w=0;w<u;w++)c+=r[w],h+=s[w];if(c<h)return 1/0;let d=c/h;o*=d;let p=0;for(let w=0;w<u;w++){let _=r[w],T=s[w]*d,S=_>T?_-T:T-_;if(S>o)return 1/0;p+=S}return p/c}}be.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),be.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),be.MAX_AVG_VARIANCE=.42,be.MAX_INDIVIDUAL_VARIANCE=.8,be.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),be.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),be.MAX_PIXEL_DRIFT=3,be.MAX_PATTERN_DRIFT=5,be.SKIPPED_ROW_COUNT_MAX=25,be.ROW_STEP=5,be.BARCODE_MIN_HEIGHT=10;class Nt{constructor(r,s){if(s.length===0)throw new v;this.field=r;let o=s.length;if(o>1&&s[0]===0){let u=1;for(;u<o&&s[u]===0;)u++;u===o?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(o-u),X.arraycopy(s,u,this.coefficients,0,this.coefficients.length))}else this.coefficients=s}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(r){return this.coefficients[this.coefficients.length-1-r]}evaluateAt(r){if(r===0)return this.getCoefficient(0);if(r===1){let u=0;for(let c of this.coefficients)u=this.field.add(u,c);return u}let s=this.coefficients[0],o=this.coefficients.length;for(let u=1;u<o;u++)s=this.field.add(this.field.multiply(r,s),this.coefficients[u]);return s}add(r){if(!this.field.equals(r.field))throw new v("ModulusPolys do not have same ModulusGF field");if(this.isZero())return r;if(r.isZero())return this;let s=this.coefficients,o=r.coefficients;if(s.length>o.length){let h=s;s=o,o=h}let u=new Int32Array(o.length),c=o.length-s.length;X.arraycopy(o,0,u,0,c);for(let h=c;h<o.length;h++)u[h]=this.field.add(s[h-c],o[h]);return new Nt(this.field,u)}subtract(r){if(!this.field.equals(r.field))throw new v("ModulusPolys do not have same ModulusGF field");return r.isZero()?this:this.add(r.negative())}multiply(r){return r instanceof Nt?this.multiplyOther(r):this.multiplyScalar(r)}multiplyOther(r){if(!this.field.equals(r.field))throw new v("ModulusPolys do not have same ModulusGF field");if(this.isZero()||r.isZero())return new Nt(this.field,new Int32Array([0]));let s=this.coefficients,o=s.length,u=r.coefficients,c=u.length,h=new Int32Array(o+c-1);for(let d=0;d<o;d++){let p=s[d];for(let w=0;w<c;w++)h[d+w]=this.field.add(h[d+w],this.field.multiply(p,u[w]))}return new Nt(this.field,h)}negative(){let r=this.coefficients.length,s=new Int32Array(r);for(let o=0;o<r;o++)s[o]=this.field.subtract(0,this.coefficients[o]);return new Nt(this.field,s)}multiplyScalar(r){if(r===0)return new Nt(this.field,new Int32Array([0]));if(r===1)return this;let s=this.coefficients.length,o=new Int32Array(s);for(let u=0;u<s;u++)o[u]=this.field.multiply(this.coefficients[u],r);return new Nt(this.field,o)}multiplyByMonomial(r,s){if(r<0)throw new v;if(s===0)return new Nt(this.field,new Int32Array([0]));let o=this.coefficients.length,u=new Int32Array(o+r);for(let c=0;c<o;c++)u[c]=this.field.multiply(this.coefficients[c],s);return new Nt(this.field,u)}toString(){let r=new L;for(let s=this.getDegree();s>=0;s--){let o=this.getCoefficient(s);o!==0&&(o<0?(r.append(" - "),o=-o):r.length()>0&&r.append(" + "),(s===0||o!==1)&&r.append(o),s!==0&&(s===1?r.append("x"):(r.append("x^"),r.append(s))))}return r.toString()}}class ql{add(r,s){return(r+s)%this.modulus}subtract(r,s){return(this.modulus+r-s)%this.modulus}exp(r){return this.expTable[r]}log(r){if(r===0)throw new v;return this.logTable[r]}inverse(r){if(r===0)throw new Rs;return this.expTable[this.modulus-this.logTable[r]-1]}multiply(r,s){return r===0||s===0?0:this.expTable[(this.logTable[r]+this.logTable[s])%(this.modulus-1)]}getSize(){return this.modulus}equals(r){return r===this}}class ks extends ql{constructor(r,s){super(),this.modulus=r,this.expTable=new Int32Array(r),this.logTable=new Int32Array(r);let o=1;for(let u=0;u<r;u++)this.expTable[u]=o,o=o*s%r;for(let u=0;u<r-1;u++)this.logTable[this.expTable[u]]=u;this.zero=new Nt(this,new Int32Array([0])),this.one=new Nt(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(r,s){if(r<0)throw new v;if(s===0)return this.zero;let o=new Int32Array(r+1);return o[0]=s,new Nt(this,o)}}ks.PDF417_GF=new ks(ve.NUMBER_OF_CODEWORDS,3);class Et{constructor(){this.field=ks.PDF417_GF}decode(r,s,o){let u=new Nt(this.field,r),c=new Int32Array(s),h=!1;for(let z=s;z>0;z--){let W=u.evaluateAt(this.field.exp(z));c[s-z]=W,W!==0&&(h=!0)}if(!h)return 0;let d=this.field.getOne();if(o!=null)for(const z of o){let W=this.field.exp(r.length-1-z),q=new Nt(this.field,new Int32Array([this.field.subtract(0,W),1]));d=d.multiply(q)}let p=new Nt(this.field,c),w=this.runEuclideanAlgorithm(this.field.buildMonomial(s,1),p,s),_=w[0],T=w[1],S=this.findErrorLocations(_),M=this.findErrorMagnitudes(T,_,S);for(let z=0;z<S.length;z++){let W=r.length-1-this.field.log(S[z]);if(W<0)throw V.getChecksumInstance();r[W]=this.field.subtract(r[W],M[z])}return S.length}runEuclideanAlgorithm(r,s,o){if(r.getDegree()<s.getDegree()){let S=r;r=s,s=S}let u=r,c=s,h=this.field.getZero(),d=this.field.getOne();for(;c.getDegree()>=Math.round(o/2);){let S=u,M=h;if(u=c,h=d,u.isZero())throw V.getChecksumInstance();c=S;let z=this.field.getZero(),W=u.getCoefficient(u.getDegree()),q=this.field.inverse(W);for(;c.getDegree()>=u.getDegree()&&!c.isZero();){let J=c.getDegree()-u.getDegree(),le=this.field.multiply(c.getCoefficient(c.getDegree()),q);z=z.add(this.field.buildMonomial(J,le)),c=c.subtract(u.multiplyByMonomial(J,le))}d=z.multiply(h).subtract(M).negative()}let p=d.getCoefficient(0);if(p===0)throw V.getChecksumInstance();let w=this.field.inverse(p),_=d.multiply(w),T=c.multiply(w);return[_,T]}findErrorLocations(r){let s=r.getDegree(),o=new Int32Array(s),u=0;for(let c=1;c<this.field.getSize()&&u<s;c++)r.evaluateAt(c)===0&&(o[u]=this.field.inverse(c),u++);if(u!==s)throw V.getChecksumInstance();return o}findErrorMagnitudes(r,s,o){let u=s.getDegree(),c=new Int32Array(u);for(let w=1;w<=u;w++)c[u-w]=this.field.multiply(w,s.getCoefficient(w));let h=new Nt(this.field,c),d=o.length,p=new Int32Array(d);for(let w=0;w<d;w++){let _=this.field.inverse(o[w]),T=this.field.subtract(0,r.evaluateAt(_)),S=this.field.inverse(h.evaluateAt(_));p[w]=this.field.multiply(T,S)}return p}}class pi{constructor(r,s,o,u,c){r instanceof pi?this.constructor_2(r):this.constructor_1(r,s,o,u,c)}constructor_1(r,s,o,u,c){const h=s==null||o==null,d=u==null||c==null;if(h&&d)throw new ee;h?(s=new de(0,u.getY()),o=new de(0,c.getY())):d&&(u=new de(r.getWidth()-1,s.getY()),c=new de(r.getWidth()-1,o.getY())),this.image=r,this.topLeft=s,this.bottomLeft=o,this.topRight=u,this.bottomRight=c,this.minX=Math.trunc(Math.min(s.getX(),o.getX())),this.maxX=Math.trunc(Math.max(u.getX(),c.getX())),this.minY=Math.trunc(Math.min(s.getY(),u.getY())),this.maxY=Math.trunc(Math.max(o.getY(),c.getY()))}constructor_2(r){this.image=r.image,this.topLeft=r.getTopLeft(),this.bottomLeft=r.getBottomLeft(),this.topRight=r.getTopRight(),this.bottomRight=r.getBottomRight(),this.minX=r.getMinX(),this.maxX=r.getMaxX(),this.minY=r.getMinY(),this.maxY=r.getMaxY()}static merge(r,s){return r==null?s:s==null?r:new pi(r.image,r.topLeft,r.bottomLeft,s.topRight,s.bottomRight)}addMissingRows(r,s,o){let u=this.topLeft,c=this.bottomLeft,h=this.topRight,d=this.bottomRight;if(r>0){let p=o?this.topLeft:this.topRight,w=Math.trunc(p.getY()-r);w<0&&(w=0);let _=new de(p.getX(),w);o?u=_:h=_}if(s>0){let p=o?this.bottomLeft:this.bottomRight,w=Math.trunc(p.getY()+s);w>=this.image.getHeight()&&(w=this.image.getHeight()-1);let _=new de(p.getX(),w);o?c=_:d=_}return new pi(this.image,u,c,h,d)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class dh{constructor(r,s,o,u){this.columnCount=r,this.errorCorrectionLevel=u,this.rowCountUpperPart=s,this.rowCountLowerPart=o,this.rowCount=s+o}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class zi{constructor(){this.buffer=""}static form(r,s){let o=-1;function u(h,d,p,w,_,T){if(h==="%%")return"%";if(s[++o]===void 0)return;h=w?parseInt(w.substr(1)):void 0;let S=_?parseInt(_.substr(1)):void 0,M;switch(T){case"s":M=s[o];break;case"c":M=s[o][0];break;case"f":M=parseFloat(s[o]).toFixed(h);break;case"p":M=parseFloat(s[o]).toPrecision(h);break;case"e":M=parseFloat(s[o]).toExponential(h);break;case"x":M=parseInt(s[o]).toString(S||16);break;case"d":M=parseFloat(parseInt(s[o],S||10).toPrecision(h)).toFixed(0);break}M=typeof M=="object"?JSON.stringify(M):(+M).toString(S);let z=parseInt(p),W=p&&p[0]+""=="0"?"0":" ";for(;M.length<z;)M=d!==void 0?M+W:W+M;return M}let c=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return r.replace(c,u)}format(r,...s){this.buffer+=zi.form(r,s)}toString(){return this.buffer}}class Hi{constructor(r){this.boundingBox=new pi(r),this.codewords=new Array(r.getMaxY()-r.getMinY()+1)}getCodewordNearby(r){let s=this.getCodeword(r);if(s!=null)return s;for(let o=1;o<Hi.MAX_NEARBY_DISTANCE;o++){let u=this.imageRowToCodewordIndex(r)-o;if(u>=0&&(s=this.codewords[u],s!=null)||(u=this.imageRowToCodewordIndex(r)+o,u<this.codewords.length&&(s=this.codewords[u],s!=null)))return s}return null}imageRowToCodewordIndex(r){return r-this.boundingBox.getMinY()}setCodeword(r,s){this.codewords[this.imageRowToCodewordIndex(r)]=s}getCodeword(r){return this.codewords[this.imageRowToCodewordIndex(r)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const r=new zi;let s=0;for(const o of this.codewords){if(o==null){r.format("%3d:    |   %n",s++);continue}r.format("%3d: %3d|%3d%n",s++,o.getRowNumber(),o.getValue())}return r.toString()}}Hi.MAX_NEARBY_DISTANCE=5;class Gi{constructor(){this.values=new Map}setValue(r){r=Math.trunc(r);let s=this.values.get(r);s==null&&(s=0),s++,this.values.set(r,s)}getValue(){let r=-1,s=new Array;for(const[o,u]of this.values.entries()){const c={getKey:()=>o,getValue:()=>u};c.getValue()>r?(r=c.getValue(),s=[],s.push(c.getKey())):c.getValue()===r&&s.push(c.getKey())}return ve.toIntArray(s)}getConfidence(r){return this.values.get(r)}}class Ls extends Hi{constructor(r,s){super(r),this._isLeft=s}setRowNumbers(){for(let r of this.getCodewords())r!=null&&r.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(r){let s=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(s,r);let o=this.getBoundingBox(),u=this._isLeft?o.getTopLeft():o.getTopRight(),c=this._isLeft?o.getBottomLeft():o.getBottomRight(),h=this.imageRowToCodewordIndex(Math.trunc(u.getY())),d=this.imageRowToCodewordIndex(Math.trunc(c.getY())),p=-1,w=1,_=0;for(let T=h;T<d;T++){if(s[T]==null)continue;let S=s[T],M=S.getRowNumber()-p;if(M===0)_++;else if(M===1)w=Math.max(w,_),_=1,p=S.getRowNumber();else if(M<0||S.getRowNumber()>=r.getRowCount()||M>T)s[T]=null;else{let z;w>2?z=(w-2)*M:z=M;let W=z>=T;for(let q=1;q<=z&&!W;q++)W=s[T-q]!=null;W?s[T]=null:(p=S.getRowNumber(),_=1)}}}getRowHeights(){let r=this.getBarcodeMetadata();if(r==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(r);let s=new Int32Array(r.getRowCount());for(let o of this.getCodewords())if(o!=null){let u=o.getRowNumber();if(u>=s.length)continue;s[u]++}return s}adjustIncompleteIndicatorColumnRowNumbers(r){let s=this.getBoundingBox(),o=this._isLeft?s.getTopLeft():s.getTopRight(),u=this._isLeft?s.getBottomLeft():s.getBottomRight(),c=this.imageRowToCodewordIndex(Math.trunc(o.getY())),h=this.imageRowToCodewordIndex(Math.trunc(u.getY())),d=this.getCodewords(),p=-1;for(let w=c;w<h;w++){if(d[w]==null)continue;let _=d[w];_.setRowNumberAsRowIndicatorColumn();let T=_.getRowNumber()-p;T===0||(T===1?p=_.getRowNumber():_.getRowNumber()>=r.getRowCount()?d[w]=null:p=_.getRowNumber())}}getBarcodeMetadata(){let r=this.getCodewords(),s=new Gi,o=new Gi,u=new Gi,c=new Gi;for(let d of r){if(d==null)continue;d.setRowNumberAsRowIndicatorColumn();let p=d.getValue()%30,w=d.getRowNumber();switch(this._isLeft||(w+=2),w%3){case 0:o.setValue(p*3+1);break;case 1:c.setValue(p/3),u.setValue(p%3);break;case 2:s.setValue(p+1);break}}if(s.getValue().length===0||o.getValue().length===0||u.getValue().length===0||c.getValue().length===0||s.getValue()[0]<1||o.getValue()[0]+u.getValue()[0]<ve.MIN_ROWS_IN_BARCODE||o.getValue()[0]+u.getValue()[0]>ve.MAX_ROWS_IN_BARCODE)return null;let h=new dh(s.getValue()[0],o.getValue()[0],u.getValue()[0],c.getValue()[0]);return this.removeIncorrectCodewords(r,h),h}removeIncorrectCodewords(r,s){for(let o=0;o<r.length;o++){let u=r[o];if(r[o]==null)continue;let c=u.getValue()%30,h=u.getRowNumber();if(h>s.getRowCount()){r[o]=null;continue}switch(this._isLeft||(h+=2),h%3){case 0:c*3+1!==s.getRowCountUpperPart()&&(r[o]=null);break;case 1:(Math.trunc(c/3)!==s.getErrorCorrectionLevel()||c%3!==s.getRowCountLowerPart())&&(r[o]=null);break;case 2:c+1!==s.getColumnCount()&&(r[o]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class Hn{constructor(r,s){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=r,this.barcodeColumnCount=r.getColumnCount(),this.boundingBox=s,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let r=ve.MAX_CODEWORDS_IN_BARCODE,s;do s=r,r=this.adjustRowNumbersAndGetCount();while(r>0&&r<s);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(r){r!=null&&r.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let r=this.adjustRowNumbersByRow();if(r===0)return 0;for(let s=1;s<this.barcodeColumnCount+1;s++){let o=this.detectionResultColumns[s].getCodewords();for(let u=0;u<o.length;u++)o[u]!=null&&(o[u].hasValidRowNumber()||this.adjustRowNumbers(s,u,o))}return r}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let r=this.detectionResultColumns[0].getCodewords(),s=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let o=0;o<r.length;o++)if(r[o]!=null&&s[o]!=null&&r[o].getRowNumber()===s[o].getRowNumber())for(let u=1;u<=this.barcodeColumnCount;u++){let c=this.detectionResultColumns[u].getCodewords()[o];c!=null&&(c.setRowNumber(r[o].getRowNumber()),c.hasValidRowNumber()||(this.detectionResultColumns[u].getCodewords()[o]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let r=0,s=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let o=0;o<s.length;o++){if(s[o]==null)continue;let u=s[o].getRowNumber(),c=0;for(let h=this.barcodeColumnCount+1;h>0&&c<this.ADJUST_ROW_NUMBER_SKIP;h--){let d=this.detectionResultColumns[h].getCodewords()[o];d!=null&&(c=Hn.adjustRowNumberIfValid(u,c,d),d.hasValidRowNumber()||r++)}}return r}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let r=0,s=this.detectionResultColumns[0].getCodewords();for(let o=0;o<s.length;o++){if(s[o]==null)continue;let u=s[o].getRowNumber(),c=0;for(let h=1;h<this.barcodeColumnCount+1&&c<this.ADJUST_ROW_NUMBER_SKIP;h++){let d=this.detectionResultColumns[h].getCodewords()[o];d!=null&&(c=Hn.adjustRowNumberIfValid(u,c,d),d.hasValidRowNumber()||r++)}}return r}static adjustRowNumberIfValid(r,s,o){return o==null||o.hasValidRowNumber()||(o.isValidRowNumber(r)?(o.setRowNumber(r),s=0):++s),s}adjustRowNumbers(r,s,o){if(!this.detectionResultColumns[r-1])return;let u=o[s],c=this.detectionResultColumns[r-1].getCodewords(),h=c;this.detectionResultColumns[r+1]!=null&&(h=this.detectionResultColumns[r+1].getCodewords());let d=new Array(14);d[2]=c[s],d[3]=h[s],s>0&&(d[0]=o[s-1],d[4]=c[s-1],d[5]=h[s-1]),s>1&&(d[8]=o[s-2],d[10]=c[s-2],d[11]=h[s-2]),s<o.length-1&&(d[1]=o[s+1],d[6]=c[s+1],d[7]=h[s+1]),s<o.length-2&&(d[9]=o[s+2],d[12]=c[s+2],d[13]=h[s+2]);for(let p of d)if(Hn.adjustRowNumber(u,p))return}static adjustRowNumber(r,s){return s==null?!1:s.hasValidRowNumber()&&s.getBucket()===r.getBucket()?(r.setRowNumber(s.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(r){this.boundingBox=r}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(r,s){this.detectionResultColumns[r]=s}getDetectionResultColumn(r){return this.detectionResultColumns[r]}toString(){let r=this.detectionResultColumns[0];r==null&&(r=this.detectionResultColumns[this.barcodeColumnCount+1]);let s=new zi;for(let o=0;o<r.getCodewords().length;o++){s.format("CW %3d:",o);for(let u=0;u<this.barcodeColumnCount+2;u++){if(this.detectionResultColumns[u]==null){s.format("    |   ");continue}let c=this.detectionResultColumns[u].getCodewords()[o];if(c==null){s.format("    |   ");continue}s.format(" %3d|%3d",c.getRowNumber(),c.getValue())}s.format("%n")}return s.toString()}}class Wi{constructor(r,s,o,u){this.rowNumber=Wi.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(r),this.endX=Math.trunc(s),this.bucket=Math.trunc(o),this.value=Math.trunc(u)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(r){return r!==Wi.BARCODE_ROW_UNKNOWN&&this.bucket===r%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(r){this.rowNumber=r}toString(){return this.rowNumber+"|"+this.value}}Wi.BARCODE_ROW_UNKNOWN=-1;class In{static initialize(){for(let r=0;r<ve.SYMBOL_TABLE.length;r++){let s=ve.SYMBOL_TABLE[r],o=s&1;for(let u=0;u<ve.BARS_IN_MODULE;u++){let c=0;for(;(s&1)===o;)c+=1,s>>=1;o=s&1,In.RATIOS_TABLE[r]||(In.RATIOS_TABLE[r]=new Array(ve.BARS_IN_MODULE)),In.RATIOS_TABLE[r][ve.BARS_IN_MODULE-u-1]=Math.fround(c/ve.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(r){let s=In.getDecodedCodewordValue(In.sampleBitCounts(r));return s!==-1?s:In.getClosestDecodedValue(r)}static sampleBitCounts(r){let s=Fe.sum(r),o=new Int32Array(ve.BARS_IN_MODULE),u=0,c=0;for(let h=0;h<ve.MODULES_IN_CODEWORD;h++){let d=s/(2*ve.MODULES_IN_CODEWORD)+h*s/ve.MODULES_IN_CODEWORD;c+r[u]<=d&&(c+=r[u],u++),o[u]++}return o}static getDecodedCodewordValue(r){let s=In.getBitValue(r);return ve.getCodeword(s)===-1?-1:s}static getBitValue(r){let s=0;for(let o=0;o<r.length;o++)for(let u=0;u<r[o];u++)s=s<<1|(o%2===0?1:0);return Math.trunc(s)}static getClosestDecodedValue(r){let s=Fe.sum(r),o=new Array(ve.BARS_IN_MODULE);if(s>1)for(let h=0;h<o.length;h++)o[h]=Math.fround(r[h]/s);let u=Ut.MAX_VALUE,c=-1;this.bSymbolTableReady||In.initialize();for(let h=0;h<In.RATIOS_TABLE.length;h++){let d=0,p=In.RATIOS_TABLE[h];for(let w=0;w<ve.BARS_IN_MODULE;w++){let _=Math.fround(p[w]-o[w]);if(d+=Math.fround(_*_),d>=u)break}d<u&&(u=d,c=ve.SYMBOL_TABLE[h])}return c}}In.bSymbolTableReady=!1,In.RATIOS_TABLE=new Array(ve.SYMBOL_TABLE.length).map(I=>new Array(ve.BARS_IN_MODULE));class ji{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(r){this.segmentIndex=r}getFileId(){return this.fileId}setFileId(r){this.fileId=r}getOptionalData(){return this.optionalData}setOptionalData(r){this.optionalData=r}isLastSegment(){return this.lastSegment}setLastSegment(r){this.lastSegment=r}getSegmentCount(){return this.segmentCount}setSegmentCount(r){this.segmentCount=r}getSender(){return this.sender||null}setSender(r){this.sender=r}getAddressee(){return this.addressee||null}setAddressee(r){this.addressee=r}getFileName(){return this.fileName}setFileName(r){this.fileName=r}getFileSize(){return this.fileSize}setFileSize(r){this.fileSize=r}getChecksum(){return this.checksum}setChecksum(r){this.checksum=r}getTimestamp(){return this.timestamp}setTimestamp(r){this.timestamp=r}}class Ea{static parseLong(r,s=void 0){return parseInt(r,s)}}class ho extends m{}ho.kind="NullPointerException";class fo{writeBytes(r){this.writeBytesOffset(r,0,r.length)}writeBytesOffset(r,s,o){if(r==null)throw new ho;if(s<0||s>r.length||o<0||s+o>r.length||s+o<0)throw new ne;if(o===0)return;for(let u=0;u<o;u++)this.write(r[s+u])}flush(){}close(){}}class Kl extends m{}class go extends fo{constructor(r=32){if(super(),this.count=0,r<0)throw new v("Negative initial size: "+r);this.buf=new Uint8Array(r)}ensureCapacity(r){r-this.buf.length>0&&this.grow(r)}grow(r){let o=this.buf.length<<1;if(o-r<0&&(o=r),o<0){if(r<0)throw new Kl;o=B.MAX_VALUE}this.buf=k.copyOfUint8Array(this.buf,o)}write(r){this.ensureCapacity(this.count+1),this.buf[this.count]=r,this.count+=1}writeBytesOffset(r,s,o){if(s<0||s>r.length||o<0||s+o-r.length>0)throw new ne;this.ensureCapacity(this.count+o),X.arraycopy(r,s,this.buf,this.count,o),this.count+=o}writeTo(r){r.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return k.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(r){return r?typeof r=="string"?this.toString_string(r):this.toString_number(r):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(r){return new String(this.buf).toString()}toString_number(r){return new String(this.buf).toString()}close(){}}var st;(function(I){I[I.ALPHA=0]="ALPHA",I[I.LOWER=1]="LOWER",I[I.MIXED=2]="MIXED",I[I.PUNCT=3]="PUNCT",I[I.ALPHA_SHIFT=4]="ALPHA_SHIFT",I[I.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(st||(st={}));function _a(){if(typeof window<"u")return window.BigInt||null;if(typeof Ta<"u")return Ta.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let Kr;function Mr(I){if(typeof Kr>"u"&&(Kr=_a()),Kr===null)throw new Error("BigInt is not supported!");return Kr(I)}function Yl(){let I=[];I[0]=Mr(1);let r=Mr(900);I[1]=r;for(let s=2;s<16;s++)I[s]=I[s-1]*r;return I}class Z{static decode(r,s){let o=new L(""),u=b.ISO8859_1;o.enableDecoding(u);let c=1,h=r[c++],d=new ji;for(;c<r[0];){switch(h){case Z.TEXT_COMPACTION_MODE_LATCH:c=Z.textCompaction(r,c,o);break;case Z.BYTE_COMPACTION_MODE_LATCH:case Z.BYTE_COMPACTION_MODE_LATCH_6:c=Z.byteCompaction(h,r,u,c,o);break;case Z.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:o.append(r[c++]);break;case Z.NUMERIC_COMPACTION_MODE_LATCH:c=Z.numericCompaction(r,c,o);break;case Z.ECI_CHARSET:b.getCharacterSetECIByValue(r[c++]);break;case Z.ECI_GENERAL_PURPOSE:c+=2;break;case Z.ECI_USER_DEFINED:c++;break;case Z.BEGIN_MACRO_PDF417_CONTROL_BLOCK:c=Z.decodeMacroBlock(r,c,d);break;case Z.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Z.MACRO_PDF417_TERMINATOR:throw new N;default:c--,c=Z.textCompaction(r,c,o);break}if(c<r.length)h=r[c++];else throw N.getFormatInstance()}if(o.length()===0)throw N.getFormatInstance();let p=new Mi(null,o.toString(),null,s);return p.setOther(d),p}static decodeMacroBlock(r,s,o){if(s+Z.NUMBER_OF_SEQUENCE_CODEWORDS>r[0])throw N.getFormatInstance();let u=new Int32Array(Z.NUMBER_OF_SEQUENCE_CODEWORDS);for(let d=0;d<Z.NUMBER_OF_SEQUENCE_CODEWORDS;d++,s++)u[d]=r[s];o.setSegmentIndex(B.parseInt(Z.decodeBase900toBase10(u,Z.NUMBER_OF_SEQUENCE_CODEWORDS)));let c=new L;s=Z.textCompaction(r,s,c),o.setFileId(c.toString());let h=-1;for(r[s]===Z.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(h=s+1);s<r[0];)switch(r[s]){case Z.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(s++,r[s]){case Z.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let d=new L;s=Z.textCompaction(r,s+1,d),o.setFileName(d.toString());break;case Z.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let p=new L;s=Z.textCompaction(r,s+1,p),o.setSender(p.toString());break;case Z.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let w=new L;s=Z.textCompaction(r,s+1,w),o.setAddressee(w.toString());break;case Z.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let _=new L;s=Z.numericCompaction(r,s+1,_),o.setSegmentCount(B.parseInt(_.toString()));break;case Z.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let T=new L;s=Z.numericCompaction(r,s+1,T),o.setTimestamp(Ea.parseLong(T.toString()));break;case Z.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let S=new L;s=Z.numericCompaction(r,s+1,S),o.setChecksum(B.parseInt(S.toString()));break;case Z.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let M=new L;s=Z.numericCompaction(r,s+1,M),o.setFileSize(Ea.parseLong(M.toString()));break;default:throw N.getFormatInstance()}break;case Z.MACRO_PDF417_TERMINATOR:s++,o.setLastSegment(!0);break;default:throw N.getFormatInstance()}if(h!==-1){let d=s-h;o.isLastSegment()&&d--,o.setOptionalData(k.copyOfRange(r,h,h+d))}return s}static textCompaction(r,s,o){let u=new Int32Array((r[0]-s)*2),c=new Int32Array((r[0]-s)*2),h=0,d=!1;for(;s<r[0]&&!d;){let p=r[s++];if(p<Z.TEXT_COMPACTION_MODE_LATCH)u[h]=p/30,u[h+1]=p%30,h+=2;else switch(p){case Z.TEXT_COMPACTION_MODE_LATCH:u[h++]=Z.TEXT_COMPACTION_MODE_LATCH;break;case Z.BYTE_COMPACTION_MODE_LATCH:case Z.BYTE_COMPACTION_MODE_LATCH_6:case Z.NUMERIC_COMPACTION_MODE_LATCH:case Z.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Z.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Z.MACRO_PDF417_TERMINATOR:s--,d=!0;break;case Z.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u[h]=Z.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,p=r[s++],c[h]=p,h++;break}}return Z.decodeTextCompaction(u,c,h,o),s}static decodeTextCompaction(r,s,o,u){let c=st.ALPHA,h=st.ALPHA,d=0;for(;d<o;){let p=r[d],w="";switch(c){case st.ALPHA:if(p<26)w=String.fromCharCode(65+p);else switch(p){case 26:w=" ";break;case Z.LL:c=st.LOWER;break;case Z.ML:c=st.MIXED;break;case Z.PS:h=c,c=st.PUNCT_SHIFT;break;case Z.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(s[d]);break;case Z.TEXT_COMPACTION_MODE_LATCH:c=st.ALPHA;break}break;case st.LOWER:if(p<26)w=String.fromCharCode(97+p);else switch(p){case 26:w=" ";break;case Z.AS:h=c,c=st.ALPHA_SHIFT;break;case Z.ML:c=st.MIXED;break;case Z.PS:h=c,c=st.PUNCT_SHIFT;break;case Z.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(s[d]);break;case Z.TEXT_COMPACTION_MODE_LATCH:c=st.ALPHA;break}break;case st.MIXED:if(p<Z.PL)w=Z.MIXED_CHARS[p];else switch(p){case Z.PL:c=st.PUNCT;break;case 26:w=" ";break;case Z.LL:c=st.LOWER;break;case Z.AL:c=st.ALPHA;break;case Z.PS:h=c,c=st.PUNCT_SHIFT;break;case Z.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(s[d]);break;case Z.TEXT_COMPACTION_MODE_LATCH:c=st.ALPHA;break}break;case st.PUNCT:if(p<Z.PAL)w=Z.PUNCT_CHARS[p];else switch(p){case Z.PAL:c=st.ALPHA;break;case Z.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(s[d]);break;case Z.TEXT_COMPACTION_MODE_LATCH:c=st.ALPHA;break}break;case st.ALPHA_SHIFT:if(c=h,p<26)w=String.fromCharCode(65+p);else switch(p){case 26:w=" ";break;case Z.TEXT_COMPACTION_MODE_LATCH:c=st.ALPHA;break}break;case st.PUNCT_SHIFT:if(c=h,p<Z.PAL)w=Z.PUNCT_CHARS[p];else switch(p){case Z.PAL:c=st.ALPHA;break;case Z.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(s[d]);break;case Z.TEXT_COMPACTION_MODE_LATCH:c=st.ALPHA;break}break}w!==""&&u.append(w),d++}}static byteCompaction(r,s,o,u,c){let h=new go,d=0,p=0,w=!1;switch(r){case Z.BYTE_COMPACTION_MODE_LATCH:let _=new Int32Array(6),T=s[u++];for(;u<s[0]&&!w;)switch(_[d++]=T,p=900*p+T,T=s[u++],T){case Z.TEXT_COMPACTION_MODE_LATCH:case Z.BYTE_COMPACTION_MODE_LATCH:case Z.NUMERIC_COMPACTION_MODE_LATCH:case Z.BYTE_COMPACTION_MODE_LATCH_6:case Z.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Z.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Z.MACRO_PDF417_TERMINATOR:u--,w=!0;break;default:if(d%5===0&&d>0){for(let S=0;S<6;++S)h.write(Number(Mr(p)>>Mr(8*(5-S))));p=0,d=0}break}u===s[0]&&T<Z.TEXT_COMPACTION_MODE_LATCH&&(_[d++]=T);for(let S=0;S<d;S++)h.write(_[S]);break;case Z.BYTE_COMPACTION_MODE_LATCH_6:for(;u<s[0]&&!w;){let S=s[u++];if(S<Z.TEXT_COMPACTION_MODE_LATCH)d++,p=900*p+S;else switch(S){case Z.TEXT_COMPACTION_MODE_LATCH:case Z.BYTE_COMPACTION_MODE_LATCH:case Z.NUMERIC_COMPACTION_MODE_LATCH:case Z.BYTE_COMPACTION_MODE_LATCH_6:case Z.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Z.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Z.MACRO_PDF417_TERMINATOR:u--,w=!0;break}if(d%5===0&&d>0){for(let M=0;M<6;++M)h.write(Number(Mr(p)>>Mr(8*(5-M))));p=0,d=0}}break}return c.append(U.decode(h.toByteArray(),o)),u}static numericCompaction(r,s,o){let u=0,c=!1,h=new Int32Array(Z.MAX_NUMERIC_CODEWORDS);for(;s<r[0]&&!c;){let d=r[s++];if(s===r[0]&&(c=!0),d<Z.TEXT_COMPACTION_MODE_LATCH)h[u]=d,u++;else switch(d){case Z.TEXT_COMPACTION_MODE_LATCH:case Z.BYTE_COMPACTION_MODE_LATCH:case Z.BYTE_COMPACTION_MODE_LATCH_6:case Z.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Z.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Z.MACRO_PDF417_TERMINATOR:s--,c=!0;break}(u%Z.MAX_NUMERIC_CODEWORDS===0||d===Z.NUMERIC_COMPACTION_MODE_LATCH||c)&&u>0&&(o.append(Z.decodeBase900toBase10(h,u)),u=0)}return s}static decodeBase900toBase10(r,s){let o=Mr(0);for(let c=0;c<s;c++)o+=Z.EXP900[s-c-1]*Mr(r[c]);let u=o.toString();if(u.charAt(0)!=="1")throw new N;return u.substring(1)}}Z.TEXT_COMPACTION_MODE_LATCH=900,Z.BYTE_COMPACTION_MODE_LATCH=901,Z.NUMERIC_COMPACTION_MODE_LATCH=902,Z.BYTE_COMPACTION_MODE_LATCH_6=924,Z.ECI_USER_DEFINED=925,Z.ECI_GENERAL_PURPOSE=926,Z.ECI_CHARSET=927,Z.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,Z.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,Z.MACRO_PDF417_TERMINATOR=922,Z.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,Z.MAX_NUMERIC_CODEWORDS=15,Z.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,Z.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,Z.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,Z.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,Z.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,Z.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,Z.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,Z.PL=25,Z.LL=27,Z.AS=27,Z.ML=28,Z.AL=28,Z.PS=29,Z.PAL=29,Z.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,Z.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",Z.EXP900=_a()?Yl():[],Z.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Pe{constructor(){}static decode(r,s,o,u,c,h,d){let p=new pi(r,s,o,u,c),w=null,_=null,T;for(let z=!0;;z=!1){if(s!=null&&(w=Pe.getRowIndicatorColumn(r,p,s,!0,h,d)),u!=null&&(_=Pe.getRowIndicatorColumn(r,p,u,!1,h,d)),T=Pe.merge(w,_),T==null)throw ee.getNotFoundInstance();let W=T.getBoundingBox();if(z&&W!=null&&(W.getMinY()<p.getMinY()||W.getMaxY()>p.getMaxY()))p=W;else break}T.setBoundingBox(p);let S=T.getBarcodeColumnCount()+1;T.setDetectionResultColumn(0,w),T.setDetectionResultColumn(S,_);let M=w!=null;for(let z=1;z<=S;z++){let W=M?z:S-z;if(T.getDetectionResultColumn(W)!==void 0)continue;let q;W===0||W===S?q=new Ls(p,W===0):q=new Hi(p),T.setDetectionResultColumn(W,q);let J=-1,le=J;for(let ue=p.getMinY();ue<=p.getMaxY();ue++){if(J=Pe.getStartColumn(T,W,ue,M),J<0||J>p.getMaxX()){if(le===-1)continue;J=le}let oe=Pe.detectCodeword(r,p.getMinX(),p.getMaxX(),M,J,ue,h,d);oe!=null&&(q.setCodeword(ue,oe),le=J,h=Math.min(h,oe.getWidth()),d=Math.max(d,oe.getWidth()))}}return Pe.createDecoderResult(T)}static merge(r,s){if(r==null&&s==null)return null;let o=Pe.getBarcodeMetadata(r,s);if(o==null)return null;let u=pi.merge(Pe.adjustBoundingBox(r),Pe.adjustBoundingBox(s));return new Hn(o,u)}static adjustBoundingBox(r){if(r==null)return null;let s=r.getRowHeights();if(s==null)return null;let o=Pe.getMax(s),u=0;for(let d of s)if(u+=o-d,d>0)break;let c=r.getCodewords();for(let d=0;u>0&&c[d]==null;d++)u--;let h=0;for(let d=s.length-1;d>=0&&(h+=o-s[d],!(s[d]>0));d--);for(let d=c.length-1;h>0&&c[d]==null;d--)h--;return r.getBoundingBox().addMissingRows(u,h,r.isLeft())}static getMax(r){let s=-1;for(let o of r)s=Math.max(s,o);return s}static getBarcodeMetadata(r,s){let o;if(r==null||(o=r.getBarcodeMetadata())==null)return s==null?null:s.getBarcodeMetadata();let u;return s==null||(u=s.getBarcodeMetadata())==null?o:o.getColumnCount()!==u.getColumnCount()&&o.getErrorCorrectionLevel()!==u.getErrorCorrectionLevel()&&o.getRowCount()!==u.getRowCount()?null:o}static getRowIndicatorColumn(r,s,o,u,c,h){let d=new Ls(s,u);for(let p=0;p<2;p++){let w=p===0?1:-1,_=Math.trunc(Math.trunc(o.getX()));for(let T=Math.trunc(Math.trunc(o.getY()));T<=s.getMaxY()&&T>=s.getMinY();T+=w){let S=Pe.detectCodeword(r,0,r.getWidth(),u,_,T,c,h);S!=null&&(d.setCodeword(T,S),u?_=S.getStartX():_=S.getEndX())}}return d}static adjustCodewordCount(r,s){let o=s[0][1],u=o.getValue(),c=r.getBarcodeColumnCount()*r.getBarcodeRowCount()-Pe.getNumberOfECCodeWords(r.getBarcodeECLevel());if(u.length===0){if(c<1||c>ve.MAX_CODEWORDS_IN_BARCODE)throw ee.getNotFoundInstance();o.setValue(c)}else u[0]!==c&&o.setValue(c)}static createDecoderResult(r){let s=Pe.createBarcodeMatrix(r);Pe.adjustCodewordCount(r,s);let o=new Array,u=new Int32Array(r.getBarcodeRowCount()*r.getBarcodeColumnCount()),c=[],h=new Array;for(let p=0;p<r.getBarcodeRowCount();p++)for(let w=0;w<r.getBarcodeColumnCount();w++){let _=s[p][w+1].getValue(),T=p*r.getBarcodeColumnCount()+w;_.length===0?o.push(T):_.length===1?u[T]=_[0]:(h.push(T),c.push(_))}let d=new Array(c.length);for(let p=0;p<d.length;p++)d[p]=c[p];return Pe.createDecoderResultFromAmbiguousValues(r.getBarcodeECLevel(),u,ve.toIntArray(o),ve.toIntArray(h),d)}static createDecoderResultFromAmbiguousValues(r,s,o,u,c){let h=new Int32Array(u.length),d=100;for(;d-- >0;){for(let p=0;p<h.length;p++)s[u[p]]=c[p][h[p]];try{return Pe.decodeCodewords(s,r,o)}catch(p){if(!(p instanceof V))throw p}if(h.length===0)throw V.getChecksumInstance();for(let p=0;p<h.length;p++)if(h[p]<c[p].length-1){h[p]++;break}else if(h[p]=0,p===h.length-1)throw V.getChecksumInstance()}throw V.getChecksumInstance()}static createBarcodeMatrix(r){let s=Array.from({length:r.getBarcodeRowCount()},()=>new Array(r.getBarcodeColumnCount()+2));for(let u=0;u<s.length;u++)for(let c=0;c<s[u].length;c++)s[u][c]=new Gi;let o=0;for(let u of r.getDetectionResultColumns()){if(u!=null){for(let c of u.getCodewords())if(c!=null){let h=c.getRowNumber();if(h>=0){if(h>=s.length)continue;s[h][o].setValue(c.getValue())}}}o++}return s}static isValidBarcodeColumn(r,s){return s>=0&&s<=r.getBarcodeColumnCount()+1}static getStartColumn(r,s,o,u){let c=u?1:-1,h=null;if(Pe.isValidBarcodeColumn(r,s-c)&&(h=r.getDetectionResultColumn(s-c).getCodeword(o)),h!=null)return u?h.getEndX():h.getStartX();if(h=r.getDetectionResultColumn(s).getCodewordNearby(o),h!=null)return u?h.getStartX():h.getEndX();if(Pe.isValidBarcodeColumn(r,s-c)&&(h=r.getDetectionResultColumn(s-c).getCodewordNearby(o)),h!=null)return u?h.getEndX():h.getStartX();let d=0;for(;Pe.isValidBarcodeColumn(r,s-c);){s-=c;for(let p of r.getDetectionResultColumn(s).getCodewords())if(p!=null)return(u?p.getEndX():p.getStartX())+c*d*(p.getEndX()-p.getStartX());d++}return u?r.getBoundingBox().getMinX():r.getBoundingBox().getMaxX()}static detectCodeword(r,s,o,u,c,h,d,p){c=Pe.adjustCodewordStartColumn(r,s,o,u,c,h);let w=Pe.getModuleBitCount(r,s,o,u,c,h);if(w==null)return null;let _,T=Fe.sum(w);if(u)_=c+T;else{for(let z=0;z<w.length/2;z++){let W=w[z];w[z]=w[w.length-1-z],w[w.length-1-z]=W}_=c,c=_-T}if(!Pe.checkCodewordSkew(T,d,p))return null;let S=In.getDecodedValue(w),M=ve.getCodeword(S);return M===-1?null:new Wi(c,_,Pe.getCodewordBucketNumber(S),M)}static getModuleBitCount(r,s,o,u,c,h){let d=c,p=new Int32Array(8),w=0,_=u?1:-1,T=u;for(;(u?d<o:d>=s)&&w<p.length;)r.get(d,h)===T?(p[w]++,d+=_):(w++,T=!T);return w===p.length||d===(u?o:s)&&w===p.length-1?p:null}static getNumberOfECCodeWords(r){return 2<<r}static adjustCodewordStartColumn(r,s,o,u,c,h){let d=c,p=u?-1:1;for(let w=0;w<2;w++){for(;(u?d>=s:d<o)&&u===r.get(d,h);){if(Math.abs(c-d)>Pe.CODEWORD_SKEW_SIZE)return c;d+=p}p=-p,u=!u}return d}static checkCodewordSkew(r,s,o){return s-Pe.CODEWORD_SKEW_SIZE<=r&&r<=o+Pe.CODEWORD_SKEW_SIZE}static decodeCodewords(r,s,o){if(r.length===0)throw N.getFormatInstance();let u=1<<s+1,c=Pe.correctErrors(r,o,u);Pe.verifyCodewordCount(r,u);let h=Z.decode(r,""+s);return h.setErrorsCorrected(c),h.setErasures(o.length),h}static correctErrors(r,s,o){if(s!=null&&s.length>o/2+Pe.MAX_ERRORS||o<0||o>Pe.MAX_EC_CODEWORDS)throw V.getChecksumInstance();return Pe.errorCorrection.decode(r,o,s)}static verifyCodewordCount(r,s){if(r.length<4)throw N.getFormatInstance();let o=r[0];if(o>r.length)throw N.getFormatInstance();if(o===0)if(s<r.length)r[0]=r.length-s;else throw N.getFormatInstance()}static getBitCountForCodeword(r){let s=new Int32Array(8),o=0,u=s.length-1;for(;!((r&1)!==o&&(o=r&1,u--,u<0));)s[u]++,r>>=1;return s}static getCodewordBucketNumber(r){return r instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(r):this.getCodewordBucketNumber_number(r)}static getCodewordBucketNumber_number(r){return Pe.getCodewordBucketNumber(Pe.getBitCountForCodeword(r))}static getCodewordBucketNumber_Int32Array(r){return(r[0]-r[2]+r[4]-r[6]+9)%9}static toString(r){let s=new zi;for(let o=0;o<r.length;o++){s.format("Row %2d: ",o);for(let u=0;u<r[o].length;u++){let c=r[o][u];c.getValue().length===0?s.format("        ",null):s.format("%4d(%2d)",c.getValue()[0],c.getConfidence(c.getValue()[0]))}s.format("%n")}return s.toString()}}Pe.CODEWORD_SKEW_SIZE=2,Pe.MAX_ERRORS=3,Pe.MAX_EC_CODEWORDS=512,Pe.errorCorrection=new Et;class Xt{decode(r,s=null){let o=Xt.decode(r,s,!1);if(o==null||o.length===0||o[0]==null)throw ee.getNotFoundInstance();return o[0]}decodeMultiple(r,s=null){try{return Xt.decode(r,s,!0)}catch(o){throw o instanceof N||o instanceof V?ee.getNotFoundInstance():o}}static decode(r,s,o){const u=new Array,c=be.detectMultiple(r,s,o);for(const h of c.getPoints()){const d=Pe.decode(c.getBits(),h[4],h[5],h[6],h[7],Xt.getMinCodewordWidth(h),Xt.getMaxCodewordWidth(h)),p=new ut(d.getText(),d.getRawBytes(),void 0,h,Ee.PDF_417);p.putMetadata(kt.ERROR_CORRECTION_LEVEL,d.getECLevel());const w=d.getOther();w!=null&&p.putMetadata(kt.PDF417_EXTRA_METADATA,w),u.push(p)}return u.map(h=>h)}static getMaxWidth(r,s){return r==null||s==null?0:Math.trunc(Math.abs(r.getX()-s.getX()))}static getMinWidth(r,s){return r==null||s==null?B.MAX_VALUE:Math.trunc(Math.abs(r.getX()-s.getX()))}static getMaxCodewordWidth(r){return Math.floor(Math.max(Math.max(Xt.getMaxWidth(r[0],r[4]),Xt.getMaxWidth(r[6],r[2])*ve.MODULES_IN_CODEWORD/ve.MODULES_IN_STOP_PATTERN),Math.max(Xt.getMaxWidth(r[1],r[5]),Xt.getMaxWidth(r[7],r[3])*ve.MODULES_IN_CODEWORD/ve.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(r){return Math.floor(Math.min(Math.min(Xt.getMinWidth(r[0],r[4]),Xt.getMinWidth(r[6],r[2])*ve.MODULES_IN_CODEWORD/ve.MODULES_IN_STOP_PATTERN),Math.min(Xt.getMinWidth(r[1],r[5]),Xt.getMinWidth(r[7],r[3])*ve.MODULES_IN_CODEWORD/ve.MODULES_IN_STOP_PATTERN)))}reset(){}}class mi extends m{}mi.kind="ReaderException";class Aa{constructor(r,s){this.verbose=r===!0,s&&this.setHints(s)}decode(r,s){return s&&this.setHints(s),this.decodeInternal(r)}decodeWithState(r){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(r)}setHints(r){this.hints=r;const s=!i(r)&&r.get(se.TRY_HARDER)===!0,o=i(r)?null:r.get(se.POSSIBLE_FORMATS),u=new Array;if(!i(o)){const c=o.some(h=>h===Ee.UPC_A||h===Ee.UPC_E||h===Ee.EAN_13||h===Ee.EAN_8||h===Ee.CODABAR||h===Ee.CODE_39||h===Ee.CODE_93||h===Ee.CODE_128||h===Ee.ITF||h===Ee.RSS_14||h===Ee.RSS_EXPANDED);c&&!s&&u.push(new gi(r,this.verbose)),o.includes(Ee.QR_CODE)&&u.push(new yr),o.includes(Ee.DATA_MATRIX)&&u.push(new Ke),o.includes(Ee.AZTEC)&&u.push(new so),o.includes(Ee.PDF_417)&&u.push(new Xt),c&&s&&u.push(new gi(r,this.verbose))}u.length===0&&(s||u.push(new gi(r,this.verbose)),u.push(new yr),u.push(new Ke),u.push(new so),u.push(new Xt),s&&u.push(new gi(r,this.verbose))),this.readers=u}reset(){if(this.readers!==null)for(const r of this.readers)r.reset()}decodeInternal(r){if(this.readers===null)throw new mi("No readers where selected, nothing can be read.");for(const s of this.readers)try{return s.decode(r,this.hints)}catch(o){if(o instanceof mi)continue}throw new ee("No MultiFormat Readers were able to detect the code.")}}class Ql extends On{constructor(r=null,s=500){const o=new Aa;o.setHints(r),super(o,s)}decodeBitmap(r){return this.reader.decodeWithState(r)}}class yi extends On{constructor(r=500){super(new Xt,r)}}class Zl extends On{constructor(r=500){super(new yr,r)}}var po;(function(I){I[I.ERROR_CORRECTION=0]="ERROR_CORRECTION",I[I.CHARACTER_SET=1]="CHARACTER_SET",I[I.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",I[I.MIN_SIZE=3]="MIN_SIZE",I[I.MAX_SIZE=4]="MAX_SIZE",I[I.MARGIN=5]="MARGIN",I[I.PDF417_COMPACT=6]="PDF417_COMPACT",I[I.PDF417_COMPACTION=7]="PDF417_COMPACTION",I[I.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",I[I.AZTEC_LAYERS=9]="AZTEC_LAYERS",I[I.QR_VERSION=10]="QR_VERSION"})(po||(po={}));var Lt=po;class mo{constructor(r){this.field=r,this.cachedGenerators=[],this.cachedGenerators.push(new An(r,Int32Array.from([1])))}buildGenerator(r){const s=this.cachedGenerators;if(r>=s.length){let o=s[s.length-1];const u=this.field;for(let c=s.length;c<=r;c++){const h=o.multiply(new An(u,Int32Array.from([1,u.exp(c-1+u.getGeneratorBase())])));s.push(h),o=h}}return s[r]}encode(r,s){if(s===0)throw new v("No error correction bytes");const o=r.length-s;if(o<=0)throw new v("No data bytes provided");const u=this.buildGenerator(s),c=new Int32Array(o);X.arraycopy(r,0,c,0,o);let h=new An(this.field,c);h=h.multiplyByMonomial(s,1);const p=h.divide(u)[1].getCoefficients(),w=s-p.length;for(let _=0;_<w;_++)r[o+_]=0;X.arraycopy(p,0,r,o+w,p.length)}}class dt{constructor(){}static applyMaskPenaltyRule1(r){return dt.applyMaskPenaltyRule1Internal(r,!0)+dt.applyMaskPenaltyRule1Internal(r,!1)}static applyMaskPenaltyRule2(r){let s=0;const o=r.getArray(),u=r.getWidth(),c=r.getHeight();for(let h=0;h<c-1;h++){const d=o[h];for(let p=0;p<u-1;p++){const w=d[p];w===d[p+1]&&w===o[h+1][p]&&w===o[h+1][p+1]&&s++}}return dt.N2*s}static applyMaskPenaltyRule3(r){let s=0;const o=r.getArray(),u=r.getWidth(),c=r.getHeight();for(let h=0;h<c;h++)for(let d=0;d<u;d++){const p=o[h];d+6<u&&p[d]===1&&p[d+1]===0&&p[d+2]===1&&p[d+3]===1&&p[d+4]===1&&p[d+5]===0&&p[d+6]===1&&(dt.isWhiteHorizontal(p,d-4,d)||dt.isWhiteHorizontal(p,d+7,d+11))&&s++,h+6<c&&o[h][d]===1&&o[h+1][d]===0&&o[h+2][d]===1&&o[h+3][d]===1&&o[h+4][d]===1&&o[h+5][d]===0&&o[h+6][d]===1&&(dt.isWhiteVertical(o,d,h-4,h)||dt.isWhiteVertical(o,d,h+7,h+11))&&s++}return s*dt.N3}static isWhiteHorizontal(r,s,o){s=Math.max(s,0),o=Math.min(o,r.length);for(let u=s;u<o;u++)if(r[u]===1)return!1;return!0}static isWhiteVertical(r,s,o,u){o=Math.max(o,0),u=Math.min(u,r.length);for(let c=o;c<u;c++)if(r[c][s]===1)return!1;return!0}static applyMaskPenaltyRule4(r){let s=0;const o=r.getArray(),u=r.getWidth(),c=r.getHeight();for(let p=0;p<c;p++){const w=o[p];for(let _=0;_<u;_++)w[_]===1&&s++}const h=r.getHeight()*r.getWidth();return Math.floor(Math.abs(s*2-h)*10/h)*dt.N4}static getDataMaskBit(r,s,o){let u,c;switch(r){case 0:u=o+s&1;break;case 1:u=o&1;break;case 2:u=s%3;break;case 3:u=(o+s)%3;break;case 4:u=Math.floor(o/2)+Math.floor(s/3)&1;break;case 5:c=o*s,u=(c&1)+c%3;break;case 6:c=o*s,u=(c&1)+c%3&1;break;case 7:c=o*s,u=c%3+(o+s&1)&1;break;default:throw new v("Invalid mask pattern: "+r)}return u===0}static applyMaskPenaltyRule1Internal(r,s){let o=0;const u=s?r.getHeight():r.getWidth(),c=s?r.getWidth():r.getHeight(),h=r.getArray();for(let d=0;d<u;d++){let p=0,w=-1;for(let _=0;_<c;_++){const T=s?h[d][_]:h[_][d];T===w?p++:(p>=5&&(o+=dt.N1+(p-5)),p=1,w=T)}p>=5&&(o+=dt.N1+(p-5))}return o}}dt.N1=3,dt.N2=3,dt.N3=40,dt.N4=10;class an{constructor(r,s){this.width=r,this.height=s;const o=new Array(s);for(let u=0;u!==s;u++)o[u]=new Uint8Array(r);this.bytes=o}getHeight(){return this.height}getWidth(){return this.width}get(r,s){return this.bytes[s][r]}getArray(){return this.bytes}setNumber(r,s,o){this.bytes[s][r]=o}setBoolean(r,s,o){this.bytes[s][r]=o?1:0}clear(r){for(const s of this.bytes)k.fill(s,r)}equals(r){if(!(r instanceof an))return!1;const s=r;if(this.width!==s.width||this.height!==s.height)return!1;for(let o=0,u=this.height;o<u;++o){const c=this.bytes[o],h=s.bytes[o];for(let d=0,p=this.width;d<p;++d)if(c[d]!==h[d])return!1}return!0}toString(){const r=new L;for(let s=0,o=this.height;s<o;++s){const u=this.bytes[s];for(let c=0,h=this.width;c<h;++c)switch(u[c]){case 0:r.append(" 0");break;case 1:r.append(" 1");break;default:r.append("  ");break}r.append(`
`)}return r.toString()}}class Yr{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const r=new L;return r.append(`<<
`),r.append(" mode: "),r.append(this.mode?this.mode.toString():"null"),r.append(`
 ecLevel: `),r.append(this.ecLevel?this.ecLevel.toString():"null"),r.append(`
 version: `),r.append(this.version?this.version.toString():"null"),r.append(`
 maskPattern: `),r.append(this.maskPattern.toString()),this.matrix?(r.append(`
 matrix:
`),r.append(this.matrix.toString())):r.append(`
 matrix: null
`),r.append(`>>
`),r.toString()}setMode(r){this.mode=r}setECLevel(r){this.ecLevel=r}setVersion(r){this.version=r}setMaskPattern(r){this.maskPattern=r}setMatrix(r){this.matrix=r}static isValidMaskPattern(r){return r>=0&&r<Yr.NUM_MASK_PATTERNS}}Yr.NUM_MASK_PATTERNS=8;class ot extends m{}ot.kind="WriterException";class Ae{constructor(){}static clearMatrix(r){r.clear(255)}static buildMatrix(r,s,o,u,c){Ae.clearMatrix(c),Ae.embedBasicPatterns(o,c),Ae.embedTypeInfo(s,u,c),Ae.maybeEmbedVersionInfo(o,c),Ae.embedDataBits(r,u,c)}static embedBasicPatterns(r,s){Ae.embedPositionDetectionPatternsAndSeparators(s),Ae.embedDarkDotAtLeftBottomCorner(s),Ae.maybeEmbedPositionAdjustmentPatterns(r,s),Ae.embedTimingPatterns(s)}static embedTypeInfo(r,s,o){const u=new $;Ae.makeTypeInfoBits(r,s,u);for(let c=0,h=u.getSize();c<h;++c){const d=u.get(u.getSize()-1-c),p=Ae.TYPE_INFO_COORDINATES[c],w=p[0],_=p[1];if(o.setBoolean(w,_,d),c<8){const T=o.getWidth()-c-1,S=8;o.setBoolean(T,S,d)}else{const S=o.getHeight()-7+(c-8);o.setBoolean(8,S,d)}}}static maybeEmbedVersionInfo(r,s){if(r.getVersionNumber()<7)return;const o=new $;Ae.makeVersionInfoBits(r,o);let u=6*3-1;for(let c=0;c<6;++c)for(let h=0;h<3;++h){const d=o.get(u);u--,s.setBoolean(c,s.getHeight()-11+h,d),s.setBoolean(s.getHeight()-11+h,c,d)}}static embedDataBits(r,s,o){let u=0,c=-1,h=o.getWidth()-1,d=o.getHeight()-1;for(;h>0;){for(h===6&&(h-=1);d>=0&&d<o.getHeight();){for(let p=0;p<2;++p){const w=h-p;if(!Ae.isEmpty(o.get(w,d)))continue;let _;u<r.getSize()?(_=r.get(u),++u):_=!1,s!==255&&dt.getDataMaskBit(s,w,d)&&(_=!_),o.setBoolean(w,d,_)}d+=c}c=-c,d+=c,h-=2}if(u!==r.getSize())throw new ot("Not all bits consumed: "+u+"/"+r.getSize())}static findMSBSet(r){return 32-B.numberOfLeadingZeros(r)}static calculateBCHCode(r,s){if(s===0)throw new v("0 polynomial");const o=Ae.findMSBSet(s);for(r<<=o-1;Ae.findMSBSet(r)>=o;)r^=s<<Ae.findMSBSet(r)-o;return r}static makeTypeInfoBits(r,s,o){if(!Yr.isValidMaskPattern(s))throw new ot("Invalid mask pattern");const u=r.getBits()<<3|s;o.appendBits(u,5);const c=Ae.calculateBCHCode(u,Ae.TYPE_INFO_POLY);o.appendBits(c,10);const h=new $;if(h.appendBits(Ae.TYPE_INFO_MASK_PATTERN,15),o.xor(h),o.getSize()!==15)throw new ot("should not happen but we got: "+o.getSize())}static makeVersionInfoBits(r,s){s.appendBits(r.getVersionNumber(),6);const o=Ae.calculateBCHCode(r.getVersionNumber(),Ae.VERSION_INFO_POLY);if(s.appendBits(o,12),s.getSize()!==18)throw new ot("should not happen but we got: "+s.getSize())}static isEmpty(r){return r===255}static embedTimingPatterns(r){for(let s=8;s<r.getWidth()-8;++s){const o=(s+1)%2;Ae.isEmpty(r.get(s,6))&&r.setNumber(s,6,o),Ae.isEmpty(r.get(6,s))&&r.setNumber(6,s,o)}}static embedDarkDotAtLeftBottomCorner(r){if(r.get(8,r.getHeight()-8)===0)throw new ot;r.setNumber(8,r.getHeight()-8,1)}static embedHorizontalSeparationPattern(r,s,o){for(let u=0;u<8;++u){if(!Ae.isEmpty(o.get(r+u,s)))throw new ot;o.setNumber(r+u,s,0)}}static embedVerticalSeparationPattern(r,s,o){for(let u=0;u<7;++u){if(!Ae.isEmpty(o.get(r,s+u)))throw new ot;o.setNumber(r,s+u,0)}}static embedPositionAdjustmentPattern(r,s,o){for(let u=0;u<5;++u){const c=Ae.POSITION_ADJUSTMENT_PATTERN[u];for(let h=0;h<5;++h)o.setNumber(r+h,s+u,c[h])}}static embedPositionDetectionPattern(r,s,o){for(let u=0;u<7;++u){const c=Ae.POSITION_DETECTION_PATTERN[u];for(let h=0;h<7;++h)o.setNumber(r+h,s+u,c[h])}}static embedPositionDetectionPatternsAndSeparators(r){const s=Ae.POSITION_DETECTION_PATTERN[0].length;Ae.embedPositionDetectionPattern(0,0,r),Ae.embedPositionDetectionPattern(r.getWidth()-s,0,r),Ae.embedPositionDetectionPattern(0,r.getWidth()-s,r);const o=8;Ae.embedHorizontalSeparationPattern(0,o-1,r),Ae.embedHorizontalSeparationPattern(r.getWidth()-o,o-1,r),Ae.embedHorizontalSeparationPattern(0,r.getWidth()-o,r);const u=7;Ae.embedVerticalSeparationPattern(u,0,r),Ae.embedVerticalSeparationPattern(r.getHeight()-u-1,0,r),Ae.embedVerticalSeparationPattern(u,r.getHeight()-u,r)}static maybeEmbedPositionAdjustmentPatterns(r,s){if(r.getVersionNumber()<2)return;const o=r.getVersionNumber()-1,u=Ae.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[o];for(let c=0,h=u.length;c!==h;c++){const d=u[c];if(d>=0)for(let p=0;p!==h;p++){const w=u[p];w>=0&&Ae.isEmpty(s.get(w,d))&&Ae.embedPositionAdjustmentPattern(w-2,d-2,s)}}}}Ae.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),Ae.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),Ae.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),Ae.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),Ae.VERSION_INFO_POLY=7973,Ae.TYPE_INFO_POLY=1335,Ae.TYPE_INFO_MASK_PATTERN=21522;class g{constructor(r,s){this.dataBytes=r,this.errorCorrectionBytes=s}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class E{constructor(){}static calculateMaskPenalty(r){return dt.applyMaskPenaltyRule1(r)+dt.applyMaskPenaltyRule2(r)+dt.applyMaskPenaltyRule3(r)+dt.applyMaskPenaltyRule4(r)}static encode(r,s,o=null){let u=E.DEFAULT_BYTE_MODE_ENCODING;const c=o!==null&&o.get(Lt.CHARACTER_SET)!==void 0;c&&(u=o.get(Lt.CHARACTER_SET).toString());const h=this.chooseMode(r,u),d=new $;if(h===Ce.BYTE&&(c||E.DEFAULT_BYTE_MODE_ENCODING!==u)){const ue=b.getCharacterSetECIByName(u);ue!==void 0&&this.appendECI(ue,d)}this.appendModeInfo(h,d);const p=new $;this.appendBytes(r,h,p,u);let w;if(o!==null&&o.get(Lt.QR_VERSION)!==void 0){const ue=Number.parseInt(o.get(Lt.QR_VERSION).toString(),10);w=_e.getVersionForNumber(ue);const oe=this.calculateBitsNeeded(h,d,p,w);if(!this.willFit(oe,w,s))throw new ot("Data too big for requested version")}else w=this.recommendVersion(s,h,d,p);const _=new $;_.appendBitArray(d);const T=h===Ce.BYTE?p.getSizeInBytes():r.length;this.appendLengthInfo(T,w,h,_),_.appendBitArray(p);const S=w.getECBlocksForLevel(s),M=w.getTotalCodewords()-S.getTotalECCodewords();this.terminateBits(M,_);const z=this.interleaveWithECBytes(_,w.getTotalCodewords(),M,S.getNumBlocks()),W=new Yr;W.setECLevel(s),W.setMode(h),W.setVersion(w);const q=w.getDimensionForVersion(),J=new an(q,q),le=this.chooseMaskPattern(z,s,w,J);return W.setMaskPattern(le),Ae.buildMatrix(z,s,w,le,J),W.setMatrix(J),W}static recommendVersion(r,s,o,u){const c=this.calculateBitsNeeded(s,o,u,_e.getVersionForNumber(1)),h=this.chooseVersion(c,r),d=this.calculateBitsNeeded(s,o,u,h);return this.chooseVersion(d,r)}static calculateBitsNeeded(r,s,o,u){return s.getSize()+r.getCharacterCountBits(u)+o.getSize()}static getAlphanumericCode(r){return r<E.ALPHANUMERIC_TABLE.length?E.ALPHANUMERIC_TABLE[r]:-1}static chooseMode(r,s=null){if(b.SJIS.getName()===s&&this.isOnlyDoubleByteKanji(r))return Ce.KANJI;let o=!1,u=!1;for(let c=0,h=r.length;c<h;++c){const d=r.charAt(c);if(E.isDigit(d))o=!0;else if(this.getAlphanumericCode(d.charCodeAt(0))!==-1)u=!0;else return Ce.BYTE}return u?Ce.ALPHANUMERIC:o?Ce.NUMERIC:Ce.BYTE}static isOnlyDoubleByteKanji(r){let s;try{s=U.encode(r,b.SJIS)}catch{return!1}const o=s.length;if(o%2!==0)return!1;for(let u=0;u<o;u+=2){const c=s[u]&255;if((c<129||c>159)&&(c<224||c>235))return!1}return!0}static chooseMaskPattern(r,s,o,u){let c=Number.MAX_SAFE_INTEGER,h=-1;for(let d=0;d<Yr.NUM_MASK_PATTERNS;d++){Ae.buildMatrix(r,s,o,d,u);let p=this.calculateMaskPenalty(u);p<c&&(c=p,h=d)}return h}static chooseVersion(r,s){for(let o=1;o<=40;o++){const u=_e.getVersionForNumber(o);if(E.willFit(r,u,s))return u}throw new ot("Data too big")}static willFit(r,s,o){const u=s.getTotalCodewords(),h=s.getECBlocksForLevel(o).getTotalECCodewords(),d=u-h,p=(r+7)/8;return d>=p}static terminateBits(r,s){const o=r*8;if(s.getSize()>o)throw new ot("data bits cannot fit in the QR Code"+s.getSize()+" > "+o);for(let h=0;h<4&&s.getSize()<o;++h)s.appendBit(!1);const u=s.getSize()&7;if(u>0)for(let h=u;h<8;h++)s.appendBit(!1);const c=r-s.getSizeInBytes();for(let h=0;h<c;++h)s.appendBits(h&1?17:236,8);if(s.getSize()!==o)throw new ot("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(r,s,o,u,c,h){if(u>=o)throw new ot("Block ID too large");const d=r%o,p=o-d,w=Math.floor(r/o),_=w+1,T=Math.floor(s/o),S=T+1,M=w-T,z=_-S;if(M!==z)throw new ot("EC bytes mismatch");if(o!==p+d)throw new ot("RS blocks mismatch");if(r!==(T+M)*p+(S+z)*d)throw new ot("Total bytes mismatch");u<p?(c[0]=T,h[0]=M):(c[0]=S,h[0]=z)}static interleaveWithECBytes(r,s,o,u){if(r.getSizeInBytes()!==o)throw new ot("Number of bits and data bytes does not match");let c=0,h=0,d=0;const p=new Array;for(let _=0;_<u;++_){const T=new Int32Array(1),S=new Int32Array(1);E.getNumDataBytesAndNumECBytesForBlockID(s,o,u,_,T,S);const M=T[0],z=new Uint8Array(M);r.toBytes(8*c,z,0,M);const W=E.generateECBytes(z,S[0]);p.push(new g(z,W)),h=Math.max(h,M),d=Math.max(d,W.length),c+=T[0]}if(o!==c)throw new ot("Data bytes does not match offset");const w=new $;for(let _=0;_<h;++_)for(const T of p){const S=T.getDataBytes();_<S.length&&w.appendBits(S[_],8)}for(let _=0;_<d;++_)for(const T of p){const S=T.getErrorCorrectionBytes();_<S.length&&w.appendBits(S[_],8)}if(s!==w.getSizeInBytes())throw new ot("Interleaving error: "+s+" and "+w.getSizeInBytes()+" differ.");return w}static generateECBytes(r,s){const o=r.length,u=new Int32Array(o+s);for(let h=0;h<o;h++)u[h]=r[h]&255;new mo(je.QR_CODE_FIELD_256).encode(u,s);const c=new Uint8Array(s);for(let h=0;h<s;h++)c[h]=u[o+h];return c}static appendModeInfo(r,s){s.appendBits(r.getBits(),4)}static appendLengthInfo(r,s,o,u){const c=o.getCharacterCountBits(s);if(r>=1<<c)throw new ot(r+" is bigger than "+((1<<c)-1));u.appendBits(r,c)}static appendBytes(r,s,o,u){switch(s){case Ce.NUMERIC:E.appendNumericBytes(r,o);break;case Ce.ALPHANUMERIC:E.appendAlphanumericBytes(r,o);break;case Ce.BYTE:E.append8BitBytes(r,o,u);break;case Ce.KANJI:E.appendKanjiBytes(r,o);break;default:throw new ot("Invalid mode: "+s)}}static getDigit(r){return r.charCodeAt(0)-48}static isDigit(r){const s=E.getDigit(r);return s>=0&&s<=9}static appendNumericBytes(r,s){const o=r.length;let u=0;for(;u<o;){const c=E.getDigit(r.charAt(u));if(u+2<o){const h=E.getDigit(r.charAt(u+1)),d=E.getDigit(r.charAt(u+2));s.appendBits(c*100+h*10+d,10),u+=3}else if(u+1<o){const h=E.getDigit(r.charAt(u+1));s.appendBits(c*10+h,7),u+=2}else s.appendBits(c,4),u++}}static appendAlphanumericBytes(r,s){const o=r.length;let u=0;for(;u<o;){const c=E.getAlphanumericCode(r.charCodeAt(u));if(c===-1)throw new ot;if(u+1<o){const h=E.getAlphanumericCode(r.charCodeAt(u+1));if(h===-1)throw new ot;s.appendBits(c*45+h,11),u+=2}else s.appendBits(c,6),u++}}static append8BitBytes(r,s,o){let u;try{u=U.encode(r,o)}catch(c){throw new ot(c)}for(let c=0,h=u.length;c!==h;c++){const d=u[c];s.appendBits(d,8)}}static appendKanjiBytes(r,s){let o;try{o=U.encode(r,b.SJIS)}catch(c){throw new ot(c)}const u=o.length;for(let c=0;c<u;c+=2){const h=o[c]&255,d=o[c+1]&255,p=h<<8&4294967295|d;let w=-1;if(p>=33088&&p<=40956?w=p-33088:p>=57408&&p<=60351&&(w=p-49472),w===-1)throw new ot("Invalid byte sequence");const _=(w>>8)*192+(w&255);s.appendBits(_,13)}}static appendECI(r,s){s.appendBits(Ce.ECI.getBits(),4),s.appendBits(r.getValue(),8)}}E.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),E.DEFAULT_BYTE_MODE_ENCODING=b.UTF8.getName();class A{write(r,s,o,u=null){if(r.length===0)throw new v("Found empty contents");if(s<0||o<0)throw new v("Requested dimensions are too small: "+s+"x"+o);let c=Je.L,h=A.QUIET_ZONE_SIZE;u!==null&&(u.get(Lt.ERROR_CORRECTION)!==void 0&&(c=Je.fromString(u.get(Lt.ERROR_CORRECTION).toString())),u.get(Lt.MARGIN)!==void 0&&(h=Number.parseInt(u.get(Lt.MARGIN).toString(),10)));const d=E.encode(r,c,u);return this.renderResult(d,s,o,h)}writeToDom(r,s,o,u,c=null){typeof r=="string"&&(r=document.querySelector(r));const h=this.write(s,o,u,c);r&&r.appendChild(h)}renderResult(r,s,o,u){const c=r.getMatrix();if(c===null)throw new Jn;const h=c.getWidth(),d=c.getHeight(),p=h+u*2,w=d+u*2,_=Math.max(s,p),T=Math.max(o,w),S=Math.min(Math.floor(_/p),Math.floor(T/w)),M=Math.floor((_-h*S)/2),z=Math.floor((T-d*S)/2),W=this.createSVGElement(_,T);for(let q=0,J=z;q<d;q++,J+=S)for(let le=0,ue=M;le<h;le++,ue+=S)if(c.get(le,q)===1){const oe=this.createSvgRectElement(ue,J,S,S);W.appendChild(oe)}return W}createSVGElement(r,s){const o=document.createElementNS(A.SVG_NS,"svg");return o.setAttributeNS(null,"height",r.toString()),o.setAttributeNS(null,"width",s.toString()),o}createSvgRectElement(r,s,o,u){const c=document.createElementNS(A.SVG_NS,"rect");return c.setAttributeNS(null,"x",r.toString()),c.setAttributeNS(null,"y",s.toString()),c.setAttributeNS(null,"height",o.toString()),c.setAttributeNS(null,"width",u.toString()),c.setAttributeNS(null,"fill","#000000"),c}}A.QUIET_ZONE_SIZE=4,A.SVG_NS="http://www.w3.org/2000/svg";class R{encode(r,s,o,u,c){if(r.length===0)throw new v("Found empty contents");if(s!==Ee.QR_CODE)throw new v("Can only encode QR_CODE, but got "+s);if(o<0||u<0)throw new v(`Requested dimensions are too small: ${o}x${u}`);let h=Je.L,d=R.QUIET_ZONE_SIZE;c!==null&&(c.get(Lt.ERROR_CORRECTION)!==void 0&&(h=Je.fromString(c.get(Lt.ERROR_CORRECTION).toString())),c.get(Lt.MARGIN)!==void 0&&(d=Number.parseInt(c.get(Lt.MARGIN).toString(),10)));const p=E.encode(r,h,c);return R.renderResult(p,o,u,d)}static renderResult(r,s,o,u){const c=r.getMatrix();if(c===null)throw new Jn;const h=c.getWidth(),d=c.getHeight(),p=h+u*2,w=d+u*2,_=Math.max(s,p),T=Math.max(o,w),S=Math.min(Math.floor(_/p),Math.floor(T/w)),M=Math.floor((_-h*S)/2),z=Math.floor((T-d*S)/2),W=new ze(_,T);for(let q=0,J=z;q<d;q++,J+=S)for(let le=0,ue=M;le<h;le++,ue+=S)c.get(le,q)===1&&W.setRegion(ue,J,S,S);return W}}R.QUIET_ZONE_SIZE=4;class j{encode(r,s,o,u,c){let h;switch(s){case Ee.QR_CODE:h=new R;break;default:throw new v("No encoder available for format "+s)}return h.encode(r,s,o,u,c)}}class Q extends ge{constructor(r,s,o,u,c,h,d,p){if(super(h,d),this.yuvData=r,this.dataWidth=s,this.dataHeight=o,this.left=u,this.top=c,u+h>s||c+d>o)throw new v("Crop rectangle does not fit within image data.");p&&this.reverseHorizontal(h,d)}getRow(r,s){if(r<0||r>=this.getHeight())throw new v("Requested row is outside the image: "+r);const o=this.getWidth();(s==null||s.length<o)&&(s=new Uint8ClampedArray(o));const u=(r+this.top)*this.dataWidth+this.left;return X.arraycopy(this.yuvData,u,s,0,o),s}getMatrix(){const r=this.getWidth(),s=this.getHeight();if(r===this.dataWidth&&s===this.dataHeight)return this.yuvData;const o=r*s,u=new Uint8ClampedArray(o);let c=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return X.arraycopy(this.yuvData,c,u,0,o),u;for(let h=0;h<s;h++){const d=h*r;X.arraycopy(this.yuvData,c,u,d,r),c+=this.dataWidth}return u}isCropSupported(){return!0}crop(r,s,o,u){return new Q(this.yuvData,this.dataWidth,this.dataHeight,this.left+r,this.top+s,o,u,!1)}renderThumbnail(){const r=this.getWidth()/Q.THUMBNAIL_SCALE_FACTOR,s=this.getHeight()/Q.THUMBNAIL_SCALE_FACTOR,o=new Int32Array(r*s),u=this.yuvData;let c=this.top*this.dataWidth+this.left;for(let h=0;h<s;h++){const d=h*r;for(let p=0;p<r;p++){const w=u[c+p*Q.THUMBNAIL_SCALE_FACTOR]&255;o[d+p]=4278190080|w*65793}c+=this.dataWidth*Q.THUMBNAIL_SCALE_FACTOR}return o}getThumbnailWidth(){return this.getWidth()/Q.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Q.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(r,s){const o=this.yuvData;for(let u=0,c=this.top*this.dataWidth+this.left;u<s;u++,c+=this.dataWidth){const h=c+r/2;for(let d=c,p=c+r-1;d<h;d++,p--){const w=o[d];o[d]=o[p],o[p]=w}}}invert(){return new Ie(this)}}Q.THUMBNAIL_SCALE_FACTOR=2;class fe extends ge{constructor(r,s,o,u,c,h,d){if(super(s,o),this.dataWidth=u,this.dataHeight=c,this.left=h,this.top=d,r.BYTES_PER_ELEMENT===4){const p=s*o,w=new Uint8ClampedArray(p);for(let _=0;_<p;_++){const T=r[_],S=T>>16&255,M=T>>7&510,z=T&255;w[_]=(S+M+z)/4&255}this.luminances=w}else this.luminances=r;if(u===void 0&&(this.dataWidth=s),c===void 0&&(this.dataHeight=o),h===void 0&&(this.left=0),d===void 0&&(this.top=0),this.left+s>this.dataWidth||this.top+o>this.dataHeight)throw new v("Crop rectangle does not fit within image data.")}getRow(r,s){if(r<0||r>=this.getHeight())throw new v("Requested row is outside the image: "+r);const o=this.getWidth();(s==null||s.length<o)&&(s=new Uint8ClampedArray(o));const u=(r+this.top)*this.dataWidth+this.left;return X.arraycopy(this.luminances,u,s,0,o),s}getMatrix(){const r=this.getWidth(),s=this.getHeight();if(r===this.dataWidth&&s===this.dataHeight)return this.luminances;const o=r*s,u=new Uint8ClampedArray(o);let c=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return X.arraycopy(this.luminances,c,u,0,o),u;for(let h=0;h<s;h++){const d=h*r;X.arraycopy(this.luminances,c,u,d,r),c+=this.dataWidth}return u}isCropSupported(){return!0}crop(r,s,o,u){return new fe(this.luminances,o,u,this.dataWidth,this.dataHeight,this.left+r,this.top+s)}invert(){return new Ie(this)}}class Me extends b{static forName(r){return this.getCharacterSetECIByName(r)}}class bt{}bt.ISO_8859_1=b.ISO8859_1;class at{isCompact(){return this.compact}setCompact(r){this.compact=r}getSize(){return this.size}setSize(r){this.size=r}getLayers(){return this.layers}setLayers(r){this.layers=r}getCodeWords(){return this.codeWords}setCodeWords(r){this.codeWords=r}getMatrix(){return this.matrix}setMatrix(r){this.matrix=r}}class zt{static singletonList(r){return[r]}static min(r,s){return r.sort(s)[0]}}class wr{constructor(r){this.previous=r}getPrevious(){return this.previous}}class Gn extends wr{constructor(r,s,o){super(r),this.value=s,this.bitCount=o}appendTo(r,s){r.appendBits(this.value,this.bitCount)}add(r,s){return new Gn(this,r,s)}addBinaryShift(r,s){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Gn(this,r,s)}toString(){let r=this.value&(1<<this.bitCount)-1;return r|=1<<this.bitCount,"<"+B.toBinaryString(r|1<<this.bitCount).substring(1)+">"}}class xr extends Gn{constructor(r,s,o){super(r,0,0),this.binaryShiftStart=s,this.binaryShiftByteCount=o}appendTo(r,s){for(let o=0;o<this.binaryShiftByteCount;o++)(o===0||o===31&&this.binaryShiftByteCount<=62)&&(r.appendBits(31,5),this.binaryShiftByteCount>62?r.appendBits(this.binaryShiftByteCount-31,16):o===0?r.appendBits(Math.min(this.binaryShiftByteCount,31),5):r.appendBits(this.binaryShiftByteCount-31,5)),r.appendBits(s[this.binaryShiftStart+o],8)}addBinaryShift(r,s){return new xr(this,r,s)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function Qr(I,r,s){return new xr(I,r,s)}function Zr(I,r,s){return new Gn(I,r,s)}const Ca=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Xi=0,$l=1,Er=2,$d=3,$r=4,bw=new Gn(null,0,0),gh=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,655360+928+30]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,655360+928+30]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,917504+14336+928+30]),Int32Array.from([(5<<16)+29,(5<<16)+28,655360+928+30,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,655360+992+28,655360+992+30,655360+992+29,0])];function Dw(I){for(let r of I)k.fill(r,-1);return I[Xi][$r]=0,I[$l][$r]=0,I[$l][Xi]=28,I[$d][$r]=0,I[Er][$r]=0,I[Er][Xi]=15,I}const Jd=Dw(k.createInt32Array(6,6));class Jr{constructor(r,s,o,u){this.token=r,this.mode=s,this.binaryShiftByteCount=o,this.bitCount=u}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(r,s){let o=this.bitCount,u=this.token;if(r!==this.mode){let h=gh[this.mode][r];u=Zr(u,h&65535,h>>16),o+=h>>16}let c=r===Er?4:5;return u=Zr(u,s,c),new Jr(u,r,0,o+c)}shiftAndAppend(r,s){let o=this.token,u=this.mode===Er?4:5;return o=Zr(o,Jd[this.mode][r],u),o=Zr(o,s,5),new Jr(o,this.mode,0,this.bitCount+u+5)}addBinaryShiftChar(r){let s=this.token,o=this.mode,u=this.bitCount;if(this.mode===$r||this.mode===Er){let d=gh[o][Xi];s=Zr(s,d&65535,d>>16),u+=d>>16,o=Xi}let c=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,h=new Jr(s,o,this.binaryShiftByteCount+1,u+c);return h.binaryShiftByteCount===2047+31&&(h=h.endBinaryShift(r+1)),h}endBinaryShift(r){if(this.binaryShiftByteCount===0)return this;let s=this.token;return s=Qr(s,r-this.binaryShiftByteCount,this.binaryShiftByteCount),new Jr(s,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(r){let s=this.bitCount+(gh[this.mode][r.mode]>>16);return this.binaryShiftByteCount<r.binaryShiftByteCount?s+=Jr.calculateBinaryShiftCost(r)-Jr.calculateBinaryShiftCost(this):this.binaryShiftByteCount>r.binaryShiftByteCount&&r.binaryShiftByteCount>0&&(s+=10),s<=r.bitCount}toBitArray(r){let s=[];for(let u=this.endBinaryShift(r.length).token;u!==null;u=u.getPrevious())s.unshift(u);let o=new $;for(const u of s)u.appendTo(o,r);return o}toString(){return G.format("%s bits=%d bytes=%d",Ca[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(r){return r.binaryShiftByteCount>62?21:r.binaryShiftByteCount>31?20:r.binaryShiftByteCount>0?10:0}}Jr.INITIAL_STATE=new Jr(bw,Xi,0,0);function Ow(I){const r=G.getCharCode(" "),s=G.getCharCode("."),o=G.getCharCode(",");I[Xi][r]=1;const u=G.getCharCode("Z"),c=G.getCharCode("A");for(let S=c;S<=u;S++)I[Xi][S]=S-c+2;I[$l][r]=1;const h=G.getCharCode("z"),d=G.getCharCode("a");for(let S=d;S<=h;S++)I[$l][S]=S-d+2;I[Er][r]=1;const p=G.getCharCode("9"),w=G.getCharCode("0");for(let S=w;S<=p;S++)I[Er][S]=S-w+2;I[Er][o]=12,I[Er][s]=13;const _=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let S=0;S<_.length;S++)I[$d][G.getCharCode(_[S])]=S;const T=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let S=0;S<T.length;S++)G.getCharCode(T[S])>0&&(I[$r][G.getCharCode(T[S])]=S);return I}const ph=Ow(k.createInt32Array(5,256));class Ia{constructor(r){this.text=r}encode(){const r=G.getCharCode(" "),s=G.getCharCode(`
`);let o=zt.singletonList(Jr.INITIAL_STATE);for(let c=0;c<this.text.length;c++){let h,d=c+1<this.text.length?this.text[c+1]:0;switch(this.text[c]){case G.getCharCode("\r"):h=d===s?2:0;break;case G.getCharCode("."):h=d===r?3:0;break;case G.getCharCode(","):h=d===r?4:0;break;case G.getCharCode(":"):h=d===r?5:0;break;default:h=0}h>0?(o=Ia.updateStateListForPair(o,c,h),c++):o=this.updateStateListForChar(o,c)}return zt.min(o,(c,h)=>c.getBitCount()-h.getBitCount()).toBitArray(this.text)}updateStateListForChar(r,s){const o=[];for(let u of r)this.updateStateForChar(u,s,o);return Ia.simplifyStates(o)}updateStateForChar(r,s,o){let u=this.text[s]&255,c=ph[r.getMode()][u]>0,h=null;for(let d=0;d<=$r;d++){let p=ph[d][u];if(p>0){if(h==null&&(h=r.endBinaryShift(s)),!c||d===r.getMode()||d===Er){const w=h.latchAndAppend(d,p);o.push(w)}if(!c&&Jd[r.getMode()][d]>=0){const w=h.shiftAndAppend(d,p);o.push(w)}}}if(r.getBinaryShiftByteCount()>0||ph[r.getMode()][u]===0){let d=r.addBinaryShiftChar(s);o.push(d)}}static updateStateListForPair(r,s,o){const u=[];for(let c of r)this.updateStateForPair(c,s,o,u);return this.simplifyStates(u)}static updateStateForPair(r,s,o,u){let c=r.endBinaryShift(s);if(u.push(c.latchAndAppend($r,o)),r.getMode()!==$r&&u.push(c.shiftAndAppend($r,o)),o===3||o===4){let h=c.latchAndAppend(Er,16-o).latchAndAppend(Er,1);u.push(h)}if(r.getBinaryShiftByteCount()>0){let h=r.addBinaryShiftChar(s).addBinaryShiftChar(s+1);u.push(h)}}static simplifyStates(r){let s=[];for(const o of r){let u=!0;for(const c of s){if(c.isBetterThanOrEqualTo(o)){u=!1;break}o.isBetterThanOrEqualTo(c)&&(s=s.filter(h=>h!==c))}u&&s.push(o)}return s}}class Ze{constructor(){}static encodeBytes(r){return Ze.encode(r,Ze.DEFAULT_EC_PERCENT,Ze.DEFAULT_AZTEC_LAYERS)}static encode(r,s,o){let u=new Ia(r).encode(),c=B.truncDivision(u.getSize()*s,100)+11,h=u.getSize()+c,d,p,w,_,T;if(o!==Ze.DEFAULT_AZTEC_LAYERS){if(d=o<0,p=Math.abs(o),p>(d?Ze.MAX_NB_BITS_COMPACT:Ze.MAX_NB_BITS))throw new v(G.format("Illegal value %s for layers",o));w=Ze.totalBitsInLayer(p,d),_=Ze.WORD_SIZE[p];let oe=w-w%_;if(T=Ze.stuffBits(u,_),T.getSize()+c>oe)throw new v("Data to large for user specified layer");if(d&&T.getSize()>_*64)throw new v("Data to large for user specified layer")}else{_=0,T=null;for(let oe=0;;oe++){if(oe>Ze.MAX_NB_BITS)throw new v("Data too large for an Aztec code");if(d=oe<=3,p=d?oe+1:oe,w=Ze.totalBitsInLayer(p,d),h>w)continue;(T==null||_!==Ze.WORD_SIZE[p])&&(_=Ze.WORD_SIZE[p],T=Ze.stuffBits(u,_));let He=w-w%_;if(!(d&&T.getSize()>_*64)&&T.getSize()+c<=He)break}}let S=Ze.generateCheckWords(T,w,_),M=T.getSize()/_,z=Ze.generateModeMessage(d,p,M),W=(d?11:14)+p*4,q=new Int32Array(W),J;if(d){J=W;for(let oe=0;oe<q.length;oe++)q[oe]=oe}else{J=W+1+2*B.truncDivision(B.truncDivision(W,2)-1,15);let oe=B.truncDivision(W,2),He=B.truncDivision(J,2);for(let ke=0;ke<oe;ke++){let Wn=ke+B.truncDivision(ke,15);q[oe-ke-1]=He-Wn-1,q[oe+ke]=He+Wn+1}}let le=new ze(J);for(let oe=0,He=0;oe<p;oe++){let ke=(p-oe)*4+(d?9:12);for(let Wn=0;Wn<ke;Wn++){let kr=Wn*2;for(let jn=0;jn<2;jn++)S.get(He+kr+jn)&&le.set(q[oe*2+jn],q[oe*2+Wn]),S.get(He+ke*2+kr+jn)&&le.set(q[oe*2+Wn],q[W-1-oe*2-jn]),S.get(He+ke*4+kr+jn)&&le.set(q[W-1-oe*2-jn],q[W-1-oe*2-Wn]),S.get(He+ke*6+kr+jn)&&le.set(q[W-1-oe*2-Wn],q[oe*2+jn])}He+=ke*8}if(Ze.drawModeMessage(le,d,J,z),d)Ze.drawBullsEye(le,B.truncDivision(J,2),5);else{Ze.drawBullsEye(le,B.truncDivision(J,2),7);for(let oe=0,He=0;oe<B.truncDivision(W,2)-1;oe+=15,He+=16)for(let ke=B.truncDivision(J,2)&1;ke<J;ke+=2)le.set(B.truncDivision(J,2)-He,ke),le.set(B.truncDivision(J,2)+He,ke),le.set(ke,B.truncDivision(J,2)-He),le.set(ke,B.truncDivision(J,2)+He)}let ue=new at;return ue.setCompact(d),ue.setSize(J),ue.setLayers(p),ue.setCodeWords(M),ue.setMatrix(le),ue}static drawBullsEye(r,s,o){for(let u=0;u<o;u+=2)for(let c=s-u;c<=s+u;c++)r.set(c,s-u),r.set(c,s+u),r.set(s-u,c),r.set(s+u,c);r.set(s-o,s-o),r.set(s-o+1,s-o),r.set(s-o,s-o+1),r.set(s+o,s-o),r.set(s+o,s-o+1),r.set(s+o,s+o-1)}static generateModeMessage(r,s,o){let u=new $;return r?(u.appendBits(s-1,2),u.appendBits(o-1,6),u=Ze.generateCheckWords(u,28,4)):(u.appendBits(s-1,5),u.appendBits(o-1,11),u=Ze.generateCheckWords(u,40,4)),u}static drawModeMessage(r,s,o,u){let c=B.truncDivision(o,2);if(s)for(let h=0;h<7;h++){let d=c-3+h;u.get(h)&&r.set(d,c-5),u.get(h+7)&&r.set(c+5,d),u.get(20-h)&&r.set(d,c+5),u.get(27-h)&&r.set(c-5,d)}else for(let h=0;h<10;h++){let d=c-5+h+B.truncDivision(h,5);u.get(h)&&r.set(d,c-7),u.get(h+10)&&r.set(c+7,d),u.get(29-h)&&r.set(d,c+7),u.get(39-h)&&r.set(c-7,d)}}static generateCheckWords(r,s,o){let u=r.getSize()/o,c=new mo(Ze.getGF(o)),h=B.truncDivision(s,o),d=Ze.bitsToWords(r,o,h);c.encode(d,h-u);let p=s%o,w=new $;w.appendBits(0,p);for(const _ of Array.from(d))w.appendBits(_,o);return w}static bitsToWords(r,s,o){let u=new Int32Array(o),c,h;for(c=0,h=r.getSize()/s;c<h;c++){let d=0;for(let p=0;p<s;p++)d|=r.get(c*s+p)?1<<s-p-1:0;u[c]=d}return u}static getGF(r){switch(r){case 4:return je.AZTEC_PARAM;case 6:return je.AZTEC_DATA_6;case 8:return je.AZTEC_DATA_8;case 10:return je.AZTEC_DATA_10;case 12:return je.AZTEC_DATA_12;default:throw new v("Unsupported word size "+r)}}static stuffBits(r,s){let o=new $,u=r.getSize(),c=(1<<s)-2;for(let h=0;h<u;h+=s){let d=0;for(let p=0;p<s;p++)(h+p>=u||r.get(h+p))&&(d|=1<<s-1-p);(d&c)===c?(o.appendBits(d&c,s),h--):d&c?o.appendBits(d,s):(o.appendBits(d|1,s),h--)}return o}static totalBitsInLayer(r,s){return((s?88:112)+16*r)*r}}Ze.DEFAULT_EC_PERCENT=33,Ze.DEFAULT_AZTEC_LAYERS=0,Ze.MAX_NB_BITS=32,Ze.MAX_NB_BITS_COMPACT=4,Ze.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Jl{encode(r,s,o,u){return this.encodeWithHints(r,s,o,u,null)}encodeWithHints(r,s,o,u,c){let h=bt.ISO_8859_1,d=Ze.DEFAULT_EC_PERCENT,p=Ze.DEFAULT_AZTEC_LAYERS;return c!=null&&(c.has(Lt.CHARACTER_SET)&&(h=Me.forName(c.get(Lt.CHARACTER_SET).toString())),c.has(Lt.ERROR_CORRECTION)&&(d=B.parseInt(c.get(Lt.ERROR_CORRECTION).toString())),c.has(Lt.AZTEC_LAYERS)&&(p=B.parseInt(c.get(Lt.AZTEC_LAYERS).toString()))),Jl.encodeLayers(r,s,o,u,h,d,p)}static encodeLayers(r,s,o,u,c,h,d){if(s!==Ee.AZTEC)throw new v("Can only encode AZTEC, but got "+s);let p=Ze.encode(G.getBytes(r,c),h,d);return Jl.renderResult(p,o,u)}static renderResult(r,s,o){let u=r.getMatrix();if(u==null)throw new Jn;let c=u.getWidth(),h=u.getHeight(),d=Math.max(s,c),p=Math.max(o,h),w=Math.min(d/c,p/h),_=(d-c*w)/2,T=(p-h*w)/2,S=new ze(d,p);for(let M=0,z=T;M<h;M++,z+=w)for(let W=0,q=_;W<c;W++,q+=w)u.get(W,M)&&S.setRegion(q,z,w,w);return S}}n.AbstractExpandedDecoder=ao,n.ArgumentException=C,n.ArithmeticException=Rs,n.AztecCode=at,n.AztecCodeReader=so,n.AztecCodeWriter=Jl,n.AztecDecoder=nt,n.AztecDetector=zl,n.AztecDetectorResult=Ul,n.AztecEncoder=Ze,n.AztecHighLevelEncoder=Ia,n.AztecPoint=Zt,n.BarcodeFormat=Ee,n.Binarizer=Y,n.BinaryBitmap=D,n.BitArray=$,n.BitMatrix=ze,n.BitSource=pr,n.BrowserAztecCodeReader=Hl,n.BrowserBarcodeReader=ma,n.BrowserCodeReader=On,n.BrowserDatamatrixCodeReader=uo,n.BrowserMultiFormatReader=Ql,n.BrowserPDF417Reader=yi,n.BrowserQRCodeReader=Zl,n.BrowserQRCodeSvgWriter=A,n.CharacterSetECI=b,n.ChecksumException=V,n.Code128Reader=he,n.Code39Reader=Rt,n.DataMatrixDecodedBitStreamParser=Un,n.DataMatrixReader=Ke,n.DecodeHintType=se,n.DecoderResult=Mi,n.DefaultGridSampler=da,n.DetectorResult=fi,n.EAN13Reader=jr,n.EncodeHintType=Lt,n.Exception=m,n.FormatException=N,n.GenericGF=je,n.GenericGFPoly=An,n.GlobalHistogramBinarizer=Tt,n.GridSampler=fa,n.GridSamplerInstance=br,n.HTMLCanvasElementLuminanceSource=Se,n.HybridBinarizer=Ne,n.ITFReader=et,n.IllegalArgumentException=v,n.IllegalStateException=Jn,n.InvertedLuminanceSource=Ie,n.LuminanceSource=ge,n.MathUtils=Fe,n.MultiFormatOneDReader=gi,n.MultiFormatReader=Aa,n.MultiFormatWriter=j,n.NotFoundException=ee,n.OneDReader=St,n.PDF417DecodedBitStreamParser=Z,n.PDF417DecoderErrorCorrection=Et,n.PDF417Reader=Xt,n.PDF417ResultMetadata=ji,n.PerspectiveTransform=hn,n.PlanarYUVLuminanceSource=Q,n.QRCodeByteMatrix=an,n.QRCodeDataMask=zn,n.QRCodeDecodedBitStreamParser=mt,n.QRCodeDecoderErrorCorrectionLevel=Je,n.QRCodeDecoderFormatInformation=on,n.QRCodeEncoder=E,n.QRCodeEncoderQRCode=Yr,n.QRCodeMaskUtil=dt,n.QRCodeMatrixUtil=Ae,n.QRCodeMode=Ce,n.QRCodeReader=yr,n.QRCodeVersion=_e,n.QRCodeWriter=R,n.RGBLuminanceSource=fe,n.RSS14Reader=wt,n.RSSExpandedReader=ie,n.ReaderException=mi,n.ReedSolomonDecoder=Ns,n.ReedSolomonEncoder=mo,n.ReedSolomonException=Wr,n.Result=ut,n.ResultMetadataType=kt,n.ResultPoint=de,n.StringUtils=G,n.UnsupportedOperationException=F,n.VideoInputDevice=ht,n.WhiteRectangleDetector=hr,n.WriterException=ot,n.ZXingArrays=k,n.ZXingCharset=Me,n.ZXingInteger=B,n.ZXingStandardCharsets=bt,n.ZXingStringBuilder=L,n.ZXingStringEncoding=U,n.ZXingSystem=X,n.createAbstractExpandedDecoder=Ui,Object.defineProperty(n,"__esModule",{value:!0})})})(g1,g1.exports);var At=g1.exports;const cT=Rp(At),hT=Sp({__proto__:null,default:cT},[At]);var Ep=function(){function t(e,n,i){if(this.formatMap=new Map([[we.QR_CODE,At.BarcodeFormat.QR_CODE],[we.AZTEC,At.BarcodeFormat.AZTEC],[we.CODABAR,At.BarcodeFormat.CODABAR],[we.CODE_39,At.BarcodeFormat.CODE_39],[we.CODE_93,At.BarcodeFormat.CODE_93],[we.CODE_128,At.BarcodeFormat.CODE_128],[we.DATA_MATRIX,At.BarcodeFormat.DATA_MATRIX],[we.MAXICODE,At.BarcodeFormat.MAXICODE],[we.ITF,At.BarcodeFormat.ITF],[we.EAN_13,At.BarcodeFormat.EAN_13],[we.EAN_8,At.BarcodeFormat.EAN_8],[we.PDF_417,At.BarcodeFormat.PDF_417],[we.RSS_14,At.BarcodeFormat.RSS_14],[we.RSS_EXPANDED,At.BarcodeFormat.RSS_EXPANDED],[we.UPC_A,At.BarcodeFormat.UPC_A],[we.UPC_E,At.BarcodeFormat.UPC_E],[we.UPC_EAN_EXTENSION,At.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!hT)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=n,this.logger=i;var a=this.createZXingFormats(e),l=new Map;l.set(At.DecodeHintType.POSSIBLE_FORMATS,a),l.set(At.DecodeHintType.TRY_HARDER,!1),this.hints=l}return t.prototype.decodeAsync=function(e){var n=this;return new Promise(function(i,a){try{i(n.decode(e))}catch(l){a(l)}})},t.prototype.decode=function(e){var n=new At.MultiFormatReader(this.verbose,this.hints),i=new At.HTMLCanvasElementLuminanceSource(e),a=new At.BinaryBitmap(new At.HybridBinarizer(i)),l=n.decode(a);return{text:l.text,format:Sw.create(this.toHtml5QrcodeSupportedFormats(l.format)),debugData:this.createDebugData()}},t.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(n,i,a){e.set(n,i)}),e},t.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},t.prototype.createZXingFormats=function(e){for(var n=[],i=0,a=e;i<a.length;i++){var l=a[i];this.formatMap.has(l)?n.push(this.formatMap.get(l)):this.logger.logError("".concat(l," is not supported by")+"ZXingHtml5QrcodeShim")}return n},t.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},t}(),fT=globalThis&&globalThis.__awaiter||function(t,e,n,i){function a(l){return l instanceof n?l:new n(function(f){f(l)})}return new(n||(n=Promise))(function(l,f){function y(C){try{m(i.next(C))}catch(v){f(v)}}function x(C){try{m(i.throw(C))}catch(v){f(v)}}function m(C){C.done?l(C.value):a(C.value).then(y,x)}m((i=i.apply(t,e||[])).next())})},dT=globalThis&&globalThis.__generator||function(t,e){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,a,l,f;return f={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function y(m){return function(C){return x([m,C])}}function x(m){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(n=0)),n;)try{if(i=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,a=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){n.label=m[1];break}if(m[0]===6&&n.label<l[1]){n.label=l[1],l=m;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(m);break}l[2]&&n.ops.pop(),n.trys.pop();continue}m=e.call(t,n)}catch(C){m=[6,C],a=0}finally{i=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},_p=function(){function t(e,n,i){if(this.formatMap=new Map([[we.QR_CODE,"qr_code"],[we.AZTEC,"aztec"],[we.CODABAR,"codabar"],[we.CODE_39,"code_39"],[we.CODE_93,"code_93"],[we.CODE_128,"code_128"],[we.DATA_MATRIX,"data_matrix"],[we.ITF,"itf"],[we.EAN_13,"ean_13"],[we.EAN_8,"ean_8"],[we.PDF_417,"pdf417"],[we.UPC_A,"upc_a"],[we.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!t.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=n,this.logger=i;var a=this.createBarcodeDetectorFormats(e);if(this.detector=new BarcodeDetector(a),!this.detector)throw"BarcodeDetector detector not supported"}return t.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var e=new BarcodeDetector({formats:["qr_code"]});return typeof e<"u"},t.prototype.decodeAsync=function(e){return fT(this,void 0,void 0,function(){var n,i;return dT(this,function(a){switch(a.label){case 0:return[4,this.detector.detect(e)];case 1:if(n=a.sent(),!n||n.length===0)throw"No barcode or QR code detected.";return i=this.selectLargestBarcode(n),[2,{text:i.rawValue,format:Sw.create(this.toHtml5QrcodeSupportedFormats(i.format)),debugData:this.createDebugData()}]}})})},t.prototype.selectLargestBarcode=function(e){for(var n=null,i=0,a=0,l=e;a<l.length;a++){var f=l[a],y=f.boundingBox.width*f.boundingBox.height;y>i&&(i=y,n=f)}if(!n)throw"No largest barcode found";return n},t.prototype.createBarcodeDetectorFormats=function(e){for(var n=[],i=0,a=e;i<a.length;i++){var l=a[i];this.formatMap.has(l)?n.push(this.formatMap.get(l)):this.logger.warn("".concat(l," is not supported by")+"BarcodeDetectorDelegate")}return{formats:n}},t.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},t.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(n,i,a){e.set(n,i)}),e},t.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},t}(),Ap=globalThis&&globalThis.__awaiter||function(t,e,n,i){function a(l){return l instanceof n?l:new n(function(f){f(l)})}return new(n||(n=Promise))(function(l,f){function y(C){try{m(i.next(C))}catch(v){f(v)}}function x(C){try{m(i.throw(C))}catch(v){f(v)}}function m(C){C.done?l(C.value):a(C.value).then(y,x)}m((i=i.apply(t,e||[])).next())})},Cp=globalThis&&globalThis.__generator||function(t,e){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,a,l,f;return f={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function y(m){return function(C){return x([m,C])}}function x(m){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(n=0)),n;)try{if(i=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,a=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){n.label=m[1];break}if(m[0]===6&&n.label<l[1]){n.label=l[1],l=m;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(m);break}l[2]&&n.ops.pop(),n.trys.pop();continue}m=e.call(t,n)}catch(C){m=[6,C],a=0}finally{i=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},gT=function(){function t(e,n,i,a){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=i,n&&_p.isSupported()?(this.primaryDecoder=new _p(e,i,a),this.secondaryDecoder=new Ep(e,i,a)):this.primaryDecoder=new Ep(e,i,a)}return t.prototype.decodeAsync=function(e){return Ap(this,void 0,void 0,function(){var n;return Cp(this,function(i){switch(i.label){case 0:n=performance.now(),i.label=1;case 1:return i.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(e)];case 2:return[2,i.sent()];case 3:return this.possiblyLogPerformance(n),[7];case 4:return[2]}})})},t.prototype.decodeRobustlyAsync=function(e){return Ap(this,void 0,void 0,function(){var n,i;return Cp(this,function(a){switch(a.label){case 0:n=performance.now(),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(e)];case 2:return[2,a.sent()];case 3:if(i=a.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(e)];throw i;case 4:return this.possiblyLogPerformance(n),[7];case 5:return[2]}})})},t.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},t.prototype.possiblyLogPerformance=function(e){if(this.verbose){var n=performance.now()-e;this.executionResults.push(n),this.executions++,this.possiblyFlushPerformanceReport()}},t.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var e=0,n=0,i=this.executionResults;n<i.length;n++){var a=i[n];e+=a}var l=e/this.executionResults.length;console.log("".concat(l," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},t}(),Zd=globalThis&&globalThis.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(i[l]=a[l])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function i(){this.constructor=e}e.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),Sc=globalThis&&globalThis.__awaiter||function(t,e,n,i){function a(l){return l instanceof n?l:new n(function(f){f(l)})}return new(n||(n=Promise))(function(l,f){function y(C){try{m(i.next(C))}catch(v){f(v)}}function x(C){try{m(i.throw(C))}catch(v){f(v)}}function m(C){C.done?l(C.value):a(C.value).then(y,x)}m((i=i.apply(t,e||[])).next())})},Rc=globalThis&&globalThis.__generator||function(t,e){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,a,l,f;return f={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function y(m){return function(C){return x([m,C])}}function x(m){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(n=0)),n;)try{if(i=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,a=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){n.label=m[1];break}if(m[0]===6&&n.label<l[1]){n.label=l[1],l=m;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(m);break}l[2]&&n.ops.pop(),n.trys.pop();continue}m=e.call(t,n)}catch(C){m=[6,C],a=0}finally{i=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},Nw=function(){function t(e,n){this.name=e,this.track=n}return t.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},t.prototype.apply=function(e){var n={};n[this.name]=e;var i={advanced:[n]};return this.track.applyConstraints(i)},t.prototype.value=function(){var e=this.track.getSettings();if(this.name in e){var n=e[this.name];return n}return null},t}(),pT=function(t){Zd(e,t);function e(n,i){return t.call(this,n,i)||this}return e.prototype.min=function(){return this.getCapabilities().min},e.prototype.max=function(){return this.getCapabilities().max},e.prototype.step=function(){return this.getCapabilities().step},e.prototype.apply=function(n){var i={};i[this.name]=n;var a={advanced:[i]};return this.track.applyConstraints(a)},e.prototype.getCapabilities=function(){this.failIfNotSupported();var n=this.track.getCapabilities(),i=n[this.name];return{min:i.min,max:i.max,step:i.step}},e.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},e}(Nw),mT=function(t){Zd(e,t);function e(n){return t.call(this,"zoom",n)||this}return e}(pT),yT=function(t){Zd(e,t);function e(n){return t.call(this,"torch",n)||this}return e}(Nw),wT=function(){function t(e){this.track=e}return t.prototype.zoomFeature=function(){return new mT(this.track)},t.prototype.torchFeature=function(){return new yT(this.track)},t}(),xT=function(){function t(e,n,i){this.isClosed=!1,this.parentElement=e,this.mediaStream=n,this.callbacks=i,this.surface=this.createVideoElement(this.parentElement.clientWidth),e.append(this.surface)}return t.prototype.createVideoElement=function(e){var n=document.createElement("video");return n.style.width="".concat(e,"px"),n.style.display="block",n.muted=!0,n.setAttribute("muted","true"),n.playsInline=!0,n},t.prototype.setupSurface=function(){var e=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var n=function(){var i=e.surface.clientWidth,a=e.surface.clientHeight;e.callbacks.onRenderSurfaceReady(i,a),e.surface.removeEventListener("playing",n)};this.surface.addEventListener("playing",n),this.surface.srcObject=this.mediaStream,this.surface.play()},t.create=function(e,n,i,a){return Sc(this,void 0,void 0,function(){var l,f;return Rc(this,function(y){switch(y.label){case 0:return l=new t(e,n,a),i.aspectRatio?(f={aspectRatio:i.aspectRatio},[4,l.getFirstTrackOrFail().applyConstraints(f)]):[3,2];case 1:y.sent(),y.label=2;case 2:return l.setupSurface(),[2,l]}})})},t.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},t.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},t.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},t.prototype.resume=function(e){this.failIfClosed();var n=this,i=function(){setTimeout(e,200),n.surface.removeEventListener("playing",i)};this.surface.addEventListener("playing",i),this.surface.play()},t.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},t.prototype.getSurface=function(){return this.failIfClosed(),this.surface},t.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},t.prototype.applyVideoConstraints=function(e){return Sc(this,void 0,void 0,function(){return Rc(this,function(n){if("aspectRatio"in e)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(e)]})})},t.prototype.close=function(){if(this.isClosed)return Promise.resolve();var e=this;return new Promise(function(n,i){var a=e.mediaStream.getVideoTracks(),l=a.length,f=0;e.mediaStream.getVideoTracks().forEach(function(y){e.mediaStream.removeTrack(y),y.stop(),++f,f>=l&&(e.isClosed=!0,e.parentElement.removeChild(e.surface),n())})})},t.prototype.getCapabilities=function(){return new wT(this.getFirstTrackOrFail())},t}(),ET=function(){function t(e){this.mediaStream=e}return t.prototype.render=function(e,n,i){return Sc(this,void 0,void 0,function(){return Rc(this,function(a){return[2,xT.create(e,this.mediaStream,n,i)]})})},t.create=function(e){return Sc(this,void 0,void 0,function(){var n,i;return Rc(this,function(a){switch(a.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return n={audio:!1,video:e},[4,navigator.mediaDevices.getUserMedia(n)];case 1:return i=a.sent(),[2,new t(i)]}})})},t}(),Ip=globalThis&&globalThis.__awaiter||function(t,e,n,i){function a(l){return l instanceof n?l:new n(function(f){f(l)})}return new(n||(n=Promise))(function(l,f){function y(C){try{m(i.next(C))}catch(v){f(v)}}function x(C){try{m(i.throw(C))}catch(v){f(v)}}function m(C){C.done?l(C.value):a(C.value).then(y,x)}m((i=i.apply(t,e||[])).next())})},Tp=globalThis&&globalThis.__generator||function(t,e){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,a,l,f;return f={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function y(m){return function(C){return x([m,C])}}function x(m){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(n=0)),n;)try{if(i=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,a=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){n.label=m[1];break}if(m[0]===6&&n.label<l[1]){n.label=l[1],l=m;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(m);break}l[2]&&n.ops.pop(),n.trys.pop();continue}m=e.call(t,n)}catch(C){m=[6,C],a=0}finally{i=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},_T=function(){function t(){}return t.failIfNotSupported=function(){return Ip(this,void 0,void 0,function(){return Tp(this,function(e){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new t]})})},t.prototype.create=function(e){return Ip(this,void 0,void 0,function(){return Tp(this,function(n){return[2,ET.create(e)]})})},t}(),AT=globalThis&&globalThis.__awaiter||function(t,e,n,i){function a(l){return l instanceof n?l:new n(function(f){f(l)})}return new(n||(n=Promise))(function(l,f){function y(C){try{m(i.next(C))}catch(v){f(v)}}function x(C){try{m(i.throw(C))}catch(v){f(v)}}function m(C){C.done?l(C.value):a(C.value).then(y,x)}m((i=i.apply(t,e||[])).next())})},CT=globalThis&&globalThis.__generator||function(t,e){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},i,a,l,f;return f={next:y(0),throw:y(1),return:y(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function y(m){return function(C){return x([m,C])}}function x(m){if(i)throw new TypeError("Generator is already executing.");for(;f&&(f=0,m[0]&&(n=0)),n;)try{if(i=1,a&&(l=m[0]&2?a.return:m[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,m[1])).done)return l;switch(a=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,a=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){n.label=m[1];break}if(m[0]===6&&n.label<l[1]){n.label=l[1],l=m;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(m);break}l[2]&&n.ops.pop(),n.trys.pop();continue}m=e.call(t,n)}catch(C){m=[6,C],a=0}finally{i=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},IT=function(){function t(){}return t.retrieve=function(){if(navigator.mediaDevices)return t.getCamerasFromMediaDevices();var e=MediaStreamTrack;return MediaStreamTrack&&e.getSources?t.getCamerasFromMediaStreamTrack():t.rejectWithError()},t.rejectWithError=function(){var e=ko.unableToQuerySupportedDevices();return t.isHttpsOrLocalhost()||(e=ko.insecureContextCameraQueryError()),Promise.reject(e)},t.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var e=location.host.split(":")[0];return e==="127.0.0.1"||e==="localhost"},t.getCamerasFromMediaDevices=function(){return AT(this,void 0,void 0,function(){var e,n,i,a,l,f,y;return CT(this,function(x){switch(x.label){case 0:return e=function(m){for(var C=m.getVideoTracks(),v=0,D=C;v<D.length;v++){var V=D[v];V.enabled=!1,V.stop(),m.removeTrack(V)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return n=x.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(i=x.sent(),a=[],l=0,f=i;l<f.length;l++)y=f[l],y.kind==="videoinput"&&a.push({id:y.deviceId,label:y.label});return e(n),[2,a]}})})},t.getCamerasFromMediaStreamTrack=function(){return new Promise(function(e,n){var i=function(l){for(var f=[],y=0,x=l;y<x.length;y++){var m=x[y];m.kind==="video"&&f.push({id:m.id,label:m.label})}e(f)},a=MediaStreamTrack;a.getSources(i)})},t}(),Bt;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.NOT_STARTED=1]="NOT_STARTED",t[t.SCANNING=2]="SCANNING",t[t.PAUSED=3]="PAUSED"})(Bt||(Bt={}));var TT=function(){function t(){this.state=Bt.NOT_STARTED,this.onGoingTransactionNewState=Bt.UNKNOWN}return t.prototype.directTransition=function(e){this.failIfTransitionOngoing(),this.validateTransition(e),this.state=e},t.prototype.startTransition=function(e){return this.failIfTransitionOngoing(),this.validateTransition(e),this.onGoingTransactionNewState=e,this},t.prototype.execute=function(){if(this.onGoingTransactionNewState===Bt.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var e=this.onGoingTransactionNewState;this.onGoingTransactionNewState=Bt.UNKNOWN,this.directTransition(e)},t.prototype.cancel=function(){if(this.onGoingTransactionNewState===Bt.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=Bt.UNKNOWN},t.prototype.getState=function(){return this.state},t.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==Bt.UNKNOWN)throw"Cannot transition to a new state, already under transition"},t.prototype.validateTransition=function(e){switch(this.state){case Bt.UNKNOWN:throw"Transition from unknown is not allowed";case Bt.NOT_STARTED:this.failIfNewStateIs(e,[Bt.PAUSED]);break;case Bt.SCANNING:break;case Bt.PAUSED:break}},t.prototype.failIfNewStateIs=function(e,n){for(var i=0,a=n;i<a.length;i++){var l=a[i];if(e===l)throw"Cannot transition from ".concat(this.state," to ").concat(e)}},t}(),vT=function(){function t(e){this.stateManager=e}return t.prototype.startTransition=function(e){return this.stateManager.startTransition(e)},t.prototype.directTransition=function(e){this.stateManager.directTransition(e)},t.prototype.getState=function(){return this.stateManager.getState()},t.prototype.canScanFile=function(){return this.stateManager.getState()===Bt.NOT_STARTED},t.prototype.isScanning=function(){return this.stateManager.getState()!==Bt.NOT_STARTED},t.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===Bt.SCANNING},t.prototype.isPaused=function(){return this.stateManager.getState()===Bt.PAUSED},t}(),ST=function(){function t(){}return t.create=function(){return new vT(new TT)},t}(),RT=globalThis&&globalThis.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(i[l]=a[l])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function i(){this.constructor=e}e.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),tr=function(t){RT(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.DEFAULT_WIDTH=300,e.DEFAULT_WIDTH_OFFSET=2,e.FILE_SCAN_MIN_HEIGHT=300,e.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,e.MIN_QR_BOX_SIZE=50,e.SHADED_LEFT=1,e.SHADED_RIGHT=2,e.SHADED_TOP=3,e.SHADED_BOTTOM=4,e.SHADED_REGION_ELEMENT_ID="qr-shaded-region",e.VERBOSE=!1,e.BORDER_SHADER_DEFAULT_COLOR="#ffffff",e.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",e}(aT),NT=function(){function t(e,n){this.logger=n,this.fps=tr.SCAN_DEFAULT_FPS,e?(e.fps&&(this.fps=e.fps),this.disableFlip=e.disableFlip===!0,this.qrbox=e.qrbox,this.aspectRatio=e.aspectRatio,this.videoConstraints=e.videoConstraints):this.disableFlip=tr.DEFAULT_DISABLE_FLIP}return t.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?Rw.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},t.prototype.isShadedBoxEnabled=function(){return!wi(this.qrbox)},t.create=function(e,n){return new t(e,n)},t}(),iv=function(){function t(e,n){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");this.elementId=e,this.verbose=!1;var i;typeof n=="boolean"?this.verbose=n===!0:n&&(i=n,this.verbose=i.verbose===!0,i.experimentalFeatures),this.logger=new uT(this.verbose),this.qrcode=new gT(this.getSupportedFormats(n),this.getUseBarCodeDetectorIfSupported(i),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=ST.create()}return t.prototype.start=function(e,n,i,a){var l=this;if(!e)throw"cameraIdOrConfig is required";if(!i||typeof i!="function")throw"qrCodeSuccessCallback is required and should be a function.";var f;a?f=a:f=this.verbose?this.logger.log:function(){};var y=NT.create(n,this.logger);this.clearElement();var x=!1;y.videoConstraints&&(y.isMediaStreamConstraintsValid()?x=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var m=x,C=document.getElementById(this.elementId);C.clientWidth?C.clientWidth:tr.DEFAULT_WIDTH,C.style.position="relative",this.shouldScan=!0,this.element=C;var v=this,D=this.stateManagerProxy.startTransition(Bt.SCANNING);return new Promise(function(V,Y){var X=m?y.videoConstraints:v.createVideoConstraints(e);if(!X){D.cancel(),Y("videoConstraints should be defined");return}var ne={};(!m||y.aspectRatio)&&(ne.aspectRatio=y.aspectRatio);var H={onRenderSurfaceReady:function(k,B){v.setupUi(k,B,y),v.isScanning=!0,v.foreverScan(y,i,f)}};_T.failIfNotSupported().then(function(k){k.create(X).then(function(B){return B.render(l.element,ne,H).then(function($){v.renderedCamera=$,D.execute(),V(null)}).catch(function($){D.cancel(),Y($)})}).catch(function(B){D.cancel(),Y(ko.errorGettingUserMedia(B))})}).catch(function(k){D.cancel(),Y(ko.cameraStreamingNotSupported())})})},t.prototype.pause=function(e){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(Bt.PAUSED),this.showPausedState(),(wi(e)||e!==!0)&&(e=!1),e&&this.renderedCamera&&this.renderedCamera.pause()},t.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var e=this,n=function(){e.stateManagerProxy.directTransition(Bt.SCANNING),e.hidePausedState()};if(!this.renderedCamera.isPaused()){n();return}this.renderedCamera.resume(function(){n()})},t.prototype.getState=function(){return this.stateManagerProxy.getState()},t.prototype.stop=function(){var e=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var n=this.stateManagerProxy.startTransition(Bt.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var i=function(){if(e.element){var l=document.getElementById(tr.SHADED_REGION_ELEMENT_ID);l&&e.element.removeChild(l)}},a=this;return this.renderedCamera.close().then(function(){return a.renderedCamera=null,a.element&&(a.element.removeChild(a.canvasElement),a.canvasElement=null),i(),a.qrRegion&&(a.qrRegion=null),a.context&&(a.context=null),n.execute(),a.hidePausedState(),a.isScanning=!1,Promise.resolve()})},t.prototype.scanFile=function(e,n){return this.scanFileV2(e,n).then(function(i){return i.decodedText})},t.prototype.scanFileV2=function(e,n){var i=this;if(!e||!(e instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(wi(n)&&(n=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(a,l){i.possiblyCloseLastScanImageFile(),i.clearElement(),i.lastScanImageFile=URL.createObjectURL(e);var f=new Image;f.onload=function(){var y=f.width,x=f.height,m=document.getElementById(i.elementId),C=m.clientWidth?m.clientWidth:tr.DEFAULT_WIDTH,v=Math.max(m.clientHeight?m.clientHeight:x,tr.FILE_SCAN_MIN_HEIGHT),D=i.computeCanvasDrawConfig(y,x,C,v);if(n){var V=i.createCanvasElement(C,v,"qr-canvas-visible");V.style.display="inline-block",m.appendChild(V);var Y=V.getContext("2d");if(!Y)throw"Unable to get 2d context from canvas";Y.canvas.width=C,Y.canvas.height=v,Y.drawImage(f,0,0,y,x,D.x,D.y,D.width,D.height)}var X=tr.FILE_SCAN_HIDDEN_CANVAS_PADDING,ne=Math.max(f.width,D.width),H=Math.max(f.height,D.height),k=ne+2*X,B=H+2*X,$=i.createCanvasElement(k,B);m.appendChild($);var ce=$.getContext("2d");if(!ce)throw"Unable to get 2d context from canvas";ce.canvas.width=k,ce.canvas.height=B,ce.drawImage(f,0,0,y,x,X,X,ne,H);try{i.qrcode.decodeRobustlyAsync($).then(function(se){a(xp.createFromQrcodeResult(se))}).catch(l)}catch(se){l("QR code parse error, error = ".concat(se))}},f.onerror=l,f.onabort=l,f.onstalled=l,f.onsuspend=l,f.src=URL.createObjectURL(e)})},t.prototype.clear=function(){this.clearElement()},t.getCameras=function(){return IT.retrieve()},t.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},t.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},t.prototype.applyVideoConstraints=function(e){if(e){if(!Rw.isMediaStreamConstraintsValid(e,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(e)},t.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},t.prototype.getSupportedFormats=function(e){var n=[we.QR_CODE,we.AZTEC,we.CODABAR,we.CODE_39,we.CODE_93,we.CODE_128,we.DATA_MATRIX,we.MAXICODE,we.ITF,we.EAN_13,we.EAN_8,we.PDF_417,we.RSS_14,we.RSS_EXPANDED,we.UPC_A,we.UPC_E,we.UPC_EAN_EXTENSION];if(!e||typeof e=="boolean"||!e.formatsToSupport)return n;if(!Array.isArray(e.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(e.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var i=[],a=0,l=e.formatsToSupport;a<l.length;a++){var f=l[a];oT(f)?i.push(f):this.logger.warn("Invalid format: ".concat(f," passed in config, ignoring."))}if(i.length===0)throw"None of formatsToSupport match supported values.";return i},t.prototype.getUseBarCodeDetectorIfSupported=function(e){if(wi(e))return!0;if(!wi(e.useBarCodeDetectorIfSupported))return e.useBarCodeDetectorIfSupported!==!1;if(wi(e.experimentalFeatures))return!0;var n=e.experimentalFeatures;return wi(n.useBarCodeDetectorIfSupported)?!0:n.useBarCodeDetectorIfSupported!==!1},t.prototype.validateQrboxSize=function(e,n,i){var a=this,l=i.qrbox;this.validateQrboxConfig(l);var f=this.toQrdimensions(e,n,l),y=function(m){if(m<tr.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(tr.MIN_QR_BOX_SIZE,"px.")},x=function(m){return m>e&&(a.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),m=e),m};y(f.width),y(f.height),f.width=x(f.width)},t.prototype.validateQrboxConfig=function(e){if(typeof e!="number"&&typeof e!="function"&&(e.width===void 0||e.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},t.prototype.toQrdimensions=function(e,n,i){if(typeof i=="number")return{width:i,height:i};if(typeof i=="function")try{return i(e,n)}catch(a){throw new Error("qrbox config was passed as a function but it failed with unknown error"+a)}return i},t.prototype.setupUi=function(e,n,i){i.isShadedBoxEnabled()&&this.validateQrboxSize(e,n,i);var a=wi(i.qrbox)?{width:e,height:n}:i.qrbox;this.validateQrboxConfig(a);var l=this.toQrdimensions(e,n,a);l.height>n&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var f=i.isShadedBoxEnabled()&&l.height<=n,y={x:0,y:0,width:e,height:n},x=f?this.getShadedRegionBounds(e,n,l):y,m=this.createCanvasElement(x.width,x.height),C={willReadFrequently:!0},v=m.getContext("2d",C);v.canvas.width=x.width,v.canvas.height=x.height,this.element.append(m),f&&this.possiblyInsertShadingElement(this.element,e,n,l),this.createScannerPausedUiElement(this.element),this.qrRegion=x,this.context=v,this.canvasElement=m},t.prototype.createScannerPausedUiElement=function(e){var n=document.createElement("div");n.innerText=ko.scannerPaused(),n.style.display="none",n.style.position="absolute",n.style.top="0px",n.style.zIndex="1",n.style.background="rgba(9, 9, 9, 0.46)",n.style.color="#FFECEC",n.style.textAlign="center",n.style.width="100%",e.appendChild(n),this.scannerPausedUiElement=n},t.prototype.scanContext=function(e,n){var i=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(a){return e(a.text,xp.createFromQrcodeResult(a)),i.possiblyUpdateShaders(!0),!0}).catch(function(a){i.possiblyUpdateShaders(!1);var l=ko.codeParseError(a);return n(l,lT.createFrom(l)),!1})},t.prototype.foreverScan=function(e,n,i){var a=this;if(this.shouldScan&&this.renderedCamera){var l=this.renderedCamera.getSurface(),f=l.videoWidth/l.clientWidth,y=l.videoHeight/l.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var x=this.qrRegion.width*f,m=this.qrRegion.height*y,C=this.qrRegion.x*f,v=this.qrRegion.y*y;this.context.drawImage(l,C,v,x,m,0,0,this.qrRegion.width,this.qrRegion.height);var D=function(){a.foreverScanTimeout=setTimeout(function(){a.foreverScan(e,n,i)},a.getTimeoutFps(e.fps))};this.scanContext(n,i).then(function(V){!V&&e.disableFlip!==!0?(a.context.translate(a.context.canvas.width,0),a.context.scale(-1,1),a.scanContext(n,i).finally(function(){D()})):D()}).catch(function(V){a.logger.logError("Error happend while scanning context",V),D()})}},t.prototype.createVideoConstraints=function(e){if(typeof e=="string")return{deviceId:{exact:e}};if(typeof e=="object"){var n="facingMode",i="deviceId",a={user:!0,environment:!0},l="exact",f=function(Y){if(Y in a)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(Y,"'")},y=Object.keys(e);if(y.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(y.length," keys");var x=Object.keys(e)[0];if(x!==n&&x!==i)throw"Only '".concat(n,"' and '").concat(i,"' ")+" are supported for 'cameraIdOrConfig'";if(x===n){var m=e.facingMode;if(typeof m=="string"){if(f(m))return{facingMode:m}}else if(typeof m=="object")if(l in m){if(f(m["".concat(l)]))return{facingMode:{exact:m["".concat(l)]}}}else throw"'facingMode' should be string or object with"+" ".concat(l," as key.");else{var C=typeof m;throw"Invalid type of 'facingMode' = ".concat(C)}}else{var v=e.deviceId;if(typeof v=="string")return{deviceId:v};if(typeof v=="object"){if(l in v)return{deviceId:{exact:v["".concat(l)]}};throw"'deviceId' should be string or object with"+" ".concat(l," as key.")}else{var D=typeof v;throw"Invalid type of 'deviceId' = ".concat(D)}}}var V=typeof e;throw"Invalid type of 'cameraIdOrConfig' = ".concat(V)},t.prototype.computeCanvasDrawConfig=function(e,n,i,a){if(e<=i&&n<=a){var l=(i-e)/2,f=(a-n)/2;return{x:l,y:f,width:e,height:n}}else{var y=e,x=n;return e>i&&(n=i/e*n,e=i),n>a&&(e=a/n*e,n=a),this.logger.log("Image downsampled from "+"".concat(y,"X").concat(x)+" to ".concat(e,"X").concat(n,".")),this.computeCanvasDrawConfig(e,n,i,a)}},t.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var e=document.getElementById(this.elementId);e&&(e.innerHTML="")},t.prototype.possiblyUpdateShaders=function(e){this.qrMatch!==e&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(n){n.style.backgroundColor=e?tr.BORDER_SHADER_MATCH_COLOR:tr.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=e)},t.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},t.prototype.createCanvasElement=function(e,n,i){var a=e,l=n,f=document.createElement("canvas");return f.style.width="".concat(a,"px"),f.style.height="".concat(l,"px"),f.style.display="none",f.id=wi(i)?"qr-canvas":i,f},t.prototype.getShadedRegionBounds=function(e,n,i){if(i.width>e||i.height>n)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(e-i.width)/2,y:(n-i.height)/2,width:i.width,height:i.height}},t.prototype.possiblyInsertShadingElement=function(e,n,i,a){if(!(n-a.width<1||i-a.height<1)){var l=document.createElement("div");l.style.position="absolute";var f=(n-a.width)/2,y=(i-a.height)/2;if(l.style.borderLeft="".concat(f,"px solid rgba(0, 0, 0, 0.48)"),l.style.borderRight="".concat(f,"px solid rgba(0, 0, 0, 0.48)"),l.style.borderTop="".concat(y,"px solid rgba(0, 0, 0, 0.48)"),l.style.borderBottom="".concat(y,"px solid rgba(0, 0, 0, 0.48)"),l.style.boxSizing="border-box",l.style.top="0px",l.style.bottom="0px",l.style.left="0px",l.style.right="0px",l.id="".concat(tr.SHADED_REGION_ELEMENT_ID),n-a.width<11||i-a.height<11)this.hasBorderShaders=!1;else{var x=5,m=40;this.insertShaderBorders(l,m,x,-x,null,0,!0),this.insertShaderBorders(l,m,x,-x,null,0,!1),this.insertShaderBorders(l,m,x,null,-x,0,!0),this.insertShaderBorders(l,m,x,null,-x,0,!1),this.insertShaderBorders(l,x,m+x,-x,null,-x,!0),this.insertShaderBorders(l,x,m+x,null,-x,-x,!0),this.insertShaderBorders(l,x,m+x,-x,null,-x,!1),this.insertShaderBorders(l,x,m+x,null,-x,-x,!1),this.hasBorderShaders=!0}e.append(l)}},t.prototype.insertShaderBorders=function(e,n,i,a,l,f,y){var x=document.createElement("div");x.style.position="absolute",x.style.backgroundColor=tr.BORDER_SHADER_DEFAULT_COLOR,x.style.width="".concat(n,"px"),x.style.height="".concat(i,"px"),a!==null&&(x.style.top="".concat(a,"px")),l!==null&&(x.style.bottom="".concat(l,"px")),y?x.style.left="".concat(f,"px"):x.style.right="".concat(f,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(x),e.appendChild(x)},t.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},t.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},t.prototype.getTimeoutFps=function(e){return 1e3/e},t}();globalThis&&globalThis.__awaiter;globalThis&&globalThis.__generator;globalThis&&globalThis.__awaiter;globalThis&&globalThis.__generator;var vp;(function(t){t[t.STATUS_DEFAULT=0]="STATUS_DEFAULT",t[t.STATUS_SUCCESS=1]="STATUS_SUCCESS",t[t.STATUS_WARNING=2]="STATUS_WARNING",t[t.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(vp||(vp={}));export{RA as A,XT as B,xl as C,$T as D,H2 as E,aa as F,qT as G,KT as H,nv as I,tv as J,HI as K,Qe as L,ev as M,ZT as N,JT as O,rv as P,jT as Q,WT as R,SA as S,YT as T,QT as U,Qw as V,iv as W,Rp as X,bT as Y,dc as _,DT as a,LT as b,Ho as c,CA as d,c_ as e,NA as f,OT as g,kT as h,PT as i,IA as j,Ri as k,HT as l,hc as m,cd as n,hd as o,d_ as p,VT as q,x1 as r,G2 as s,s_ as t,y_ as u,BT as v,UT as w,zT as x,MT as y,FT as z};
