import{j as e,L as t}from"./index-655d3ef3.js";import{r as s,$ as a,L as l,y as i,U as r,O as n,W as d,B as c}from"./ui-vendors-d35e5635.js";import"./firebase-lib-1a6647fc.js";const o=({teacherId:o})=>{var x,m,h,u,g,p,b,f,v,j,y,w,N,k,z,H,O;const[S,D]=s.useState([]),[K,C]=s.useState([]),[T,L]=s.useState(!0),[B,A]=s.useState(""),[V,P]=s.useState(null),[G,Y]=s.useState(!0);if(s.useEffect(()=>{(async()=>{if(o){L(!0);try{const[e,,s,a]=await Promise.all([t.getStudents(o),t.getBooks(o),t.getAllTransactions(o),t.getSettings(o)]);D(e),C(s),Y((null==a?void 0:a.parentViewPrivate)??!0)}catch(e){}finally{L(!1)}}else L(!1)})()},[o]),!o)return e.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-6",children:e.jsxs("div",{className:"max-w-md w-full bg-white p-10 rounded-[2.5rem] shadow-xl text-center space-y-6",children:[e.jsx("div",{className:"w-20 h-20 bg-rose-50 text-rose-500 rounded-3xl flex items-center justify-center mx-auto",children:e.jsx(a,{size:40})}),e.jsx("h2",{className:"text-2xl font-black text-slate-800",children:"Geçersiz Bağlantı"}),e.jsx("p",{className:"text-slate-500 font-medium",children:"Veli görünümüne erişmek için geçerli bir öğretmen bağlantısı gereklidir."})]})});if(T)return e.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-slate-50",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-cyan-600 mb-4"}),e.jsx("p",{className:"text-slate-500 font-bold animate-pulse",children:"Veli Paneli Yükleniyor..."})]});const $=S.filter(e=>{const t=B.toLowerCase().trim();if(t){return/^\d+$/.test(t)?e.studentNumber===t:e.name.toLowerCase().trim()===t}return!G}).sort((e,t)=>{var s,a;return((null==(s=t.readingHistory)?void 0:s.length)||0)-((null==(a=e.readingHistory)?void 0:a.length)||0)});return e.jsxs("div",{className:"min-h-screen bg-slate-50 pb-12 font-sans",children:[e.jsx("header",{className:"bg-slate-900 text-white p-6 shadow-xl sticky top-0 z-30",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-cyan-500/20 p-2 rounded-xl backdrop-blur-md border border-cyan-500/30",children:e.jsx(l,{size:28,className:"text-cyan-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black tracking-tight uppercase text-white",children:"LibraTech"}),e.jsx("p",{className:"text-[10px] text-cyan-400 font-bold tracking-[0.2em] uppercase",children:"Veli Takip Sistemi"})]})]}),e.jsx("div",{className:"hidden md:flex flex-col items-end",children:e.jsx("p",{className:"text-sm font-bold text-slate-400 italic",children:'"Okumak, özgürlüğe uçmaktır."'})})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto p-4 md:p-8 space-y-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-cyan-600 to-blue-700 p-8 rounded-[2.5rem] text-white shadow-2xl relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 w-80 h-80 bg-white/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 group-hover:bg-white/15 transition-colors duration-700"}),e.jsxs("div",{className:"relative z-10 text-center space-y-4",children:[e.jsx("h2",{className:"text-3xl font-black italic tracking-wide",children:"Öğrenci Okuma Karnesi Sorgula"}),e.jsx("p",{className:"text-cyan-50 max-w-lg mx-auto font-medium",children:"Çocuğunuzun okuma gelişimini takip etmek için ismine veya okul numarasına göre arama yapabilirsiniz."}),e.jsxs("div",{className:"relative max-w-xl mx-auto mt-6",children:[e.jsx(i,{className:"absolute left-6 top-1/2 -translate-y-1/2 text-cyan-700 pointer-events-none",size:24}),e.jsx("input",{id:"parent-search",name:"parent-search",type:"text",placeholder:"Öğrenci adı veya numarası giriniz...",className:"w-full pl-16 pr-6 py-5 bg-white text-slate-800 rounded-2xl shadow-xl shadow-cyan-900/20 border-none focus:ring-4 focus:ring-cyan-300/50 transition-all font-bold text-lg outline-none placeholder:text-slate-300",value:B,onChange:e=>A(e.target.value)})]})]})]}),(B||!G)&&e.jsxs("div",{className:"space-y-6 animate-soft-fade",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(r,{className:"text-cyan-600",size:28}),e.jsx("h3",{className:"text-2xl font-black text-slate-800 uppercase tracking-tight",children:B?"Arama Sonuçları":"Öğrenci Okuma Karneleri"})]}),0===$.length?e.jsxs("div",{className:"bg-white border-2 border-dashed border-slate-200 p-12 rounded-[2.5rem] text-center",children:[e.jsx(a,{className:"mx-auto text-slate-300 mb-4",size:48}),e.jsx("p",{className:"text-slate-500 font-bold text-lg",children:"Aradığınız kriterlere uygun öğrenci bulunamadı."}),e.jsx("p",{className:"text-slate-400 text-sm mt-1",children:"Lütfen öğrenci numarasını veya ismini kontrol ediniz."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:$.map((t,s)=>{var a,l;return e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] shadow-sm hover:shadow-xl hover:shadow-cyan-100/50 border border-slate-100 hover:border-cyan-200 transition-all group flex flex-col justify-between relative overflow-hidden",children:[e.jsxs("div",{className:"relative z-10 transition-transform duration-300",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gradient-to-tr from-cyan-500 to-blue-600 flex items-center justify-center text-white font-black text-xl shadow-lg shadow-cyan-200",children:t.name.split(" ").map(e=>e[0]).join("")}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-black text-slate-800 leading-tight uppercase group-hover:text-cyan-600 transition-colors tracking-tight",children:t.name}),e.jsxs("p",{className:"text-[10px] text-slate-400 font-black uppercase tracking-widest mt-1",children:[t.grade," • NO: ",t.studentNumber]})]}),t.readingHistory&&t.readingHistory.length>20&&e.jsx("div",{className:"absolute top-0 right-0 text-amber-400",children:e.jsx(n,{size:24,fill:"currentColor"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between text-[10px] font-black uppercase text-slate-400 tracking-widest",children:[e.jsx("span",{children:"Okuma İlerlemesi"}),e.jsxs("span",{className:"text-cyan-600",children:[(null==(a=t.readingHistory)?void 0:a.length)||0," Kitap"]})]}),e.jsx("div",{className:"w-full bg-slate-100 h-3 rounded-full overflow-hidden",children:e.jsx("div",{className:"bg-gradient-to-r from-cyan-500 to-blue-500 h-full rounded-full transition-all duration-1000 shadow-[0_0_10px_rgba(6,182,212,0.4)]",style:{width:`${Math.min(((null==(l=t.readingHistory)?void 0:l.length)||0)/10*100,100)}%`}})})]})]}),e.jsxs("button",{onClick:()=>P(t),className:"mt-8 w-full py-4 bg-slate-50 text-slate-600 rounded-2xl font-black text-[10px] uppercase tracking-widest hover:bg-cyan-600 hover:text-white transition-all flex items-center justify-center gap-2 group-hover:shadow-lg group-hover:shadow-cyan-200",children:["Detaylı Karneyi Görüntüle ",e.jsx(d,{size:14})]})]},t.id)})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-slate-100 shadow-sm flex items-start gap-4 text-slate-500 text-sm",children:[e.jsx("div",{className:"bg-blue-50 p-2 rounded-xl text-blue-500 shrink-0",children:e.jsx(a,{size:20})}),e.jsx("p",{className:"font-medium leading-relaxed",children:"Sayın Velimiz, bu panel üzerinden çocuğunuzun kütüphanemizdeki okuma serüvenini takip edebilirsiniz. Okul numarasını veya tam adını girerek kişisel karnesine ulaşabilir, okuduğu kitapları inceleyebilirsiniz."})]})]}),V&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-md no-print animate-fade-in",children:e.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-[3rem] shadow-2xl overflow-hidden flex flex-col max-h-[90vh] animate-soft-fade border border-white/20",children:[e.jsxs("div",{className:"bg-cyan-600 p-10 text-white flex justify-between items-center shrink-0 relative overflow-hidden",children:[e.jsx("div",{className:"absolute -top-10 -right-10 w-48 h-48 bg-white/10 rounded-full blur-3xl opacity-50"}),e.jsxs("div",{className:"flex items-center gap-6 relative z-10",children:[e.jsx("div",{className:"w-20 h-20 bg-white/20 rounded-3xl flex items-center justify-center text-4xl font-black shadow-inner border border-white/10 backdrop-blur-sm",children:V.name.split(" ").map(e=>e[0]).join("")}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-3xl font-black uppercase tracking-tighter",children:V.name}),e.jsx("p",{className:"text-cyan-100 font-bold uppercase tracking-widest text-[10px] bg-cyan-800/30 px-3 py-1 rounded-full inline-block mt-2",children:"Dijital Okuma Karnesi"})]})]}),e.jsx("button",{onClick:()=>P(null),className:"p-3 bg-white/10 hover:bg-white/20 rounded-2xl transition-transform hover:scale-105 relative z-10",children:e.jsx(d,{size:24,className:"rotate-90"})})]}),e.jsxs("div",{className:"p-8 overflow-y-auto flex-grow bg-slate-50 custom-scrollbar",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-slate-100 flex flex-col items-center shadow-sm",children:[e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2",children:"Toplam Okuduğu"}),e.jsx("p",{className:"text-5xl font-black text-cyan-600 tracking-tighter",children:(null==(x=V.readingHistory)?void 0:x.length)||0}),e.jsx("p",{className:"text-[10px] text-slate-400 font-bold mt-2 uppercase tracking-wide",children:"Kitap"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-slate-100 flex flex-col items-center shadow-sm",children:[e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2",children:"Başarı Puanı"}),e.jsx("p",{className:"text-5xl font-black tracking-tighter "+(((null==(m=V.readingHistory)?void 0:m.length)||0)>30?"text-emerald-500":((null==(h=V.readingHistory)?void 0:h.length)||0)>20?"text-blue-500":((null==(u=V.readingHistory)?void 0:u.length)||0)>10?"text-cyan-500":((null==(g=V.readingHistory)?void 0:g.length)||0)>=1?"text-amber-500":"text-slate-300"),children:((null==(p=V.readingHistory)?void 0:p.length)||0)>30?"A+":((null==(b=V.readingHistory)?void 0:b.length)||0)>20?"A":((null==(f=V.readingHistory)?void 0:f.length)||0)>10?"B":((null==(v=V.readingHistory)?void 0:v.length)||0)>=1?"C":"-"}),e.jsx("p",{className:"text-[10px] font-bold mt-2 uppercase text-center tracking-wide "+(((null==(j=V.readingHistory)?void 0:j.length)||0)>30?"text-emerald-500":((null==(y=V.readingHistory)?void 0:y.length)||0)>20?"text-blue-500":((null==(w=V.readingHistory)?void 0:w.length)||0)>10?"text-cyan-500":((null==(N=V.readingHistory)?void 0:N.length)||0)>=1?"text-amber-500":"text-slate-300"),children:((null==(k=V.readingHistory)?void 0:k.length)||0)>30?"Kitap Kurdu":((null==(z=V.readingHistory)?void 0:z.length)||0)>20?"Harika Okuyucu":((null==(H=V.readingHistory)?void 0:H.length)||0)>10?"İyi Okuyucu":((null==(O=V.readingHistory)?void 0:O.length)||0)>=1?"Okuma Yolunda":"Yeni Başlıyor"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h4",{className:"font-black text-slate-800 flex items-center gap-2 text-lg uppercase tracking-tight",children:[e.jsx(n,{size:24,className:"text-amber-400 drop-shadow-sm"}),"Okuma Geçmişi"]}),e.jsx("div",{className:"space-y-3",children:K.filter(e=>e.studentId===V.id).sort((e,t)=>new Date(t.issueDate).getTime()-new Date(e.issueDate).getTime()).map((t,s)=>e.jsx("div",{className:"flex items-center justify-between p-5 bg-white rounded-3xl border border-slate-100 hover:shadow-md transition-all group hover:border-cyan-100",children:e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx("div",{className:"p-3 bg-slate-50 rounded-2xl shadow-inner group-hover:bg-cyan-500 group-hover:text-white transition-colors",children:e.jsx(c,{size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-black text-slate-800 group-hover:text-cyan-600 transition-colors uppercase text-sm tracking-tight",children:t.book.title}),e.jsxs("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest mt-0.5",children:[new Date(t.issueDate).toLocaleDateString("tr-TR")," Tarihinde Okundu"]})]})]})},s))})]})]}),e.jsx("div",{className:"p-6 bg-white border-t border-slate-100 flex justify-center shrink-0",children:e.jsx("button",{onClick:()=>P(null),className:"px-12 py-4 bg-cyan-600 text-white rounded-2xl font-black uppercase tracking-[0.2em] shadow-lg shadow-cyan-200 hover:bg-cyan-700 transition-all text-xs",children:"Kapat"})})]})})]})};export{o as ParentView};
