import{r as b,a as we,i as ve,g as ke,c as re,b as B,q as D,w as I,d as X,e as ie,f as O,u as F,H as Se,R as K}from"./vendor-d8403d61.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))i(h);new MutationObserver(h=>{for(const d of h)if(d.type==="childList")for(const x of d.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&i(x)}).observe(document,{childList:!0,subtree:!0});function o(h){const d={};return h.integrity&&(d.integrity=h.integrity),h.referrerPolicy&&(d.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?d.credentials="include":h.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function i(h){if(h.ep)return;h.ep=!0;const d=o(h);fetch(h.href,d)}})();var he={exports:{}},W={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ee=b,Ce=Symbol.for("react.element"),Ae=Symbol.for("react.fragment"),Me=Object.prototype.hasOwnProperty,Re=Ee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Be={key:!0,ref:!0,__self:!0,__source:!0};function ue(l,n,o){var i,h={},d=null,x=null;o!==void 0&&(d=""+o),n.key!==void 0&&(d=""+n.key),n.ref!==void 0&&(x=n.ref);for(i in n)Me.call(n,i)&&!Be.hasOwnProperty(i)&&(h[i]=n[i]);if(l&&l.defaultProps)for(i in n=l.defaultProps,n)h[i]===void 0&&(h[i]=n[i]);return{$$typeof:Ce,type:l,key:d,ref:x,props:h,_owner:Re.current}}W.Fragment=Ae;W.jsx=ue;W.jsxs=ue;he.exports=W;var e=he.exports,te={},le=we;te.createRoot=le.createRoot,te.hydrateRoot=le.hydrateRoot;var Le={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const ze=l=>l.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),De=(l,n)=>{const o=b.forwardRef(({color:i="currentColor",size:h=24,strokeWidth:d=2,absoluteStrokeWidth:x,children:m,...t},a)=>b.createElement("svg",{ref:a,...Le,width:h,height:h,stroke:i,strokeWidth:x?Number(d)*24/Number(h):d,className:`lucide lucide-${ze(l)}`,...t},[...n.map(([s,r])=>b.createElement(s,r)),...(Array.isArray(m)?m:[m])||[]]));return o.displayName=`${l}`,o};var w=De;const xe=w("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Z=w("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Ie=w("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]),_e=w("BookDown",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}],["path",{d:"M12 13V7",key:"h0r20n"}],["path",{d:"m9 10 3 3 3-3",key:"zt5b4y"}]]),Te=w("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),Oe=w("BookUp",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}],["path",{d:"M12 13V7",key:"h0r20n"}],["path",{d:"m9 10 3-3 3 3",key:"11gsxs"}]]),V=w("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}]]),Pe=w("CheckCircle2",[["path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z",key:"14v8dr"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),se=w("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),He=w("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]),Ue=w("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Fe=w("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),ae=w("Library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]]),Ke=w("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]),$e=w("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),Ve=w("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),me=w("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),ge=w("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]),Qe=w("RefreshCcw",[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]]),Ye=w("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),Ge=w("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),pe=w("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),Q=w("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),oe=w("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),qe=w("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),G=w("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),J=w("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);var L=(l=>(l.AVAILABLE="AVAILABLE",l.BORROWED="BORROWED",l.LOST="LOST",l))(L||{});const We={apiKey:"AIzaSyBwlK6cJQdiBuxSzKCeV25VzWtsYD6Wd1I",authDomain:"libratech-db.firebaseapp.com",projectId:"libratech-db",storageBucket:"libratech-db.firebasestorage.app",messagingSenderId:"766487965530",appId:"1:766487965530:web:34ab9cc14f5ff6296e0d63"},Xe=ve(We),z=ke(Xe),H=re(z,"books"),U=re(z,"students"),ee=re(z,"transactions"),T=l=>({id:l.id,...l.data()}),M={getBooks:async()=>(await B(H)).docs.map(n=>T(n)),addBook:async l=>{try{const n=D(H,I("isbn","==",l.isbn));if(!(await B(n)).empty)return{success:!1,message:"Bu ISBN numarasına sahip bir kitap zaten var."};const i={...l,status:L.AVAILABLE,addedDate:new Date().toISOString()};return await X(H,i),{success:!0,message:"Kitap başarıyla eklendi."}}catch(n){return{success:!1,message:"Hata: "+n.message}}},deleteBook:async l=>{await ie(O(z,"books",l))},getStudents:async()=>(await B(U)).docs.map(n=>T(n)),addStudent:async l=>{try{const n=D(U,I("studentNumber","==",l.studentNumber));if(!(await B(n)).empty)return{success:!1,message:"Bu numaraya sahip bir öğrenci zaten kayıtlı."};const i={...l,readingHistory:[]};return await X(U,i),{success:!0,message:"Öğrenci başarıyla eklendi."}}catch(n){return{success:!1,message:"Hata: "+n.message}}},deleteStudent:async l=>{await ie(O(z,"students",l))},getActiveTransactions:async()=>{const o=(await B(ee)).docs.map(d=>T(d)).filter(d=>!d.isReturned);if(o.length===0)return[];const[i,h]=await Promise.all([M.getBooks(),M.getStudents()]);return o.map(d=>{const x=i.find(t=>t.id===d.bookId),m=h.find(t=>t.id===d.studentId);return!x||!m?null:{...d,book:x,student:m}}).filter(d=>d!==null)},issueBook:async(l,n,o)=>{try{const i=D(H,I("isbn","==",l)),h=await B(i);if(h.empty)return{success:!1,message:"Bu ISBN/QR kodu ile kitap bulunamadı."};const d=h.docs[0],x=T(d),m=D(U,I("studentNumber","==",n)),t=await B(m);if(t.empty)return{success:!1,message:"Bu numara/QR ile öğrenci bulunamadı."};const a=t.docs[0],s=T(a);if(x.status!==L.AVAILABLE)return{success:!1,message:"Kitap şu anda başkasında ödünçte."};const r=s.readingHistory&&s.readingHistory.includes(x.id);let c;r&&(c=`Dikkat! ${s.name} isimli öğrenci "${x.title}" kitabını daha önce okumuş.`);const p={bookId:x.id,studentId:s.id,issueDate:new Date().toISOString(),dueDate:new Date(Date.now()+o*24*60*60*1e3).toISOString(),isReturned:!1};await X(ee,p),await F(O(z,"books",x.id),{status:L.BORROWED});const g=s.readingHistory||[];return await F(O(z,"students",s.id),{readingHistory:[...g,x.id]}),{success:!0,message:"Kitap başarıyla ödünç verildi.",warning:c}}catch(i){return{success:!1,message:"İşlem Başarısız: "+i.message}}},returnBook:async l=>{try{const n=D(H,I("isbn","==",l)),o=await B(n);if(o.empty)return{success:!1,message:"Kitap bulunamadı."};const i=o.docs[0],h=T(i),d=D(ee,I("bookId","==",h.id),I("isReturned","==",!1)),x=await B(d);if(x.empty)return{success:!1,message:"Bu kitap şu anda ödünçte görünmüyor."};const m=x.docs[0];return await F(O(z,"transactions",m.id),{isReturned:!0,returnDate:new Date().toISOString()}),await F(O(z,"books",h.id),{status:L.AVAILABLE}),{success:!0,message:"Kitap envantere başarıyla iade edildi."}}catch(n){return{success:!1,message:"İade Başarısız: "+n.message}}},resetDatabase:async()=>{console.warn("Reset Database functionality is disabled in Remote DB mode for safety."),alert("Bulut veritabanında toplu silme işlemi güvenlik nedeniyle devre dışı bırakılmıştır. Verileri manuel siliniz.")},removeBookFromHistory:async(l,n)=>{try{const o=O(z,"students",l),h=(await B(D(U))).docs.find(m=>m.id===l);if(!h)return{success:!1,message:"Öğrenci bulunamadı."};const x=(h.data().readingHistory||[]).filter(m=>m!==n);return await F(o,{readingHistory:x}),{success:!0,message:"Kitap geçmişten silindi."}}catch(o){return{success:!1,message:"Hata: "+o.message}}},checkBookForStudent:async(l,n)=>{try{const o=D(H,I("isbn","==",l)),i=await B(o);if(i.empty)return{success:!1,message:"Kitap bulunamadı.",type:"NOT_FOUND"};const h=T(i.docs[0]);if(h.status!==L.AVAILABLE)return{success:!1,message:"Kitap şu anda ödünçte.",type:"NOT_AVAILABLE"};if(n){const d=D(U,I("studentNumber","==",n)),x=await B(d);if(!x.empty){const m=T(x.docs[0]);if(m.readingHistory&&m.readingHistory.includes(h.id))return{success:!1,message:"Bu öğrenci bu kitabı daha önce okumuş!",type:"ALREADY_READ"}}}return{success:!0,message:"Uygun",type:"VALID"}}catch{return{success:!1,message:"Hata oluştu.",type:"NOT_FOUND"}}}},Ze=({children:l,currentPage:n,onNavigate:o,onLogout:i,user:h})=>{const[d,x]=b.useState(!1),m=[{id:"dashboard",label:"Panel",icon:Fe},{id:"circulation",label:"Ödünç İşlemleri",icon:Ie},{id:"books",label:"Kitap Envanteri",icon:Te},{id:"students",label:"Öğrenciler",icon:qe}],t=()=>{window.confirm("TÜM VERİLER SİLİNECEK ve fabrika ayarlarına dönülecek. Onaylıyor musunuz?")&&M.resetDatabase()},a=s=>{o(s),x(!1)};return e.jsxs("div",{className:"flex h-screen bg-gray-50 overflow-hidden flex-col md:flex-row",children:[e.jsxs("div",{className:"md:hidden bg-indigo-900 text-white p-4 flex justify-between items-center shadow-md z-20 no-print",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{size:24}),e.jsx("span",{className:"font-bold text-lg",children:"LibraTech"})]}),e.jsx("button",{onClick:()=>x(!d),className:"p-1 hover:bg-indigo-800 rounded focus:outline-none",children:d?e.jsx(G,{size:24}):e.jsx(Ve,{size:24})})]}),d&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-30 md:hidden transition-opacity",onClick:()=>x(!1)}),e.jsxs("div",{className:`
        fixed md:static inset-y-0 left-0 z-40 w-64 bg-indigo-900 text-white flex flex-col shadow-xl 
        transform transition-transform duration-300 ease-in-out md:translate-x-0 no-print
        ${d?"translate-x-0":"-translate-x-full"}
      `,children:[e.jsxs("div",{className:"hidden md:flex p-6 items-center space-x-3 border-b border-indigo-800",children:[e.jsx("div",{className:"bg-indigo-500 p-2 rounded-lg",children:e.jsx(ae,{size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-lg",children:"LibraTech"}),e.jsx("p",{className:"text-xs text-indigo-300",children:"Okul Kütüphanesi"})]})]}),e.jsxs("div",{className:"md:hidden p-4 border-b border-indigo-800 flex items-center justify-between bg-indigo-950",children:[e.jsx("span",{className:"font-bold text-sm uppercase tracking-wider text-indigo-400",children:"Menü"}),e.jsx("button",{onClick:()=>x(!1),children:e.jsx(G,{size:20})})]}),e.jsx("nav",{className:"flex-1 p-4 space-y-2",children:m.map(s=>{const r=s.icon,c=n===s.id;return e.jsxs("button",{onClick:()=>a(s.id),className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ${c?"bg-indigo-700 text-white shadow-md":"text-indigo-200 hover:bg-indigo-800 hover:text-white"}`,children:[e.jsx(r,{size:20}),e.jsx("span",{className:"font-medium",children:s.label})]},s.id)})}),e.jsxs("div",{className:"p-4 border-t border-indigo-800 space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-3 px-4 py-3 mb-2",children:[e.jsx("img",{src:`https://ui-avatars.com/api/?name=${h.name}&background=random`,alt:"Profile",className:"w-8 h-8 rounded-full"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:h.name}),e.jsx("p",{className:"text-xs text-indigo-300 truncate",children:h.email})]})]}),e.jsxs("button",{onClick:t,className:"w-full flex items-center space-x-3 px-4 py-2 text-indigo-300 hover:bg-indigo-950 hover:text-white rounded-lg transition-colors",title:"Veritabanını Sıfırla",children:[e.jsx(Qe,{size:18}),e.jsx("span",{className:"text-xs",children:"Verileri Sıfırla"})]}),e.jsxs("button",{onClick:i,className:"w-full flex items-center space-x-3 px-4 py-2 text-red-300 hover:bg-indigo-950 hover:text-red-200 rounded-lg transition-colors",children:[e.jsx($e,{size:18}),e.jsx("span",{children:"Çıkış Yap"})]})]})]}),e.jsx("main",{className:"flex-1 overflow-auto w-full relative bg-gray-50",children:e.jsx("div",{className:"max-w-7xl mx-auto p-4 md:p-8 pb-20 md:pb-8",children:l})})]})},Je=({onLogin:l})=>e.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8 space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto bg-indigo-600 w-16 h-16 rounded-xl flex items-center justify-center text-white mb-4",children:e.jsx(ae,{size:32})}),e.jsx("h2",{className:"text-3xl font-extrabold text-gray-900",children:"Kütüphane Yönetimi"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Yönetmek için giriş yapın"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{onClick:l,className:"w-full flex items-center justify-center px-4 py-3 border border-transparent text-sm font-medium rounded-lg text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors shadow-lg shadow-indigo-200",children:"Google ile Giriş Yap"}),e.jsx("button",{onClick:l,className:"w-full flex items-center justify-center px-4 py-3 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 transition-colors",children:"Email ile Giriş Yap"})]}),e.jsx("p",{className:"text-center text-xs text-gray-400",children:"Demo Uygulaması - Herhangi bir butona basarak Admin olarak giriş yapabilirsiniz."})]})}),ce=()=>{const[l,n]=b.useState([]),[o,i]=b.useState(!0),h=async()=>{i(!0);const m=await M.getActiveTransactions();n(m),i(!1)};b.useEffect(()=>{h()},[]);const d=m=>{const t=new Date(m),s=Math.abs(new Date().getTime()-t.getTime());return Math.ceil(s/(1e3*60*60*24))},x=m=>new Date>new Date(m);return o?e.jsx("div",{className:"p-8 text-center",children:"Panel verileri yükleniyor..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Kütüphane Paneli"}),e.jsx("button",{onClick:h,className:"text-sm text-indigo-600 hover:text-indigo-800",children:"Verileri Yenile"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Aktif Ödünçler"}),e.jsx("h3",{className:"text-3xl font-bold text-gray-800 mt-1",children:l.length})]}),e.jsx("div",{className:"bg-blue-50 p-3 rounded-lg text-blue-600",children:e.jsx(Ue,{size:24})})]})}),e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Gecikmiş Kitaplar"}),e.jsx("h3",{className:"text-3xl font-bold text-red-600 mt-1",children:l.filter(m=>x(m.dueDate)).length})]}),e.jsx("div",{className:"bg-red-50 p-3 rounded-lg text-red-600",children:e.jsx(xe,{size:24})})]})}),e.jsx("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Zamanında Teslimler"}),e.jsx("h3",{className:"text-3xl font-bold text-green-600 mt-1",children:l.filter(m=>!x(m.dueDate)).length})]}),e.jsx("div",{className:"bg-green-50 p-3 rounded-lg text-green-600",children:e.jsx(Pe,{size:24})})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-100 bg-gray-50",children:e.jsx("h3",{className:"font-semibold text-gray-800",children:"Şu An Ödünçte Olan Kitaplar"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 text-gray-500 text-sm border-b border-gray-100",children:[e.jsx("th",{className:"px-6 py-3 font-medium",children:"Öğrenci"}),e.jsx("th",{className:"px-6 py-3 font-medium",children:"Kitap Adı"}),e.jsx("th",{className:"px-6 py-3 font-medium",children:"Veriliş Tarihi"}),e.jsx("th",{className:"px-6 py-3 font-medium",children:"Teslim Tarihi"}),e.jsx("th",{className:"px-6 py-3 font-medium",children:"Geçen Gün"}),e.jsx("th",{className:"px-6 py-3 font-medium",children:"Durum"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:l.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-8 text-center text-gray-400",children:"Şu anda ödünç verilmiş kitap yok."})}):l.map(m=>{const t=x(m.dueDate),a=d(m.issueDate);return e.jsxs("tr",{className:`transition-colors ${t?"bg-red-50 hover:bg-red-100":"hover:bg-gray-50"}`,children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-medium text-gray-900",children:m.student.name}),e.jsx("div",{className:"text-xs text-gray-500",children:m.student.studentNumber})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-gray-900",children:m.book.title}),e.jsxs("div",{className:"text-xs text-gray-500",children:["ISBN: ",m.book.isbn]})]}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:new Date(m.issueDate).toLocaleDateString("tr-TR")}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:new Date(m.dueDate).toLocaleDateString("tr-TR")}),e.jsxs("td",{className:"px-6 py-4 text-sm font-medium",children:[a," gün"]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t?"bg-red-100 text-red-800 border border-red-200":"bg-green-100 text-green-800 border border-green-200"}`,children:t?"Gecikmiş":"Zamanında"})})]},m.id)})})]})})]})]})},et=({onComplete:l,onCancel:n,isReturnOnly:o=!1})=>{const[i,h]=b.useState(o?"SCAN_BOOKS_ONLY":"SCAN_STUDENT"),[d,x]=b.useState(null),[m,t]=b.useState([]),[a,s]=b.useState(null),[r,c]=b.useState(null),[p,g]=b.useState(!1),y=b.useRef(null),u=b.useRef(0),C=b.useRef(!1),E=(j="success")=>{try{const v=new(window.AudioContext||window.webkitAudioContext),k=v.createOscillator(),_=v.createGain();k.connect(_),_.connect(v.destination),k.type="sine",k.frequency.setValueAtTime(j==="success"?880:220,v.currentTime),_.gain.setValueAtTime(.1,v.currentTime),k.start(),setTimeout(()=>{k.stop(),v.close()},j==="success"?150:400)}catch(v){console.error("Audio play failed",v)}};b.useEffect(()=>{const j="optimized-reader";return(async()=>{try{const k=new Se(j);y.current=k,await k.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250},aspectRatio:1,disableFlip:!1},(_,ne)=>{S(_)},_=>{}),C.current=!0}catch(k){console.error("Error starting scanner",k)}})(),()=>{y.current&&C.current&&(y.current.stop().then(()=>{var k;(k=y.current)==null||k.clear()}).catch(k=>{console.error("Failed to stop scanner",k)}),C.current=!1)}},[]);const N=b.useRef({scanState:i,studentId:d,books:m});b.useEffect(()=>{N.current={scanState:i,studentId:d,books:m}},[i,d,m]);const S=async j=>{const v=Date.now();if(v-u.current<1e3)return;u.current=v;const{scanState:k,studentId:_,books:ne}=N.current;if(k==="SCAN_STUDENT")E("success"),x(j),h("SCAN_BOOKS"),R(j,"success","Öğrenci Tanımlandı");else{if(ne.includes(j))return;if(!o){const Y=await M.checkBookForStudent(j,_);if(!Y.success){E("error"),R(j,"error",Y.message);return}}E("success"),t(Y=>[...Y,j]),R(j,"success",o?"İade Listesine Eklendi":"Ödünç Listesine Eklendi")}},R=(j,v,k)=>{s(j),c({type:v,message:k}),g(!0),setTimeout(()=>g(!1),v==="success"?1e3:2e3)},f=()=>{const j=prompt("Öğrenci Numarası Girin:");j&&S(j)},A=()=>{const j=prompt("Kitap Barkodu Girin:");j&&S(j)};return e.jsxs("div",{className:"fixed inset-0 z-50 bg-black flex flex-col items-center justify-between p-4",children:[e.jsxs("div",{className:"w-full text-white flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2",children:[i==="SCAN_STUDENT"?e.jsx(oe,{className:"text-yellow-400"}):e.jsx(V,{className:"text-green-400"}),i==="SCAN_STUDENT"?"Öğrenci Kartını Okutun":o?"İade Edilecek Kitapları Okutun":"Kitapları Okutun"]}),e.jsx("button",{onClick:n,className:"p-2 bg-gray-800 rounded-full hover:bg-gray-700",children:e.jsx(G,{size:24})})]}),e.jsxs("div",{className:"relative w-full flex-grow flex items-center justify-center bg-black overflow-hidden rounded-xl border-2 border-gray-700",children:[e.jsx("div",{id:"optimized-reader",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 pointer-events-none flex items-center justify-center",children:e.jsx("div",{className:`w-64 h-64 border-4 rounded-3xl opacity-50 ${i==="SCAN_STUDENT"?"border-yellow-400":"border-green-400"}`})}),p&&e.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center bg-black/70 animated-fade-in",children:e.jsxs("div",{className:`text-black p-8 rounded-3xl flex flex-col items-center animate-bounce-in shadow-2xl ${(r==null?void 0:r.type)==="success"?"bg-white":"bg-red-50 border-4 border-red-500"}`,children:[(r==null?void 0:r.type)==="success"?e.jsx(se,{size:64,className:"text-green-500 mb-4"}):e.jsx(xe,{size:64,className:"text-red-500 mb-4 animate-pulse"}),e.jsx("p",{className:"text-2xl font-black mb-1",children:a}),e.jsx("p",{className:`text-lg font-bold ${(r==null?void 0:r.type)==="success"?"text-gray-500":"text-red-600"}`,children:r==null?void 0:r.message})]})})]}),e.jsxs("div",{className:"w-full mt-4 space-y-3",children:[e.jsxs("div",{className:"bg-gray-900 text-white p-4 rounded-xl flex items-center justify-between",children:[!o&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${d?"bg-green-600":"bg-gray-700"}`,children:e.jsx(oe,{size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400",children:"Aktif Öğrenci"}),e.jsx("p",{className:"font-mono font-bold",children:d||"Bekleniyor..."})]})]}),e.jsx("div",{className:"h-8 w-px bg-gray-700"})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-grow justify-center",children:[e.jsx("div",{className:`p-2 rounded-lg ${m.length>0?o?"bg-orange-600":"bg-blue-600":"bg-gray-700"}`,children:e.jsx(V,{size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400",children:o?"Toplanacak Kitap":"Kitap Sayısı"}),e.jsx("p",{className:"font-mono font-bold text-center",children:m.length})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i==="SCAN_BOOKS"&&e.jsxs("button",{onClick:()=>{h("SCAN_STUDENT"),x(null),t([])},className:"flex items-center justify-center gap-2 py-3 px-4 bg-gray-800 text-white rounded-xl font-semibold hover:bg-gray-700 active:scale-95 transition-transform",children:[e.jsx(Ye,{size:18}),e.jsx("span",{children:"Sıfırla"})]}),e.jsxs("button",{onClick:()=>(o||d)&&m.length>0?l(d,m):null,disabled:o?m.length===0:!d||m.length===0,className:`col-span-${i==="SCAN_STUDENT"||o?"2":"1"} flex items-center justify-center gap-2 py-3 px-4 rounded-xl font-bold text-lg shadow-lg active:scale-95 transition-all ${(o||d)&&m.length>0?"bg-green-500 hover:bg-green-600 text-white":"bg-gray-800 text-gray-500 cursor-not-allowed"}`,children:[e.jsx(Ge,{size:20}),e.jsx("span",{children:o?"İadeleri Tamamla":"Ödünç İşlemini Tamamla"})]})]}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx("button",{onClick:f,className:"text-xs text-gray-500 underline",children:"El ile Öğrenci Gir"}),d&&e.jsx("button",{onClick:A,className:"text-xs text-gray-500 underline",children:"El ile Kitap Gir"})]})]})]})},tt=()=>{const[l,n]=b.useState("ISSUE"),[o,i]=b.useState(14),[h,d]=b.useState(null),[x,m]=b.useState(null),[t,a]=b.useState(!1),s=async(r,c)=>{a(!1),m(null),d({type:"warning",msg:"İşlem yapılıyor, lütfen bekleyin..."});const p=[],g=[];for(const y of c)try{const u=l==="ISSUE"?await M.issueBook(y,r,o):await M.returnBook(y);u.success?p.push(`${y}: ${u.message}`):g.push(`${y}: ${u.message}`)}catch{g.push(`${y}: Sistem hatası`)}m({successes:p,failures:g}),g.length===0?d({type:"success",msg:`Toplam ${p.length} kitap başarıyla ${l==="ISSUE"?"ödünç verildi":"iade alındı"}.`}):d({type:"warning",msg:`${p.length} kitap başarılı, ${g.length} kitapta hata oluştu.`})};return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8 pb-20",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h2",{className:"text-4xl font-black text-gray-900 tracking-tight",children:"Ödünç & İade Bankosu"}),e.jsx("p",{className:"text-gray-500 text-lg",children:"Hızlı tarama sistemi ile kitap işlemlerini saniyeler içinde tamamlayın."})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsx("div",{className:`relative overflow-hidden group rounded-3xl p-8 border-2 transition-all cursor-pointer ${l==="ISSUE"?"border-indigo-500 bg-white shadow-xl":"border-gray-100 bg-gray-50 hover:border-gray-200"}`,onClick:()=>{n("ISSUE"),d(null),m(null)},children:e.jsxs("div",{className:"flex flex-col h-full justify-between",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:`w-14 h-14 rounded-2xl flex items-center justify-center ${l==="ISSUE"?"bg-indigo-500 text-white":"bg-gray-200 text-gray-400"}`,children:e.jsx(_e,{size:32})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Kitap Ver (Ödünç)"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Öğrenci kartı ve kitapları taratarak ödünç verin."})]})]}),l==="ISSUE"&&e.jsxs("div",{className:"mt-8 space-y-4 animate-fade-in",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-semibold text-gray-600",children:"Ödünç Süresi"}),e.jsxs("select",{value:o,onClick:r=>r.stopPropagation(),onChange:r=>i(Number(r.target.value)),className:"block w-full rounded-xl border-gray-200 border py-3 px-4 focus:ring-2 focus:ring-indigo-500 outline-none",children:[e.jsx("option",{value:7,children:"7 Gün (1 Hafta)"}),e.jsx("option",{value:14,children:"14 Gün (2 Hafta)"}),e.jsx("option",{value:30,children:"30 Gün (1 Ay)"}),e.jsx("option",{value:90,children:"90 Gün (Dönemlik)"})]})]}),e.jsxs("button",{onClick:r=>{r.stopPropagation(),a(!0)},className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white py-4 rounded-2xl font-bold flex items-center justify-center gap-3 shadow-lg shadow-indigo-200 transition-transform active:scale-95",children:[e.jsx(J,{size:22}),e.jsx("span",{children:"Hızlı Taramayı Başlat"})]})]})]})}),e.jsx("div",{className:`relative overflow-hidden group rounded-3xl p-8 border-2 transition-all cursor-pointer ${l==="RETURN"?"border-emerald-500 bg-white shadow-xl":"border-gray-100 bg-gray-50 hover:border-gray-200"}`,onClick:()=>{n("RETURN"),d(null),m(null)},children:e.jsxs("div",{className:"flex flex-col h-full justify-between",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:`w-14 h-14 rounded-2xl flex items-center justify-center ${l==="RETURN"?"bg-emerald-500 text-white":"bg-gray-200 text-gray-400"}`,children:e.jsx(Oe,{size:32})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Kitap Al (İade)"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"İade edilen kitapları topluca envantere geri alın."})]})]}),l==="RETURN"&&e.jsx("div",{className:"mt-8 animate-fade-in",children:e.jsxs("button",{onClick:r=>{r.stopPropagation(),a(!0)},className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white py-4 rounded-2xl font-bold flex items-center justify-center gap-3 shadow-lg shadow-emerald-200 transition-transform active:scale-95",children:[e.jsx(J,{size:22}),e.jsx("span",{children:"Hızlı Taramayı Başlat"})]})})]})})]}),t&&e.jsx(et,{onComplete:s,onCancel:()=>a(!1),isReturnOnly:l==="RETURN"}),h&&e.jsxs("div",{className:`p-6 rounded-3xl flex items-start space-x-4 border ${h.type==="error"?"bg-red-50 text-red-800 border-red-100":h.type==="warning"?"bg-amber-50 text-amber-800 border-amber-100":"bg-green-50 text-green-800 border-green-100"}`,children:[h.type==="error"&&e.jsx(Z,{className:"shrink-0 mt-1",size:28}),h.type==="warning"&&e.jsx(Z,{className:"shrink-0 mt-1",size:28}),h.type==="success"&&e.jsx(se,{className:"shrink-0 mt-1",size:28}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold mb-1",children:h.type==="error"?"Hata":h.type==="warning"?"Bilgi/Uyarı":"Başarılı"}),e.jsx("p",{className:"opacity-90",children:h.msg})]})]}),x&&e.jsxs("div",{className:"bg-white border border-gray-100 rounded-3xl overflow-hidden shadow-2xl",children:[e.jsxs("div",{className:"bg-gray-50 px-8 py-5 border-b flex justify-between items-center",children:[e.jsxs("h3",{className:"font-black text-xl text-gray-800 flex items-center gap-3",children:[e.jsx(Ke,{size:24,className:"text-gray-400"}),"İşlem Raporu"]}),e.jsxs("button",{onClick:()=>m(null),className:"text-gray-400 hover:text-gray-600 transition-colors",children:[e.jsx(J,{size:20,className:"inline mr-1 rotate-12"})," Raporu Kapat"]})]}),e.jsxs("div",{className:"p-8 grid md:grid-cols-2 gap-8",children:[x.successes.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-lg font-black text-green-700 flex items-center gap-2",children:[e.jsx(se,{size:20})," Başarılı (",x.successes.length,")"]}),e.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 pr-2",children:x.successes.map((r,c)=>e.jsxs("div",{className:"p-3 bg-green-50 rounded-xl text-sm text-green-700 font-medium flex items-center gap-3 border border-green-100",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-400"}),r]},c))})]}),x.failures.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-lg font-black text-red-700 flex items-center gap-2",children:[e.jsx(Z,{size:20})," Hatalı (",x.failures.length,")"]}),e.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 pr-2",children:x.failures.map((r,c)=>e.jsxs("div",{className:"p-3 bg-red-50 rounded-xl text-sm text-red-700 font-medium flex items-center gap-3 border border-red-100",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-400"}),r]},c))})]})]})]})]})};var st=Object.defineProperty,q=Object.getOwnPropertySymbols,fe=Object.prototype.hasOwnProperty,ye=Object.prototype.propertyIsEnumerable,de=(l,n,o)=>n in l?st(l,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[n]=o,at=(l,n)=>{for(var o in n||(n={}))fe.call(n,o)&&de(l,o,n[o]);if(q)for(var o of q(n))ye.call(n,o)&&de(l,o,n[o]);return l},rt=(l,n)=>{var o={};for(var i in l)fe.call(l,i)&&n.indexOf(i)<0&&(o[i]=l[i]);if(l!=null&&q)for(var i of q(l))n.indexOf(i)<0&&ye.call(l,i)&&(o[i]=l[i]);return o};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var P;(l=>{const n=class{constructor(t,a,s,r){if(this.version=t,this.errorCorrectionLevel=a,this.modules=[],this.isFunction=[],t<n.MIN_VERSION||t>n.MAX_VERSION)throw new RangeError("Version value out of range");if(r<-1||r>7)throw new RangeError("Mask value out of range");this.size=t*4+17;let c=[];for(let g=0;g<this.size;g++)c.push(!1);for(let g=0;g<this.size;g++)this.modules.push(c.slice()),this.isFunction.push(c.slice());this.drawFunctionPatterns();const p=this.addEccAndInterleave(s);if(this.drawCodewords(p),r==-1){let g=1e9;for(let y=0;y<8;y++){this.applyMask(y),this.drawFormatBits(y);const u=this.getPenaltyScore();u<g&&(r=y,g=u),this.applyMask(y)}}d(0<=r&&r<=7),this.mask=r,this.applyMask(r),this.drawFormatBits(r),this.isFunction=[]}static encodeText(t,a){const s=l.QrSegment.makeSegments(t);return n.encodeSegments(s,a)}static encodeBinary(t,a){const s=l.QrSegment.makeBytes(t);return n.encodeSegments([s],a)}static encodeSegments(t,a,s=1,r=40,c=-1,p=!0){if(!(n.MIN_VERSION<=s&&s<=r&&r<=n.MAX_VERSION)||c<-1||c>7)throw new RangeError("Invalid value");let g,y;for(g=s;;g++){const N=n.getNumDataCodewords(g,a)*8,S=m.getTotalBits(t,g);if(S<=N){y=S;break}if(g>=r)throw new RangeError("Data too long")}for(const N of[n.Ecc.MEDIUM,n.Ecc.QUARTILE,n.Ecc.HIGH])p&&y<=n.getNumDataCodewords(g,N)*8&&(a=N);let u=[];for(const N of t){i(N.mode.modeBits,4,u),i(N.numChars,N.mode.numCharCountBits(g),u);for(const S of N.getData())u.push(S)}d(u.length==y);const C=n.getNumDataCodewords(g,a)*8;d(u.length<=C),i(0,Math.min(4,C-u.length),u),i(0,(8-u.length%8)%8,u),d(u.length%8==0);for(let N=236;u.length<C;N^=253)i(N,8,u);let E=[];for(;E.length*8<u.length;)E.push(0);return u.forEach((N,S)=>E[S>>>3]|=N<<7-(S&7)),new n(g,a,E,c)}getModule(t,a){return 0<=t&&t<this.size&&0<=a&&a<this.size&&this.modules[a][t]}getModules(){return this.modules}drawFunctionPatterns(){for(let s=0;s<this.size;s++)this.setFunctionModule(6,s,s%2==0),this.setFunctionModule(s,6,s%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const t=this.getAlignmentPatternPositions(),a=t.length;for(let s=0;s<a;s++)for(let r=0;r<a;r++)s==0&&r==0||s==0&&r==a-1||s==a-1&&r==0||this.drawAlignmentPattern(t[s],t[r]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(t){const a=this.errorCorrectionLevel.formatBits<<3|t;let s=a;for(let c=0;c<10;c++)s=s<<1^(s>>>9)*1335;const r=(a<<10|s)^21522;d(r>>>15==0);for(let c=0;c<=5;c++)this.setFunctionModule(8,c,h(r,c));this.setFunctionModule(8,7,h(r,6)),this.setFunctionModule(8,8,h(r,7)),this.setFunctionModule(7,8,h(r,8));for(let c=9;c<15;c++)this.setFunctionModule(14-c,8,h(r,c));for(let c=0;c<8;c++)this.setFunctionModule(this.size-1-c,8,h(r,c));for(let c=8;c<15;c++)this.setFunctionModule(8,this.size-15+c,h(r,c));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let t=this.version;for(let s=0;s<12;s++)t=t<<1^(t>>>11)*7973;const a=this.version<<12|t;d(a>>>18==0);for(let s=0;s<18;s++){const r=h(a,s),c=this.size-11+s%3,p=Math.floor(s/3);this.setFunctionModule(c,p,r),this.setFunctionModule(p,c,r)}}drawFinderPattern(t,a){for(let s=-4;s<=4;s++)for(let r=-4;r<=4;r++){const c=Math.max(Math.abs(r),Math.abs(s)),p=t+r,g=a+s;0<=p&&p<this.size&&0<=g&&g<this.size&&this.setFunctionModule(p,g,c!=2&&c!=4)}}drawAlignmentPattern(t,a){for(let s=-2;s<=2;s++)for(let r=-2;r<=2;r++)this.setFunctionModule(t+r,a+s,Math.max(Math.abs(r),Math.abs(s))!=1)}setFunctionModule(t,a,s){this.modules[a][t]=s,this.isFunction[a][t]=!0}addEccAndInterleave(t){const a=this.version,s=this.errorCorrectionLevel;if(t.length!=n.getNumDataCodewords(a,s))throw new RangeError("Invalid argument");const r=n.NUM_ERROR_CORRECTION_BLOCKS[s.ordinal][a],c=n.ECC_CODEWORDS_PER_BLOCK[s.ordinal][a],p=Math.floor(n.getNumRawDataModules(a)/8),g=r-p%r,y=Math.floor(p/r);let u=[];const C=n.reedSolomonComputeDivisor(c);for(let N=0,S=0;N<r;N++){let R=t.slice(S,S+y-c+(N<g?0:1));S+=R.length;const f=n.reedSolomonComputeRemainder(R,C);N<g&&R.push(0),u.push(R.concat(f))}let E=[];for(let N=0;N<u[0].length;N++)u.forEach((S,R)=>{(N!=y-c||R>=g)&&E.push(S[N])});return d(E.length==p),E}drawCodewords(t){if(t.length!=Math.floor(n.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let a=0;for(let s=this.size-1;s>=1;s-=2){s==6&&(s=5);for(let r=0;r<this.size;r++)for(let c=0;c<2;c++){const p=s-c,y=(s+1&2)==0?this.size-1-r:r;!this.isFunction[y][p]&&a<t.length*8&&(this.modules[y][p]=h(t[a>>>3],7-(a&7)),a++)}}d(a==t.length*8)}applyMask(t){if(t<0||t>7)throw new RangeError("Mask value out of range");for(let a=0;a<this.size;a++)for(let s=0;s<this.size;s++){let r;switch(t){case 0:r=(s+a)%2==0;break;case 1:r=a%2==0;break;case 2:r=s%3==0;break;case 3:r=(s+a)%3==0;break;case 4:r=(Math.floor(s/3)+Math.floor(a/2))%2==0;break;case 5:r=s*a%2+s*a%3==0;break;case 6:r=(s*a%2+s*a%3)%2==0;break;case 7:r=((s+a)%2+s*a%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[a][s]&&r&&(this.modules[a][s]=!this.modules[a][s])}}getPenaltyScore(){let t=0;for(let c=0;c<this.size;c++){let p=!1,g=0,y=[0,0,0,0,0,0,0];for(let u=0;u<this.size;u++)this.modules[c][u]==p?(g++,g==5?t+=n.PENALTY_N1:g>5&&t++):(this.finderPenaltyAddHistory(g,y),p||(t+=this.finderPenaltyCountPatterns(y)*n.PENALTY_N3),p=this.modules[c][u],g=1);t+=this.finderPenaltyTerminateAndCount(p,g,y)*n.PENALTY_N3}for(let c=0;c<this.size;c++){let p=!1,g=0,y=[0,0,0,0,0,0,0];for(let u=0;u<this.size;u++)this.modules[u][c]==p?(g++,g==5?t+=n.PENALTY_N1:g>5&&t++):(this.finderPenaltyAddHistory(g,y),p||(t+=this.finderPenaltyCountPatterns(y)*n.PENALTY_N3),p=this.modules[u][c],g=1);t+=this.finderPenaltyTerminateAndCount(p,g,y)*n.PENALTY_N3}for(let c=0;c<this.size-1;c++)for(let p=0;p<this.size-1;p++){const g=this.modules[c][p];g==this.modules[c][p+1]&&g==this.modules[c+1][p]&&g==this.modules[c+1][p+1]&&(t+=n.PENALTY_N2)}let a=0;for(const c of this.modules)a=c.reduce((p,g)=>p+(g?1:0),a);const s=this.size*this.size,r=Math.ceil(Math.abs(a*20-s*10)/s)-1;return d(0<=r&&r<=9),t+=r*n.PENALTY_N4,d(0<=t&&t<=2568888),t}getAlignmentPatternPositions(){if(this.version==1)return[];{const t=Math.floor(this.version/7)+2,a=this.version==32?26:Math.ceil((this.version*4+4)/(t*2-2))*2;let s=[6];for(let r=this.size-7;s.length<t;r-=a)s.splice(1,0,r);return s}}static getNumRawDataModules(t){if(t<n.MIN_VERSION||t>n.MAX_VERSION)throw new RangeError("Version number out of range");let a=(16*t+128)*t+64;if(t>=2){const s=Math.floor(t/7)+2;a-=(25*s-10)*s-55,t>=7&&(a-=36)}return d(208<=a&&a<=29648),a}static getNumDataCodewords(t,a){return Math.floor(n.getNumRawDataModules(t)/8)-n.ECC_CODEWORDS_PER_BLOCK[a.ordinal][t]*n.NUM_ERROR_CORRECTION_BLOCKS[a.ordinal][t]}static reedSolomonComputeDivisor(t){if(t<1||t>255)throw new RangeError("Degree out of range");let a=[];for(let r=0;r<t-1;r++)a.push(0);a.push(1);let s=1;for(let r=0;r<t;r++){for(let c=0;c<a.length;c++)a[c]=n.reedSolomonMultiply(a[c],s),c+1<a.length&&(a[c]^=a[c+1]);s=n.reedSolomonMultiply(s,2)}return a}static reedSolomonComputeRemainder(t,a){let s=a.map(r=>0);for(const r of t){const c=r^s.shift();s.push(0),a.forEach((p,g)=>s[g]^=n.reedSolomonMultiply(p,c))}return s}static reedSolomonMultiply(t,a){if(t>>>8||a>>>8)throw new RangeError("Byte out of range");let s=0;for(let r=7;r>=0;r--)s=s<<1^(s>>>7)*285,s^=(a>>>r&1)*t;return d(s>>>8==0),s}finderPenaltyCountPatterns(t){const a=t[1];d(a<=this.size*3);const s=a>0&&t[2]==a&&t[3]==a*3&&t[4]==a&&t[5]==a;return(s&&t[0]>=a*4&&t[6]>=a?1:0)+(s&&t[6]>=a*4&&t[0]>=a?1:0)}finderPenaltyTerminateAndCount(t,a,s){return t&&(this.finderPenaltyAddHistory(a,s),a=0),a+=this.size,this.finderPenaltyAddHistory(a,s),this.finderPenaltyCountPatterns(s)}finderPenaltyAddHistory(t,a){a[0]==0&&(t+=this.size),a.pop(),a.unshift(t)}};let o=n;o.MIN_VERSION=1,o.MAX_VERSION=40,o.PENALTY_N1=3,o.PENALTY_N2=3,o.PENALTY_N3=40,o.PENALTY_N4=10,o.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],o.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],l.QrCode=o;function i(t,a,s){if(a<0||a>31||t>>>a)throw new RangeError("Value out of range");for(let r=a-1;r>=0;r--)s.push(t>>>r&1)}function h(t,a){return(t>>>a&1)!=0}function d(t){if(!t)throw new Error("Assertion error")}const x=class{constructor(t,a,s){if(this.mode=t,this.numChars=a,this.bitData=s,a<0)throw new RangeError("Invalid argument");this.bitData=s.slice()}static makeBytes(t){let a=[];for(const s of t)i(s,8,a);return new x(x.Mode.BYTE,t.length,a)}static makeNumeric(t){if(!x.isNumeric(t))throw new RangeError("String contains non-numeric characters");let a=[];for(let s=0;s<t.length;){const r=Math.min(t.length-s,3);i(parseInt(t.substr(s,r),10),r*3+1,a),s+=r}return new x(x.Mode.NUMERIC,t.length,a)}static makeAlphanumeric(t){if(!x.isAlphanumeric(t))throw new RangeError("String contains unencodable characters in alphanumeric mode");let a=[],s;for(s=0;s+2<=t.length;s+=2){let r=x.ALPHANUMERIC_CHARSET.indexOf(t.charAt(s))*45;r+=x.ALPHANUMERIC_CHARSET.indexOf(t.charAt(s+1)),i(r,11,a)}return s<t.length&&i(x.ALPHANUMERIC_CHARSET.indexOf(t.charAt(s)),6,a),new x(x.Mode.ALPHANUMERIC,t.length,a)}static makeSegments(t){return t==""?[]:x.isNumeric(t)?[x.makeNumeric(t)]:x.isAlphanumeric(t)?[x.makeAlphanumeric(t)]:[x.makeBytes(x.toUtf8ByteArray(t))]}static makeEci(t){let a=[];if(t<0)throw new RangeError("ECI assignment value out of range");if(t<128)i(t,8,a);else if(t<16384)i(2,2,a),i(t,14,a);else if(t<1e6)i(6,3,a),i(t,21,a);else throw new RangeError("ECI assignment value out of range");return new x(x.Mode.ECI,0,a)}static isNumeric(t){return x.NUMERIC_REGEX.test(t)}static isAlphanumeric(t){return x.ALPHANUMERIC_REGEX.test(t)}getData(){return this.bitData.slice()}static getTotalBits(t,a){let s=0;for(const r of t){const c=r.mode.numCharCountBits(a);if(r.numChars>=1<<c)return 1/0;s+=4+c+r.bitData.length}return s}static toUtf8ByteArray(t){t=encodeURI(t);let a=[];for(let s=0;s<t.length;s++)t.charAt(s)!="%"?a.push(t.charCodeAt(s)):(a.push(parseInt(t.substr(s+1,2),16)),s+=2);return a}};let m=x;m.NUMERIC_REGEX=/^[0-9]*$/,m.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,m.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",l.QrSegment=m})(P||(P={}));(l=>{(n=>{const o=class{constructor(h,d){this.ordinal=h,this.formatBits=d}};let i=o;i.LOW=new o(0,1),i.MEDIUM=new o(1,0),i.QUARTILE=new o(2,3),i.HIGH=new o(3,2),n.Ecc=i})(l.QrCode||(l.QrCode={}))})(P||(P={}));(l=>{(n=>{const o=class{constructor(h,d){this.modeBits=h,this.numBitsCharCount=d}numCharCountBits(h){return this.numBitsCharCount[Math.floor((h+7)/17)]}};let i=o;i.NUMERIC=new o(1,[10,12,14]),i.ALPHANUMERIC=new o(2,[9,11,13]),i.BYTE=new o(4,[8,16,16]),i.KANJI=new o(8,[8,10,12]),i.ECI=new o(7,[0,0,0]),n.Mode=i})(l.QrSegment||(l.QrSegment={}))})(P||(P={}));var $=P;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var nt={L:$.QrCode.Ecc.LOW,M:$.QrCode.Ecc.MEDIUM,Q:$.QrCode.Ecc.QUARTILE,H:$.QrCode.Ecc.HIGH},it=128,lt="L",ot="#FFFFFF",ct="#000000",dt=!1,be=4,ht=.1;function ut(l,n=0){const o=[];return l.forEach(function(i,h){let d=null;i.forEach(function(x,m){if(!x&&d!==null){o.push(`M${d+n} ${h+n}h${m-d}v1H${d+n}z`),d=null;return}if(m===i.length-1){if(!x)return;d===null?o.push(`M${m+n},${h+n} h1v1H${m+n}z`):o.push(`M${d+n},${h+n} h${m+1-d}v1H${d+n}z`);return}x&&d===null&&(d=m)})}),o.join("")}function xt(l,n){return l.slice().map((o,i)=>i<n.y||i>=n.y+n.h?o:o.map((h,d)=>d<n.x||d>=n.x+n.w?h:!1))}function mt(l,n,o,i){if(i==null)return null;const h=o?be:0,d=l.length+h*2,x=Math.floor(n*ht),m=d/n,t=(i.width||x)*m,a=(i.height||x)*m,s=i.x==null?l.length/2-t/2:i.x*m,r=i.y==null?l.length/2-a/2:i.y*m;let c=null;if(i.excavate){let p=Math.floor(s),g=Math.floor(r),y=Math.ceil(t+s-p),u=Math.ceil(a+r-g);c={x:p,y:g,w:y,h:u}}return{x:s,y:r,h:a,w:t,excavation:c}}(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})();function gt(l){const n=l,{value:o,size:i=it,level:h=lt,bgColor:d=ot,fgColor:x=ct,includeMargin:m=dt,imageSettings:t}=n,a=rt(n,["value","size","level","bgColor","fgColor","includeMargin","imageSettings"]);let s=$.QrCode.encodeText(o,nt[h]).getModules();const r=m?be:0,c=s.length+r*2,p=mt(s,i,m,t);let g=null;t!=null&&p!=null&&(p.excavation!=null&&(s=xt(s,p.excavation)),g=K.createElement("image",{xlinkHref:t.src,height:p.h,width:p.w,x:p.x+r,y:p.y+r,preserveAspectRatio:"none"}));const y=ut(s,r);return K.createElement("svg",at({height:i,width:i,viewBox:`0 0 ${c} ${c}`},a),K.createElement("path",{fill:d,d:`M0,0 h${c}v${c}H0z`,shapeRendering:"crispEdges"}),K.createElement("path",{fill:x,d:y,shapeRendering:"crispEdges"}),g)}const je=({value:l,label:n,subLabel:o,size:i=128})=>e.jsxs("div",{className:"flex flex-col items-center justify-center p-4 border border-gray-200 rounded-lg bg-white shadow-sm break-inside-avoid",children:[e.jsx(gt,{value:l,size:i,level:"H"}),e.jsxs("div",{className:"mt-2 text-center",children:[e.jsx("p",{className:"font-bold text-gray-800 text-sm",children:n}),o&&e.jsx("p",{className:"text-xs text-gray-500",children:o})]})]}),pt=()=>{const[l,n]=b.useState([]),[o,i]=b.useState([]),[h,d]=b.useState(""),[x,m]=b.useState(!1),[t,a]=b.useState({title:"",author:"",isbn:"",category:""}),s=async()=>{const u=await M.getBooks();n(u),i(u)};b.useEffect(()=>{s()},[]),b.useEffect(()=>{const u=h.toLowerCase(),C=l.filter(E=>E.title.toLowerCase().includes(u)||E.author.toLowerCase().includes(u)||E.isbn.includes(u));i(C)},[h,l]);const r=async u=>{if(u.preventDefault(),t.title&&t.isbn){const C=await M.addBook(t);C.success?(a({title:"",author:"",isbn:"",category:""}),m(!1),s()):alert(C.message)}},c=async u=>{window.confirm("Bu kitabı silmek istediğinize emin misiniz?")&&(await M.deleteBook(u),s())},p=()=>{window.print()},g=()=>{a(u=>({...u,isbn:Math.floor(1e12+Math.random()*9e12).toString()}))},y=u=>{switch(u){case L.AVAILABLE:return"MEVCUT";case L.BORROWED:return"ÖDÜNÇTE";case L.LOST:return"KAYIP";default:return u}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 no-print",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Kitap Envanteri"}),e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(pe,{size:18,className:"text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Kitap ara...",className:"pl-10 block w-full rounded-lg border-gray-300 border py-2 px-4 focus:ring-indigo-500 focus:border-indigo-500",value:h,onChange:u=>d(u.target.value)})]}),e.jsxs("div",{className:"flex space-x-3 w-full md:w-auto",children:[e.jsxs("button",{onClick:p,className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 flex items-center justify-center space-x-2 flex-1 md:flex-none",children:[e.jsx(ge,{size:18}),e.jsx("span",{children:"QR Yazdır"})]}),e.jsxs("button",{onClick:()=>m(!x),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 flex items-center justify-center space-x-2 flex-1 md:flex-none",children:[e.jsx(me,{size:18}),e.jsx("span",{children:"Ekle"})]})]})]}),x&&e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md border border-indigo-100 no-print",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Yeni Kitap Ekle"}),e.jsxs("form",{onSubmit:r,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("input",{placeholder:"Kitap Adı",className:"border p-2 rounded",value:t.title,onChange:u=>a({...t,title:u.target.value}),required:!0}),e.jsx("input",{placeholder:"Yazar",className:"border p-2 rounded",value:t.author,onChange:u=>a({...t,author:u.target.value}),required:!0}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{placeholder:"ISBN / Barkod",className:"border p-2 rounded flex-1",value:t.isbn,onChange:u=>a({...t,isbn:u.target.value}),required:!0}),e.jsx("button",{type:"button",onClick:g,className:"text-xs bg-gray-100 px-2 rounded hover:bg-gray-200",children:"Üret"})]}),e.jsx("input",{placeholder:"Kategori",className:"border p-2 rounded",value:t.category,onChange:u=>a({...t,category:u.target.value})}),e.jsx("button",{type:"submit",className:"col-span-2 bg-indigo-600 text-white p-2 rounded hover:bg-indigo-700",children:"Kaydet"})]})]}),e.jsx("div",{className:"hidden md:block bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden no-print",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-sm font-medium text-gray-500",children:"Başlık"}),e.jsx("th",{className:"px-6 py-3 text-sm font-medium text-gray-500",children:"Yazar"}),e.jsx("th",{className:"px-6 py-3 text-sm font-medium text-gray-500",children:"ISBN"}),e.jsx("th",{className:"px-6 py-3 text-sm font-medium text-gray-500",children:"Durum"}),e.jsx("th",{className:"px-6 py-3 text-sm font-medium text-gray-500 text-right",children:"İşlem"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:o.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-6 text-gray-400",children:"Kitap bulunamadı."})}):o.map(u=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4",children:u.title}),e.jsx("td",{className:"px-6 py-4 text-gray-500",children:u.author}),e.jsx("td",{className:"px-6 py-4 font-mono text-xs",children:u.isbn}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${u.status===L.AVAILABLE?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:y(u.status)})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("button",{onClick:()=>c(u.id),className:"text-red-400 hover:text-red-600 p-1 rounded-full hover:bg-red-50 transition-colors",title:"Kitabı Sil",children:e.jsx(Q,{size:16})})})]},u.id))})]})}),e.jsx("div",{className:"md:hidden space-y-4 no-print",children:o.length===0?e.jsx("div",{className:"bg-white p-6 rounded-xl text-center text-gray-400 border border-gray-200",children:"Kitap bulunamadı."}):o.map(u=>e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200 flex justify-between items-start",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"font-bold text-gray-900",children:u.title}),e.jsx("p",{className:"text-sm text-gray-500",children:u.author}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-[10px] font-mono bg-gray-100 px-2 py-0.5 rounded text-gray-600",children:u.isbn}),e.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full font-bold ${u.status===L.AVAILABLE?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:y(u.status)})]})]}),e.jsx("button",{onClick:()=>c(u.id),className:"text-red-400 hover:text-red-600 p-2 rounded-lg bg-red-50 transition-colors",title:"Kitabı Sil",children:e.jsx(Q,{size:18})})]},u.id))}),e.jsxs("div",{className:"print-only",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6 text-center",children:"Kitap Envanteri QR Kodları"}),e.jsx("div",{className:"grid grid-cols-4 gap-4",children:o.map(u=>e.jsx(je,{value:u.isbn,label:u.title.substring(0,20)+(u.title.length>20?"...":""),subLabel:u.isbn},u.id))})]})]})},ft=()=>{const[l,n]=b.useState([]),[o,i]=b.useState([]),[h,d]=b.useState(""),[x,m]=b.useState(!1),[t,a]=b.useState({name:"",studentNumber:"",email:"",grade:""}),[s,r]=b.useState(null),[c,p]=b.useState([]),[g,y]=b.useState(!1),u=async()=>{const f=await M.getStudents();n(f),i(f)};b.useEffect(()=>{u()},[]),b.useEffect(()=>{const f=h.toLowerCase(),A=l.filter(j=>j.name.toLowerCase().includes(f)||j.studentNumber.includes(f)||j.grade.toLowerCase().includes(f));i(A)},[h,l]);const C=async f=>{if(f.preventDefault(),t.name&&t.studentNumber){const A=await M.addStudent(t);A.success?(a({name:"",studentNumber:"",email:"",grade:""}),m(!1),u()):alert(A.message)}},E=async f=>{window.confirm("Bu öğrenciyi silmek istediğinize emin misiniz?")&&(await M.deleteStudent(f),u())},N=()=>{window.print()},S=async f=>{r(f),y(!0);try{const A=await M.getBooks(),j=f.readingHistory.map(v=>A.find(k=>k.id===v)).filter(v=>v!==void 0);p(j)}catch(A){console.error("Failed to fetch history",A)}finally{y(!1)}},R=async f=>{if(s&&window.confirm("Bu kitabı öğrencinin geçmişinden silmek istediğinize emin misiniz?")){const A=await M.removeBookFromHistory(s.id,f);A.success?(p(j=>j.filter(v=>v.id!==f)),n(j=>j.map(v=>v.id===s.id?{...v,readingHistory:(v.readingHistory||[]).filter(k=>k!==f)}:v))):alert(A.message)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 no-print",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Öğrenci Veritabanı"}),e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(pe,{size:18,className:"text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Öğrenci ara...",className:"pl-10 block w-full rounded-lg border-gray-300 border py-2 px-4 focus:ring-indigo-500 focus:border-indigo-500",value:h,onChange:f=>d(f.target.value)})]}),e.jsxs("div",{className:"flex space-x-3 w-full md:w-auto",children:[e.jsxs("button",{onClick:N,className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 flex items-center justify-center space-x-2 flex-1 md:flex-none",children:[e.jsx(ge,{size:18}),e.jsx("span",{children:"Kart Yazdır"})]}),e.jsxs("button",{onClick:()=>m(!x),className:"bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 flex items-center justify-center space-x-2 flex-1 md:flex-none",children:[e.jsx(me,{size:18}),e.jsx("span",{children:"Ekle"})]})]})]}),x&&e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md border border-indigo-100 no-print",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Yeni Öğrenci Kaydet"}),e.jsxs("form",{onSubmit:C,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("input",{placeholder:"Ad Soyad",className:"border p-2 rounded",value:t.name,onChange:f=>a({...t,name:f.target.value}),required:!0}),e.jsx("input",{placeholder:"Öğrenci No (ID)",className:"border p-2 rounded",value:t.studentNumber,onChange:f=>a({...t,studentNumber:f.target.value}),required:!0}),e.jsx("input",{placeholder:"Email",type:"email",className:"border p-2 rounded",value:t.email,onChange:f=>a({...t,email:f.target.value})}),e.jsx("input",{placeholder:"Sınıf / Şube",className:"border p-2 rounded",value:t.grade,onChange:f=>a({...t,grade:f.target.value})}),e.jsx("button",{type:"submit",className:"col-span-2 bg-indigo-600 text-white p-2 rounded hover:bg-indigo-700",children:"Öğrenciyi Kaydet"})]})]}),e.jsx("div",{className:"hidden md:block bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden no-print",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-sm font-medium text-gray-500",children:"İsim"}),e.jsx("th",{className:"px-6 py-3 text-sm font-medium text-gray-500",children:"Öğrenci No"}),e.jsx("th",{className:"px-6 py-3 text-sm font-medium text-gray-500",children:"Sınıf"}),e.jsx("th",{className:"px-6 py-3 text-sm font-medium text-gray-500",children:"Geçmiş"}),e.jsx("th",{className:"px-6 py-3 text-sm font-medium text-gray-500 text-right",children:"İşlem"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:o.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-6 text-gray-400",children:"Öğrenci bulunamadı."})}):o.map(f=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("button",{onClick:()=>S(f),className:"font-bold text-indigo-600 hover:text-indigo-800 hover:underline text-left",children:f.name})}),e.jsx("td",{className:"px-6 py-4 text-gray-500 font-mono",children:f.studentNumber}),e.jsx("td",{className:"px-6 py-4",children:f.grade}),e.jsxs("td",{className:"px-6 py-4 text-sm text-gray-500",children:[f.readingHistory.length," kitap okudu"]}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("button",{onClick:()=>E(f.id),className:"text-red-400 hover:text-red-600 p-1 rounded-full hover:bg-red-50 transition-colors",title:"Öğrenciyi Sil",children:e.jsx(Q,{size:16})})})]},f.id))})]})}),e.jsx("div",{className:"md:hidden space-y-4 no-print",children:o.length===0?e.jsx("div",{className:"bg-white p-6 rounded-xl text-center text-gray-400 border border-gray-200",children:"Öğrenci bulunamadı."}):o.map(f=>e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200 flex justify-between items-start",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("button",{onClick:()=>S(f),className:"font-bold text-indigo-600 text-left",children:f.name}),e.jsx("p",{className:"text-sm text-gray-500 font-mono",children:f.studentNumber}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-[10px] bg-gray-100 px-2 py-0.5 rounded text-gray-600 font-bold uppercase",children:f.grade}),e.jsxs("span",{className:"text-[10px] bg-blue-50 px-2 py-0.5 rounded text-blue-600 font-bold",children:[f.readingHistory.length," Kitap"]})]})]}),e.jsx("button",{onClick:()=>E(f.id),className:"text-red-400 hover:text-red-600 p-2 rounded-lg bg-red-50 transition-colors",title:"Öğrenciyi Sil",children:e.jsx(Q,{size:18})})]},f.id))}),s&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-fade-in no-print",children:e.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-3xl shadow-2xl overflow-hidden animate-soft-fade max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"bg-indigo-600 p-6 text-white flex justify-between items-center shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-2xl flex items-center justify-center",children:e.jsx(He,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold",children:s.name}),e.jsx("p",{className:"text-indigo-100 text-sm",children:"Okuma Geçmişi Detayı"})]})]}),e.jsx("button",{onClick:()=>r(null),className:"p-2 hover:bg-white/10 rounded-full transition-colors",children:e.jsx(G,{size:24})})]}),e.jsx("div",{className:"p-6 overflow-y-auto flex-grow",children:g?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-gray-400",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600 mb-4"}),e.jsx("p",{children:"Geçmiş yükleniyor..."})]}):c.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-gray-400 space-y-4",children:[e.jsx(V,{size:48,className:"opacity-20"}),e.jsx("p",{className:"text-lg",children:"Bu öğrenci henüz hiç kitap okumamış."})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"font-bold text-gray-700 flex items-center gap-2",children:[e.jsx(V,{size:18,className:"text-indigo-500"}),"Toplam ",c.length," Kitap"]}),e.jsx("div",{className:"grid gap-3",children:c.map((f,A)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-2xl border border-gray-100 hover:border-indigo-100 transition-all group",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-white rounded-xl shadow-sm flex items-center justify-center text-indigo-500 group-hover:bg-indigo-500 group-hover:text-white transition-colors",children:e.jsx(V,{size:18})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-900 leading-tight",children:f.title}),e.jsx("p",{className:"text-sm text-gray-500",children:f.author})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"px-3 py-1 bg-indigo-50 text-indigo-600 rounded-full text-xs font-bold uppercase tracking-wider hidden sm:inline-block",children:f.category}),e.jsx("button",{onClick:()=>R(f.id),className:"p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-xl transition-colors",title:"Geçmişten Sil",children:e.jsx(Q,{size:18})})]})]},A))})]})}),e.jsx("div",{className:"p-6 bg-gray-50 border-t flex justify-end shrink-0",children:e.jsx("button",{onClick:()=>r(null),className:"px-6 py-2 bg-indigo-600 text-white rounded-xl font-bold hover:bg-indigo-700 transition-colors shadow-lg shadow-indigo-100",children:"Kapat"})})]})}),e.jsxs("div",{className:"print-only w-full",children:[e.jsx("h1",{className:"text-2xl font-bold mb-8 text-center",children:"Kütüphane Kartları"}),e.jsx("div",{className:"grid grid-cols-2 gap-8 w-full",children:o.map(f=>e.jsxs("div",{className:"border-2 border-black rounded-xl p-6 flex items-center justify-between break-inside-avoid shadow-none",children:[e.jsxs("div",{className:"flex-1 mr-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("div",{className:"w-8 h-8 bg-black rounded-full text-white flex items-center justify-center font-bold",children:"L"}),e.jsx("span",{className:"font-bold text-sm tracking-wider uppercase",children:"Okul Kütüphanesi"})]}),e.jsx("h3",{className:"text-xl font-bold uppercase mb-1",children:f.name}),e.jsx("p",{className:"text-lg font-mono mb-1",children:f.studentNumber}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:f.grade}),e.jsx("div",{className:"border-t-2 border-black pt-2 w-32",children:e.jsx("p",{className:"text-[10px] uppercase font-bold text-gray-500",children:"Yetkili İmza"})})]}),e.jsx("div",{children:e.jsx(je,{value:f.studentNumber,label:"",size:96})})]},f.id))})]})]})},yt=()=>{const[l,n]=b.useState(null),[o,i]=b.useState("dashboard"),h=()=>{n({id:"admin-1",name:"Admin User",email:"admin@library.school",role:"ADMIN"})},d=()=>{n(null),i("dashboard")};if(!l)return e.jsx(Je,{onLogin:h});const x=()=>{switch(o){case"dashboard":return e.jsx(ce,{});case"circulation":return e.jsx(tt,{});case"books":return e.jsx(pt,{});case"students":return e.jsx(ft,{});default:return e.jsx(ce,{})}};return e.jsx(Ze,{currentPage:o,onNavigate:i,onLogout:d,user:l,children:x()})};const Ne=document.getElementById("root");if(!Ne)throw new Error("Could not find root element to mount to");const bt=te.createRoot(Ne);bt.render(e.jsx(K.StrictMode,{children:e.jsx(yt,{})}));
