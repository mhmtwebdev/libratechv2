import{j as e,X as Y,b as h,_ as $}from"./index-c74f4282.js";import{r}from"./vendor-e917c440.js";import{F as I,P as O,Q as R}from"./QRCodeDisplay-4945ddc1.js";import{G as X}from"./graduation-cap-27a2e989.js";import{S as q}from"./search-a6b4a219.js";import{P as N}from"./printer-04216ae2.js";import{B as p}from"./book-16f270dc.js";import{T as w}from"./trash-2-841cd29f.js";import{C as Q}from"./clipboard-list-0ce05f88.js";const ae=()=>{const[u,v]=r.useState([]),[c,k]=r.useState([]),[b,B]=r.useState(""),[n,o]=r.useState([]),[g,E]=r.useState(!1),[S,z]=r.useState(!1),[i,x]=r.useState({name:"",studentNumber:"",email:"",grade:""}),[m,f]=r.useState(null),[j,C]=r.useState([]),[L,_]=r.useState(!1),y=async()=>{const s=[...await h.getStudents()].sort((a,l)=>a.name.localeCompare(l.name,"tr",{sensitivity:"base"}));v(s),k(s)};r.useEffect(()=>{y()},[]),r.useEffect(()=>{const t=b.toLowerCase(),s=u.filter(a=>a.name.toLowerCase().includes(t)||a.studentNumber.includes(t)||a.grade.toLowerCase().includes(t));k(s)},[b,u]);const A=()=>{o(g?[]:c.map(t=>t.id)),E(!g)},H=t=>{o(s=>s.includes(t)?s.filter(a=>a!==t):[...s,t])},F=async t=>{if(t.preventDefault(),i.name&&i.studentNumber){const s=await h.addStudent(i);s.success?(x({name:"",studentNumber:"",email:"",grade:""}),z(!1),y()):alert(s.message)}},K=async t=>{window.confirm("Bu öğrenciyi silmek istediğinize emin misiniz?")&&(await h.deleteStudent(t),y())},D=()=>{window.print()},P=async()=>{const t=c.map(d=>({"Ad Soyad":d.name,"Öğrenci No":d.studentNumber,Sınıf:d.grade,"Okuduğu Kitap Sayısı":d.readingHistory?d.readingHistory.length:0,Email:d.email||"Belirtilmemiş"})),s=await $(()=>import("./xlsx-6ed613d4.js"),[]),a=s.utils.json_to_sheet(t),l=s.utils.book_new();s.utils.book_append_sheet(l,a,"Öğrenciler"),s.writeFile(l,`Ogrenci_Listesi_${new Date().toLocaleDateString("tr-TR")}.xlsx`)},T=async t=>{f(t),_(!0);try{const s=await h.getBooks(),a=t.readingHistory.map(l=>s.find(d=>d.id===l)).filter(l=>l!==void 0);C(a)}catch(s){console.error("Failed to fetch history",s)}finally{_(!1)}},G=async t=>{if(m&&window.confirm("Bu kitabı öğrencinin geçmişinden silmek istediğinize emin misiniz?")){const s=await h.removeBookFromHistory(m.id,t);s.success?(C(a=>a.filter(l=>l.id!==t)),v(a=>a.map(l=>l.id===m.id?{...l,readingHistory:(l.readingHistory||[]).filter(d=>d!==t)}:l))):alert(s.message)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 no-print",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-cyan-100 rounded-xl text-cyan-600",children:e.jsx(X,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-slate-800 uppercase tracking-tight",children:"Öğrenci Veritabanı"}),e.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase tracking-widest",children:"Kütüphane Üyeleri"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-3 w-full md:w-auto items-stretch md:items-center",children:[e.jsxs("div",{className:"relative group w-full md:w-64",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(q,{size:18,className:"text-slate-400 group-focus-within:text-cyan-500 transition-colors"})}),e.jsx("input",{id:"student-search",name:"student-search",type:"text",placeholder:"Öğrenci ara...",className:"pl-10 block w-full rounded-xl border-2 border-slate-200 bg-white py-2.5 px-4 font-bold text-slate-700 placeholder:text-slate-400 focus:border-cyan-500 focus:ring-0 transition-all outline-none",value:b,onChange:t=>B(t.target.value)})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:P,className:"bg-emerald-50 text-emerald-600 px-4 py-2.5 rounded-xl hover:bg-emerald-100 font-bold text-sm uppercase tracking-wide flex items-center justify-center gap-2 transition-all flex-1 md:flex-none border border-emerald-100",children:[e.jsx(I,{size:18}),e.jsx("span",{className:"hidden lg:inline",children:"Excel"})]}),e.jsxs("button",{onClick:D,className:`${n.length>0?"bg-emerald-600 text-white":"bg-slate-100 text-slate-600"} px-4 py-2.5 rounded-xl hover:opacity-90 font-bold text-sm uppercase tracking-wide flex items-center justify-center gap-2 transition-all flex-1 md:flex-none`,children:[e.jsx(N,{size:18}),e.jsx("span",{className:"hidden lg:inline",children:n.length>0?`Seçilenleri Yazdır (${n.length})`:"Tümünü Yazdır"}),e.jsx("span",{className:"lg:hidden",children:n.length>0?`(${n.length})`:""})]}),e.jsxs("button",{onClick:()=>z(!S),className:"bg-cyan-600 text-white px-6 py-2.5 rounded-xl hover:bg-cyan-700 font-bold text-sm uppercase tracking-wide flex items-center justify-center gap-2 shadow-lg shadow-cyan-600/20 transition-all flex-1 md:flex-none",children:[e.jsx(O,{size:18}),e.jsx("span",{children:"Ekle"})]})]})]})]}),S&&e.jsxs("div",{className:"bg-white p-8 rounded-[2rem] shadow-xl shadow-slate-200/50 border border-slate-100 no-print animate-soft-fade",children:[e.jsxs("h3",{className:"text-lg font-black text-slate-800 uppercase tracking-tight mb-6 flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-6 bg-cyan-500 rounded-full"}),"Yeni Öğrenci Kaydet"]}),e.jsxs("form",{onSubmit:F,className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{htmlFor:"student-name",className:"text-[10px] uppercase tracking-widest font-black text-slate-400 ml-1",children:"Ad Soyad"}),e.jsx("input",{id:"student-name",name:"student-name",placeholder:"Örn: Ahmet Yılmaz",className:"w-full bg-slate-50 border-2 border-slate-100 rounded-xl p-3 font-bold text-slate-700 outline-none focus:border-cyan-500 transition-all",value:i.name,onChange:t=>x({...i,name:t.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{htmlFor:"student-id",className:"text-[10px] uppercase tracking-widest font-black text-slate-400 ml-1",children:"Öğrenci No (ID)"}),e.jsx("input",{id:"student-id",name:"student-id",placeholder:"Örn: 123",className:"w-full bg-slate-50 border-2 border-slate-100 rounded-xl p-3 font-bold text-slate-700 outline-none focus:border-cyan-500 transition-all",value:i.studentNumber,onChange:t=>x({...i,studentNumber:t.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{htmlFor:"student-email",className:"text-[10px] uppercase tracking-widest font-black text-slate-400 ml-1",children:"Email (İsteğe Bağlı)"}),e.jsx("input",{id:"student-email",name:"student-email",placeholder:"ogrenci@okul.com",type:"email",className:"w-full bg-slate-50 border-2 border-slate-100 rounded-xl p-3 font-bold text-slate-700 outline-none focus:border-cyan-500 transition-all",value:i.email,onChange:t=>x({...i,email:t.target.value})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{htmlFor:"student-grade",className:"text-[10px] uppercase tracking-widest font-black text-slate-400 ml-1",children:"Sınıf / Şube"}),e.jsx("input",{id:"student-grade",name:"student-grade",placeholder:"Örn: 10-A",className:"w-full bg-slate-50 border-2 border-slate-100 rounded-xl p-3 font-bold text-slate-700 outline-none focus:border-cyan-500 transition-all",value:i.grade,onChange:t=>x({...i,grade:t.target.value})})]}),e.jsx("button",{type:"submit",className:"md:col-span-2 bg-cyan-600 text-white rounded-xl py-4 font-black text-sm uppercase tracking-widest hover:bg-cyan-700 shadow-lg shadow-cyan-600/20 active:scale-[0.98] transition-all",children:"Öğrenciyi Kaydet"})]})]}),e.jsx("div",{className:"hidden md:block bg-white rounded-[2.5rem] shadow-xl shadow-slate-200/50 border border-slate-100 overflow-hidden no-print",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-slate-50/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-5 no-print",children:e.jsx("input",{type:"checkbox",checked:g&&c.length>0,onChange:A,className:"w-5 h-5 rounded border-2 border-slate-300 text-cyan-600 focus:ring-cyan-500 cursor-pointer"})}),e.jsx("th",{className:"px-6 py-5 text-[11px] font-black text-slate-400 uppercase tracking-widest",children:"İsim"}),e.jsx("th",{className:"px-8 py-5 text-[11px) font-black text-slate-400 uppercase tracking-widest",children:"Öğrenci No"}),e.jsx("th",{className:"px-8 py-5 text-[11px] font-black text-slate-400 uppercase tracking-widest",children:"Sınıf"}),e.jsx("th",{className:"px-8 py-5 text-[11px] font-black text-slate-400 uppercase tracking-widest",children:"Geçmiş"}),e.jsx("th",{className:"px-8 py-5 text-[11px] font-black text-slate-400 uppercase tracking-widest text-right",children:"İşlem"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50",children:c.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-12 text-slate-400 font-bold",children:"Öğrenci bulunamadı."})}):c.map(t=>e.jsxs("tr",{className:`hover:bg-slate-50 transition-colors group ${n.includes(t.id)?"bg-cyan-50/50":""}`,children:[e.jsx("td",{className:"px-6 py-4 no-print",children:e.jsx("input",{type:"checkbox",checked:n.includes(t.id),onChange:()=>H(t.id),className:"w-5 h-5 rounded border-2 border-slate-300 text-cyan-600 focus:ring-cyan-500 cursor-pointer"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("button",{onClick:()=>T(t),className:"font-bold text-slate-800 hover:text-cyan-600 hover:underline text-left text-lg transition-colors",children:t.name})}),e.jsx("td",{className:"px-8 py-4 text-slate-500 font-mono font-medium",children:t.studentNumber}),e.jsx("td",{className:"px-8 py-4",children:e.jsx("span",{className:"text-xs font-bold text-slate-600 bg-slate-100 px-2 py-1 rounded-lg border border-slate-200",children:t.grade})}),e.jsx("td",{className:"px-8 py-4 text-sm font-bold text-slate-500",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{size:16,className:"text-cyan-400"}),t.readingHistory.length," Kitap"]})}),e.jsx("td",{className:"px-8 py-4 text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>{o([t.id]),setTimeout(()=>window.print(),100)},className:"text-slate-400 hover:text-cyan-600 p-2 rounded-xl hover:bg-cyan-50 transition-all no-print",title:"Sadece Bu Kartı Yazdır",children:e.jsx(N,{size:18})}),e.jsx("button",{onClick:()=>K(t.id),className:"text-slate-400 hover:text-rose-600 p-2 rounded-xl hover:bg-rose-50 transition-all no-print",title:"Öğrenciyi Sil",children:e.jsx(w,{size:18})})]})})]},t.id))})]})}),e.jsx("div",{className:"md:hidden space-y-4 no-print",children:c.length===0?e.jsx("div",{className:"bg-white p-8 rounded-2xl text-center text-slate-400 font-bold border border-slate-100",children:"Öğrenci bulunamadı."}):c.map(t=>e.jsxs("div",{className:`bg-white p-5 rounded-2xl shadow-sm border transition-all ${n.includes(t.id)?"border-cyan-200 bg-cyan-50/30":"border-slate-100"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("input",{type:"checkbox",checked:n.includes(t.id),onChange:()=>H(t.id),className:"w-6 h-6 rounded-lg border-2 border-slate-300 text-cyan-600 focus:ring-cyan-500 cursor-pointer"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{o([t.id]),setTimeout(()=>window.print(),100)},className:"text-slate-400 p-2 rounded-xl bg-slate-50 active:bg-cyan-100 transition-colors",children:e.jsx(N,{size:20})}),e.jsx("button",{onClick:()=>K(t.id),className:"text-slate-400 p-2 rounded-xl bg-slate-50 active:bg-rose-100 transition-colors",children:e.jsx(w,{size:20})})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("button",{onClick:()=>T(t),className:"font-bold text-slate-900 text-lg hover:text-cyan-600 text-left transition-colors",children:t.name}),e.jsx("p",{className:"text-sm text-slate-500 font-mono",children:t.studentNumber}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsx("span",{className:"text-[10px] bg-slate-100 px-2 py-1 rounded border border-slate-200 text-slate-600 font-bold uppercase",children:t.grade}),e.jsxs("span",{className:"text-[10px] bg-cyan-50 px-2 py-1 rounded text-cyan-600 font-bold flex items-center gap-1",children:[e.jsx(p,{size:12}),t.readingHistory.length," Kitap"]})]})]})]},t.id))}),m&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/40 backdrop-blur-md animate-fade-in no-print",children:e.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-[2rem] shadow-2xl overflow-hidden animate-soft-fade max-h-[90vh] flex flex-col border border-white/20",children:[e.jsxs("div",{className:"bg-cyan-600 p-8 text-white flex justify-between items-center shrink-0 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"}),e.jsxs("div",{className:"flex items-center gap-5 relative z-10",children:[e.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl backdrop-blur-sm flex items-center justify-center shadow-inner border border-white/10",children:e.jsx(Q,{size:28,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-black tracking-tight",children:m.name}),e.jsx("p",{className:"text-cyan-100 text-sm font-medium",children:"Okuma Geçmişi Detayı"})]})]}),e.jsx("button",{onClick:()=>f(null),className:"p-2 hover:bg-white/20 rounded-xl transition-colors relative z-10",children:e.jsx(Y,{size:24})})]}),e.jsx("div",{className:"p-8 overflow-y-auto flex-grow bg-slate-50",children:L?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-slate-400",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-4 border-cyan-500 mb-4"}),e.jsx("p",{className:"font-bold",children:"Geçmiş yükleniyor..."})]}):j.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-slate-400 space-y-4",children:[e.jsx("div",{className:"p-6 bg-slate-100 rounded-full border border-slate-200",children:e.jsx(p,{size:48,className:"opacity-40"})}),e.jsx("p",{className:"text-lg font-bold",children:"Bu öğrenci henüz hiç kitap okumamış."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h4",{className:"font-bold text-slate-400 uppercase tracking-widest text-xs flex items-center gap-2",children:[e.jsx(p,{size:14,className:"text-cyan-500"}),"Toplam ",j.length," Kitap"]}),e.jsx("div",{className:"grid gap-3",children:j.map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between p-5 bg-white rounded-2xl shadow-sm border border-slate-100 hover:shadow-md hover:border-cyan-100 transition-all group",children:[e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-50 rounded-xl flex items-center justify-center text-slate-400 group-hover:bg-cyan-500 group-hover:text-white transition-all shadow-inner",children:e.jsx(p,{size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-800 leading-tight text-lg",children:t.title}),e.jsx("p",{className:"text-sm text-slate-500 font-medium",children:t.author})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"px-3 py-1 bg-cyan-50 text-cyan-600 rounded-lg text-[10px] font-black uppercase tracking-wider hidden sm:inline-block border border-cyan-100",children:t.category}),e.jsx("button",{onClick:()=>G(t.id),className:"p-2 text-slate-400 hover:text-rose-500 hover:bg-rose-50 rounded-xl transition-colors",title:"Geçmişten Sil",children:e.jsx(w,{size:20})})]})]},s))})]})}),e.jsx("div",{className:"p-6 bg-white border-t border-slate-100 flex justify-end shrink-0",children:e.jsx("button",{onClick:()=>f(null),className:"px-8 py-3 bg-slate-100 text-slate-600 hover:bg-slate-200 rounded-xl font-bold transition-colors uppercase tracking-wide text-sm",children:"Kapat"})})]})}),e.jsxs("div",{className:"print-only w-full",children:[e.jsx("h1",{className:"text-2xl font-bold mb-8 text-center",children:n.length>0?"Seçilen Öğrenci Kütüphane Kartları":"Tüm Öğrenci Kütüphane Kartları"}),e.jsx("div",{className:"grid grid-cols-2 gap-8 w-full",children:(n.length>0?u.filter(t=>n.includes(t.id)):c).map(t=>e.jsxs("div",{className:"border-2 border-black rounded-xl p-6 flex items-center justify-between break-inside-avoid shadow-none",children:[e.jsxs("div",{className:"flex-1 mr-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("div",{className:"w-8 h-8 bg-black rounded-full text-white flex items-center justify-center font-bold",children:"L"}),e.jsx("span",{className:"font-bold text-sm tracking-wider uppercase",children:"Okul Kütüphanesi"})]}),e.jsx("h3",{className:"text-xl font-bold uppercase mb-1",children:t.name}),e.jsx("p",{className:"text-lg font-mono mb-1",children:t.studentNumber}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:t.grade}),e.jsx("div",{className:"border-t-2 border-black pt-2 w-32",children:e.jsx("p",{className:"text-[10px] uppercase font-bold text-gray-500",children:"Yetkili İmza"})})]}),e.jsx("div",{children:e.jsx(R,{value:t.studentNumber,label:"",size:96})})]},t.id))})]})]})};export{ae as Students};
