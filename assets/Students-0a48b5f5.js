import{j as e,L as t,_ as s}from"./index-655d3ef3.js";import{r as a,G as l,y as n,F as i,P as r,z as d,q as c,T as o,D as x,X as m}from"./ui-vendors-d35e5635.js";import{Q as h}from"./QRCodeDisplay-d70a0d15.js";import"./firebase-lib-1a6647fc.js";const p=()=>{const[p,u]=a.useState([]),[b,g]=a.useState([]),[f,j]=a.useState(""),[y,N]=a.useState([]),[w,v]=a.useState(!1),[k,z]=a.useState(!1),[S,C]=a.useState({name:"",studentNumber:"",email:"",grade:""}),[K,_]=a.useState(null),[B,D]=a.useState([]),[E,H]=a.useState(!1),L=async()=>{const e=[...await t.getStudents()].sort((e,t)=>e.name.localeCompare(t.name,"tr",{sensitivity:"base"}));u(e),g(e)};a.useEffect(()=>{L()},[]),a.useEffect(()=>{const e=f.toLowerCase(),t=p.filter(t=>t.name.toLowerCase().includes(e)||t.studentNumber.includes(e)||t.grade.toLowerCase().includes(e));g(t)},[f,p]);const T=e=>{N(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},F=async e=>{window.confirm("Bu öğrenciyi silmek istediğinize emin misiniz?")&&(await t.deleteStudent(e),L())},Y=async e=>{_(e),H(!0);try{const s=await t.getBooks(),a=e.readingHistory.map(e=>s.find(t=>t.id===e)).filter(e=>void 0!==e);D(a)}catch(s){}finally{H(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 no-print",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-cyan-100 rounded-xl text-cyan-600",children:e.jsx(l,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-slate-800 uppercase tracking-tight",children:"Öğrenci Veritabanı"}),e.jsx("p",{className:"text-xs text-slate-500 font-bold uppercase tracking-widest",children:"Kütüphane Üyeleri"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-3 w-full md:w-auto items-stretch md:items-center",children:[e.jsxs("div",{className:"relative group w-full md:w-64",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(n,{size:18,className:"text-slate-400 group-focus-within:text-cyan-500 transition-colors"})}),e.jsx("input",{id:"student-search",name:"student-search",type:"text",placeholder:"Öğrenci ara...",className:"pl-10 block w-full rounded-xl border-2 border-slate-200 bg-white py-2.5 px-4 font-bold text-slate-700 placeholder:text-slate-400 focus:border-cyan-500 focus:ring-0 transition-all outline-none",value:f,onChange:e=>j(e.target.value)})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:async()=>{const e=b.map(e=>({"Ad Soyad":e.name,"Öğrenci No":e.studentNumber,"Sınıf":e.grade,"Okuduğu Kitap Sayısı":e.readingHistory?e.readingHistory.length:0,Email:e.email||"Belirtilmemiş"})),t=await s(()=>import("./xlsx-b2cdeacf.js"),[]),a=t.utils.json_to_sheet(e),l=t.utils.book_new();t.utils.book_append_sheet(l,a,"Öğrenciler"),t.writeFile(l,`Ogrenci_Listesi_${(new Date).toLocaleDateString("tr-TR")}.xlsx`)},className:"bg-emerald-50 text-emerald-600 px-4 py-2.5 rounded-xl hover:bg-emerald-100 font-bold text-sm uppercase tracking-wide flex items-center justify-center gap-2 transition-all flex-1 md:flex-none border border-emerald-100",children:[e.jsx(i,{size:18}),e.jsx("span",{className:"hidden lg:inline",children:"Excel"})]}),e.jsxs("button",{onClick:()=>{window.print()},className:(y.length>0?"bg-emerald-600 text-white":"bg-slate-100 text-slate-600")+" px-4 py-2.5 rounded-xl hover:opacity-90 font-bold text-sm uppercase tracking-wide flex items-center justify-center gap-2 transition-all flex-1 md:flex-none",children:[e.jsx(r,{size:18}),e.jsx("span",{className:"hidden lg:inline",children:y.length>0?`Seçilenleri Yazdır (${y.length})`:"Tümünü Yazdır"}),e.jsx("span",{className:"lg:hidden",children:y.length>0?`(${y.length})`:""})]}),e.jsxs("button",{onClick:()=>z(!k),className:"bg-cyan-600 text-white px-6 py-2.5 rounded-xl hover:bg-cyan-700 font-bold text-sm uppercase tracking-wide flex items-center justify-center gap-2 shadow-lg shadow-cyan-600/20 transition-all flex-1 md:flex-none",children:[e.jsx(d,{size:18}),e.jsx("span",{children:"Ekle"})]})]})]})]}),k&&e.jsxs("div",{className:"bg-white p-8 rounded-[2rem] shadow-xl shadow-slate-200/50 border border-slate-100 no-print animate-soft-fade",children:[e.jsxs("h3",{className:"text-lg font-black text-slate-800 uppercase tracking-tight mb-6 flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-6 bg-cyan-500 rounded-full"}),"Yeni Öğrenci Kaydet"]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),S.name&&S.studentNumber){const e=await t.addStudent(S);e.success?(C({name:"",studentNumber:"",email:"",grade:""}),z(!1),L()):alert(e.message)}},className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{htmlFor:"student-name",className:"text-[10px] uppercase tracking-widest font-black text-slate-400 ml-1",children:"Ad Soyad"}),e.jsx("input",{id:"student-name",name:"student-name",placeholder:"Örn: Ahmet Yılmaz",className:"w-full bg-slate-50 border-2 border-slate-100 rounded-xl p-3 font-bold text-slate-700 outline-none focus:border-cyan-500 transition-all",value:S.name,onChange:e=>C({...S,name:e.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{htmlFor:"student-id",className:"text-[10px] uppercase tracking-widest font-black text-slate-400 ml-1",children:"Öğrenci No (ID)"}),e.jsx("input",{id:"student-id",name:"student-id",placeholder:"Örn: 123",className:"w-full bg-slate-50 border-2 border-slate-100 rounded-xl p-3 font-bold text-slate-700 outline-none focus:border-cyan-500 transition-all",value:S.studentNumber,onChange:e=>C({...S,studentNumber:e.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{htmlFor:"student-email",className:"text-[10px] uppercase tracking-widest font-black text-slate-400 ml-1",children:"Email (İsteğe Bağlı)"}),e.jsx("input",{id:"student-email",name:"student-email",placeholder:"ogrenci@okul.com",type:"email",className:"w-full bg-slate-50 border-2 border-slate-100 rounded-xl p-3 font-bold text-slate-700 outline-none focus:border-cyan-500 transition-all",value:S.email,onChange:e=>C({...S,email:e.target.value})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{htmlFor:"student-grade",className:"text-[10px] uppercase tracking-widest font-black text-slate-400 ml-1",children:"Sınıf / Şube"}),e.jsx("input",{id:"student-grade",name:"student-grade",placeholder:"Örn: 10-A",className:"w-full bg-slate-50 border-2 border-slate-100 rounded-xl p-3 font-bold text-slate-700 outline-none focus:border-cyan-500 transition-all",value:S.grade,onChange:e=>C({...S,grade:e.target.value})})]}),e.jsx("button",{type:"submit",className:"md:col-span-2 bg-cyan-600 text-white rounded-xl py-4 font-black text-sm uppercase tracking-widest hover:bg-cyan-700 shadow-lg shadow-cyan-600/20 active:scale-[0.98] transition-all",children:"Öğrenciyi Kaydet"})]})]}),e.jsx("div",{className:"hidden md:block bg-white rounded-[2.5rem] shadow-xl shadow-slate-200/50 border border-slate-100 overflow-hidden no-print",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-slate-50/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-5 no-print",children:e.jsx("input",{type:"checkbox",checked:w&&b.length>0,onChange:()=>{N(w?[]:b.map(e=>e.id)),v(!w)},className:"w-5 h-5 rounded border-2 border-slate-300 text-cyan-600 focus:ring-cyan-500 cursor-pointer"})}),e.jsx("th",{className:"px-6 py-5 text-[11px] font-black text-slate-400 uppercase tracking-widest",children:"İsim"}),e.jsx("th",{className:"px-8 py-5 text-[11px) font-black text-slate-400 uppercase tracking-widest",children:"Öğrenci No"}),e.jsx("th",{className:"px-8 py-5 text-[11px] font-black text-slate-400 uppercase tracking-widest",children:"Sınıf"}),e.jsx("th",{className:"px-8 py-5 text-[11px] font-black text-slate-400 uppercase tracking-widest",children:"Geçmiş"}),e.jsx("th",{className:"px-8 py-5 text-[11px] font-black text-slate-400 uppercase tracking-widest text-right",children:"İşlem"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-50",children:0===b.length?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-12 text-slate-400 font-bold",children:"Öğrenci bulunamadı."})}):b.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group "+(y.includes(t.id)?"bg-cyan-50/50":""),children:[e.jsx("td",{className:"px-6 py-4 no-print",children:e.jsx("input",{type:"checkbox",checked:y.includes(t.id),onChange:()=>T(t.id),className:"w-5 h-5 rounded border-2 border-slate-300 text-cyan-600 focus:ring-cyan-500 cursor-pointer"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("button",{onClick:()=>Y(t),className:"font-bold text-slate-800 hover:text-cyan-600 hover:underline text-left text-lg transition-colors",children:t.name})}),e.jsx("td",{className:"px-8 py-4 text-slate-500 font-mono font-medium",children:t.studentNumber}),e.jsx("td",{className:"px-8 py-4",children:e.jsx("span",{className:"text-xs font-bold text-slate-600 bg-slate-100 px-2 py-1 rounded-lg border border-slate-200",children:t.grade})}),e.jsx("td",{className:"px-8 py-4 text-sm font-bold text-slate-500",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{size:16,className:"text-cyan-400"}),t.readingHistory.length," Kitap"]})}),e.jsx("td",{className:"px-8 py-4 text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>{N([t.id]),setTimeout(()=>window.print(),100)},className:"text-slate-400 hover:text-cyan-600 p-2 rounded-xl hover:bg-cyan-50 transition-all no-print",title:"Sadece Bu Kartı Yazdır",children:e.jsx(r,{size:18})}),e.jsx("button",{onClick:()=>F(t.id),className:"text-slate-400 hover:text-rose-600 p-2 rounded-xl hover:bg-rose-50 transition-all no-print",title:"Öğrenciyi Sil",children:e.jsx(o,{size:18})})]})})]},t.id))})]})}),e.jsx("div",{className:"md:hidden space-y-4 no-print",children:0===b.length?e.jsx("div",{className:"bg-white p-8 rounded-2xl text-center text-slate-400 font-bold border border-slate-100",children:"Öğrenci bulunamadı."}):b.map(t=>e.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-sm border transition-all "+(y.includes(t.id)?"border-cyan-200 bg-cyan-50/30":"border-slate-100"),children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("input",{type:"checkbox",checked:y.includes(t.id),onChange:()=>T(t.id),className:"w-6 h-6 rounded-lg border-2 border-slate-300 text-cyan-600 focus:ring-cyan-500 cursor-pointer"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{N([t.id]),setTimeout(()=>window.print(),100)},className:"text-slate-400 p-2 rounded-xl bg-slate-50 active:bg-cyan-100 transition-colors",children:e.jsx(r,{size:20})}),e.jsx("button",{onClick:()=>F(t.id),className:"text-slate-400 p-2 rounded-xl bg-slate-50 active:bg-rose-100 transition-colors",children:e.jsx(o,{size:20})})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("button",{onClick:()=>Y(t),className:"font-bold text-slate-900 text-lg hover:text-cyan-600 text-left transition-colors",children:t.name}),e.jsx("p",{className:"text-sm text-slate-500 font-mono",children:t.studentNumber}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsx("span",{className:"text-[10px] bg-slate-100 px-2 py-1 rounded border border-slate-200 text-slate-600 font-bold uppercase",children:t.grade}),e.jsxs("span",{className:"text-[10px] bg-cyan-50 px-2 py-1 rounded text-cyan-600 font-bold flex items-center gap-1",children:[e.jsx(c,{size:12}),t.readingHistory.length," Kitap"]})]})]})]},t.id))}),K&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/40 backdrop-blur-md animate-fade-in no-print",children:e.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-[2rem] shadow-2xl overflow-hidden animate-soft-fade max-h-[90vh] flex flex-col border border-white/20",children:[e.jsxs("div",{className:"bg-cyan-600 p-8 text-white flex justify-between items-center shrink-0 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"}),e.jsxs("div",{className:"flex items-center gap-5 relative z-10",children:[e.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-2xl backdrop-blur-sm flex items-center justify-center shadow-inner border border-white/10",children:e.jsx(x,{size:28,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-black tracking-tight",children:K.name}),e.jsx("p",{className:"text-cyan-100 text-sm font-medium",children:"Okuma Geçmişi Detayı"})]})]}),e.jsx("button",{onClick:()=>_(null),className:"p-2 hover:bg-white/20 rounded-xl transition-colors relative z-10",children:e.jsx(m,{size:24})})]}),e.jsx("div",{className:"p-8 overflow-y-auto flex-grow bg-slate-50",children:E?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-slate-400",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-4 border-cyan-500 mb-4"}),e.jsx("p",{className:"font-bold",children:"Geçmiş yükleniyor..."})]}):0===B.length?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-slate-400 space-y-4",children:[e.jsx("div",{className:"p-6 bg-slate-100 rounded-full border border-slate-200",children:e.jsx(c,{size:48,className:"opacity-40"})}),e.jsx("p",{className:"text-lg font-bold",children:"Bu öğrenci henüz hiç kitap okumamış."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h4",{className:"font-bold text-slate-400 uppercase tracking-widest text-xs flex items-center gap-2",children:[e.jsx(c,{size:14,className:"text-cyan-500"}),"Toplam ",B.length," Kitap"]}),e.jsx("div",{className:"grid gap-3",children:B.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-5 bg-white rounded-2xl shadow-sm border border-slate-100 hover:shadow-md hover:border-cyan-100 transition-all group",children:[e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-50 rounded-xl flex items-center justify-center text-slate-400 group-hover:bg-cyan-500 group-hover:text-white transition-all shadow-inner",children:e.jsx(c,{size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-800 leading-tight text-lg",children:s.title}),e.jsx("p",{className:"text-sm text-slate-500 font-medium",children:s.author})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"px-3 py-1 bg-cyan-50 text-cyan-600 rounded-lg text-[10px] font-black uppercase tracking-wider hidden sm:inline-block border border-cyan-100",children:s.category}),e.jsx("button",{onClick:()=>(async e=>{if(K&&window.confirm("Bu kitabı öğrencinin geçmişinden silmek istediğinize emin misiniz?")){const s=await t.removeBookFromHistory(K.id,e);s.success?(D(t=>t.filter(t=>t.id!==e)),u(t=>t.map(t=>t.id===K.id?{...t,readingHistory:(t.readingHistory||[]).filter(t=>t!==e)}:t))):alert(s.message)}})(s.id),className:"p-2 text-slate-400 hover:text-rose-500 hover:bg-rose-50 rounded-xl transition-colors",title:"Geçmişten Sil",children:e.jsx(o,{size:20})})]})]},a))})]})}),e.jsx("div",{className:"p-6 bg-white border-t border-slate-100 flex justify-end shrink-0",children:e.jsx("button",{onClick:()=>_(null),className:"px-8 py-3 bg-slate-100 text-slate-600 hover:bg-slate-200 rounded-xl font-bold transition-colors uppercase tracking-wide text-sm",children:"Kapat"})})]})}),e.jsxs("div",{className:"print-only w-full",children:[e.jsx("h1",{className:"text-2xl font-bold mb-8 text-center",children:y.length>0?"Seçilen Öğrenci Kütüphane Kartları":"Tüm Öğrenci Kütüphane Kartları"}),e.jsx("div",{className:"grid grid-cols-2 gap-8 w-full",children:(y.length>0?p.filter(e=>y.includes(e.id)):b).map(t=>e.jsxs("div",{className:"border-2 border-black rounded-xl p-6 flex items-center justify-between break-inside-avoid shadow-none",children:[e.jsxs("div",{className:"flex-1 mr-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("div",{className:"w-8 h-8 bg-black rounded-full text-white flex items-center justify-center font-bold",children:"L"}),e.jsx("span",{className:"font-bold text-sm tracking-wider uppercase",children:"Okul Kütüphanesi"})]}),e.jsx("h3",{className:"text-xl font-bold uppercase mb-1",children:t.name}),e.jsx("p",{className:"text-lg font-mono mb-1",children:t.studentNumber}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:t.grade}),e.jsx("div",{className:"border-t-2 border-black pt-2 w-32",children:e.jsx("p",{className:"text-[10px] uppercase font-bold text-gray-500",children:"Yetkili İmza"})})]}),e.jsx("div",{children:e.jsx(h,{value:t.studentNumber,label:"",size:96})})]},t.id))})]})]})};export{p as Students};
